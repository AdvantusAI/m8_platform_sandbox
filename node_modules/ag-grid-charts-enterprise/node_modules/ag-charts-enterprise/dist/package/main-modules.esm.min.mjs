var Zv=Object.defineProperty,$v=Object.getOwnPropertyDescriptor,d=(t,e,i,o)=>{for(var s=o>1?void 0:o?$v(e,i):e,a=t.length-1,n;a>=0;a--)(n=t[a])&&(s=(o?n(e,i,s):n(s))||s);return o&&s&&Zv(e,i,s),s};import{AgCharts as Qv,setupCommunityModules as qv}from"ag-charts-community";import{_ModuleSupport as Fa}from"ag-charts-community";import{_ModuleSupport as Jv,_Scale as tM,_Util as eM}from"ag-charts-community";function rc(t,e,i){const o=(a,n,r,l)=>{let c=t[0];for(let h=a;r>0?h<=n:h>n;h+=r){const p=t[h];if(l(c,p))return!0;c=p}return!1},s=Math.floor(t.length/2);return o(e,s,e,i)?!0:o(t.length-e,s,-e,i)}import{_ModuleSupport as iM}from"ag-charts-community";var{OR:oM,POSITIVE_NUMBER:sM,NAN:aM,AxisInterval:nM,Validate:rM}=iM,lc=class extends nM{constructor(){super(...arguments),this.minSpacing=NaN}};d([rM(oM(sM,aM))],lc.prototype,"minSpacing",2);import{_ModuleSupport as cc,_Scene as hc,_Util as lM}from"ag-charts-community";import{_ModuleSupport as cM,_Scale as Iu,_Scene as hM,_Util as dM}from"ag-charts-community";import{_ModuleSupport as pM,_Scene as uM,_Util as gM}from"ag-charts-community";var{BaseProperties:Nu,ChartAxisDirection:yM,ZIndexMap:dc,ARRAY:fM,BOOLEAN:pc,COLOR_STRING:uc,FONT_STYLE:mM,FONT_WEIGHT:xM,LINE_DASH:SM,NUMBER:Ou,OBJECT:bM,POSITIVE_NUMBER:vM,RATIO:Lu,STRING:Cu,UNION:Eu,AND:MM,Validate:kt,MATCHING_CROSSLINE_TYPE:_u}=pM,{Layer:Ru}=uM,{createId:TM}=gM,ti=class extends Nu{constructor(){super(...arguments),this.fontSize=14,this.fontFamily="Verdana, sans-serif",this.padding=5,this.color="rgba(87, 87, 87, 1)"}};d([kt(pc,{optional:!0})],ti.prototype,"enabled",2),d([kt(Cu,{optional:!0})],ti.prototype,"text",2),d([kt(mM,{optional:!0})],ti.prototype,"fontStyle",2),d([kt(xM,{optional:!0})],ti.prototype,"fontWeight",2),d([kt(vM)],ti.prototype,"fontSize",2),d([kt(Cu)],ti.prototype,"fontFamily",2),d([kt(Ou)],ti.prototype,"padding",2),d([kt(uc,{optional:!0})],ti.prototype,"color",2),d([kt(pc,{optional:!0})],ti.prototype,"parallel",2);var ee=class Tu extends Nu{constructor(){super(...arguments),this.id=TM(this),this.shape="polygon",this.label=new ti,this.scale=void 0,this.clippedRange=[-1/0,1/0],this.gridLength=0,this.sideFlag=-1,this.parallelFlipRotation=0,this.regularFlipRotation=0,this.direction=yM.X,this.axisInnerRadius=0,this.axisOuterRadius=0,this.group=new Ru({name:this.id,zIndex:Tu.LINE_LAYER_ZINDEX}),this.labelGroup=new Ru({name:this.id,zIndex:Tu.LABEL_LAYER_ZINDEX})}setSectorNodeProps(e){e.fill=this.fill,e.fillOpacity=this.fillOpacity??1,e.stroke=this.stroke,e.strokeOpacity=this.strokeOpacity??1,e.strokeWidth=this.strokeWidth??1,e.lineDash=this.lineDash}setLabelNodeProps(e,i,o,s,a){const{label:n}=this;e.x=i,e.y=o,e.text=n.text,e.textAlign="center",e.textBaseline=s,e.rotation=a,e.rotationCenterX=i,e.rotationCenterY=o,e.fill=n.color,e.fontFamily=n.fontFamily,e.fontSize=n.fontSize,e.fontStyle=n.fontStyle,e.visible=!0}};ee.LINE_LAYER_ZINDEX=dc.SERIES_CROSSLINE_LINE,ee.RANGE_LAYER_ZINDEX=dc.SERIES_CROSSLINE_RANGE,ee.LABEL_LAYER_ZINDEX=dc.SERIES_LABEL,d([kt(pc,{optional:!0})],ee.prototype,"enabled",2),d([kt(Eu(["range","line"],"a crossLine type"),{optional:!0})],ee.prototype,"type",2),d([kt(MM(_u("range"),fM.restrict({length:2})),{optional:!0})],ee.prototype,"range",2),d([kt(_u("value"),{optional:!0})],ee.prototype,"value",2),d([kt(uc,{optional:!0})],ee.prototype,"fill",2),d([kt(Lu,{optional:!0})],ee.prototype,"fillOpacity",2),d([kt(uc,{optional:!0})],ee.prototype,"stroke",2),d([kt(Ou,{optional:!0})],ee.prototype,"strokeWidth",2),d([kt(Lu,{optional:!0})],ee.prototype,"strokeOpacity",2),d([kt(SM,{optional:!0})],ee.prototype,"lineDash",2),d([kt(Eu(["polygon","circle"],"a shape"))],ee.prototype,"shape",2),d([kt(bM)],ee.prototype,"label",2);var wu=ee,{ChartAxisDirection:AM,validateCrossLineValues:DM}=cM,{Path:Pu,Sector:kM,RotatableText:IM,ContinuousScale:NM}=hM,{normalizeAngle360:gc,isNumberEqual:Bu}=dM,zu=class nc extends wu{constructor(){super(),this.direction=AM.X,this.polygonNode=new Pu,this.sectorNode=new kM,this.lineNode=new Pu,this.labelNode=new IM,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.group.append(this.lineNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:i,shape:o,type:s,value:a,range:n}=this;if(!i||!s||!DM(s,a,n,i,()=>{if(!NM.is(i))return!0;const[l,c]=n??[a,void 0],h=i.getDomain?.()??i.domain;return l>=h[0]&&l<=h[1]&&(s==="line"||c>=l&&c<=h[1])})){this.group.visible=!1,this.labelGroup.visible=!1;return}this.group.visible=e,this.labelGroup.visible=e,s==="line"&&o==="circle"&&i instanceof Iu.BandScale&&(this.type="range",this.range=[a,a]),this.updateLineNode(e),this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e)}updateLineNode(e){const{scale:i,type:o,value:s,lineNode:a}=this;let n;if(!e||o!=="line"||!i||isNaN(n=i.convert(s))){a.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this;a.visible=!0,a.stroke=this.stroke,a.strokeOpacity=this.strokeOpacity??1,a.strokeWidth=this.strokeWidth??1,a.fill=void 0,a.lineDash=this.lineDash;const c=l*Math.cos(n),h=l*Math.sin(n),p=r*Math.cos(n),u=r*Math.sin(n);a.path.clear(!0),a.path.moveTo(p,u),a.path.lineTo(c,h),this.group.zIndex=nc.LINE_LAYER_ZINDEX}updatePolygonNode(e){const{polygonNode:i,range:o,scale:s,shape:a,type:n}=this;let r;if(!e||n!=="range"||a!=="polygon"||!s||!o||!(r=s.ticks?.())){i.visible=!1;return}const{axisInnerRadius:l,axisOuterRadius:c}=this,h=r.indexOf(o[0]),p=r.indexOf(o[1]),y=(h<=p?r.slice(h,p+1):r.slice(h).concat(r.slice(0,p+1))).map(f=>s.convert(f));i.visible=!0,this.setSectorNodeProps(i);const{path:g}=i;g.clear(!0),y.forEach((f,m)=>{const v=c*Math.cos(f),b=c*Math.sin(f);m===0?g.moveTo(v,b):g.lineTo(v,b)}),l===0?g.lineTo(0,0):y.slice().reverse().forEach(f=>{const m=l*Math.cos(f),v=l*Math.sin(f);g.lineTo(m,v)}),i.path.closePath(),this.group.zIndex=nc.RANGE_LAYER_ZINDEX}updateSectorNode(e){const{sectorNode:i,range:o,scale:s,shape:a,type:n}=this;if(!e||n!=="range"||a!=="circle"||!s||!o){i.visible=!1;return}const{axisInnerRadius:r,axisOuterRadius:l}=this,c=o.map(u=>s.convert(u)),h=s.step??0,p=s instanceof Iu.BandScale?h/2:0;i.visible=!0,this.setSectorNodeProps(i),i.centerX=0,i.centerY=0,i.innerRadius=r,i.outerRadius=l,i.startAngle=c[0]-p,i.endAngle=c[1]+p,this.group.zIndex=nc.RANGE_LAYER_ZINDEX}updateLabelNode(e){const{label:i,labelNode:o,range:s,scale:a,type:n}=this;if(!e||i.enabled===!1||!i.text||!a||n==="range"&&!s){o.visible=!0;return}const{axisInnerRadius:r,axisOuterRadius:l}=this;let c,h,p,u;if(n==="line"){const y=gc(a.convert(this.value)),g=1.5*Math.PI,f=Bu(y,g)||y>g||y<Math.PI/2,m=(r+l)/2*Math.cos(y),v=(r+l)/2*Math.sin(y);c=m+i.padding*Math.cos(y+Math.PI/2),h=v+i.padding*Math.sin(y+Math.PI/2),u=f?"top":"bottom",p=f?y:y-Math.PI}else{const[y,g]=s.map(S=>gc(a.convert(S)));let f=(y+g)/2;y>g&&(f-=Math.PI),f=gc(f);const m=(Bu(f,0)||f>0)&&f<Math.PI;let v;const b=a.ticks?.()??[];this.shape==="circle"||b.length<3?v=l-i.padding:v=l*Math.cos(Math.PI/b.length)-i.padding,c=v*Math.cos(f),h=v*Math.sin(f),u=m?"bottom":"top",p=m?f-Math.PI/2:f+Math.PI/2}this.setLabelNodeProps(o,c,h,u,p)}};zu.className="AngleCrossLine";var Fu=zu,{AND:OM,ChartAxisDirection:LM,GREATER_THAN:CM,NUMBER:Vu,UNION:EM,ProxyOnWrite:_M,TextWrapper:RM,TextUtils:wM,Validate:yc}=cc,{Path:PM,RotatableText:BM}=hc,{angleBetween:zM,isNumberEqual:Ps,toRadians:fc,normalizeAngle360:Bs}=lM,mc=class extends cc.AxisLabel{constructor(){super(...arguments),this.orientation="fixed"}};d([yc(EM(["fixed","parallel","perpendicular"],"a label orientation"))],mc.prototype,"orientation",2);var Va=class extends cc.PolarAxis{constructor(t,e){super(t,e),this.startAngle=0,this.endAngle=void 0,this.labelData=[],this.tickData=[],this.radiusLine=this.axisGroup.appendChild(new PM),this.includeInvisibleDomains=!0}get direction(){return LM.X}createLabel(){return new mc}update(){return this.updateScale(),this.updatePosition(),this.updateGridLines(),this.updateTickLines(),this.updateLabels(),this.updateRadiusLine(),this.updateCrossLines(),this.tickData.length}computeRange(){const t=Bs(-Math.PI/2+fc(this.startAngle));let e=this.endAngle==null?t+Math.PI*2:-Math.PI/2+fc(this.endAngle);e<t&&(e+=2*Math.PI),this.range=[t,e]}calculateAvailableRange(){const{range:t,gridLength:e}=this;return zM(t[0],t[1])*e}updatePosition(){const{translation:t,axisGroup:e,gridGroup:i,crossLineGroup:o}=this,s=Math.floor(t.x),a=Math.floor(t.y);e.translationX=s,e.translationY=a,i.translationX=s,i.translationY=a,o.translationX=s,o.translationY=a}updateRadiusLine(){const t=this.radiusLine,{path:e}=t;e.clear(!0);const{points:i,closePath:o}=this.getAxisLinePoints();i.forEach(({x:s,y:a,moveTo:n,arc:r,radius:l=0,startAngle:c=0,endAngle:h=0})=>{r?e.arc(s,a,l,c,h):n?e.moveTo(s,a):e.lineTo(s,a)}),o&&e.closePath(),t.visible=this.line.enabled,t.stroke=this.line.stroke,t.strokeWidth=this.line.width,t.fill=void 0}getAxisLinePoints(){const{scale:t,shape:e,gridLength:i}=this,[o,s]=this.range,a=Ps(s-o,2*Math.PI),n=[];if(e==="circle")a?n.push({x:i,y:0,moveTo:!0},{x:0,y:0,radius:i,startAngle:0,endAngle:2*Math.PI,arc:!0,moveTo:!1}):n.push({x:i*Math.cos(o),y:i*Math.sin(o),moveTo:!0},{x:0,y:0,radius:i,startAngle:Bs(o),endAngle:Bs(s),arc:!0,moveTo:!1});else if(e==="polygon"){const r=t.ticks?.().map(l=>t.convert(l));r&&r.length>2&&r.forEach((l,c)=>{const h=i*Math.cos(l),p=i*Math.sin(l),u=c===0;n.push({x:h,y:p,moveTo:u})})}return{points:n,closePath:a}}updateGridLines(){const{scale:t,gridLength:e,gridLine:{enabled:i,style:o,width:s},innerRadiusRatio:a}=this;if(!(o&&e>0))return;const n=this.tickData,r=e*a,l=o.length,c=h=>h.value;this.gridLineGroupSelection.update(i?n:[],void 0,c).each((h,p,u)=>{const{value:y}=p,{stroke:g,lineDash:f}=o[u%l],m=t.convert(y);h.x1=r*Math.cos(m),h.y1=r*Math.sin(m),h.x2=e*Math.cos(m),h.y2=e*Math.sin(m),h.stroke=g,h.strokeWidth=s,h.lineDash=f,h.fill=void 0}),this.gridLineGroupSelection.cleanup()}updateLabels(){const{label:t,tickLabelGroupSelection:e}=this,i=this.tickData;e.update(t.enabled?i:[]).each((o,s,a)=>{const n=this.labelData[a];if(!n||n.hidden){o.visible=!1;return}o.text=n.text,o.setFont(t),o.fill=t.color,o.x=n.x,o.y=n.y,o.textAlign=n.textAlign,o.textBaseline=n.textBaseline,o.visible=!0,n.rotation?(o.rotation=n.rotation,o.rotationCenterX=n.x,o.rotationCenterY=n.y):o.rotation=0})}updateTickLines(){const{scale:t,gridLength:e,tick:i,tickLineGroupSelection:o}=this,s=this.tickData;o.update(i.enabled?s:[]).each((a,n)=>{const{value:r}=n,l=t.convert(r),c=Math.cos(l),h=Math.sin(l);a.x1=e*c,a.y1=e*h,a.x2=(e+i.size)*c,a.y2=(e+i.size)*h,a.stroke=i.stroke,a.strokeWidth=i.width})}createLabelNodeData(t,e,i){const{label:o,gridLength:s,scale:a,tick:n}=this;if(!o.enabled)return[];const r=new BM,l=i.x-this.translation.x,c=i.x+i.width-this.translation.x,h=t.map((p,u)=>{const{value:y}=p,g=s+o.padding+n.size,f=a.convert(y),m=Math.cos(f),v=Math.sin(f),b=g*m,S=g*v,{textAlign:x,textBaseline:M}=this.getLabelAlign(f),T=u===t.length-1&&y!==t[0]&&Ps(Bs(f),Bs(a.convert(t[0]))),A=this.getLabelRotation(f);let D=String(y);if(o.formatter){const{callbackCache:N}=this.moduleCtx;D=N.call(o.formatter,{value:y,index:u})??""}r.text=D,r.x=b,r.y=S,r.setFont(o),r.textAlign=x,r.textBaseline=M,r.rotation=A,A&&(r.rotationCenterX=b,r.rotationCenterY=S);let I=A?hc.Transformable.toCanvas(r):r.getBBox();if(I&&e.hideWhenNecessary&&!A){const N=l-I.x,O=I.x+I.width-c,L=1;if(N>L||O>L){const C=I.width-Math.max(N,O);D=RM.wrapText(D,{maxWidth:C,font:o,textWrap:"never"}),D===wM.EllipsisChar&&(D=""),r.text=D,I=r.getBBox()}}return{text:D,x:b,y:S,textAlign:x,textBaseline:M,hidden:D===""||p.hidden||T,rotation:A,box:I}});return o.avoidCollisions&&this.avoidLabelCollisions(h),h}computeLabelsBBox(t,e){this.tickData=this.generateAngleTicks(),this.labelData=this.createLabelNodeData(this.tickData,t,e);const i=this.labelData.map(({box:o})=>o).filter(o=>o!=null);return!this.label.enabled||i.length===0?null:hc.BBox.merge(i)}getLabelOrientation(){const{label:t}=this;return t instanceof mc?t.orientation:"fixed"}getLabelRotation(t){let e=fc(this.label.rotation??0);t=Bs(t);const i=this.getLabelOrientation();return i==="parallel"?(e+=t,t>=0&&t<Math.PI?e-=Math.PI/2:e+=Math.PI/2):i==="perpendicular"&&(e+=t,t>=Math.PI/2&&t<1.5*Math.PI&&(e+=Math.PI)),e}getLabelAlign(t){const e=Math.cos(t),i=Math.sin(t);let o,s;const a=this.getLabelOrientation(),n=Ps(e,0),r=Ps(i,0),l=Ps(e,1),c=Ps(i,-1),h=e>0&&!n,p=i>0&&!r;return a==="parallel"?(o="center",s=l&&r||p?"top":"bottom"):a==="perpendicular"?(o=c||h?"left":"right",s="middle"):(o="right",n?o="center":h&&(o="left"),s="bottom",r?s="middle":p&&(s="top")),{textAlign:o,textBaseline:s}}updateCrossLines(){this.crossLines?.forEach(t=>{if(t instanceof Fu){const{shape:e,gridLength:i,innerRadiusRatio:o}=this;t.shape=e,t.axisOuterRadius=i,t.axisInnerRadius=i*o}}),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}};Va.CrossLineConstructor=Fu,d([_M("rotation"),yc(Vu.restrict({min:0,max:360}))],Va.prototype,"startAngle",2),d([yc(OM(Vu.restrict({min:0,max:720}),CM("startAngle")),{optional:!0})],Va.prototype,"endAngle",2);var{RATIO:Uu,OBJECT:FM,Validate:xc}=Jv,{BandScale:VM}=tM,{isNumberEqual:Hu}=eM,Vo=class extends Va{constructor(t){super(t,new VM),this.groupPaddingInner=0,this.paddingInner=0,this.interval=new lc}generateAngleTicks(){const{scale:t,gridLength:e}=this,{values:i,minSpacing:o}=this.interval,s=i??t.ticks()??[];if(s.length<2||isNaN(o))return s.map(c=>({value:c,visible:!0}));const a=s[0],n=t.convert(a),r=e*Math.cos(n),l=e*Math.sin(n);for(let c=1;c<s.length-1;c++){const h=s[c],p=t.convert(h);if(p-n>Math.PI)break;const u=e*Math.cos(p),y=e*Math.sin(p);if(Math.sqrt((u-r)**2+(y-l)**2)>o){const f=new Set([a]);return rc(s,c,(m,v)=>{f.add(v)}),s.map(m=>{const v=f.has(m);return{value:m,visible:v}})}}return[{value:a,visible:!0}]}avoidLabelCollisions(t){let{minSpacing:e}=this.label;if(Number.isFinite(e)||(e=0),t.length<3)return;const i=(l,c)=>{if(l.hidden||c.hidden)return!1;const h=l.box.clone().grow(e/2),p=c.box.clone().grow(e/2);return h.collidesBBox(p)},o=t[0],s=t.at(-1),a=new Set([o]),n=Hu(o.x,s.x)&&Hu(o.y,s.y),r=Math.floor(t.length/2);for(let l=1;l<=r;l++){const c=n?t.slice(0,-1):t;if(!rc(c,l,i)){rc(c,l,(p,u)=>{a.add(u)});break}}t.forEach(l=>{a.has(l)||(l.hidden=!0,l.box=void 0)})}};Vo.className="AngleCategoryAxis",Vo.type="angle-category",d([xc(Uu)],Vo.prototype,"groupPaddingInner",2),d([xc(Uu)],Vo.prototype,"paddingInner",2),d([xc(FM)],Vo.prototype,"interval",2);var UM={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-category",moduleFactory:t=>new Vo(t)};import{_ModuleSupport as HM,_Util as GM}from"ag-charts-community";import{_Scale as WM,_Util as KM}from"ag-charts-community";var{LinearScale:YM,Invalidating:jM}=WM,{range:Gu,isDenseInterval:XM,isNumberEqual:ZM}=KM,Wu=class extends YM{constructor(){super(...arguments),this.arcLength=0,this.niceTickStep=0}ticks(){if(!this.domain||this.domain.length<2||this.domain.some(s=>!isFinite(s))||this.arcLength<=0)return[];this.refresh();const{interval:t}=this,[e,i]=this.getDomain();if(t){const s=Math.abs(t),a=this.getPixelRange();if(!XM((i-e)/s,a))return Gu(e,i,s)}const o=this.nice&&this.niceTickStep?this.niceTickStep:this.getTickStep(e,i);return Gu(e,i,o)}hasNiceRange(){const t=this.range.slice().sort((i,o)=>i-o);return[Math.PI,2*Math.PI].some(i=>ZM(i,t[1]-t[0]))}getNiceStepAndTickCount(){const[t,e]=this.niceDomain;let i=this.getTickStep(t,e);const o=isNaN(this.maxTickCount)?1/0:this.maxTickCount,s=Math.abs(e-t)/i;let a=Math.pow(2,Math.ceil(Math.log(s)/Math.log(2)));return a>o&&(a/=2,i*=2),{count:a,step:i}}updateNiceDomain(){if(super.updateNiceDomain(),!this.hasNiceRange())return;const t=this.niceDomain[0]>this.niceDomain[1],e=t?this.niceDomain[1]:this.niceDomain[0],{step:i,count:o}=this.getNiceStepAndTickCount(),s=1/i,a=i>=1?Math.ceil(e/i+o)*i:Math.ceil((e+o*i)*s)/s;this.niceDomain=t?[a,e]:[e,a],this.niceTickStep=i}getPixelRange(){return this.arcLength}};d([jM],Wu.prototype,"arcLength",2);var{AND:Ku,Default:Yu,GREATER_THAN:$M,LESS_THAN:QM,NUMBER_OR_NAN:ju,OBJECT:qM,Validate:Sc}=HM,{angleBetween:JM,isNumberEqual:Xu,normalisedExtentWithMetadata:tT,findMinMax:eT}=GM,zs=class extends Va{constructor(t){super(t,new Wu),this.shape="circle",this.min=NaN,this.max=NaN,this.interval=new lc}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=tT(t,e,i);return{domain:o,clipped:s}}getRangeArcLength(){const{range:t}=this,e=Math.min(...t),i=Math.max(...t),o=JM(e,i)||2*Math.PI,s=this.gridLength;return o*s}generateAngleTicks(){const t=this.getRangeArcLength(),{scale:e,range:i}=this,{values:o,minSpacing:s,maxSpacing:a}=this.interval,n=a?Math.floor(t/a):1,r=s?Math.floor(t/s):1/0,l=Math.floor(4/Math.PI*Math.abs(i[0]-i[1]));e.tickCount=Math.max(n,Math.min(r,l)),e.minTickCount=n,e.maxTickCount=r,e.arcLength=t;let c;if(o!=null){const[h,p]=eT(e.getDomain().map(Number));c=o.filter(u=>u>=h&&u<=p).sort((u,y)=>u-y)}else c=e.ticks();return c.map(h=>({value:h,visible:!0}))}avoidLabelCollisions(t){let{minSpacing:e}=this.label;Number.isFinite(e)||(e=0);const i=(a,n)=>{if(a.hidden||n.hidden)return!1;const r=a.box.clone().grow(e/2),l=n.box.clone().grow(e/2);return r.collidesBBox(l)},o=t[0],s=t.at(-1);o!==s&&Xu(o.x,s.x)&&Xu(o.y,s.y)&&(s.hidden=!0);for(let a=1;a<t.length;a*=2){let n=!1;for(let r=a;r<t.length;r+=a){const l=t[r],c=t[r-a];if(i(c,l)){n=!0;break}}if(!n){t.forEach((r,l)=>{l%a>0&&(r.hidden=!0,r.box=void 0)});return}}t.forEach((a,n)=>{n>0&&(a.hidden=!0,a.box=void 0)})}};zs.className="AngleNumberAxis",zs.type="angle-number",d([Sc(Ku(ju,QM("max"))),Yu(NaN)],zs.prototype,"min",2),d([Sc(Ku(ju,$M("min"))),Yu(NaN)],zs.prototype,"max",2),d([Sc(qM)],zs.prototype,"interval",2);var iT={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"angle-number",moduleFactory:t=>new zs(t)};import{_ModuleSupport as Zu,_Scale as oT}from"ag-charts-community";var{OrdinalTimeScale:sT}=oT,{dateToNumber:bc}=Zu,vc=class extends Zu.CategoryAxis{constructor(t){super(t,new sT)}normaliseDataDomain(t){const e=[],i=new Set;for(let o of t){typeof o=="number"&&(o=new Date(o));const s=bc(o);i.has(s)||(i.add(s),e.push(o))}return e.sort((o,s)=>bc(o)-bc(s)),{domain:e,clipped:!1}}onFormatChange(t,e,i,o){o?super.onFormatChange(t,e,i,o):this.labelFormatter=this.scale.tickFormat({ticks:t,domain:i})}};vc.className="OrdinalTimeAxis",vc.type="ordinal-time";var aT={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ordinal-time",moduleFactory:t=>new vc(t)};import{_ModuleSupport as nT,_Scale as rT}from"ag-charts-community";import{_ModuleSupport as Mc,_Scene as lT,_Util as cT}from"ag-charts-community";import{_ModuleSupport as hT,_Scale as $u,_Scene as dT,_Util as Tc}from"ag-charts-community";var{ChartAxisDirection:pT,Validate:uT,DEGREE:gT,validateCrossLineValues:yT}=hT,{Path:fT,Sector:mT,RotatableText:xT}=dT,{normalizeAngle360:ST,toRadians:bT,isNumberEqual:vT}=Tc,Qu=class extends ti{constructor(){super(...arguments),this.positionAngle=void 0}};d([uT(gT,{optional:!0})],Qu.prototype,"positionAngle",2);var qu=class Au extends wu{constructor(){super(),this.direction=pT.Y,this.label=new Qu,this.polygonNode=new fT,this.sectorNode=new mT,this.labelNode=new xT,this.outerRadius=0,this.innerRadius=0,this.group.append(this.polygonNode),this.group.append(this.sectorNode),this.labelGroup.append(this.labelNode)}update(e){const{scale:i,type:o,value:s,range:a}=this;if(!i||!o||!yT(o,s,a,i)){this.group.visible=!1,this.labelGroup.visible=!1;return}o==="line"&&i instanceof $u.BandScale&&(this.type="range",this.range=[s,s]),this.updateRadii();const{innerRadius:n,outerRadius:r}=this;e&&(e=n>=this.axisInnerRadius&&r<=this.axisOuterRadius),this.group.visible=e,this.labelGroup.visible=e,this.updatePolygonNode(e),this.updateSectorNode(e),this.updateLabelNode(e),this.group.zIndex=this.type==="line"?Au.LINE_LAYER_ZINDEX:Au.RANGE_LAYER_ZINDEX}updateRadii(){const{range:e,scale:i,type:o,axisInnerRadius:s,axisOuterRadius:a}=this;if(!i)return{innerRadius:0,outerRadius:0};const n=c=>a+s-c;let r=0,l=0;if(o==="line")r=n(i.convert(this.value)),l=r;else{const c=Math.abs(i?.bandwidth??0),h=e.map(p=>i.convert(p));r=n(Math.max(...h)),l=n(Math.min(...h))+c}this.outerRadius=r,this.innerRadius=l}drawPolygon(e,i,o){i.forEach((s,a)=>{const n=e*Math.cos(s),r=e*Math.sin(s);a===0?o.path.moveTo(n,r):o.path.lineTo(n,r)}),o.path.closePath()}updatePolygonNode(e){const{gridAngles:i,polygonNode:o,scale:s,shape:a,type:n,innerRadius:r,outerRadius:l}=this;if(!e||a!=="polygon"||!s||!i){o.visible=!1;return}o.visible=!0;const c=this.getPadding();o.path.clear(!0),this.drawPolygon(l-c,i,o);const h=i.slice().reverse(),p=n==="line"?l-c:r+c;this.drawPolygon(p,h,o),this.setSectorNodeProps(o)}updateSectorNode(e){const{axisInnerRadius:i,axisOuterRadius:o,scale:s,sectorNode:a,shape:n,innerRadius:r,outerRadius:l}=this;if(!e||n!=="circle"||!s){a.visible=!1;return}a.visible=!0,a.startAngle=0,a.endAngle=2*Math.PI;const c=this.getPadding(),h=Tc.clamp(i,r+c,o),p=Tc.clamp(i,l-c,o);a.innerRadius=Math.min(h,p),a.outerRadius=Math.max(h,p),this.setSectorNodeProps(a)}updateLabelNode(e){const{innerRadius:i,label:o,labelNode:s,scale:a,shape:n,type:r}=this;if(!e||o.enabled===!1||!o.text||!a){s.visible=!1;return}const l=ST(bT((o.positionAngle??0)-90)),c=(vT(l,0)||l>0)&&l<Math.PI,h=c?l-Math.PI/2:l+Math.PI/2;let p=0;const u=this.gridAngles??[];r==="line"?p=i+o.padding:n==="circle"||u.length<3?p=i-o.padding:p=i*Math.cos(Math.PI/u.length)-o.padding;const y=p*Math.cos(l),g=p*Math.sin(l);let f;r==="line"?f=c?"top":"bottom":f=c?"bottom":"top",this.setLabelNodeProps(s,y,g,f,h)}getPadding(){const{scale:e}=this;if(!e)return 0;const i=Math.abs(e.bandwidth??0),o=Math.abs(e.step??0);return e instanceof $u.BandScale?(o-i)/2:0}};qu.className="RadiusCrossLine";var Ju=qu,{ChartAxisDirection:MT,Default:TT,ZIndexMap:AT,DEGREE:tg,BOOLEAN:DT,Validate:Ac}=Mc,{Caption:kT,Group:IT,Path:NT,Selection:OT}=lT,{isNumberEqual:LT,normalizeAngle360:eg,toRadians:CT}=cT,Dc=class extends Mc.AxisLabel{constructor(){super(...arguments),this.autoRotateAngle=335}};d([Ac(DT,{optional:!0})],Dc.prototype,"autoRotate",2),d([Ac(tg)],Dc.prototype,"autoRotateAngle",2);var Gn=class extends Mc.PolarAxis{constructor(t,e){super(t,e),this.positionAngle=0,this.gridPathGroup=this.gridGroup.appendChild(new IT({name:`${this.id}-gridPaths`,zIndex:AT.AXIS_GRID})),this.gridPathSelection=OT.select(this.gridPathGroup,NT)}get direction(){return MT.Y}getAxisTransform(){const t=this.scale.range[0],{translation:e,positionAngle:i,innerRadiusRatio:o}=this,s=t*o,a=CT(i);return{translationX:e.x,translationY:e.y-t-s,rotation:a,rotationCenterX:0,rotationCenterY:t+s}}updateSelections(t,e,i){super.updateSelections(t,e,i);const{gridLine:{enabled:o,style:s,width:a},shape:n}=this;if(!s)return;const r=this.prepareTickData(e),l=s.length,c=(f,m)=>{const{stroke:v,lineDash:b}=s[m%l];f.stroke=v,f.strokeWidth=a,f.lineDash=b,f.fill=void 0},[h,p]=this.gridRange??[0,2*Math.PI],u=LT(p-h,2*Math.PI),y=(f,m)=>{const{path:v}=f;v.clear(!0);const b=this.getTickRadius(m);u?(v.moveTo(b,0),v.arc(0,0,b,0,2*Math.PI)):(v.moveTo(b*Math.cos(h),b*Math.sin(h)),v.arc(0,0,b,eg(h),eg(p))),u&&v.closePath()},g=(f,m)=>{const{path:v}=f,b=this.gridAngles;if(v.clear(!0),!b||b.length<3)return;const S=this.getTickRadius(m);b.forEach((x,M)=>{const T=S*Math.cos(x),A=S*Math.sin(x);M===0?v.moveTo(T,A):v.lineTo(T,A),b.forEach((D,I)=>{const N=S*Math.cos(D),O=S*Math.sin(D);I===0?v.moveTo(N,O):v.lineTo(N,O)}),v.closePath()}),v.closePath()};this.gridPathSelection.update(o?r:[]).each((f,m,v)=>{c(f,v),n==="circle"?y(f,m):g(f,m)})}updateTitle(){const t=r=>r.defaultValue,{title:e,range:i,moduleCtx:{callbackCache:o}}=this,{formatter:s=t}=this.title;e.caption.enabled=e.enabled,e.caption.fontFamily=e.fontFamily,e.caption.fontSize=e.fontSize,e.caption.fontStyle=e.fontStyle,e.caption.fontWeight=e.fontWeight,e.caption.color=e.color,e.caption.wrapping=e.wrapping;let a=!1;const n=e.caption.node;e.enabled&&(a=!0,n.rotation=Math.PI/2,n.x=Math.floor((i[0]+i[1])/2),n.y=-kT.SMALL_PADDING,n.textAlign="center",n.textBaseline="bottom",n.text=o.call(s,this.getTitleFormatterParams())),n.visible=a}updateCrossLines(){this.crossLines?.forEach(t=>{if(t instanceof Ju){const{shape:e,gridAngles:i,range:o,innerRadiusRatio:s}=this,a=o[0];t.shape=e,t.gridAngles=i,t.axisOuterRadius=a,t.axisInnerRadius=a*s}}),super.updateCrossLines({rotation:0,parallelFlipRotation:0,regularFlipRotation:0})}createLabel(){return new Dc}};Gn.CrossLineConstructor=Ju,d([Ac(tg),TT(0)],Gn.prototype,"positionAngle",2);var{RATIO:kc,ProxyPropertyOnWrite:ig,Validate:Ic}=nT,{BandScale:og}=rT,Uo=class extends Gn{constructor(t){super(t,new og),this.shape="circle",this.groupPaddingInner=0,this.paddingInner=0,this.paddingOuter=0}prepareTickData(t){return t.slice().reverse()}getTickRadius(t){const{scale:e,innerRadiusRatio:i}=this,o=e.range[0],s=o*i;if(e instanceof og){const a=e.ticks(),n=a.length-1-a.indexOf(t.tickId);return n===0?s:e.inset+e.step*(n-.5)+e.bandwidth/2}else{const a=(o-s)/e.domain.length;return o-t.translationY+s-a/2}}};Uo.className="RadiusCategoryAxis",Uo.type="radius-category",d([Ic(kc)],Uo.prototype,"groupPaddingInner",2),d([ig("scale","paddingInner"),Ic(kc)],Uo.prototype,"paddingInner",2),d([ig("scale","paddingOuter"),Ic(kc)],Uo.prototype,"paddingOuter",2);var ET={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-category",moduleFactory:t=>new Uo(t)};import{_ModuleSupport as _T,_Scale as RT,_Util as wT}from"ag-charts-community";var{AND:sg,Default:ag,GREATER_THAN:PT,LESS_THAN:BT,NUMBER_OR_NAN:ng,Validate:rg}=_T,{LinearScale:zT}=RT,{normalisedExtentWithMetadata:FT}=wT,Ua=class extends Gn{constructor(t){super(t,new zT),this.shape="polygon",this.min=NaN,this.max=NaN}prepareTickData(t){const{scale:e}=this,i=e.getDomain?.()[1];return t.filter(({tick:o})=>o!==i).sort((o,s)=>s.tick-o.tick)}getTickRadius(t){const{scale:e}=this,i=e.range[0],o=i*this.innerRadiusRatio;return i-t.translationY+o}normaliseDataDomain(t){const{min:e,max:i}=this,{extent:o,clipped:s}=FT(t,e,i);return{domain:o,clipped:s}}};Ua.className="RadiusNumberAxis",Ua.type="radius-number",d([rg(sg(ng,BT("max"))),ag(NaN)],Ua.prototype,"min",2),d([rg(sg(ng,PT("min"))),ag(NaN)],Ua.prototype,"max",2);var VT={type:"axis",optionsKey:"axes[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radius-number",moduleFactory:t=>new Ua(t)};import{_ModuleSupport as lg}from"ag-charts-community";var{BOOLEAN:UT,POSITIVE_NUMBER:HT,ObserveChanges:cg,Validate:hg}=lg,Nc=class extends lg.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,t.animationManager.skip(!1)}};d([cg((t,e)=>{t.ctx.animationManager.skip(!e)}),hg(UT)],Nc.prototype,"enabled",2),d([cg((t,e)=>{t.ctx.animationManager.defaultDuration=e}),hg(HT,{optional:!0})],Nc.prototype,"duration",2);var GT={type:"root",optionsKey:"animation",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new Nc(t),themeTemplate:{animation:{enabled:!0}}};import{_Theme as ot}from"ag-charts-community";import{_ModuleSupport as Oc,_Scene as Lc,_Util as Cc}from"ag-charts-community";import{_ModuleSupport as WT}from"ag-charts-community";import{_ModuleSupport as KT,_Util as YT}from"ag-charts-community";import{_ModuleSupport as jT}from"ag-charts-community";var{BaseModuleInstance:XT,createElement:dg,getLastFocus:ZT}=jT,pg="canvas-overlay",ug=class extends XT{constructor(t,e,i){super(),this.ctx=t,this.hideFns=[],this.moduleId=`popover-${e}`,i?.detached?this.element=dg("div"):this.element=t.domManager.addChild(pg,this.moduleId),this.element.setAttribute("role","presentation"),this.destroyFns.push(()=>t.domManager.removeChild(pg,this.moduleId))}attachTo(t){this.element.parentElement||t.element.append(this.element)}hide(t){const{lastFocus:e=this.lastFocus}=t??{};this.element.children.length!==0&&(this.hideFns.forEach(i=>i()),e?.focus(),this.lastFocus=void 0)}removeChildren(){this.element.replaceChildren()}showWithChildren(t,e){if(!this.element.parentElement)throw new Error("Can not show popover that has not been attached to a parent.");const i=dg("div","ag-charts-popover");if(e.ariaLabel!=null&&i.setAttribute("aria-label",e.ariaLabel),e.class!=null&&i.classList.add(e.class),i.replaceChildren(...t),this.element.replaceChildren(i),this.hideFns.push(()=>this.removeChildren()),e.onHide&&this.hideFns.push(e.onHide),e.initialFocus&&e.sourceEvent){const o=ZT(e.sourceEvent);o!==void 0&&(e.initialFocus.focus(),this.lastFocus=o)}return i}getPopoverElement(){return this.element.firstElementChild}updatePosition(t){const e=this.getPopoverElement();e&&(e.style.setProperty("top","unset"),e.style.setProperty("bottom","unset"),e.style.setProperty("left",`${Math.floor(t.x)}px`),e.style.setProperty("top",`${Math.floor(t.y)}px`))}},{clamp:Wn}=YT,gg=class extends ug{setAnchor(t,e){this.anchor=t,this.fallbackAnchor=e,this.updatePosition(t),this.repositionWithinBounds()}showWithChildren(t,e){const i=e.anchor??this.anchor,o=e.fallbackAnchor??this.fallbackAnchor,s=super.showWithChildren(t,e);return i&&this.setAnchor(i,o),KT.getWindow().requestAnimationFrame(()=>{this.repositionWithinBounds()}),s}repositionWithinBounds(){const{anchor:t,ctx:e,fallbackAnchor:i}=this,o=this.getPopoverElement();if(!t||!o)return;const s=e.domManager.getBoundingClientRect(),{offsetWidth:a,offsetHeight:n}=o;let r=Wn(0,t.x,s.width-a),l=Wn(0,t.y,s.height-n);r!==t.x&&i?.x!=null&&(r=Wn(0,i.x-a,s.width-a)),l!==t.y&&i?.y!=null&&(l=Wn(0,i.y-n,s.height-n)),this.updatePosition({x:r,y:l})}},{createElement:Ec,initMenuKeyNav:$T,isButtonClickEvent:QT}=WT,Ha=class extends gg{show(t){const e=t.items.map(o=>this.createRow(t,o)),i=this.showWithChildren(e,t);i.classList.add("ag-charts-menu"),i.setAttribute("role","menu"),this.menuCloser=$T({orientation:"vertical",menu:i,buttons:e,sourceEvent:t.sourceEvent,closeCallback:()=>this.hide()}),this.hideFns.push(()=>{this.menuCloser?.finishClosing(),this.menuCloser=void 0})}createRow(t,e){const{domManager:i}=this.ctx,{menuItemRole:o="menuitem"}=t,s=e.value===t.value,a=Ec("div","ag-charts-menu__row");if(a.setAttribute("role",o),o==="menuitemradio"&&a.setAttribute("aria-checked",(t.value===e.value).toString()),typeof e.value=="string"&&(a.dataset.popoverId=e.value),a.classList.toggle("ag-charts-menu__row--active",s),e.icon!=null){const c=Ec("span",`ag-charts-menu__icon ${i.getIconClassNames(e.icon)}`);a.appendChild(c)}const n=e.strokeWidth!=null;if(n&&(a.classList.toggle("ag-charts-menu__row--stroke-width-visible",n),a.style.setProperty("--strokeWidth",n?`${e.strokeWidth}px`:null)),e.label!=null){const c=Ec("span","ag-charts-menu__label");c.textContent=this.ctx.localeManager.t(e.label),a.appendChild(c)}"altText"in e&&(a.ariaLabel=this.ctx.localeManager.t(e.altText));const r=()=>{t.onPress?.(e)},l=c=>{QT(c)&&(r(),c.preventDefault(),c.stopPropagation())};return a.addEventListener("keydown",l),a.addEventListener("click",l),a.addEventListener("mousemove",()=>{a.focus()}),a}};import{_ModuleSupport as qT}from"ag-charts-community";var{ChartAxisDirection:JT}=qT;function tA({x:t,y:e,labelBBox:i,bounds:o,axisPosition:s,axisDirection:a,padding:n}){let r;if(a===JT.X){const c=-i.width/2,h=s==="bottom"?-4:-i.height+4,p=s==="bottom"?o.y+o.height+n:o.y-n;r={x:t+c,y:p+h}}else{const c=-i.height/2,h=s==="right"?-8:-i.width+8;r={x:(s==="right"?o.x+o.width+n:o.x-n)+h,y:e+c}}return r}function yg(t,e,i){const o=t.clone();return o.x+=e==="left"?-i:0,o.y+=e==="top"?-i:0,o.width+=e==="left"||e==="right"?i:0,o.height+=e==="top"||e==="bottom"?i:0,o}import{_ModuleSupport as eA,_Util as iA}from"ag-charts-community";var oA='<div class="ag-charts-color-picker__palette" tabindex="0"></div><input class="ag-charts-color-picker__hue-input" tabindex="0" type="range" min="0" max="360" value="0"> <input class="ag-charts-color-picker__alpha-input" tabindex="0" type="range" min="0" max="1" value="1" step="0.01"> <label class="ag-charts-color-picker__color-field"><span class="ag-charts-color-picker__color-label">Color</span> <input class="ag-charts-color-picker__color-input" tabindex="0" value="#000"></label>',{createElement:sA}=eA,{Color:_c,clamp:Kn}=iA,fg=t=>{try{const e=_c.fromString(t),[i,o,s]=e.toHSB();return[i,o,s,e.a]}catch{return}},mg=class extends gg{constructor(t,e){super(t,"color-picker",e),this.hasChanged=!1,this.hideFns.push(()=>{this.hasChanged&&this.onChangeHide?.()})}show(t){this.hasChanged=!1,this.onChangeHide=t.onChangeHide;const{element:e,initialFocus:i}=this.createColorPicker(t),o=this.showWithChildren([e],{initialFocus:i,...t});o.classList.add("ag-charts-color-picker"),o.setAttribute("role","dialog")}createColorPicker(t){let[e,i,o,s]=fg(t.color??"#f00")??[0,1,.5,1];s=t.opacity??s;const a=sA("div","ag-charts-color-picker__content");a.innerHTML=oA,a.ariaLabel=this.ctx.localeManager.t("ariaLabelColorPicker");const n=a.querySelector(".ag-charts-color-picker__palette"),r=a.querySelector(".ag-charts-color-picker__hue-input"),l=a.querySelector(".ag-charts-color-picker__alpha-input"),c=a.querySelector(".ag-charts-color-picker__color-input"),h=(u=!0)=>{const g=_c.fromHSB(e,i,o,s).toHexString();if(a.style.setProperty("--h",`${e}`),a.style.setProperty("--s",`${i}`),a.style.setProperty("--v",`${o}`),a.style.setProperty("--a",`${s}`),a.style.setProperty("--color",g.slice(0,7)),a.style.setProperty("--color-a",g),r.value=`${e}`,l.value=`${s}`,l.classList.toggle("ag-charts-color-picker__alpha-input--opaque",s===1),document.activeElement!==c&&(c.value=g.toUpperCase()),u||t.color==null){const f=_c.fromHSB(e,i,o,1).toHexString();t.onChange?.(g,f,s)}u&&(this.hasChanged=!0)};h(!1);const p=u=>{u.preventDefault();const y=u.currentTarget;y.focus();const g=y.getBoundingClientRect(),f=({pageX:m,pageY:v})=>{i=Math.min(Math.max((m-g.left)/g.width,0),1),o=1-Math.min(Math.max((v-g.top)/g.height,0),1),h()};f(u),window.addEventListener("mousemove",f),window.addEventListener("mouseup",()=>window.removeEventListener("mousemove",f),{once:!0})};return a.addEventListener("mousedown",u=>{u.stopPropagation()}),a.addEventListener("keydown",u=>{switch(u.stopPropagation(),u.key){case"Enter":case"Escape":this.hide();break;default:return}u.preventDefault()}),n.addEventListener("mousedown",p),n.addEventListener("keydown",u=>{if(u.key==="ArrowLeft")i=Kn(0,i-.01,1);else if(u.key==="ArrowRight")i=Kn(0,i+.01,1);else if(u.key==="ArrowUp")o=Kn(0,o+.01,1);else if(u.key==="ArrowDown")o=Kn(0,o-.01,1);else return;u.preventDefault(),h()}),r.addEventListener("input",u=>{e=u.currentTarget.valueAsNumber??0,h()}),l.addEventListener("input",u=>{s=u.currentTarget.valueAsNumber??0,h()}),c.addEventListener("input",u=>{const y=fg(u.currentTarget.value);y!=null&&([e,i,o,s]=y,h())}),c.addEventListener("blur",()=>h()),c.addEventListener("keydown",u=>{u.key==="Enter"&&(u.currentTarget.blur(),h())}),{element:a,initialFocus:n}}};import{_ModuleSupport as xg,_Scene as aA}from"ag-charts-community";var nA='<div contenteditable="plaintext-only" class="ag-charts-text-input__textarea" tabindex="0"></div>',{focusCursorAtEnd:rA}=xg,Sg="text-input",bg="canvas-overlay",lA=class extends xg.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1,this.element=t.domManager.addChild(bg,Sg),this.element.classList.add("ag-charts-text-input"),this.destroyFns.push(()=>t.domManager.removeChild(bg,Sg))}setKeyDownHandler(t){this.element.addEventListener("keydown",t),this.destroyFns.push(()=>this.element.removeEventListener("keydown",t))}show(t){this.element.innerHTML=nA;const e=this.element.firstElementChild;e.isContentEditable||(e.contentEditable="true"),e.setAttribute("placeholder",this.ctx.localeManager.t(t.placeholderText??"inputTextareaPlaceholder")),t.styles?.placeholderColor&&e.style.setProperty("--ag-charts-input-placeholder-color",t.styles?.placeholderColor),e.innerText=t.text??"",e.style.color=t.styles?.color??"inherit",e.style.fontFamily=t.styles?.fontFamily??"inherit",e.style.fontSize=t.styles?.fontSize?`${t.styles.fontSize}px`:"inherit",e.style.fontStyle=t.styles?.fontStyle??"inherit",e.style.fontWeight=typeof t.styles?.fontWeight=="number"?`${t.styles.fontWeight}`:t.styles?.fontWeight??"inherit",rA(e),e.addEventListener("input",()=>{this.updatePosition(),t.onChange?.(this.getValue(),this.getBBox())}),e.addEventListener("click",i=>{i.stopPropagation()}),t.layout&&(this.layout=t.layout,this.updatePosition()),t.onChange?.(this.getValue(),this.getBBox()),this.visible=!0}hide(){this.element.innerHTML="",this.layout={getTextInputCoords:()=>({x:0,y:0}),getTextPosition:()=>"center",alignment:"center",textAlign:"center"},this.visible=!1}isVisible(){return this.visible}updateColor(t){this.element.firstElementChild&&(this.element.firstElementChild.style.color=t)}updateFontSize(t){if(this.element.firstElementChild)return this.element.firstElementChild.style.fontSize=`${t}px`,this.updatePosition(),this.getBBox()}getValue(){if(this.element.firstElementChild)return this.element.firstElementChild.innerText.trim()}updatePosition(){const{element:t}=this,e=t.firstElementChild;if(!e)return;const i=this.ctx.domManager.getBoundingClientRect(),{width:o,getTextInputCoords:s,getTextPosition:a,alignment:n,textAlign:r}=this.layout;t.style.setProperty("width",o?`${o}px`:"unset");const l=e.getBoundingClientRect(),c=s(l.height);let h=c.x;n==="center"?h-=(o??l.width)/2:n==="right"&&(h-=o??l.width);const p=a();let u=c.y;p==="center"?u-=l.height/2:p==="bottom"&&(u-=l.height),t.style.setProperty("top",`${u}px`),t.style.setProperty("left",`${h}px`),t.style.setProperty("max-width",`${i.width-h}px`),t.style.setProperty("text-align",n),e.style.setProperty("text-align",r)}getBBox(){const{left:t,top:e,width:i,height:o}=this.element.getBoundingClientRect();return new aA.BBox(t,e,i,o)}};import{_ModuleSupport as cA}from"ag-charts-community";var{BOOLEAN:hA,Validate:vg,UNION:dA}=cA,pA=dA(["x","y","xy"],"an axis type"),Rc=class{constructor(){this.enabled=!0,this.axes="y"}};d([vg(hA)],Rc.prototype,"enabled",2),d([vg(pA,{optional:!0})],Rc.prototype,"axes",2);import{_Util as Ti}from"ag-charts-community";var wc=(t=>(t.Line="line",t.HorizontalLine="horizontal-line",t.VerticalLine="vertical-line",t.DisjointChannel="disjoint-channel",t.ParallelChannel="parallel-channel",t.Callout="callout",t.Comment="comment",t.Note="note",t.Text="text",t.Arrow="arrow",t.ArrowUp="arrow-up",t.ArrowDown="arrow-down",t.DateRange="date-range",t.PriceRange="price-range",t.DatePriceRange="date-price-range",t.QuickDatePriceRange="quick-date-price-range",t))(wc||{}),uA=Object.values(wc),gA=["line","horizontal-line","vertical-line","disjoint-channel","parallel-channel","callout","comment","note","text","arrow","arrow-up","arrow-down"],yA=["line-menu","text-menu","shape-menu","measurer-menu"];function Mg(t){for(const e of uA)if(e===t)return e}import{_ModuleSupport as fA}from"ag-charts-community";import{_ModuleSupport as mA,_Util as xA}from"ag-charts-community";import{_ModuleSupport as SA,_Util as bA}from"ag-charts-community";var{BOOLEAN:Ga,COLOR_STRING:Pc,DATE:Bc,FONT_STYLE:vA,FONT_WEIGHT:MA,FUNCTION:TA,LINE_DASH:AA,LINE_STYLE:DA,NUMBER:Ho,OBJECT:Wa,OR:zc,POSITIVE_NUMBER:Fc,RATIO:Tg,STRING:Fs,TEXT_ALIGN:kA,UNION:Yn,BaseProperties:Go,Validate:X}=SA,jn=class extends Go{};d([X(zc(Fs,Ho,Bc))],jn.prototype,"x",2),d([X(Ho)],jn.prototype,"y",2);var IA=class extends ie(Gi(Ig(Go))){},Vc=class extends ie(Gi(Ai(Gc(Vs(Go))))){constructor(){super(...arguments),this.cornerRadius=2}};d([X(Ga)],Vc.prototype,"enabled",2),d([X(Fc)],Vc.prototype,"cornerRadius",2);var NA=class extends Ai(Go){},OA=class extends ie(Gi(Ai(Go))){},Wo=class extends Vs(Go){constructor(){super(...arguments),this.label="",this.position="top",this.alignment="left"}};d([X(Fs)],Wo.prototype,"label",2),d([X(Yn(["top","center","bottom"]),{optional:!0})],Wo.prototype,"position",2),d([X(Yn(["left","center","right"]),{optional:!0})],Wo.prototype,"alignment",2);var Ka=class extends Vs(Go){constructor(){super(...arguments),this.label=""}};d([X(Fs)],Ka.prototype,"label",2),d([X(Yn(["top","inside","bottom"]),{optional:!0})],Ka.prototype,"position",2),d([X(Yn(["left","center","right"]),{optional:!0})],Ka.prototype,"alignment",2);function Ko(t){class e extends CA(Ig(t)){constructor(){super(...arguments),this.id=bA.generateUUID()}isValidWithContext(o,s){return super.isValid(s)}}return e}function Uc(t){class e extends t{constructor(){super(...arguments),this.start=new jn,this.end=new jn}}return d([X(Wa)],e.prototype,"start",2),d([X(Wa)],e.prototype,"end",2),e}function Ag(t){class e extends t{}return d([X(zc(Fs,Ho,Bc))],e.prototype,"x",2),d([X(Ho)],e.prototype,"y",2),e}function Dg(t){class e extends t{}return d([X(zc(Fs,Ho,Bc))],e.prototype,"value",2),e}function Hc(t){class e extends t{constructor(){super(...arguments),this.background=new NA}}return d([X(Wa,{optional:!0})],e.prototype,"background",2),e}function yo(t){class e extends t{constructor(){super(...arguments),this.handle=new OA}}return d([X(Wa,{optional:!0})],e.prototype,"handle",2),e}function kg(t){class e extends t{constructor(){super(...arguments),this.axisLabel=new Vc}}return d([X(Wa,{optional:!0})],e.prototype,"axisLabel",2),e}function Gc(t){class e extends t{constructor(){super(...arguments),this.textAlign="center"}}return d([X(Fc,{optional:!0})],e.prototype,"padding",2),d([X(kA,{optional:!0})],e.prototype,"textAlign",2),d([X(TA,{optional:!0})],e.prototype,"formatter",2),e}function LA(t){class e extends t{}return e}function Wc(t){class e extends t{}return d([X(Ga,{optional:!0})],e.prototype,"extendStart",2),d([X(Ga,{optional:!0})],e.prototype,"extendEnd",2),e}function CA(t){class e extends t{}return d([X(Ga,{optional:!0})],e.prototype,"locked",2),e}function Kc(t){class e extends t{setLocaleManager(o){this.localeManager??(this.localeManager=o)}}return e}function Ig(t){class e extends t{}return d([X(Ga,{optional:!0})],e.prototype,"visible",2),e}function Ai(t){class e extends t{}return d([X(Pc,{optional:!0})],e.prototype,"fill",2),d([X(Tg,{optional:!0})],e.prototype,"fillOpacity",2),e}function ie(t){class e extends t{}return d([X(Pc,{optional:!0})],e.prototype,"stroke",2),d([X(Tg,{optional:!0})],e.prototype,"strokeOpacity",2),d([X(Ho,{optional:!0})],e.prototype,"strokeWidth",2),e}function Gi(t){class e extends t{constructor(){super(...arguments),this.lineCap=void 0,this.computedLineDash=void 0}}return d([X(AA,{optional:!0})],e.prototype,"lineDash",2),d([X(Ho,{optional:!0})],e.prototype,"lineDashOffset",2),d([X(DA,{optional:!0})],e.prototype,"lineStyle",2),e}function Vs(t){class e extends t{constructor(){super(...arguments),this.fontSize=12,this.fontFamily="Verdana, sans-serif"}}return d([X(vA,{optional:!0})],e.prototype,"fontStyle",2),d([X(MA,{optional:!0})],e.prototype,"fontWeight",2),d([X(Fc)],e.prototype,"fontSize",2),d([X(Fs)],e.prototype,"fontFamily",2),d([X(Pc,{optional:!0})],e.prototype,"color",2),e}import{_ModuleSupport as EA}from"ag-charts-community";function Yo(t,e){if(t.start==null||t.end==null)return;const i=xt(t.start,e),o=xt(t.end,e);if(!(i==null||o==null))return{x1:i.x,y1:i.y,x2:o.x,y2:o.y}}function xt(t,e){const i=jo(t.x,e.xAxis),o=jo(t.y,e.yAxis);return{x:i,y:o}}function jo(t,e){if(t==null)return 0;const i=(e.scaleBandwidth()??0)/2;return e.scaleConvert(t)+i}function Pt(t,e){const i=Ya(t.x,e.xAxis),o=Ya(t.y,e.yAxis);return{x:i,y:o}}function Ya(t,e){const i=(e.scaleBandwidth()??0)/2;return e.continuous?e.scaleInvert(t-i):e.scaleInvertNearest(t-i)}import{_ModuleSupport as _A}from"ag-charts-community";var{BaseProperties:RA}=_A,Yc=class extends Ko(Uc(yo(RA))){constructor(){super(...arguments),this.snapToAngle=45}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){}getDefaultOpacity(t){}},{STRING:wA,Validate:PA}=EA,Ng=class extends Kc(Gc(Vs(Yc))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;let e=this.text;return t&&(e=this.placeholderText??"",this.localeManager&&(e=this.localeManager.t(e))),{text:e,isPlaceholder:t}}getTextInputCoords(t,e){return xt(this.end,t)}getTextPosition(){return this.position}};d([PA(wA)],Ng.prototype,"text",2);var{STRING:BA,Validate:zA,isObject:FA}=mA,{Color:Og}=xA,VA={top:6,right:12,bottom:9,left:12},Re=class extends Ai(ie(Ng)){constructor(){super(...arguments),this.type="callout",this.position="bottom",this.alignment="left"}static is(t){return FA(t)&&t.type==="callout"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=Og.fromString(this.color??"#888888");return new Og(t,e,i,.66).toString()}getPadding(){const{padding:t}=this;return t==null?{...VA}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding(),s=typeof o=="number"?o:o?.left??0,a=typeof o=="number"?o:o?.bottom??0;return{x:i.x+s,y:i.y-a}}};d([zA(BA)],Re.prototype,"type",2);import{_ModuleSupport as UA,_Util as HA}from"ag-charts-community";import{_ModuleSupport as GA}from"ag-charts-community";var{STRING:WA,BaseProperties:KA,Validate:YA}=GA,Xn=class extends Ko(Ag(yo(Gc(Vs(KA))))){constructor(){super(...arguments),this.text="",this.position="top",this.alignment="left",this.placement="inside",this.placeholderText="inputTextareaPlaceholder"}isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){return this.color}getDefaultOpacity(t){}getPlaceholderColor(){}getPadding(){const{padding:t=0}=this;return{top:t,right:t,bottom:t,left:t}}getText(){const t=this.text.length==0;return{text:t?this.placeholderText??"":this.text,isPlaceholder:t}}getTextInputCoords(t,e){return xt(this,t)}getTextPosition(){return this.position}};d([YA(WA)],Xn.prototype,"text",2);var{STRING:jA,Validate:XA,isObject:ZA}=UA,{Color:Lg}=HA,Zn={top:8,right:14,bottom:8,left:14},He=class extends Ai(ie(Xn)){constructor(){super(...arguments),this.type="comment",this.position="bottom",this.alignment="left"}static is(t){return ZA(t)&&t.type==="comment"}getDefaultColor(t){switch(t){case"fill-color":return this.fill;case"line-color":return this.stroke;case"text-color":default:return this.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.fillOpacity;case"line-color":return this.strokeOpacity;case"text-color":default:return}}getPlaceholderColor(){const{r:t,g:e,b:i}=Lg.fromString(this.color??"#888888");return new Lg(t,e,i,.66).toString()}getPadding(){const{padding:t,fontSize:e}=this;return t==null?{top:Math.max(e*.4,Zn.top),bottom:Math.max(e*.4,Zn.bottom),left:Math.max(e*.8,Zn.left),right:Math.max(e*.8,Zn.right)}:{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const i=super.getTextInputCoords(t,e),o=this.getPadding();return{x:i.x+o.left,y:i.y-o.bottom}}};d([XA(jA)],He.prototype,"type",2);import{_ModuleSupport as $A}from"ag-charts-community";import{_ModuleSupport as QA}from"ag-charts-community";var{Vec2:Xo}=QA;function ja(t,e){return t?"dashed":e??"solid"}function Cg(t,e){switch(e){case"solid":return[];case"dashed":return[t*4,t*2];case"dotted":return[0,t*2]}}function Us(t,e,i,o){const s=ja(t,i);return e??t??Cg(o??1,s)}function Hs(t,e,i){const o=ja(e,i);return t??o==="dotted"?"round":void 0}function qA(t,e){const[i,o]=Xo.from(t),s=e.height,a=Xo.gradient(o,i,s),n=Xo.intercept(o,a,s),r=[{x:i.x,y:s??0},{x:i.x,y:s==null?e.height:s-e.height}];if(a===1/0)return r;let l=[Xo.intersectAtY(a,n,0,s),Xo.intersectAtY(a,n,e.height,s),Xo.intersectAtX(a,n,0,s),Xo.intersectAtX(a,n,e.width,s)];return l=l.filter(c=>c.x>=e.x&&c.x<=e.width&&c.y>=e.y&&c.y<=e.height).sort((c,h)=>c.x===h.x?0:c.x<h.x?-1:1),l.length!==2?r:l}var{BOOLEAN:$n,OBJECT:Gs,STRING:Qn,BaseProperties:jc,Validate:Me,isObject:qn}=$A,JA=class extends ie(jc){},Xc=class extends Vs(Ai(ie(jc))){constructor(){super(...arguments),this.divider=new JA}};d([Me(Gs,{optional:!0})],Xc.prototype,"divider",2);var Zc=class extends Ai(ie(yo(jc))){constructor(){super(...arguments),this.statistics=new Xc}};d([Me(Gs,{optional:!0})],Zc.prototype,"statistics",2);var Xa=class extends Kc(Hc(ie(Gi(Yc)))){constructor(){super(...arguments),this.direction="both",this.hasDateRange=!1,this.hasPriceRange=!1,this.statistics=new Xc,this.getVolume=()=>0}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([Me(Gs,{optional:!0})],Xa.prototype,"statistics",2);function $c(t){class e extends t{constructor(){super(...arguments),this.hasDateRange=!0}}return e}function Qc(t){class e extends t{constructor(){super(...arguments),this.hasPriceRange=!0}}return e}function qc(t){class e extends t{constructor(){super(...arguments),this.text=new Wo}getDefaultColor(o){return o==="text-color"?this.text.color:super.getDefaultColor(o)}}return d([Me(Gs,{optional:!0})],e.prototype,"text",2),e}var Te=class extends $c(qc(Xa)){constructor(){super(...arguments),this.type="date-range",this.direction="horizontal"}static is(t){return qn(t)&&t.type==="date-range"}};d([Me(Qn)],Te.prototype,"type",2),d([Me($n,{optional:!0})],Te.prototype,"extendAbove",2),d([Me($n,{optional:!0})],Te.prototype,"extendBelow",2);var Ae=class extends Qc(qc(Xa)){constructor(){super(...arguments),this.type="price-range",this.direction="vertical"}static is(t){return qn(t)&&t.type==="price-range"}};d([Me(Qn)],Ae.prototype,"type",2),d([Me($n,{optional:!0})],Ae.prototype,"extendLeft",2),d([Me($n,{optional:!0})],Ae.prototype,"extendRight",2);var ei=class extends $c(Qc(qc(Xa))){constructor(){super(...arguments),this.type="date-price-range",this.direction="both"}static is(t){return qn(t)&&t.type==="date-price-range"}};d([Me(Qn)],ei.prototype,"type",2);var fe=class extends $c(Qc(Xa)){constructor(){super(...arguments),this.type="quick-date-price-range",this.up=new Zc,this.down=new Zc,this.direction="both"}static is(t){return qn(t)&&t.type==="quick-date-price-range"}};d([Me(Qn)],fe.prototype,"type",2),d([Me(Gs,{optional:!0})],fe.prototype,"up",2),d([Me(Gs,{optional:!0})],fe.prototype,"down",2);import{_ModuleSupport as tD,_Util as eD}from"ag-charts-community";import{_ModuleSupport as iD,_Scene as oD}from"ag-charts-community";var{TextWrapper:sD,CachedTextMeasurerPool:aD}=iD,{BBox:nD}=oD,Jn=1.38;function Eg(t){return{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},textAlign:t.textAlign,textBaseline:t.position=="center"?"middle":t.position,lineHeight:Jn,avoidOrphans:!1,textWrap:"always"}}function tr(t,e,i){return i?sD.wrapText(e,{...Eg(t),maxWidth:i}):e}function rD(t,e){const i=Eg(t),{lineMetrics:o,width:s}=aD.measureLines(e,i),a=o.length*(t.fontSize??14)*Jn;return{width:s,height:a}}function Jc(t,e,i,o){let s=o?.width??0,a=o?.height??0;if(!o){const n=t.width!=null?tr(t,e,t.width):e;({width:s,height:a}=rD(t,n))}return new nD(i.x,i.y,s,a)}function _g(t,e,i,o,{x:s,y:a}){const{visible:n=!0,fontFamily:r,fontSize:l=14,fontStyle:c,fontWeight:h,textAlign:p}=o,u=l*Jn,y=o.position=="center"?"middle":o.position,g=i?o.getPlaceholderColor():o.color;t.setProperties({x:s,y:a,visible:n,text:e,fill:g,fontFamily:r,fontSize:l,fontStyle:c,fontWeight:h,textAlign:p,lineHeight:u,textBaseline:y})}var{OBJECT:lD,STRING:cD,BaseProperties:hD,Validate:Rg,isObject:dD}=tD,{clamp:pD}=eD,uD=10,gD=11,wg=20,yD=22,fD=10,Pg=wg+fD,Bg=34,mD=class extends Ai(ie(hD)){},oe=class extends Ai(ie(Xn)){constructor(){super(...arguments),this.type="note",this.background=new mD,this.position="bottom",this.alignment="center",this.width=200}static is(t){return dD(t)&&t.type==="note"}getDefaultColor(t){switch(t){case"line-color":return this.fill;case"text-color":return this.color}}getDefaultOpacity(t){switch(t){case"line-color":return this.fillOpacity;case"text-color":return}}getPadding(){const t=this.padding??uD;return{top:t,right:t,bottom:t,left:t}}getTextInputCoords(t,e){const{width:i,text:o}=this,{seriesRect:s}=t,a=super.getTextInputCoords(t,e),n=this.getPadding().top,r=Jc(this,o,a,void 0);r.x=pD(i/2,r.x,s.width-i/2);const l=r.y-Pg-n*2,c=r.y+gD+n*2,h=Math.max(r.height,e);return l-h-Bg<s.y?(r.y=c,this.position="top"):(r.y=l+n,this.position="bottom"),{x:r.x,y:r.y}}};d([Rg(cD)],oe.prototype,"type",2),d([Rg(lD,{optional:!0})],oe.prototype,"background",2);import{_ModuleSupport as xD}from"ag-charts-community";var{BaseProperties:SD}=xD,bD=class extends Ko(Ag(yo(SD))){isValidWithContext(t,e){return super.isValid(e)}getDefaultColor(t){}getDefaultOpacity(t){}},th=class Yv extends Ai(bD){constructor(){super(...arguments),this.size=32}static is(e){return e instanceof Yv}getDefaultColor(e){return e==="fill-color"?this.fill:void 0}getDefaultOpacity(e){return e==="fill-color"?this.fillOpacity:void 0}};import{_ModuleSupport as vD}from"ag-charts-community";import{_Scale as MD,_Util as TD}from"ag-charts-community";var{Logger:eh}=TD;function Za(t,e,i){let o=!0;return o&&(o=Wi(t,e.start,i&&`${i}[start] `)),o&&(o=Wi(t,e.end,i&&`${i}[end] `)),o}function zg(t,e,i){const o=e.direction==="horizontal"?t.yAxis:t.xAxis,s=ih(e.value,o);return!s&&i&&eh.warnOnce(`${i}is outside the axis domain, ignoring. - value: [${e.value}]]`),s}function Wi(t,e,i){if(e.x==null||e.y==null)return i&&eh.warnOnce(`${i}requires both an [x] and [y] property, ignoring.`),!1;const o=ih(e.x,t.xAxis),s=ih(e.y,t.yAxis);if(!o||!s){let a="x & y domains";return o&&(a="y domain"),s&&(a="x domain"),i&&eh.warnOnce(`${i}is outside the ${a}, ignoring. - x: [${e.x}], y: ${e.y}]`),!1}return!0}function ih(t,e){const i=e.scaleDomain();return i&&MD.OrdinalTimeScale.is(e.scale)?t>=i[0]&&t<=i.at(-1):!0}function AD(t){return t?.x!=null&&t?.y!=null}var{OBJECT:Fg,STRING:Vg,BaseProperties:Ug,Validate:er,isObject:Hg}=vD,Zt=class extends Ko(Dg(yo(kg(ie(Gi(Ug)))))){constructor(){super(...arguments),this.direction="horizontal",this.type="horizontal-line",this.text=new Wo}static is(t){return Hg(t)&&t.type==="horizontal-line"}isValidWithContext(t,e){return super.isValid(e)&&zg(t,this,e)}getDefaultColor(t){return this.stroke}getDefaultOpacity(t){return this.strokeOpacity}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([er(Vg)],Zt.prototype,"type",2),d([er(Fg,{optional:!0})],Zt.prototype,"text",2);var ii=class extends Ko(Dg(yo(kg(ie(Gi(Ug)))))){constructor(){super(...arguments),this.direction="vertical",this.type="vertical-line",this.text=new Wo}static is(t){return Hg(t)&&t.type==="vertical-line"}isValidWithContext(t,e){return super.isValid(e)&&zg(t,this,e)}getDefaultColor(t){return this.stroke}getDefaultOpacity(t){return this.strokeOpacity}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([er(Vg)],ii.prototype,"type",2),d([er(Fg,{optional:!0})],ii.prototype,"text",2);import{_ModuleSupport as DD,_Util as kD}from"ag-charts-community";var{NUMBER:Gg,OBJECT:ID,STRING:ND,BaseProperties:OD,Validate:ir,isObject:LD}=DD,De=class extends Ko(Hc(Uc(yo(Wc(ie(Gi(OD))))))){constructor(){super(...arguments),this.type="disjoint-channel",this.text=new Ka,this.snapToAngle=45}static is(t){return LD(t)&&t.type==="disjoint-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.startHeight,t.end.y-=this.endHeight):kD.Logger.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Za(t,this,e)&&Za(t,this.bottom,e)}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([ir(ND)],De.prototype,"type",2),d([ir(Gg)],De.prototype,"startHeight",2),d([ir(Gg)],De.prototype,"endHeight",2),d([ir(ID,{optional:!0})],De.prototype,"text",2);import{_ModuleSupport as CD}from"ag-charts-community";var{OBJECT:ED,STRING:Wg,Validate:oh,isObject:Kg}=CD,sh=class extends Kc(LA(Wc(ie(Gi(Yc))))){constructor(){super(...arguments),this.text=new Wo}isValidWithContext(t,e){return super.isValid(e)&&Za(t,this,e)}getDefaultColor(t){switch(t){case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){return this.strokeOpacity}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([oh(ED,{optional:!0})],sh.prototype,"text",2);var oi=class extends sh{constructor(){super(...arguments),this.type="arrow",this.endCap="arrow"}static is(t){return Kg(t)&&t.type==="arrow"}};d([oh(Wg)],oi.prototype,"type",2);var si=class extends sh{constructor(){super(...arguments),this.type="line"}static is(t){return Kg(t)&&t.type==="line"}};d([oh(Wg)],si.prototype,"type",2);import{_ModuleSupport as _D,_Util as RD}from"ag-charts-community";var{NUMBER:wD,STRING:PD,OBJECT:Yg,BaseProperties:BD,Validate:or,isObject:zD}=_D,ke=class extends Ko(Hc(Uc(yo(Wc(ie(Gi(BD))))))){constructor(){super(...arguments),this.type="parallel-channel",this.middle=new IA,this.text=new Ka,this.snapToAngle=45}static is(t){return zD(t)&&t.type==="parallel-channel"}get bottom(){const t={start:{x:this.start.x,y:this.start.y},end:{x:this.end.x,y:this.end.y}};return typeof t.start.y=="number"&&typeof t.end.y=="number"?(t.start.y-=this.height,t.end.y-=this.height):RD.Logger.warnOnce(`Annotation [${this.type}] can only be used with a numeric y-axis.`),t}isValidWithContext(t,e){return super.isValid(e)&&Za(t,this,e)&&Za(t,this.bottom,e)}getDefaultColor(t){switch(t){case"fill-color":return this.background.fill;case"line-color":return this.stroke;case"text-color":return this.text.color}}getDefaultOpacity(t){switch(t){case"fill-color":return this.background.fillOpacity;case"line-color":return this.strokeOpacity}}getLineDash(){return Us(this.lineDash,this.computedLineDash,this.lineStyle,this.strokeWidth)}getLineCap(){return Hs(this.lineCap,this.lineDash,this.lineStyle)}};d([or(PD)],ke.prototype,"type",2),d([or(wD)],ke.prototype,"height",2),d([or(Yg,{optional:!0})],ke.prototype,"middle",2),d([or(Yg,{optional:!0})],ke.prototype,"text",2);import{_ModuleSupport as FD}from"ag-charts-community";var{STRING:VD,Validate:UD,isObject:HD}=FD,ai=class extends Xn{constructor(){super(...arguments),this.type="text",this.position="bottom"}static is(t){return HD(t)&&t.type==="text"}};d([UD(VD)],ai.prototype,"type",2);function fo(t){return fe.is(t)}function sr(t){return si.is(t)||Zt.is(t)||ii.is(t)||oi.is(t)}function Ki(t){return De.is(t)||ke.is(t)}function Di(t){return Re.is(t)||He.is(t)||oe.is(t)||ai.is(t)}function $a(t){return Te.is(t)||Ae.is(t)||ei.is(t)||fe.is(t)}var{isObject:GD}=fA;function jg(t){return Di(t)&&!oe.is(t)}function mo(t){return sr(t)||Ki(t)||$a(t)&&!fe.is(t)}function WD(t){return sr(t)||Ki(t)||$a(t)||Re.is(t)||oe.is(t)}function KD(t){return oe.is(t)}function YD(t){return Ki(t)||$a(t)||Re.is(t)||He.is(t)||th.is(t)}function jD(t){return Di(t)&&!oe.is(t)}function Ws(t){return(sr(t)||Ki(t)||$a(t))&&!fo(t)&&GD(t.text)}function XD(t,e){"fontSize"in t&&(t.fontSize=e),Ws(t)&&(t.text.fontSize=e)}function Xg(t,e){const i=e?.strokeWidth??t.strokeWidth??1,o=e?.type??t.lineStyle,s=o??ja(t.lineDash,o),a=Cg(i,s);t.strokeWidth=i,t.computedLineDash=a,t.lineStyle=s,t.lineCap=s==="dotted"?"round":void 0}function ar(t,e,i,o,s){switch(e){case"fill-color":{"fill"in t&&(t.fill=o),"fillOpacity"in t&&(t.fillOpacity=s),"background"in t&&(t.background.fill=o,t.background.fillOpacity=s);break}case"line-color":{"axisLabel"in t&&(t.axisLabel.fill=o,t.axisLabel.fillOpacity=s,t.axisLabel.stroke=o,t.axisLabel.strokeOpacity=s),"fill"in t&&"fillOpacity"in t&&KD(t)?(t.fill=o,t.fillOpacity=s):("stroke"in t&&(t.stroke=o),"strokeOpacity"in t&&(t.strokeOpacity=s));break}case"text-color":{"color"in t&&(t.color=i),Ws(t)&&(t.text.color=o);break}}}var ZD=class{constructor(){this.mementoOriginatorKey="annotation-defaults",this.colors=new Map(Object.values(wc).map(t=>[t,new Map([["line-color",void 0],["fill-color",void 0],["text-color",void 0]])])),this.fontSizes=new Map([["callout",void 0],["comment",void 0],["text",void 0],["arrow",void 0],["line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineStyles=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextAlignments=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]]),this.lineTextPositions=new Map([["line",void 0],["horizontal-line",void 0],["vertical-line",void 0],["disjoint-channel",void 0],["parallel-channel",void 0],["arrow",void 0],["date-range",void 0],["price-range",void 0],["date-price-range",void 0]])}createMemento(){return{colors:Ti.deepClone(this.colors),fontSizes:Ti.deepClone(this.fontSizes),lineStyles:Ti.deepClone(this.lineStyles),lineTextAlignments:Ti.deepClone(this.lineTextAlignments),lineTextPositions:Ti.deepClone(this.lineTextPositions)}}guardMemento(t){return!0}restoreMemento(t,e,i){this.colors=Ti.deepClone(i.colors),this.fontSizes=Ti.deepClone(i.fontSizes),this.lineStyles=Ti.deepClone(i.lineStyles),this.lineTextAlignments=Ti.deepClone(i.lineTextAlignments),this.lineTextPositions=Ti.deepClone(i.lineTextPositions)}setDefaultColor(t,e,i,o,s){this.colors.get(t)?.set(e,[i,o,s])}setDefaultFontSize(t,e){this.fontSizes.set(t,e)}setDefaultLineStyleType(t,e){const i=this.lineStyles.get(t);i?i.type=e:this.lineStyles.set(t,{type:e})}setDefaultLineStyleWidth(t,e){const i=this.lineStyles.get(t);i?i.strokeWidth=e:this.lineStyles.set(t,{strokeWidth:e})}setDefaultLineTextAlignment(t,e){this.lineTextAlignments.set(t,e)}setDefaultLineTextPosition(t,e){this.lineTextPositions.set(t,e)}applyDefaults(t){for(const[e,i]of this.colors)if(t.type===e)for(const[o,[s,a,n]=[]]of i)s&&a&&n!=null&&ar(t,o,s,a,n);for(const[e,i]of this.fontSizes)t.type!==e||i==null||XD(t,i);for(const[e,i]of this.lineStyles)t.type!==e||i==null||Xg(t,i);for(const[e,i]of this.lineTextPositions)t.type!==e||i==null||(t.text.position=i);for(const[e,i]of this.lineTextAlignments)t.type!==e||i==null||(t.text.alignment=i)}};import{_ModuleSupport as $D,_Util as QD}from"ag-charts-community";var{StateMachine:Zg,Vec2:$g}=$D,se=class extends Zg{constructor(t){const e=({shiftKey:i,context:o})=>{t.setSnapping(i);const s=t.datum(),a=t.getHoverCoords();a&&(t.node()?.drag(s,a,o,i),t.update())};super("idle",{idle:{dragStart:{target:"dragging",action:({offset:i,context:o})=>{this.hasMoved=!1,this.dragStart=i,t.node()?.dragStart(t.datum(),i,o)}}},dragging:{keyDown:e,keyUp:e,drag:({offset:i,context:o})=>{this.hasMoved=$g.lengthSquared($g.sub(i,this.dragStart))>0;const s=t.datum(),a=t.getSnapping();t.node()?.drag(s,i,o,a),t.update()},dragEnd:{target:Zg.parent,action:()=>{t.node()?.stopDragging(),t.stopInteracting(),this.hasMoved&&t.recordAction("Move annotation"),t.update()}}}}),this.debug=QD.Debug.create(!0,"annotations"),this.hasMoved=!1}};import{_ModuleSupport as qD}from"ag-charts-community";var{STRING:JD,Validate:tk,isObject:ek}=qD,Yi=class extends th{constructor(){super(...arguments),this.type="arrow-down"}static is(t){return ek(t)&&t.type==="arrow-down"}};d([tk(JD)],Yi.prototype,"type",2);import{_Scene as ik}from"ag-charts-community";import{_ModuleSupport as ok,_Scene as ah}from"ag-charts-community";import{_Scene as Zo}from"ag-charts-community";var Qg=class jv extends Zo.Group{constructor(){super(...arguments),this.active=!1,this.locked=!1,this.visible=!1,this.zIndex=1}drag(e){const{handle:i,locked:o}=this;return o?{point:{x:i.x,y:i.y},offset:{x:0,y:0}}:{point:e,offset:{x:e.x-i.x,y:e.y-i.y}}}toggleActive(e){this.active=e,e||(this.handle.strokeWidth=jv.INACTIVE_STROKE_WIDTH)}toggleHovered(e){this.glow.visible=!this.locked&&e,this.glow.dirtyPath=!0}toggleDragging(e){this.locked||(this.handle.visible=!e,this.glow.visible=this.glow.visible&&!e,this.handle.dirtyPath=!0,this.glow.dirtyPath=!0)}toggleLocked(e){this.locked=e}getCursor(){}containsPoint(e,i){return this.handle.containsPoint(e,i)}};Qg.INACTIVE_STROKE_WIDTH=2;var xo=Qg,nh=class Xv extends xo{constructor(){super(),this.handle=new Zo.Circle,this.glow=new Zo.Circle,this.append([this.handle]),this.handle.size=Xv.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2}update(e){this.handle.setProperties({...e,strokeWidth:xo.INACTIVE_STROKE_WIDTH})}drag(e){return{point:e,offset:{x:0,y:0}}}};nh.HANDLE_SIZE=7,nh.GLOW_SIZE=9;var So=nh,nr=class Ee extends xo{constructor(){super(),this.handle=new Zo.Rect,this.glow=new Zo.Rect,this.gradient="horizontal",this.append([this.glow,this.handle]),this.handle.cornerRadius=Ee.CORNER_RADIUS,this.handle.width=Ee.HANDLE_SIZE,this.handle.height=Ee.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.cornerRadius=Ee.CORNER_RADIUS,this.glow.width=Ee.GLOW_SIZE,this.glow.height=Ee.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){if(super.toggleLocked(e),e){const i=(Ee.HANDLE_SIZE-So.HANDLE_SIZE)/2;this.handle.cornerRadius=1,this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.x+=i,this.handle.y+=i,this.handle.width=So.HANDLE_SIZE,this.handle.height=So.HANDLE_SIZE,this.glow.width=So.GLOW_SIZE,this.glow.height=So.GLOW_SIZE}else this.handle.cornerRadius=Ee.CORNER_RADIUS,this.handle.width=Ee.HANDLE_SIZE,this.handle.height=Ee.HANDLE_SIZE,this.glow.width=Ee.GLOW_SIZE,this.glow.height=Ee.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles)}update(e){if(this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked){delete e.fill,delete e.strokeWidth;const i=(Ee.HANDLE_SIZE-So.HANDLE_SIZE)/2;e.x-=i,e.y-=i,this.cachedStyles.x-=i,this.cachedStyles.y-=i}this.handle.setProperties(e),this.glow.setProperties({...e,x:(e.x??this.glow.x)-2,y:(e.y??this.glow.y)-2,strokeWidth:0,fill:e.stroke})}drag(e){return this.locked?{point:e,offset:{x:0,y:0}}:this.gradient==="vertical"?{point:{x:e.x,y:this.handle.y},offset:{x:e.x-this.handle.x,y:0}}:{point:{x:this.handle.x,y:e.y},offset:{x:0,y:e.y-this.handle.y}}}getCursor(){if(!this.locked)return this.gradient==="vertical"?"col-resize":"row-resize"}};nr.HANDLE_SIZE=12,nr.GLOW_SIZE=16,nr.CORNER_RADIUS=4;var Ks=nr,rh=class Vn extends xo{constructor(){super(),this.handle=new Zo.Circle,this.glow=new Zo.Circle,this.append([this.glow,this.handle]),this.handle.size=Vn.HANDLE_SIZE,this.handle.strokeWidth=xo.INACTIVE_STROKE_WIDTH,this.handle.zIndex=2,this.glow.size=Vn.GLOW_SIZE,this.glow.strokeWidth=0,this.glow.fillOpacity=.2,this.glow.zIndex=1,this.glow.visible=!1}toggleLocked(e){super.toggleLocked(e),e?(this.handle.fill=this.handle.stroke,this.handle.strokeWidth=0,this.handle.size=So.HANDLE_SIZE,this.glow.size=So.GLOW_SIZE):(this.handle.size=Vn.HANDLE_SIZE,this.glow.size=Vn.GLOW_SIZE,this.cachedStyles&&this.handle.setProperties(this.cachedStyles))}update(e){this.cachedStyles={...e},this.active||delete e.strokeWidth,this.locked&&(delete e.fill,delete e.strokeWidth),this.handle.setProperties(e),this.glow.setProperties({...e,strokeWidth:0,fill:e.stroke})}getCursor(){return"pointer"}};rh.HANDLE_SIZE=11,rh.GLOW_SIZE=17;var Ht=rh,{ZIndexMap:sk,isObject:ak}=ok,me=class extends ah.Group{constructor(){super(...arguments),this.name="AnnotationScene",this.zIndex=sk.CHART_ANNOTATION}static isCheck(t,e){return ak(t)&&Object.hasOwn(t,"type")&&t.type===e}toggleHovered(t){this.toggleHandles(t)}*nonHandleChildren(){for(const t of this.children())t instanceof xo||(yield t)}computeBBoxWithoutHandles(){return ah.Transformable.toCanvas(this,ah.Group.computeChildrenBBox(this.nonHandleChildren()))}};import{_ModuleSupport as nk}from"ag-charts-community";var{Vec2:lh}=nk,qg=class extends me{constructor(){super(...arguments),this.handle=new Ht,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=xt(t,e);this.updateHandle(t,i),this.anchor=this.updateAnchor(t,i,e)}dragStart(t,e,i){this.dragState={offset:e,handle:xt(t,i)}}drag(t,e,i){const{dragState:o}=this;if(t.locked||!o)return;const s=lh.add(o.handle,lh.sub(e,o.offset)),a=Pt(s,i);t.x=a.x,t.y=a.y}translate(t,e,i){const o=lh.add(xt(t,i),e),s=Pt(o,i);Wi(i,s)&&(t.x=s.x,t.y=s.y)}toggleHandles(t){this.handle.visible=!!t,this.handle.toggleHovered(this.activeHandle==="handle")}toggleActive(t){this.toggleHandles(t),this.handle.toggleActive(t)}stopDragging(){this.handle.toggleDragging(!1)}copy(t,e,i){const o=xt(t,i),s=Pt({x:o.x-30,y:o.y-30},i);return e.x=s.x,e.y=s.y,e}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{handle:i}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="handle",!0):!1}getNodeAtCoords(t,e){if(this.handle.containsPoint(t,e))return"handle"}updateHandle(t,e,i){const{x:o,y:s}=this.getHandleCoords(t,e,i),a=this.getHandleStyles(t);this.handle.update({...a,x:o,y:s}),this.handle.toggleLocked(t.locked??!1)}updateAnchor(t,e,i){const o=this.getHandleCoords(t,e);return{x:o.x+i.seriesRect.x,y:o.y+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i){return{x:e.x,y:e.y}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},Jg=class extends qg{constructor(){super(),this.append([this.handle])}update(t,e){super.update(t,e);const i=xt(t,e);this.updateShape(t,i)}updateShape(t,e){this.updateShapeStyles(t),this.updateShapePath(t,e)}updateShapeStyles(t){const{shape:e}=this;e.fill=t.fill,e.fillOpacity=t.fillOpacity??1}updateShapePath(t,e){const{shape:i}=this;i.x=e.x,i.y=e.y,i.size=t.size}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}getNodeAtCoords(t,e){return this.shape.containsPoint(t,e)?"shape":super.getNodeAtCoords(t,e)}},Ys=class extends Jg{constructor(){super(),this.type="arrow-down",this.shape=new ik.ArrowDown,this.append([this.shape])}static is(t){return me.isCheck(t,"arrow-down")}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i);return o.y-=t.size,o}getHandleCoords(t,e){const i=Ht.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y+=i,o}};import{_ModuleSupport as rk,_Util as lk}from"ag-charts-community";var{StateMachine:rr}=rk,ty=class extends rr{constructor(t){const e=({point:o})=>{const s=this.createDatum(),{x:a,y:n}=o();s.set({x:a,y:n}),t.create(s)},i=()=>{t.node()?.toggleActive(!0),t.showAnnotationOptions(),t.update()};super("start",{start:{click:{target:"waiting-first-render",action:e},drag:{target:"waiting-first-render",action:e},cancel:rr.parent,reset:rr.parent},"waiting-first-render":{render:{target:rr.parent,action:i}}}),this.debug=lk.Debug.create(!0,"annotations")}},ck=class extends ty{createDatum(){return new Yi}},ey={type:"arrow-down",datum:Yi,scene:Ys,isDatum:Yi.is,translate:(t,e,i,o)=>{Yi.is(e)&&Ys.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Yi.is(e)&&Yi.is(i)&&Ys.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Yi.is(e)&&Ys.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getNode:i})=>new ck({...t,create:e("arrow-down"),node:i(Ys.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(Yi.is),node:i(Ys.is)})};import{_ModuleSupport as hk}from"ag-charts-community";var{STRING:dk,Validate:pk,isObject:uk}=hk,ji=class extends th{constructor(){super(...arguments),this.type="arrow-up"}static is(t){return uk(t)&&t.type==="arrow-up"}};d([pk(dk)],ji.prototype,"type",2);import{_Scene as gk}from"ag-charts-community";var js=class extends Jg{constructor(){super(),this.type="arrow-up",this.shape=new gk.ArrowUp,this.append([this.shape])}static is(t){return me.isCheck(t,"arrow-up")}getHandleCoords(t,e){const i=Ht.HANDLE_SIZE/2,o=super.getHandleCoords(t,e);return o.y-=i,o}},yk=class extends ty{createDatum(){return new ji}},iy={type:"arrow-up",datum:ji,scene:js,isDatum:ji.is,translate:(t,e,i,o)=>{ji.is(e)&&js.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(ji.is(e)&&ji.is(i)&&js.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{ji.is(e)&&js.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getNode:i})=>new yk({...t,create:e("arrow-up"),node:i(js.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(ji.is),node:i(js.is)})};import{_Scene as oy}from"ag-charts-community";import{_ModuleSupport as fk,_Scene as sy}from"ag-charts-community";import{_ModuleSupport as mk}from"ag-charts-community";import{_Scene as xk}from"ag-charts-community";var{toRadians:Sk}=xk;function ch({x:t,y:e},i,o,s=1){const{x:a,y:n}=i,r=Math.sqrt(Math.pow(t-a,2)+Math.pow(e-n,2)),l=Math.atan2(e-n,t-a),c=Sk(o),h=Math.round(l/c)*c;return{x:a+r*Math.cos(h),y:n+r*Math.sin(h)*s}}import{_ModuleSupport as bk}from"ag-charts-community";var{Vec2:hh}=bk,ay=class extends me{extendLine({x1:t,y1:e,x2:i,y2:o},s,a){const n={x1:t,y1:e,x2:i,y2:o};if(!s.extendStart&&!s.extendEnd)return n;const[r,l]=qA(n,a.yAxis.bounds),c=n.x2<n.x1,h=n.y1>=n.y2,p=n.x2===n.x1;return s.extendEnd&&(p?n.y2=h?l.y:r.y:(n.x2=c?r.x:l.x,n.y2=c?r.y:l.y)),s.extendStart&&(p?n.y1=h?r.y:l.y:(n.x1=c?l.x:r.x,n.y1=c?l.y:r.y)),n}dragStart(t,e,i){this.dragState={offset:e,start:xt(t.start,i),end:xt(t.end,i)}}drag(t,e,i,o){t.locked||(this.activeHandle?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}dragAll(t,e,i){const{dragState:o}=this;o&&this.translatePoints({datum:t,start:o.start,end:o.end,translation:hh.sub(e,o.offset),context:i})}translatePoints({datum:t,start:e,end:i,translation:o,context:s}){const a=hh.add(e,o),n=hh.add(i,o),r=Pt(a,s),l=Pt(n,s),{xAxis:c,yAxis:h}=s,p=(y,g,f)=>g>=y&&g<=f,u=[a,n].concat(...this.getOtherCoords(t,a,n,s));u.every(y=>p(c.bounds.x,y.x,c.bounds.x+c.bounds.width))&&(t.start.x=r.x,t.end.x=l.x),u.every(y=>p(h.bounds.y,y.y,h.bounds.y+h.bounds.height))&&(t.start.y=r.y,t.end.y=l.y)}translate(t,e,i){this.translatePoints({datum:t,start:xt(t.start,i),end:xt(t.end,i),translation:e,context:i})}copy(t,e,i){const o=Yo(t,i);if(!o)return;const s=this.computeBBoxWithoutHandles();return this.translatePoints({datum:e,start:{x:o.x1,y:o.y1},end:{x:o.x2,y:o.y2},translation:{x:-s.width/2,y:-s.height/2},context:i}),e}getOtherCoords(t,e,i,o){return[]}},{Vec4:ny}=mk,dh=class extends ay{constructor(){super(...arguments),this.start=new Ht,this.end=new Ht,this.anchor={x:0,y:0,position:"above"}}update(t,e){const i=Yo(t,e);i!=null&&(this.updateHandles(t,i),this.updateAnchor(t,i,e))}toggleHandles(t){if(typeof t=="boolean")this.start.visible=t,this.end.visible=t;else for(const[e,i]of Object.entries(t))this[e].visible=i;this.start.toggleHovered(this.activeHandle==="start"),this.end.toggleHovered(this.activeHandle==="end")}toggleActive(t){this.toggleHandles(t),this.start.toggleActive(t),this.end.toggleActive(t)}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=o?this.snapToAngle(t,e,i):Pt(this[s].drag(e).point,i);!n||!Wi(i,n)||(t[s].x=n.x,t[s].y=n.y)}snapToAngle(t,e,i){const{activeHandle:o}=this,a=["start","end"].find(r=>r!==o);if(!o||!a)return;this[o].toggleDragging(!0);const n=xt(t[a],i);return Pt(ch(e,n,t.snapToAngle),i)}stopDragging(){this.start.toggleDragging(!1),this.end.toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return"pointer"}containsPoint(t,e){const{start:i,end:o}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="start",!0):o.containsPoint(t,e)?(this.activeHandle="end",!0):!1}getNodeAtCoords(t,e){if(this.start.containsPoint(t,e)||this.end.containsPoint(t,e))return"handle"}updateHandles(t,e,i){this.start.update({...this.getHandleStyles(t,"start"),...this.getHandleCoords(t,e,"start")}),this.end.update({...this.getHandleStyles(t,"end"),...this.getHandleCoords(t,e,"end",i)}),this.start.toggleLocked(t.locked??!1),this.end.toggleLocked(t.locked??!1)}updateAnchor(t,e,i,o){this.anchor={x:e.x1+i.seriesRect.x,y:e.y1+i.seriesRect.y,position:this.anchor.position}}getHandleCoords(t,e,i,o){return i==="start"?ny.start(e):ny.end(e)}getHandleStyles(t,e){return{fill:t.handle.fill,stroke:t.handle.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}},{Vec2:ry,Vec4:ly}=fk,vk=class extends dh{constructor(){super(...arguments),this.label=new sy.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty(sy.RedrawType.MINOR)}update(t,e){const i=Yo(t,e);if(i==null)return;const o=this.getTextBBox(t,i);this.updateLabel(t,o,i),this.updateHandles(t,i,o),this.updateShape(t,o,i),this.updateAnchor(t,i,e,o)}dragHandle(t,e,i,o){const{activeHandle:s,dragState:a}=this;if(!s||!a)return;this[s].toggleDragging(!0);const n=ry.add(a.end,ry.sub(e,a.offset)),r=o?this.snapToAngle(t,n,i):Pt(n,i);!r||!Wi(i,r)||(t[s].x=r.x,t[s].y=r.y)}containsPoint(t,e){const{label:i}=this;return super.containsPoint(t,e)||i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e){const{text:i}=t.getText();return Jc(t,i,ly.end(e),this.textInputBBox)}updateLabel(t,e,i){const{text:o,isPlaceholder:s}=t.getText();_g(this.label,o,s,t,this.getLabelCoords(t,e,i))}updateShape(t,e,i){}getLabelCoords(t,e,i){return ly.end(i)}getHandleStyles(t,e){return{...super.getHandleStyles(t,e),stroke:t.handle.stroke??t.color}}},{drawCorner:Mk}=oy,Xs=class extends vk{constructor(){super(),this.type="callout",this.shape=new oy.Path,this.append([this.shape,this.label,this.start,this.end])}static is(t){return me.isCheck(t,"callout")}drag(t,e,i,o){t.locked||(this.activeHandle==="end"?this.dragHandle(t,e,i,o):this.dragAll(t,e,i))}getLabelCoords(t,e,i){const o=t.getPadding(),{bodyBounds:s={x:0,y:0,width:0,height:0}}=this.getDimensions(t,e,i)??{};return{x:s.x+o.left,y:s.y-o.bottom}}getHandleStyles(t,e){return e==="start"?{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}:{fill:void 0,strokeWidth:0}}updateAnchor(t,e,i,o){const{bodyBounds:s}=this.getDimensions(t,o,e)??{},a=s??o;this.anchor={x:a.x+i.seriesRect.x,y:a.y+i.seriesRect.y-a.height,position:this.anchor.position}}updateShape(t,e,i){const{shape:o}=this;o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeWidth=t.strokeWidth??1,o.strokeOpacity=t.strokeOpacity??1;const{tailPoint:s,bodyBounds:a}=this.getDimensions(t,e,i)??{};!s||!a||this.updatePath(s,a)}updatePath(t,e){const{x:i,y:o}=t,{x:s,y:a,width:n,height:r}=e,l=a-r,c=s+n,h=this.calculateCalloutPlacement({x:i,y:o},e),p=8,u=[{coordinates:{x0:s,x1:s+p,y0:l+p,y1:l,cx:h==="topLeft"?i:s+p,cy:h==="topLeft"?o:l+p},type:h==="topLeft"?"calloutCorner":"corner"},{coordinates:{x0:s+p,x1:c-p,y0:l,y1:l,cx:i,cy:o},type:h==="top"?"calloutSide":"side"},{coordinates:{x0:c-p,x1:c,y0:l,y1:l+p,cx:h==="topRight"?i:c-p,cy:h==="topRight"?o:l+p},type:h==="topRight"?"calloutCorner":"corner"},{coordinates:{x0:c,x1:c,y0:l+p,y1:a-p,cx:i,cy:o},type:h==="right"?"calloutSide":"side"},{coordinates:{x0:c,x1:c-p,y0:a-p,y1:a,cx:h==="bottomRight"?i:c-p,cy:h==="bottomRight"?o:a-p},type:h==="bottomRight"?"calloutCorner":"corner"},{coordinates:{x0:c-p,x1:s+p,y0:a,y1:a,cx:i,cy:o},type:h==="bottom"?"calloutSide":"side"},{coordinates:{x0:s+p,x1:s,y0:a,y1:a-p,cx:h==="bottomLeft"?i:s+p,cy:h==="bottomLeft"?o:a-p},type:h==="bottomLeft"?"calloutCorner":"corner"},{coordinates:{x0:s,x1:s,y0:a-p,y1:l+p,cx:i,cy:o},type:h==="left"?"calloutSide":"side"}],{path:y}=this.shape;y.clear(),y.moveTo(s,l+p),u.forEach(({coordinates:g,type:f})=>{this.drawPath(y,g,p,f)}),y.closePath()}drawPath(t,{x0:e,y0:i,x1:o,y1:s,cx:a,cy:n},r,l){switch(l){case"calloutCorner":{t.lineTo(a,n),t.lineTo(o,s);break}case"corner":{Mk(t,{x0:e,x1:o,y0:i,y1:s,cx:a,cy:n},r,!1);break}case"calloutSide":{if(e!==o){const h=e>o?-1:1,p=Math.min(e,o)+Math.abs(o-e)/2;t.lineTo(p-6*h,i),t.lineTo(a,n),t.lineTo(p+6*h,i),t.lineTo(o,s)}else{const h=i>s?-1:1,p=Math.min(i,s)+Math.abs(i-s)/2;t.lineTo(e,p-6*h),t.lineTo(a,n),t.lineTo(e,p+6*h),t.lineTo(o,s)}break}case"side":default:{t.lineTo(o,s);break}}}calculateCalloutPlacement(t,e){const i=e.x+e.width,o=e.y-e.height;let s,a;return t.x>i?s="right":t.x<e.x&&(s="left"),t.y>e.y?a="bottom":t.y<o&&(a="top"),s&&a?`${a}${s[0].toUpperCase()}${s.substring(1)}`:a??s}getDimensions(t,e,i){const{fontSize:o}=t,s=t.getPadding(),a=s.left+s.right,n=s.top+s.bottom,r=e.width+a,l=Math.max(e.height+n,o+n);return{tailPoint:{x:i.x1,y:i.y1},bodyBounds:{x:e.x,y:e.y,width:r,height:l}}}containsPoint(t,e){const{start:i,end:o,shape:s}=this;if(this.activeHandle=void 0,i.containsPoint(t,e))return this.activeHandle="start",!0;const a=o.containsPoint(t,e)||s.containsPoint(t,e);return a&&(this.activeHandle="end"),a}};import{_ModuleSupport as Tk,_Util as Ak}from"ag-charts-community";function ph({key:t}){return t==="Escape"}function uh({key:t,shiftKey:e}){return!e&&t==="Enter"}var{StateMachine:ni}=Tk,Dk=class extends ni{constructor(t){const e=({point:u})=>{const y=this.createDatum(),g=u();y.set({start:g,end:g,visible:!0}),t.create(y)},i=()=>{t.node()?.toggleActive(!0)},o=()=>{t.showTextInput();const u=t.datum();u&&(u.visible=!1)},s=()=>{t.hideTextInput();const u=t.datum();u&&(u.visible=!0),t.deselect()},a=u=>{t.node()?.setTextInputBBox(u),t.update()},n=({point:u})=>{t.datum()?.set({end:u()}),t.node()?.toggleActive(!0),t.node()?.toggleHandles({end:!1}),t.update()},r=()=>{t.showAnnotationOptions(),t.node()?.toggleHandles({end:!0})},l=({colorPickerType:u,colorOpacity:y,color:g,opacity:f})=>{const m=t.datum();m&&(u==="text-color"&&t.updateTextInputColor(g),ar(m,u,y,g,f),t.update())},c=u=>{const y=t.datum(),g=t.node();!y||!g||!Di(y)||(y.fontSize=u,t.updateTextInputFontSize(u),t.update())},h=()=>{t.delete()},p=({textInputValue:u,bbox:y})=>{if(u!=null&&u.length>0){const g=t.datum();if(!Di(g))return;const f=tr(g,u,y.width);g?.set({text:f}),t.update(),t.recordAction(`Create ${t.node()?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:ni.parent,reset:ni.parent},"waiting-first-render":{render:{target:"end",action:i}},end:{hover:n,drag:n,click:{target:"edit",action:r},dragEnd:{target:"edit",action:r},reset:{target:ni.parent,action:h},cancel:{target:ni.parent,action:h}},edit:{onEnter:o,updateTextInputBBox:a,color:l,fontSize:c,keyDown:[{guard:ph,target:ni.parent,action:h},{guard:uh,target:ni.parent,action:p}],click:{target:ni.parent,action:p},dragStart:{target:ni.parent,action:p},zoomChange:{target:ni.parent,action:p},onExit:s,cancel:{target:ni.parent,action:h}}}),this.debug=Ak.Debug.create(!0,"annotations")}},kk=class extends Dk{createDatum(){return new Re}},cy={type:"callout",datum:Re,scene:Xs,isDatum:Re.is,translate:(t,e,i,o)=>{if(Re.is(e)&&Xs.is(t))return t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Re.is(e)&&Re.is(i)&&Xs.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Re.is(e)&&Xs.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new kk({...t,create:e("callout"),datum:i(Re.is),node:o(Xs.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(Re.is),node:i(Xs.is)})};import{_Scene as hy}from"ag-charts-community";import{_Scene as dy}from"ag-charts-community";var gh=class extends qg{constructor(){super(...arguments),this.label=new dy.Text({zIndex:1}),this.anchor={x:0,y:0,position:"above-left"}}setTextInputBBox(t){this.textInputBBox=t,this.markDirty(dy.RedrawType.MINOR)}update(t,e){const i=xt(t,e),o=this.getTextBBox(t,i,e);this.updateLabel(t,o),this.updateHandle(t,i,o),this.updateShape(t,o),this.anchor=this.updateAnchor(t,o,e)}copy(t,e,i){const o=xt(t,i),s=this.getTextBBox(t,o,i),a=t.getPadding(),n=a.left+a.right,r=a.top+a.bottom,l=(s.width+n)/2,c=s.height+r,h=Pt({x:o.x-l,y:o.y-c},i);return e.x=h.x,e.y=h.y,e}containsPoint(t,e){const{label:i}=this;return super.containsPoint(t,e)||i.visible&&i.containsPoint(t,e)}getNodeAtCoords(t,e){return this.label.visible&&this.label.containsPoint(t,e)?"text":super.getNodeAtCoords(t,e)}getTextBBox(t,e,i){const{text:o}=t.getText();return Jc(t,o,{x:e.x,y:e.y},this.textInputBBox)}updateLabel(t,e){const{text:i,isPlaceholder:o}=t.getText();_g(this.label,i,o,t,this.getLabelCoords(t,e))}updateShape(t,e){}updateAnchor(t,e,i){return{x:e.x+i.seriesRect.x,y:e.y+i.seriesRect.y-e.height,position:this.anchor.position}}getLabelCoords(t,e){return e}getHandleCoords(t,e,i){return i}getHandleStyles(t){const e=super.getHandleStyles(t);return e.stroke=t.handle.stroke??t.color,e}},{drawCorner:yh}=hy,Zs=class extends gh{constructor(){super(),this.type="comment",this.shape=new hy.Path,this.append([this.shape,this.label,this.handle])}static is(t){return me.isCheck(t,"comment")}updateShape(t,e){const{shape:i}=this;i.fill=t.fill,i.fillOpacity=t.fillOpacity??1,i.stroke=t.stroke??"transparent",i.strokeWidth=t.strokeWidth??1,i.strokeOpacity=t.strokeOpacity??1,this.updatePath(t,e)}getLabelCoords(t,e){const i=t.getPadding();return{x:e.x+i.left,y:e.y-i.bottom}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}updateAnchor(t,e,i){const o=super.updateAnchor(t,e,i),s=t.getPadding();return o.y-=s.bottom+s.top,o}updatePath(t,e){const i=t.getPadding(),{x:o,y:s}=e;let{width:a,height:n}=e;const{fontSize:r}=t,l=i.left+i.right,c=i.top+i.bottom;a=a+l,n=Math.max(n+c,r+c);const h=s-n,p=o+a,u=(r*Jn+c)/2,{path:y}=this.shape;y.clear(),y.moveTo(o,s),y.lineTo(o,h+u),yh(y,{x0:o,x1:o+u,y0:h+u,y1:h,cx:o+u,cy:h+u},u,!1),y.lineTo(p-u,h),yh(y,{x0:p-u,x1:p,y0:h,y1:h+u,cx:p-u,cy:h+u},u,!1),y.lineTo(p,s-u),yh(y,{x0:p,x1:p-u,y0:s-u,y1:s,cx:p-u,cy:s-u},u,!1),y.closePath()}containsPoint(t,e){return super.containsPoint(t,e)||this.shape.containsPoint(t,e)}};import{_ModuleSupport as Ik,_Util as Nk}from"ag-charts-community";var{StateMachine:Xi}=Ik,fh=class extends Xi{constructor(t){const e=({point:h})=>{const p=this.createDatum(),{x:u,y}=h();p.set({x:u,y}),t.create(p)},i=()=>{t.node()?.toggleActive(!0),t.showAnnotationOptions(),t.update()},o=()=>{t.showTextInput();const h=t.datum();h&&(h.visible=!1)},s=()=>{t.hideTextInput();const h=t.datum();h&&(h.visible=!0),t.deselect()},a=h=>{t.node()?.setTextInputBBox(h),t.update()},n=({colorPickerType:h,colorOpacity:p,color:u,opacity:y})=>{const g=t.datum();g&&(h==="text-color"&&t.updateTextInputColor(u),ar(g,h,p,u,y),t.update())},r=h=>{const p=t.datum(),u=t.node();!p||!u||!Di(p)||(p.fontSize=h,t.updateTextInputFontSize(h),t.update())},l=()=>{t.delete()},c=({textInputValue:h,bbox:p})=>{if(h!=null&&h.length>0){const u=t.datum();if(!Di(u))return;const y=tr(u,h,p.width);u?.set({text:y}),t.update(),t.recordAction(`Create ${t.node()?.type} annotation`)}else t.delete()};super("start",{start:{click:{target:"waiting-first-render",action:e},dragStart:{target:"waiting-first-render",action:e},cancel:Xi.parent,reset:Xi.parent},"waiting-first-render":{render:{target:"edit",action:i}},edit:{onEnter:o,updateTextInputBBox:a,color:n,fontSize:r,keyDown:[{guard:ph,target:Xi.parent,action:l},{guard:uh,target:Xi.parent,action:c}],click:{target:Xi.parent,action:c},dragStart:{target:Xi.parent,action:c},zoomChange:{target:Xi.parent,action:c},onExit:s,cancel:{target:Xi.parent,action:l}}}),this.debug=Nk.Debug.create(!0,"annotations")}},Ok=class extends fh{createDatum(){return new He}},py={type:"comment",datum:He,scene:Zs,isDatum:He.is,translate:(t,e,i,o)=>{He.is(e)&&Zs.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(He.is(e)&&He.is(i)&&Zs.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{He.is(e)&&Zs.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new Ok({...t,create:e("comment"),datum:i(He.is),node:o(Zs.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(He.is),node:i(Zs.is)})};import{_ModuleSupport as Lk}from"ag-charts-community";import{_ModuleSupport as Ck,_Scene as mh}from"ag-charts-community";var{calculateLabelTranslation:Ek,ChartAxisDirection:_k}=Ck,uy=class extends mh.Group{constructor(){super({name:"AnnotationAxisLabelGroup"}),this.label=new mh.Text({zIndex:1}),this.rect=new mh.Rect;const{label:t}=this;t.fontSize=12,t.fontFamily="Verdana, sans-serif",t.fill="black",t.textBaseline="middle",t.textAlign="center",this.append([this.rect,this.label])}update(t){this.updateLabel(t),this.updateRect(t),this.updatePosition(t)}updateLabel({value:t,styles:e,context:i}){const{label:o}=this,{fontWeight:s,fontSize:a,fontStyle:n,fontFamily:r,textAlign:l,color:c="white",formatter:h}=e;o.setProperties({fontWeight:s,fontSize:a,fontStyle:n,fontFamily:r,textAlign:l,fill:c}),o.text=this.getFormattedValue(t,h??i.scaleValueFormatter())}updateRect({styles:t}){const{rect:e}=this,{cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n}=t;e.setProperties({cornerRadius:i,fill:o,fillOpacity:s,stroke:a,strokeOpacity:n})}updatePosition({x:t,y:e,context:i,styles:{padding:o}}){const{label:s,rect:a}=this,n=s.getBBox()?.clone(),r=8,l=5;n.grow(o??r,"horizontal"),n.grow(o??l,"vertical");const c=i.direction===_k.X?l/2:r,{xTranslation:h,yTranslation:p}=Ek({yDirection:!0,padding:i.labelPadding-c,position:i.position??"left",bbox:n}),u=t+h,y=e+p;s.x=u,s.y=y,a.x=u-n.width/2,a.y=y-n.height/2,a.height=n.height,a.width=n.width}getFormattedValue(t,e){return e?.(t)??String(t)}};uy.className="AxisLabel";import{_ModuleSupport as gy,_Scene as xh}from"ag-charts-community";var{Vec2:ki}=gy,ri=class extends xh.Line{constructor(){super(...arguments),this.growCollisionBox=9}setProperties(t,e){return super.setProperties(t,e),this.updateCollisionBBox(),this}updateCollisionBBox(){const{growCollisionBox:t,strokeWidth:e,x1:i,y1:o,x2:s,y2:a}=this;let n=e+t;n%2===0&&(n+=1);const r=ki.from(i,o-Math.floor(n/2)),l=ki.from(s,a),c=ki.distance(r,l);this.collisionBBox=new xh.BBox(r.x,r.y,c,n)}isPointInPath(t,e){const{collisionBBox:i,x1:o,y1:s,x2:a,y2:n}=this;if(!i)return!1;const r=ki.from(o,s),l=ki.from(a,n),c=ki.sub(ki.from(t,e),r),h=ki.sub(l,r),p=ki.rotate(c,ki.angle(c,h),r);return i.containsPoint(p.x,p.y)??!1}render(t){this.applyClipMask(t.ctx),super.render(t),this.closeClipMask(t.ctx)}setClipMask(t){gy.jsonDiff(this.clipMask,t)!=null&&this.markDirty(xh.RedrawType.MAJOR),this.clipMask=t}applyClipMask(t){const{clipMask:e}=this;if(!e)return;const{x:i,y:o,radius:s}=e;t.save(),t.beginPath(),t.rect(0,0,t.canvas.width,t.canvas.height),t.ellipse(i,o,s,s,0,Math.PI*2,0,!0),t.clip()}closeClipMask(t){this.clipMask&&t.restore()}};import{_ModuleSupport as Rk}from"ag-charts-community";import{_Scene as wk}from"ag-charts-community";var yy=class extends wk.TransformableText{constructor(){super(...arguments),this.growCollisionBox={top:4,right:4,bottom:4,left:4}}isPointInPath(t,e){const i=this.fromParentPoint(t,e),o=this.computeBBoxWithoutTransforms();return o?o.grow(this.growCollisionBox).containsPoint(i.x,i.y):!1}},{Vec2:ae}=Rk,Qa=class Rs{static updateLineText(e,i,o){if(!i.text?.label&&this.text&&(this.removeChild(this.text),e.setClipMask(),this.text=void 0),!i.text?.label)return;this.text==null&&(this.text=new yy,this.appendChild(this.text));const{alignment:s,position:a}=i.text,n=Rs.getNumbers(o,i.text.fontSize,i.strokeWidth),{point:r,textBaseline:l}=Rs.positionAndAlignment(n,a,s);Rs.setProperties(this.text,i.text,r,n.angle,l);const{x:c,y:h,width:p,height:u}=this.text.getBBox(),y=ae.length(ae.from(p,u)),g={x:c+p/2,y:h+u/2,radius:y/2+ae.length(n.offset)};return a==="center"?e.setClipMask(g):e.setClipMask(),{clipMask:g,numbers:n}}static updateChannelText(e,i,o,s){if(!i.text?.label&&this.text&&(this.removeChild(this.text),this.text=void 0),!i.text?.label)return;this.text==null&&(this.text=new yy,this.appendChild(this.text));const{alignment:a,position:n}=i.text,[r,l]=o.y1<=s.y1?[o,s]:[s,o];let c=r;n==="bottom"?c=l:n==="inside"&&(c={x1:(r.x1+l.x1)/2,y1:(r.y1+l.y1)/2,x2:(r.x2+l.x2)/2,y2:(r.y2+l.y2)/2});const h=Rs.getNumbers(c,i.text.fontSize,i.strokeWidth),{point:p,textBaseline:u}=Rs.positionAndAlignment(h,n==="inside"?"center":n,a,e);Rs.setProperties(this.text,i.text,p,h.angle,u)}static getNumbers(e,i,o){let[s,a]=ae.from(e);s.x>a.x&&([s,a]=[a,s]);const n=ae.normalized(ae.sub(a,s)),r=ae.angle(n),l=ae.multiply(n,Ht.HANDLE_SIZE/2+(i??14)/2),c=ae.multiply(n,(o??2)/2+(i??14)/3);return{left:s,right:a,normal:n,angle:r,inset:l,offset:c}}static positionAndAlignment({left:e,right:i,normal:o,angle:s,inset:a,offset:n},r,l,c){let h;l==="right"?h=ae.sub(i,a):l==="center"?h=ae.add(e,ae.multiply(o,ae.distance(e,i)/2)):h=ae.add(e,a);let p="bottom";return r==="bottom"?(h=ae.rotate(n,s+Math.PI/2,h),p="top"):r==="center"&&!c?p="middle":h=ae.rotate(n,s-Math.PI/2,h),{point:h,textBaseline:p}}static setProperties(e,i,o,s,a){e.setProperties({text:i.label,x:o.x,y:o.y,rotation:s,rotationCenterX:o.x,rotationCenterY:o.y,fill:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,textAlign:i.alignment,textBaseline:a})}},{ChartAxisDirection:Pk,Vec2:$s,Vec4:Sh}=Lk,Ge=class extends me{constructor(){super(),this.type="cross-line",this.line=new ri,this.middle=new Ks,this.isHorizontal=!1,this.append([this.line,this.middle])}static is(t){return me.isCheck(t,"cross-line")}update(t,e){const{seriesRect:i}=e;this.seriesRect=i,this.isHorizontal=Zt.is(t);const o=this.isHorizontal?e.yAxis:e.xAxis,s=this.convertCrossLine(t,o);if(s==null){this.visible=!1;return}this.visible=t.visible??!0,this.visible&&(this.updateLine(t,s),this.updateHandle(t,s),this.updateText(t,s),this.updateAxisLabel(t,o,s))}updateLine(t,e){const{line:i}=this,{lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,{x1:r,y1:l,x2:c,y2:h}=e;i.setProperties({x1:r,y1:l,x2:c,y2:h,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:o,stroke:s,strokeWidth:a,strokeOpacity:n,fillOpacity:0})}updateHandle(t,e){const{middle:i}=this,{locked:o,stroke:s,strokeWidth:a,strokeOpacity:n}=t,r={fill:t.handle.fill,stroke:t.handle.stroke??s,strokeOpacity:t.handle.strokeOpacity??n,strokeWidth:t.handle.strokeWidth??a},l=$s.sub(Sh.center(e),$s.from(i.handle.width/2,i.handle.height/2));i.gradient=this.isHorizontal?"horizontal":"vertical",i.update({...r,...l}),i.toggleLocked(o??!1)}updateText(t,e){Qa.updateLineText.call(this,this.line,t,e)}createAxisLabel(t){const e=new uy;return t.attachLabel(e),e}updateAxisLabel(t,e,i){this.axisLabel||(this.axisLabel=this.createAxisLabel(e));const{axisLabel:o,seriesRect:s}=this,{direction:a,position:n}=e;if(t.axisLabel.enabled){o.visible=this.visible;const r=n==="left"||n==="top"?Sh.start(i):Sh.end(i),l=a===Pk.X?r.x:r.y;if(!e.inRange(l)){o.visible=!1;return}o.update({...$s.add(r,$s.required(s)),value:t.value,styles:t.axisLabel,context:e})}else o.visible=!1}toggleHandles(t){this.middle.visible=t,this.middle.toggleHovered(this.activeHandle==="middle")}destroy(){super.destroy(),this.axisLabel?.destroy()}toggleActive(t){this.toggleHandles(t),this.middle.toggleActive(t)}dragStart(t,e,i){const o=Zt.is(t)?{x:e.x,y:jo(t.value,i.yAxis)}:{x:jo(t.value,i.xAxis),y:e.y};this.dragState={offset:e,middle:o}}drag(t,e,i){const{activeHandle:o,dragState:s}=this;if(t.locked)return;let a;if(o)this[o].toggleDragging(!0),a=this[o].drag(e).point;else if(s)a=$s.add(s.middle,$s.sub(e,s.offset));else return;const n=Pt(a,i),r=Zt.is(t);t.set({value:r?n.y:n.x})}translate(t,{x:e,y:i},o){if(t.locked)return;const{axisContext:s,translation:a}=Zt.is(t)?{axisContext:o.yAxis,translation:i}:{axisContext:o.xAxis,translation:e},n=jo(t.value,s)+a,r=Ya(n,s);isNaN(r)||t.set({value:r})}stopDragging(){this.middle.toggleDragging(!1)}copy(t,e,i){const o=Zt.is(t),s=this.isHorizontal?i.yAxis:i.xAxis,a=this.convertCrossLine(t,s);if(!a)return;const n=o?-30:0,r=o?0:-30,l=Pt({x:a.x1+r,y:a.y1+n},i);return e.set({value:o?l.y:l.x}),e}getCursor(){return this.activeHandle==null?"pointer":this[this.activeHandle].getCursor()}containsPoint(t,e){const{middle:i,line:o,text:s}=this;return this.activeHandle=void 0,i.containsPoint(t,e)?(this.activeHandle="middle",!0):o.isPointInPath(t,e)||!!s?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.line.isPointInPath(t,e))return"line";if(this.middle.containsPoint(t,e))return"handle"}getAnchor(){const t=this.computeBBoxWithoutHandles();return this.isHorizontal?{x:t.x+t.width/2,y:t.y}:{x:t.x+t.width,y:t.y+t.height/2,position:"right"}}convertCrossLine(t,e){if(t.value==null)return;let i=0,o=0,s=0,a=0;const{bounds:n,scaleConvert:r,scaleBandwidth:l}=e,c=(l()??0)/2;if(Zt.is(t)){const h=r(t.value)+c;o=n.width,s=h,a=h}else{const h=r(t.value)+c;i=h,o=h,a=n.height}return{x1:i,y1:s,x2:o,y2:a}}};import{_ModuleSupport as Bk,_Util as zk}from"ag-charts-community";var{StateMachine:lr}=Bk,fy=class extends lr{constructor(t,e){const i=({point:s})=>{const a=t==="horizontal",n=a?new Zt:new ii,{x:r,y:l}=s();n.set({value:a?l:r}),e.create(n),e.recordAction(`Create ${a?"horizontal-line":"vertical-line"} annotation`)},o=()=>{e.node()?.toggleActive(!0),e.showAnnotationOptions(),e.update()};super("start",{start:{click:{target:"waiting-first-render",action:i},drag:{target:"waiting-first-render",action:i},reset:lr.parent,cancel:lr.parent},"waiting-first-render":{render:{target:lr.parent,action:o}}}),this.debug=zk.Debug.create(!0,"annotations")}},my={type:"horizontal-line",datum:Zt,scene:Ge,isDatum:Zt.is,translate:(t,e,i,o)=>{Zt.is(e)&&Ge.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Zt.is(e)&&Zt.is(i)&&Ge.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Zt.is(e)&&Ge.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getNode:i})=>new fy("horizontal",{...t,create:e("horizontal-line"),node:i(Ge.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(Zt.is),node:i(Ge.is)})},xy={type:"vertical-line",datum:ii,scene:Ge,isDatum:ii.is,translate:(t,e,i,o)=>{ii.is(e)&&Ge.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(ii.is(e)&&ii.is(i)&&Ge.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{ii.is(e)&&Ge.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getNode:i})=>new fy("vertical",{...t,create:e("vertical-line"),node:i(Ge.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(ii.is),node:i(Ge.is)})};import{_ModuleSupport as Fk}from"ag-charts-community";import{_Scene as Sy}from"ag-charts-community";import{_ModuleSupport as Vk}from"ag-charts-community";var{Vec4:Uk}=Vk,by=class{static updateBackground(t,e,i,o){const{background:s}=this,{seriesRect:a}=o;s.path.clear(!0);const n=Uk.from(0,0,a.width,a.height),r=this.getBackgroundPoints(t,e,i,n);for(let c=0;c<r.length;c++){const h=r[c];c===0?s.path.moveTo(h.x,h.y):s.path.lineTo(h.x,h.y)}s.path.closePath(),s.checkPathDirty();const l=this.getBackgroundStyles?.(t)??t.background;s.setProperties({fill:l.fill,fillOpacity:l.fillOpacity})}},vy=class extends ay{constructor(){super(...arguments),this.handles={},this.topLine=new ri,this.bottomLine=new ri,this.background=new Sy.Path({zIndex:-1}),this.anchor={x:0,y:0},this.updateBackground=by.updateBackground.bind(this)}update(t,e){const{locked:i,visible:o}=t,s=Yo(t,e),a=Yo(t.bottom,e);if(s==null||a==null){this.visible=!1;return}else this.visible=o??!0;const n=this.extendLine(s,t,e),r=this.extendLine(a,t,e);this.updateLines(t,n,r,e,s,a),this.updateHandles(t,s,a),this.updateText(t,s,a),this.updateBackground(t,n,r,e),this.updateAnchor(s,a);for(const l of Object.values(this.handles))l.toggleLocked(i??!1)}snapToAngle(t,e,i,o,s,a){const{handles:n}=this,r=n[o].handle,l=n[i].drag(t).point;return Pt(ch(l,r,s,a),e)}toggleHandles(t){const{handles:e}=this;if(typeof t=="boolean"){for(const[i,o]of Object.entries(e))o.visible=t,o.toggleHovered(this.activeHandle===i);return}for(const[i,o]of Object.entries(t)){const s=e[i];s.visible=o??!0,s.toggleHovered(this.activeHandle===i)}}toggleActive(t){this.toggleHandles(t);for(const e of Object.values(this.handles))e.toggleActive(t)}stopDragging(){const{activeHandle:t,handles:e}=this;t!=null&&e[t].toggleDragging(!1)}getAnchor(){return this.anchor}getCursor(){return this.activeHandle==null?"pointer":this.handles[this.activeHandle].getCursor()}containsPoint(t,e){const{handles:i,topLine:o,bottomLine:s,text:a}=this;this.activeHandle=void 0;for(const[n,r]of Object.entries(i))if(r.containsPoint(t,e))return this.activeHandle=n,!0;return o.containsPoint(t,e)||s.containsPoint(t,e)||!!a?.containsPoint(t,e)}getNodeAtCoords(t,e){if(this.text?.containsPoint(t,e))return"text";if(this.topLine.containsPoint(t,e)||this.bottomLine.containsPoint(t,e))return"line";for(const[i,o]of Object.entries(this.handles))if(o.containsPoint(t,e))return"handle"}updateAnchor(t,e){const{x:i,y:o}=Sy.Transformable.toCanvasPoint(this.topLine,(t.x1+t.x2)/2,Math.min(t.y1,t.y2,e.y1,e.y2));this.anchor.x=i,this.anchor.y=o}},{Vec2:We,Vec4:cr}=Fk,Qs=class extends vy{constructor(){super(),this.type="disjoint-channel",this.handles={topLeft:new Ht,topRight:new Ht,bottomLeft:new Ht,bottomRight:new Ks},this.updateText=Qa.updateChannelText.bind(this,!1),this.append([this.background,this.topLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return me.isCheck(t,"disjoint-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=h=>Pt(h,i),l=t.toJson(),c=t.snapToAngle;switch(s){case"topLeft":case"bottomLeft":{const h=s==="topLeft"?1:-1,p=o?this.snapToAngle(e,i,"topLeft","topRight",c,h):r({x:a.topLeft.handle.x+n.x,y:a.topLeft.handle.y+n.y*h}),u=o?this.snapToAngle(e,i,"bottomLeft","bottomRight",c,-h):r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y*-h});if(!p||p.y==null||!u||u.y==null||t.start.y==null)return;const y=t.startHeight+(p.y-t.start.y)*2;t.start.x=p.x,t.start.y=p.y,t.startHeight=y;break}case"topRight":{const h=o?this.snapToAngle(e,i,"topRight","topLeft",c):r({x:a.topRight.handle.x+n.x,y:a.topRight.handle.y+n.y});if(!h||h.y==null||t.end.y==null)return;const p=t.endHeight+(h.y-t.end.y)*2;t.end.x=h.x,t.end.y=h.y,t.endHeight=p;break}case"bottomRight":{const h=r({x:a.bottomLeft.handle.x+n.x,y:a.bottomLeft.handle.y+n.y}),p=r({x:a.bottomRight.handle.x+n.x,y:a.bottomRight.handle.y+n.y});if(!h||!p||t.start.y==null||t.end.y==null)return;const u=t.end.y-p.y,y=t.startHeight-(t.endHeight-u);t.startHeight=y,t.endHeight=u}}t.isValidWithContext(i)||t.set(l)}getOtherCoords(t,e,i,o){const s=xt(t.bottom.start,o).y-xt(t.start,o).y,a=xt(t.bottom.end,o).y-xt(t.end,o).y,n=We.add(e,We.from(0,s)),r=We.add(i,We.from(0,a));return[n,r]}updateLines(t,e,i){const{topLine:o,bottomLine:s}=this,{lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l}=t,c={lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:a,stroke:n,strokeOpacity:r,strokeWidth:l};o.setProperties({...e,...c}),s.setProperties({...i,...c})}updateHandles(t,e,i){const{handles:{topLeft:o,topRight:s,bottomLeft:a,bottomRight:n}}=this,r={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...r,...cr.start(e)}),s.update({...r,...cr.end(e)}),a.update({...r,...cr.start(i)}),n.update({...r,...We.sub(cr.end(i),We.from(n.handle.width/2,n.handle.height/2))})}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=a?o.y2:o.y1,r=a?o.y1:o.y2,l=We.from(e);return t.extendEnd&&e.y2===r&&l.push(We.from(s?o.x1:o.x2,a?o.y1:o.y2)),t.extendEnd&&i.y2===n&&l.push(We.from(s?o.x1:o.x2,a?o.y2:o.y1)),l.push(...We.from(i).reverse()),t.extendStart&&i.y1===r&&l.push(We.from(s?o.x2:o.x1,a?o.y1:o.y2)),t.extendStart&&e.y1===n&&l.push(We.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as Hk,_Util as Gk}from"ag-charts-community";var{StateMachine:bo}=Hk,Wk=class extends bo{constructor(t){const e=({point:r})=>{const l=new De,c=r();l.set({start:c,end:c,startHeight:0,endHeight:0}),t.create(l),t.addPostUpdateFns(()=>t.node()?.toggleActive(!0),()=>t.node()?.toggleHandles({topLeft:!0,topRight:!1,bottomLeft:!1,bottomRight:!1}))},i=({point:r})=>{const l=t.datum();l?.set({end:r(l?.start,l?.snapToAngle)}),t.update()},o=()=>{t.node()?.toggleHandles({topRight:!0}),t.update()},s=({point:r})=>{const l=t.datum();if(l?.start.y==null||l?.end.y==null)return;const c=r().y,h=l.end.y-(c??0),p=(l.start.y-l.end.y)*2+h,u={x:l.start.x,y:l.start.y-p},y={x:l.end.x,y:c};t.node()?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint(u)||!t.validatePoint(y))&&(l.set({startHeight:p,endHeight:h}),t.update())},a=({point:r})=>{const l=t.datum();if(l?.start.y==null||l?.end.y==null)return;const c=r().y,h=l.end.y-(c??0),p=(l.start.y-l.end.y)*2+h,u={x:l.start.x,y:l.start.y-h},y={x:l.end.x,y:c};t.node()?.toggleHandles(!0),!(!t.validatePoint(u)||!t.validatePoint(y))&&(l.set({startHeight:p,endHeight:h}),t.recordAction("Create disjoint-channel annotation"),t.showAnnotationOptions(),t.update())},n=()=>t.delete();super("start",{start:{click:{target:"end",action:e},drag:{target:"end",action:e},reset:bo.parent},end:{hover:i,drag:i,keyDown:i,keyUp:i,click:{target:"height",action:o},dragEnd:{target:"height",action:o},reset:{target:bo.parent,action:n},cancel:{target:bo.parent,action:n}},height:{hover:s,click:{target:bo.parent,action:a},drag:{target:bo.parent,action:a},reset:{target:bo.parent,action:n},cancel:{target:bo.parent,action:n}}}),this.debug=Gk.Debug.create(!0,"annotations")}},My={type:"disjoint-channel",datum:De,scene:Qs,isDatum:De.is,translate:(t,e,i,o)=>{De.is(e)&&Qs.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(De.is(e)&&De.is(i)&&Qs.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{De.is(e)&&Qs.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new Wk({...t,create:e("disjoint-channel"),datum:i(De.is),node:o(Qs.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(De.is),node:i(Qs.is)})};import{_ModuleSupport as Kk,_Scene as Yk}from"ag-charts-community";import{_ModuleSupport as jk,_Scene as Ty}from"ag-charts-community";var{Vec2:qa}=jk,Xk=class extends Ty.Group{},hr=class extends Xk{constructor(){super(),this.type="arrow",this.path=new Ty.Path,this.armLength=6,this.append([this.path])}update(t){const{path:e}=this,{x:i,y:o,angle:s,...a}=t,n=qa.from(i,o),r=3*Math.PI/4,l=this.armLength+(t.strokeWidth??0)*2,c=qa.rotate(qa.from(0,l),s+r,n),h=qa.rotate(qa.from(l,0),s-r,n);e.setProperties(a),e.fillOpacity=0,e.path.clear(),e.path.moveTo(c.x,c.y),e.path.lineTo(n.x,n.y),e.path.lineTo(h.x,h.y)}},{Vec2:li,Vec4:Ay}=Kk,Ke=class extends dh{constructor(){super(),this.type="line",this.line=new ri,this.append([this.line,this.start,this.end])}static is(t){return me.isCheck(t,"line")}update(t,e){let i=Yo(t,e);if(i==null){this.visible=!1;return}i=Ay.round(i),this.visible=t.visible??!0,this.visible&&(this.updateLine(t,i,e),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateAnchor(t,i,e))}updateLine(t,e,i){const{line:o}=this,{lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r}=t,l=this.extendLine(e,t,i);o.setProperties({...l,lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:s,stroke:a,strokeWidth:n,strokeOpacity:r,fillOpacity:0})}updateText(t,e){Qa.updateLineText.call(this,this.line,t,e)}updateCaps(t,e){if(!t.startCap&&this.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),!t.endCap&&this.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),!t.startCap&&!t.endCap)return;const{stroke:i,strokeWidth:o,strokeOpacity:s}=t,[a,n]=li.from(e),r=li.angle(li.sub(n,a));t.startCap&&(this.startCap&&this.startCap.type!==t.startCap&&(this.removeChild(this.startCap),this.startCap=void 0),this.startCap==null&&(this.startCap=new hr,this.append([this.startCap])),this.startCap.update({x:a.x,y:a.y,angle:r-Math.PI,stroke:i,strokeWidth:o,strokeOpacity:s})),t.endCap&&(this.endCap&&this.endCap.type!==t.endCap&&(this.removeChild(this.endCap),this.endCap=void 0),this.endCap==null&&(this.endCap=new hr,this.append([this.endCap])),this.endCap.update({x:n.x,y:n.y,angle:r,stroke:i,strokeWidth:o,strokeOpacity:s}))}updateAnchor(t,e,i,o){const s=Ay.topCenter(e);li.apply(this.anchor,Yk.Transformable.toCanvasPoint(this.line,s.x,s.y))}containsPoint(t,e){const{line:i,text:o}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.line.isPointInPath(t,e)?"line":super.getNodeAtCoords(t,e)}getHandleCoords(t,e,i,o){const{startCap:s,endCap:a}=this;let[n,r]=li.from(e);const l=li.angle(li.sub(r,n));return s&&(n=li.rotate(li.from(0,-Ht.HANDLE_SIZE/2),l,n)),a&&(r=li.rotate(li.from(0,Ht.HANDLE_SIZE/2),l,r)),i==="start"?n:r}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}};import{_ModuleSupport as Zk,_Util as $k}from"ag-charts-community";var{StateMachine:qs}=Zk,Dy=class extends qs{constructor(t){const e=({point:n})=>{const r=this.createDatum(),l=n();r.set({start:l,end:l}),t.create(r),t.addPostUpdateFns(()=>t.node()?.toggleActive(!0),()=>t.node()?.toggleHandles({start:!0,end:!1}))},i=({point:n})=>{const r=t.datum();r?.set({end:n(r?.start,r?.snapToAngle)}),t.update()},o=()=>{t.node()?.toggleHandles({end:!0}),t.update()},s=()=>t.delete(),a=()=>{t.showAnnotationOptions(),t.recordAction(`Create ${t.datum()?.type} annotation`)};super("start",{start:{reset:qs.parent,click:{target:"end",action:e},drag:{target:"end",action:e}},end:{hover:i,keyDown:i,keyUp:i,click:{target:qs.parent,action:o},drag:i,dragEnd:{target:qs.parent,action:o},reset:{target:qs.parent,action:s},cancel:{target:qs.parent,action:s},onExit:a}}),this.debug=$k.Debug.create(!0,"annotations")}},Qk=class extends Dy{createDatum(){return new oi}},qk=class extends Dy{createDatum(){return new si}},ky={type:"line",datum:si,scene:Ke,isDatum:si.is,translate:(t,e,i,o)=>{si.is(e)&&Ke.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(si.is(e)&&si.is(i)&&Ke.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{si.is(e)&&Ke.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new qk({...t,create:e("line"),datum:i(si.is),node:o(Ke.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(si.is),node:i(Ke.is)})},Iy={type:"arrow",datum:oi,scene:Ke,isDatum:oi.is,translate:(t,e,i,o)=>{oi.is(e)&&Ke.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(oi.is(e)&&oi.is(i)&&Ke.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{oi.is(e)&&Ke.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new Qk({...t,create:e("arrow"),datum:i(oi.is),node:o(Ke.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(oi.is),node:i(Ke.is)})};import{_ModuleSupport as Jk,_Scene as Ny}from"ag-charts-community";import{_ModuleSupport as tI,_Scene as ci}from"ag-charts-community";import{_Scene as Oy}from"ag-charts-community";function Ly(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)Cy(a,o);o+=Oy.Group.computeChildrenBBox(s).width+i}else Cy(s,o),o+=s.getBBox().width+i}function eI(t,e=0,i=0){let o=e;for(const s of t)if(Array.isArray(s)){for(const a of s)Ey(a,o);o+=Oy.Group.computeChildrenBBox(s).height+i}else Ey(s,o),o+=s.getBBox().height+i}function Cy(t,e){"x1"in t?(t.x2=e+(t.x2-t.x1),t.x1=e):t.x=e}function Ey(t,e){"y1"in t?(t.y2=e+(t.y2-t.y1),t.y1=e):t.y=e}function _y(t,e){"x1"in t?(t.x1+=e,t.x2+=e):t.x+=e}function Ry(t,e){"y1"in t?(t.y1+=e,t.y2+=e):t.y+=e}var{Vec4:iI}=tI,wy=class extends ci.Group{constructor(){super(),this.name="MeasurerStatisticsScene",this.background=new ci.Rect,this.dateRangeBarsText=new ci.Text,this.dateRangeDivider=new ci.Line,this.dateRangeValueText=new ci.Text,this.priceRangeValueText=new ci.Text,this.priceRangeDivider=new ci.Line,this.priceRangePercentageText=new ci.Text,this.volumeText=new ci.Text,this.volumeFormatter=new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2}),this.append([this.background,this.dateRangeBarsText,this.dateRangeDivider,this.dateRangeValueText,this.priceRangeValueText,this.priceRangeDivider,this.priceRangePercentageText,this.volumeText])}update(t,e,i,o,s,a){this.verticalDirection=s;const n=this.updateStatistics(t,e,i,a),r=ci.Group.computeChildrenBBox(n.flat()),l=10;r.grow(l),this.updateBackground(t,r,l),this.reposition(n,l,o)}updateStatistics(t,e,i,o){const{dateRangeBarsText:s,dateRangeDivider:a,dateRangeValueText:n,priceRangeValueText:r,priceRangeDivider:l,priceRangePercentageText:c,volumeText:h}=this,p=8,u=6,y=t.statistics.fontSize+3,g=-2,f=this.getTextStyles(t),m={...this.getDividerStyles(t),x1:0,y1:0,x2:0,y2:y},v=[s,a,n],b=[r,l,c],S=[];return e.priceRange&&(r.setProperties({...f,text:this.formatPriceRangeValue(e.priceRange.value,o)}),l.setProperties(m),c.setProperties({...f,text:this.formatPriceRangePercentage(e.priceRange.percentage,o)}),Ly(b,i.x,p),S.push(b)),e.dateRange&&(s.setProperties({...f,text:this.formatDateRangeBars(e.dateRange.bars,o)}),a.setProperties(m),n.setProperties({...f,text:this.formatDateRangeValue(e.dateRange.value)}),Ly(v,i.x,p),S.push(v)),e.volume!=null&&(h.setProperties({...f,x:i.x,text:this.formatVolume(e.volume,o)}),S.push(h)),eI(S,i.y,u),l.y1+=g,l.y2+=g,a.y1+=g,a.y2+=g,S}updateBackground(t,e,i){const o=this.getBackgroundStyles(t);this.background.setProperties({...o,...e,x:e.x-e.width/2+i,y:e.y})}reposition(t,e,i){const{width:o,height:s}=i.seriesRect,a=iI.from(this.background.getBBox());let n=0;a.x1<0&&(n=-a.x1),a.x2>o&&(n=o-a.x2);const r=Math.min(e,s-a.y2);for(const l of t)if(Array.isArray(l)){const c=ci.Group.computeChildrenBBox(l).width;for(const h of l)_y(h,n-c/2),Ry(h,r)}else _y(l,n-l.getBBox().width/2),Ry(l,r);this.background.x+=n,this.background.y+=r}getTextStyles(t){return{fill:t.statistics.color,fontFamily:t.statistics.fontFamily,fontSize:t.statistics.fontSize,fontStyle:t.statistics.fontStyle,fontWeight:t.statistics.fontWeight,textBaseline:"top"}}getDividerStyles(t){return{stroke:t.statistics.divider.stroke,strokeOpacity:t.statistics.divider.strokeOpacity,strokeWidth:t.statistics.divider.strokeWidth}}getBackgroundStyles(t){return{fill:t.statistics.fill,stroke:t.statistics.stroke,strokeOpacity:t.statistics.strokeOpacity,strokeWidth:t.statistics.strokeWidth,cornerRadius:4}}formatDateRangeBars(t,e){return e?.t("measurerDateRangeBars",{value:t})??`${t}`}formatDateRangeValue(t){const e=[],i=t>=0?"":"-";t=Math.abs(t);const o=1e3*60,s=o*60,a=s*24,n=Math.floor(t/o),r=Math.floor(t/s),l=Math.floor(t/a),c=r%(a/s),h=n%(s/o);return l>=1&&e.push(`${l}d`),r>=1&&(t<a||c!==0)&&e.push(`${c}h`),(t<s||h!==0)&&e.push(`${h}m`),e[0]=`${i}${e[0]}`,e.join(" ")}formatPriceRangeValue(t,e){return e?.t("measurerPriceRangeValue",{value:Number(t.toFixed(2))})??`${t}`}formatPriceRangePercentage(t,e){return e?.t("measurerPriceRangePercent",{value:t})??`${t}`}formatVolume(t,e){const i=isNaN(t)?"":this.volumeFormatter.format(t);return e?.t("measurerVolume",{value:i})??i}},oI=class extends wy{getDirectionStyles(t){return this.verticalDirection==="down"?t.down.statistics:t.up.statistics}getTextStyles(t){const e=this.getDirectionStyles(t);return{...super.getTextStyles(t),fill:e.color,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight}}getDividerStyles(t){const e=this.getDirectionStyles(t);return{stroke:e.divider.stroke,strokeOpacity:e.divider.strokeOpacity,strokeWidth:e.divider.strokeWidth}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{...super.getBackgroundStyles(t),fill:e.fill,stroke:e.stroke,strokeOpacity:e.strokeOpacity,strokeWidth:e.strokeWidth}}},{Vec2:Ii,Vec4:$o}=Jk,Bt=class extends dh{constructor(){super(),this.type="measurer",this.horizontalLine=new ri,this.verticalLine=new ri,this.horizontalStartLine=new ri,this.horizontalEndLine=new ri,this.verticalStartLine=new ri,this.verticalEndLine=new ri,this.horizontalEndCap=new hr,this.verticalEndCap=new hr,this.background=new Ny.Path({zIndex:-1}),this.updateBackground=by.updateBackground.bind(this),this.statistics=this.createStatisticsScene(),this.statistics.zIndex=1,this.append([this.background,this.verticalStartLine,this.verticalEndLine,this.horizontalStartLine,this.horizontalEndLine,this.horizontalLine,this.verticalLine,this.horizontalEndCap,this.verticalEndCap,this.start,this.end,this.statistics])}static is(t){return me.isCheck(t,"measurer")}createStatisticsScene(){return new wy}update(t,e){const i=Yo(t,e);if(i==null){this.visible=!1;return}if(this.visible=t.visible??!0,!this.visible)return;const o=this.extendPerpendicular(i,t,e),s={...o,y2:o.y1},a={...o,y1:o.y2};this.verticalDirection=i.y1<i.y2?"down":"up",this.updateVisibilities(t),this.updateLines(t,i),this.updateHandles(t,i),this.updateText(t,i),this.updateCaps(t,i),this.updateBoundingLines(t,o),this.updateBackground(t,s,a,e),this.updateStatistics(t,i,e),this.updateAnchor(t,i,e)}extendPerpendicular(t,e,i){const o={x1:Math.min(t.x1,t.x2),x2:Math.max(t.x1,t.x2),y1:Math.min(t.y1,t.y2),y2:Math.max(t.y1,t.y2)},[s,a]=Ii.from(i.yAxis.bounds);return Te.is(e)?(e.extendAbove&&(o.y1=s.y),e.extendBelow&&(o.y2=a.y)):Ae.is(e)&&(e.extendLeft&&(o.x1=s.x),e.extendRight&&(o.x2=a.x)),o}updateVisibilities(t){const{horizontalStartLine:e,horizontalEndLine:i,horizontalEndCap:o,verticalStartLine:s,verticalEndLine:a,verticalEndCap:n}=this,{direction:r}=t;s.visible=r!=="vertical",a.visible=r!=="vertical",o.visible=r!=="vertical",e.visible=r!=="horizontal",i.visible=r!=="horizontal",n.visible=r!=="horizontal"}updateLines(t,e){const{horizontalLine:i,verticalLine:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=Ii.round($o.center(e)),h=this.getLineStyles(t);s!=="vertical"&&i.setProperties({...h,x1:a,x2:r,y1:c.y,y2:c.y}),s!=="horizontal"&&o.setProperties({...h,x1:c.x,x2:c.x,y1:n,y2:l})}updateText(t,e){const{direction:i}=t,o=Ii.round($o.center(e));let s;const a={...e};i==="vertical"?(s=this.verticalLine,a.x1=o.x,a.x2=o.x):(s=this.horizontalLine,a.y1=o.y,a.y2=o.y);const n=Qa.updateLineText.call(this,s,t,a);let r;if(i==="both"&&n&&this.text){const l=$o.from(this.text.getBBox()),{offset:c}=n.numbers;l.x1<=o.x+c.x&&l.x2>=o.x-c.x&&(r={x:o.x,y:n.clipMask.y,radius:this.text.getBBox().height/2+Ii.length(c)})}this.verticalLine.setClipMask(r)}updateCaps(t,e){const{horizontalEndCap:i,verticalEndCap:o}=this,{direction:s}=t,{x1:a,y1:n,x2:r,y2:l}=e,c=Ii.round($o.center(e)),{stroke:h,strokeWidth:p,strokeOpacity:u}=this.getLineStyles(t),y={stroke:h,strokeWidth:p,strokeOpacity:u};if(s!=="vertical"){const g=a<=r?0:Math.PI;let f=r;s==="horizontal"&&(f+=a<=r?-2:2),i.update({...y,x:f,y:c.y,angle:g})}if(s!=="horizontal"){const g=n<=l?Math.PI/2:Math.PI/-2;let f=l;s==="vertical"&&(f+=n<=l?-2:2),o.update({...y,x:c.x,y:f,angle:g})}}updateBoundingLines(t,e){const{verticalStartLine:i,verticalEndLine:o,horizontalStartLine:s,horizontalEndLine:a}=this,{direction:n}=t,{x1:r,y1:l,x2:c,y2:h}=e,p=this.getLineStyles(t);n==="horizontal"&&(i.setProperties({...p,x1:r,y1:l,x2:r,y2:h}),o.setProperties({...p,x1:c,y1:l,x2:c,y2:h})),n==="vertical"&&(s.setProperties({...p,x1:r,y1:l,x2:c,y2:l}),a.setProperties({...p,x1:r,y1:h,x2:c,y2:h}))}updateStatistics(t,e,i){const o=Ii.add($o.bottomCenter(e),Ii.from(0,10)),s={volume:this.getVolume(t)};t.hasPriceRange&&(s.priceRange={percentage:this.getPriceRangePercentage(t),value:this.getPriceRangeValue(t)}),t.hasDateRange&&(s.dateRange={bars:this.getDateRangeBars(e,i),value:this.getDateRangeValue(t)}),this.statistics.update(t,s,o,i,this.verticalDirection,t.localeManager)}updateAnchor(t,e,i,o){const s=$o.topCenter(e);Ii.apply(this.anchor,Ny.Transformable.toCanvasPoint(this.horizontalLine,s.x,s.y))}getBackgroundPoints(t,e,i,o){const[s,a]=Ii.from(e),[n,r]=Ii.from(i);return[s,a,r,n]}getLineStyles(t){const{lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s}=t;return{lineCap:t.getLineCap(),lineDash:t.getLineDash(),lineDashOffset:e,stroke:i,strokeWidth:o,strokeOpacity:s,fillOpacity:0}}getBackgroundStyles(t){const{background:e}=t;return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth}}containsPoint(t,e){const{horizontalLine:i,text:o,verticalLine:s,horizontalStartLine:a,horizontalEndLine:n,verticalStartLine:r,verticalEndLine:l}=this;return super.containsPoint(t,e)||i.isPointInPath(t,e)||s.isPointInPath(t,e)||a.visible&&a.isPointInPath(t,e)||n.visible&&n.isPointInPath(t,e)||r.visible&&r.isPointInPath(t,e)||l.visible&&l.isPointInPath(t,e)||!!o?.containsPoint(t,e)}getNodeAtCoords(t,e){return this.text?.containsPoint(t,e)?"text":this.start.containsPoint(t,e)||this.end.containsPoint(t,e)?"handle":"line"}getDateRangeBars(t,e){const i=t.x1<=t.x2?1:-1;return Math.round($o.width(t)/e.xAxis.scaleStep())*i}getDateRangeValue(t){if(t.start.x==null||t.end.x==null||!(t.start.x instanceof Date)||!(t.end.x instanceof Date))throw new Error("Can not create a date range measurement of non-date x-axis.");return t.end.x.getTime()-t.start.x.getTime()}getPriceRangePercentage(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");return(t.end.y-t.start.y)/t.start.y}getPriceRangeValue(t){if(t.start.y==null||t.end.y==null)throw new Error("Can not create a price range measurement of a non-numeric y-axis");return t.end.y-t.start.y}getVolume(t){return t.getVolume?.(t.start.x,t.end.x)}},Js=class extends Bt{constructor(){super(...arguments),this.type="quick-measurer"}static is(t){return me.isCheck(t,"quick-measurer")}createStatisticsScene(){return new oI}getDirectionStyles(t){return this.verticalDirection==="down"?t.down:t.up}getLineStyles(t){const e=this.getDirectionStyles(t);return{...super.getLineStyles(t),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity}}getBackgroundStyles(t){const e=this.getDirectionStyles(t);return{fill:e.fill,fillOpacity:e.fillOpacity}}getHandleStyles(t){const e=this.getDirectionStyles(t);return{fill:e.handle.fill,stroke:e.handle.stroke??e.stroke,strokeOpacity:e.handle.strokeOpacity??e.strokeOpacity,strokeWidth:e.handle.strokeWidth??e.strokeWidth}}};import{_ModuleSupport as sI,_Util as aI}from"ag-charts-community";var{StateMachine:ta}=sI,dr=class extends ta{constructor(t){const e=({point:n})=>{const r=this.createDatum(),l=n();r.set({start:l,end:l}),t.create(r)},i=({point:n})=>{t.datum()?.set({end:n()}),t.node()?.toggleActive(!0),t.node()?.toggleHandles({end:!1}),t.update()},o=()=>{t.node()?.toggleHandles({end:!0})},s=()=>t.delete(),a=()=>{t.showAnnotationOptions(),!fo(t.datum())&&t.recordAction(`Create ${t.node()?.type} annotation`)};super("start",{start:{reset:ta.parent,click:{target:"end",action:e},drag:{target:"end",action:e}},end:{hover:i,click:{target:ta.parent,action:o},dragEnd:{target:ta.parent,action:o},drag:i,reset:{target:ta.parent,action:s},cancel:{target:ta.parent,action:s},onExit:a}}),this.debug=aI.Debug.create(!0,"annotations")}},nI=class extends dr{createDatum(){return new Te}},rI=class extends dr{createDatum(){return new Ae}},lI=class extends dr{createDatum(){return new ei}},cI=class extends dr{createDatum(){return new fe}},Py={type:"date-range",datum:Te,scene:Bt,isDatum:Te.is,translate:(t,e,i,o)=>{Te.is(e)&&Bt.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Te.is(e)&&Te.is(i)&&Bt.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Te.is(e)&&Bt.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new nI({...t,create:e("date-range"),datum:i(Te.is),node:o(Bt.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(Te.is),node:i(Bt.is)})},By={type:"price-range",datum:Ae,scene:Bt,isDatum:Ae.is,translate:(t,e,i,o)=>{Ae.is(e)&&Bt.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(Ae.is(e)&&Ae.is(i)&&Bt.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{Ae.is(e)&&Bt.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new rI({...t,create:e("date-range"),datum:i(Ae.is),node:o(Bt.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(Ae.is),node:i(Bt.is)})},zy={type:"date-price-range",datum:ei,scene:Bt,isDatum:ei.is,translate:(t,e,i,o)=>{ei.is(e)&&Bt.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(ei.is(e)&&ei.is(i)&&Bt.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{ei.is(e)&&Bt.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new lI({...t,create:e("date-range"),datum:i(ei.is),node:o(Bt.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(ei.is),node:i(Bt.is)})},Fy={type:"quick-date-price-range",datum:fe,scene:Js,isDatum:fe.is,translate:(t,e,i,o)=>{fe.is(e)&&Js.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(fe.is(e)&&fe.is(i)&&Js.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{fe.is(e)&&Js.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new cI({...t,create:e("quick-date-price-range"),datum:i(fe.is),node:o(Js.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(fe.is),node:i(Js.is)})};import{_ModuleSupport as hI,_Scene as pr,_Util as dI}from"ag-charts-community";var{ZIndexMap:Vy,TextWrapper:pI}=hI,{clamp:uI}=dI,ea=class extends gh{constructor(){super(),this.type="note",this.shape=new pr.Rect,this.iconBackground=new pr.SvgPath("M22 1.83333C22 0.820811 21.1792 0 20.1667 0H1.83333C0.820811 0 0 0.82081 0 1.83333V13.9868C0 14.9994 0.820811 15.8202 1.83333 15.8202L5.88971 15.8202C6.44575 15.8202 6.97175 16.0725 7.31971 16.5062L9.57006 19.3112C10.304 20.2259 11.6962 20.2259 12.4301 19.3112L14.6804 16.5062C15.0284 16.0725 15.5544 15.8202 16.1104 15.8202L20.1667 15.8202C21.1792 15.8202 22 14.9994 22 13.9868V1.83333Z"),this.iconLines=new pr.SvgPath("M17.1114 5.75C17.1114 6.16421 16.7756 6.5 16.3614 6.5H5.63916C5.22495 6.5 4.88916 6.16421 4.88916 5.75V5.75C4.88916 5.33579 5.22495 5 5.63916 5H16.3614C16.7756 5 17.1114 5.33579 17.1114 5.75V5.75ZM17.1114 9.25C17.1114 9.66421 16.7756 10 16.3614 10H5.63916C5.22495 10 4.88916 9.66421 4.88916 9.25V9.25C4.88916 8.83579 5.22495 8.5 5.63916 8.5H16.3614C16.7756 8.5 17.1114 8.83579 17.1114 9.25V9.25Z"),this.active=!1,this.shape.visible=!1,this.label.visible=!1,this.iconBackground.fillShadow=new pr.DropShadow,this.append([this.shape,this.label,this.iconBackground,this.iconLines,this.handle])}static is(t){return me.isCheck(t,"note")}update(t,e){this.updateIcon(t,e),super.update(t,e)}getTextBBox(t,e,i){const o=super.getTextBBox(t,e,i),{seriesRect:s}=i;o.x-=t.width/2,o.x=uI(0,o.x,s.width-t.width);const a=t.getPadding().top,n=o.y-Pg-a*2,r=o.y+Ht.HANDLE_SIZE+a*2;return n-o.height-Bg<s.y?(o.y=r,t.position="top"):(o.y=n+a,t.position="bottom"),o}updateLabel(t,e){const i=t.visible===!1?!1:this.label.visible;super.updateLabel(t,e),this.label.visible=i,this.label.text=pI.wrapText(t.text,{font:{fontFamily:t.fontFamily,fontSize:t.fontSize,fontStyle:t.fontStyle,fontWeight:t.fontWeight},avoidOrphans:!1,textAlign:t.textAlign,textBaseline:"hanging",textWrap:"always",maxWidth:200})}updateShape(t,e){const{shape:i}=this;i.fill=t.background.fill,i.fillOpacity=t.background.fillOpacity??1,i.stroke=t.background.stroke,i.strokeOpacity=t.background.strokeOpacity??1,i.strokeWidth=t.background.strokeWidth??1,i.cornerRadius=4;const o=t.getPadding().top,s=t.position==="top";i.x=e.x-o,i.width=t.width+o*2,i.height=e.height+o*2,i.y=e.y+(s?0:-e.height)-o}updateIcon(t,e){const{active:i,iconBackground:o,iconLines:s}=this,{x:a,y:n}=xt(t,e);o.x=a-yD/2,o.y=n-wg,s.x=o.x,s.y=o.y,o.fill=t.fill,o.fillOpacity=t.fillOpacity??1,o.stroke=t.stroke,o.strokeOpacity=t.strokeOpacity??1,o.strokeWidth=t.strokeWidth??1,s.fill=t.stroke,i?o.fillShadow.color=t.fill??"rgba(0, 0, 0, 0.22)":o.fillShadow.color="rgba(0, 0, 0, 0.22)"}updateAnchor(t,e,i){const o=t.getPadding().top,s=t.position==="top",a=s?1:-1;return{x:e.x+i.seriesRect.x+t.width/2,y:e.y+i.seriesRect.y+a*(e.height+o),position:s?"below":"above"}}getHandleCoords(t,e,i){return{x:e.x,y:e.y+Ht.HANDLE_SIZE/2+4}}getHandleStyles(t){return{fill:t.handle.fill,stroke:t.handle.stroke??t.fill,strokeOpacity:t.handle.strokeOpacity,strokeWidth:t.handle.strokeWidth}}toggleHovered(t){super.toggleHovered(t),this.label.visible=t,this.shape.visible=t,this.zIndex=t?Vy.CHART_ANNOTATION_FOCUSED:Vy.CHART_ANNOTATION}toggleActive(t){super.toggleActive(t),this.label.visible=t,this.shape.visible=t,this.active=t}containsPoint(t,e){return this.shape.visible&&this.shape.containsPoint(t,e)||this.iconBackground.containsPoint(t,e)?!0:super.containsPoint(t,e)}},gI=class extends fh{createDatum(){return new oe}},Uy={type:"note",datum:oe,scene:ea,isDatum:oe.is,translate:(t,e,i,o)=>{oe.is(e)&&ea.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(oe.is(e)&&oe.is(i)&&ea.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{oe.is(e)&&ea.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new gI({...t,create:e("note"),datum:i(oe.is),node:o(ea.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(oe.is),node:i(ea.is)})};import{_ModuleSupport as yI}from"ag-charts-community";var{Vec2:Ie,Vec4:ia}=yI,oa=class extends vy{constructor(){super(),this.type="parallel-channel",this.handles={topLeft:new Ht,topMiddle:new Ks,topRight:new Ht,bottomLeft:new Ht,bottomMiddle:new Ks,bottomRight:new Ht},this.middleLine=new ri,this.updateText=Qa.updateChannelText.bind(this,!0),this.append([this.background,this.topLine,this.middleLine,this.bottomLine,...Object.values(this.handles)])}static is(t){return me.isCheck(t,"parallel-channel")}dragHandle(t,e,i,o){const{activeHandle:s,handles:a}=this;if(s==null)return;const{offset:n}=a[s].drag(e);a[s].toggleDragging(!0);const r=t.toJson();let l=[],c=[];switch(s){case"topLeft":case"bottomLeft":l=["topLeft","bottomLeft"],c=["topRight","bottomRight"];break;case"topMiddle":l=["topLeft","topRight"],n.y-=Ks.HANDLE_SIZE/2;break;case"topRight":case"bottomRight":l=["topRight","bottomRight"],c=["topLeft","bottomLeft"];break;case"bottomMiddle":l=["bottomLeft","bottomRight"],n.y-=Ks.HANDLE_SIZE/2;break}const h=t.snapToAngle,p=l.map((u,y)=>o&&c[y]?this.snapToAngle(e,i,u,c[y],h):Pt(Ie.add(a[u].handle,n),i)).filter(AD);if(!p.some(u=>!Wi(i,u))){if((s==="topMiddle"||s==="bottomMiddle")&&t.start.y!=null){const u=Pt(Ie.add(a.topLeft.handle,n),i);Wi(i,u)&&(s==="topMiddle"?t.height+=u.y-t.start.y:t.height-=u.y-t.start.y)}for(const[u,y]of p.entries())switch(l[u]){case"topLeft":t.start.x=y.x,t.start.y=y.y;break;case"topRight":t.end.x=y.x,t.end.y=y.y;break}t.isValidWithContext(i)||t.set(r)}}getOtherCoords(t,e,i,o){const s=xt(t.bottom.start,o).y-xt(t.start,o).y,a=Ie.add(e,Ie.from(0,s)),n=Ie.add(i,Ie.from(0,s));return[a,n]}containsPoint(t,e){return super.containsPoint(t,e)||this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)}getNodeAtCoords(t,e){return this.middleLine.visible&&this.middleLine.strokeWidth>0&&this.middleLine.containsPoint(t,e)?"line":super.getNodeAtCoords(t,e)}updateLines(t,e,i,o,s,a){const{topLine:n,middleLine:r,bottomLine:l}=this,{lineDashOffset:c,stroke:h,strokeOpacity:p,strokeWidth:u}=t,y=t.getLineDash(),g={lineCap:t.getLineCap(),lineDash:y,lineDashOffset:c,stroke:h,strokeOpacity:p,strokeWidth:u};n.setProperties({...e,...g}),l.setProperties({...i,...g});const f=this.extendLine({x1:s.x1,y1:a.y1+(s.y1-a.y1)/2,x2:s.x2,y2:a.y2+(s.y2-a.y2)/2},t,o);r.setProperties({...f,lineDash:t.middle.lineDash??y,lineDashOffset:t.middle.lineDashOffset??c,stroke:t.middle.stroke??h,strokeOpacity:t.middle.strokeOpacity??p,strokeWidth:t.middle.strokeWidth??u,visible:t.middle.visible??!0})}updateHandles(t,e,i){const{handles:{topLeft:o,topMiddle:s,topRight:a,bottomLeft:n,bottomMiddle:r,bottomRight:l}}=this,c={fill:t.handle.fill,stroke:t.handle.stroke??t.stroke,strokeOpacity:t.handle.strokeOpacity??t.strokeOpacity,strokeWidth:t.handle.strokeWidth??t.strokeWidth};o.update({...c,...ia.start(e)}),a.update({...c,...ia.end(e)}),n.update({...c,...ia.start(i)}),l.update({...c,...ia.end(i)}),s.update({...c,...Ie.sub(ia.center(e),Ie.from(s.handle.width/2,s.handle.height/2))}),r.update({...c,...Ie.sub(ia.center(i),Ie.from(r.handle.width/2,r.handle.height/2))})}getBackgroundPoints(t,e,i,o){const s=e.x1>e.x2,a=e.y1>e.y2,n=e.x1!==i.x1&&e.y1!==i.y1,r=e.x2!==i.x2&&e.y2!==i.y2,l=Ie.from(e);return t.extendEnd&&r&&l.push(Ie.from(s?o.x1:o.x2,a?o.y1:o.y2)),l.push(...Ie.from(i).reverse()),t.extendStart&&n&&l.push(Ie.from(s?o.x2:o.x1,a?o.y2:o.y1)),l}};import{_ModuleSupport as fI,_Util as mI}from"ag-charts-community";var{StateMachine:vo}=fI,xI=class extends vo{constructor(t){const e=({point:r})=>{const l=new ke,c=r();l.set({start:c,end:c,height:0}),t.create(l),t.addPostUpdateFns(()=>t.node()?.toggleActive(!0),()=>t.node()?.toggleHandles({topLeft:!0,topMiddle:!1,topRight:!1,bottomLeft:!1,bottomMiddle:!1,bottomRight:!1}))},i=({point:r})=>{const l=t.datum();l?.set({end:r(l?.start,l?.snapToAngle),height:0}),t.update()},o=()=>{t.node()?.toggleHandles({topRight:!0}),t.update()},s=({point:r})=>{const l=t.datum();if(l?.start.y==null||l?.end.y==null)return;const c=r().y,h=l.end.y-(c??0),p=l.start.y-h;t.node()?.toggleHandles({bottomLeft:!0,bottomRight:!0}),!(!t.validatePoint({x:l.start.x,y:p})||!t.validatePoint({x:l.end.x,y:c}))&&(l.set({height:h}),t.update())},a=({point:r})=>{const l=t.datum();if(l?.start.y==null||l?.end.y==null)return;const c=r().y,h=l.end.y-(c??0),p=l.start.y-h;t.node()?.toggleHandles(!0),!(!t.validatePoint({x:l.start.x,y:p})||!t.validatePoint({x:l.end.x,y:c}))&&(l.set({height:h}),t.recordAction("Create parallel-channel annotation"),t.showAnnotationOptions(),t.update())},n=()=>t.delete();super("start",{start:{click:{target:"end",action:e},drag:{target:"end",action:e},reset:vo.parent},end:{hover:i,drag:i,keyDown:i,keyUp:i,click:{target:"height",action:o},dragEnd:{target:"height",action:o},reset:{target:vo.parent,action:n},cancel:{target:vo.parent,action:n}},height:{hover:s,click:{target:vo.parent,action:a},drag:{target:vo.parent,action:a},reset:{target:vo.parent,action:n},cancel:{target:vo.parent,action:n}}}),this.debug=mI.Debug.create(!0,"annotations")}},Hy={type:"parallel-channel",datum:ke,scene:oa,isDatum:ke.is,translate:(t,e,i,o)=>{ke.is(e)&&oa.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(ke.is(e)&&ke.is(i)&&oa.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{ke.is(e)&&oa.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new xI({...t,create:e("parallel-channel"),datum:i(ke.is),node:o(oa.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(ke.is),node:i(oa.is)})},sa=class extends gh{constructor(){super(),this.type="text",this.append([this.label,this.handle])}static is(t){return me.isCheck(t,"text")}getHandleCoords(t,e){const i=Ht.HANDLE_SIZE/2;return{x:e.x+i,y:e.y+2+i}}},SI=class extends fh{createDatum(){return new ai}},Gy={type:"text",datum:ai,scene:sa,isDatum:ai.is,translate:(t,e,i,o)=>{ai.is(e)&&sa.is(t)&&t.translate(e,i,o)},copy:(t,e,i,o)=>{if(ai.is(e)&&ai.is(i)&&sa.is(t))return t.copy(e,i,o)},update:(t,e,i)=>{ai.is(e)&&sa.is(t)&&t.update(e,i)},createState:(t,{createDatum:e,getDatum:i,getNode:o})=>new SI({...t,create:e("text"),datum:i(ai.is),node:o(sa.is)}),dragState:(t,{getDatum:e,getNode:i})=>new se({...t,datum:e(ai.is),node:i(sa.is)})},we={[ky.type]:ky,[my.type]:my,[xy.type]:xy,[Hy.type]:Hy,[My.type]:My,[cy.type]:cy,[py.type]:py,[Uy.type]:Uy,[Gy.type]:Gy,[Iy.type]:Iy,[iy.type]:iy,[ey.type]:ey,[Py.type]:Py,[By.type]:By,[zy.type]:zy,[Fy.type]:Fy};function Zi(t){for(const{isDatum:e}of Object.values(we))if(e(t))return t}var bI=[{label:"toolbarAnnotationsTrendLine",icon:"trend-line-drawing",value:"line"},{label:"toolbarAnnotationsHorizontalLine",icon:"horizontal-line-drawing",value:"horizontal-line"},{label:"toolbarAnnotationsVerticalLine",icon:"vertical-line-drawing",value:"vertical-line"},{label:"toolbarAnnotationsParallelChannel",icon:"parallel-channel-drawing",value:"parallel-channel"},{label:"toolbarAnnotationsDisjointChannel",icon:"disjoint-channel-drawing",value:"disjoint-channel"}],vI=[{label:"toolbarAnnotationsText",icon:"text-annotation",value:"text"},{label:"toolbarAnnotationsComment",icon:"comment-annotation",value:"comment"},{label:"toolbarAnnotationsCallout",icon:"callout-annotation",value:"callout"},{label:"toolbarAnnotationsNote",icon:"note-annotation",value:"note"}],MI=[{label:"toolbarAnnotationsArrow",icon:"arrow-drawing",value:"arrow"},{label:"toolbarAnnotationsArrowUp",icon:"arrow-up-drawing",value:"arrow-up"},{label:"toolbarAnnotationsArrowDown",icon:"arrow-down-drawing",value:"arrow-down"}],TI=[{label:"toolbarAnnotationsQuickDatePriceRange",icon:"measurer-drawing",value:"quick-date-price-range"},{label:"toolbarAnnotationsDateRange",icon:"date-range-drawing",value:"date-range"},{label:"toolbarAnnotationsPriceRange",icon:"price-range-drawing",value:"price-range"},{label:"toolbarAnnotationsDatePriceRange",icon:"date-price-range-drawing",value:"date-price-range"}],Wy=[{strokeWidth:1,label:"1",value:1},{strokeWidth:2,label:"2",value:2},{strokeWidth:3,label:"3",value:3},{strokeWidth:4,label:"4",value:4},{strokeWidth:8,label:"8",value:8}],Ja=[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],Ky=[{label:"10",value:10},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"22",value:22},{label:"28",value:28},{label:"36",value:36},{label:"46",value:46}];import{_ModuleSupport as AI,_Util as DI}from"ag-charts-community";var{StateMachine:kI}=AI,II=class extends kI{constructor(t){const e=M=>()=>{if(this.active==null)return;const T=t.datum(this.active);if(M(T))return T},i=M=>()=>{if(this.active==null)return;const T=t.node(this.active);if(M(T))return T},o=M=>T=>{t.create(M,T),this.active=t.selectLast()},s=()=>{this.active!=null&&t.delete(this.active),this.active=void 0,t.select()},a={createDatum:o,getDatum:e,getNode:i},n={...t,delete:s,showTextInput:()=>{this.active!=null&&t.showTextInput(this.active)},deselect:()=>{const M=this.active;this.active=void 0,this.hovered=void 0,t.select(this.active,M)},showAnnotationOptions:()=>{this.active!=null&&t.showAnnotationOptions(this.active)}},r=Object.fromEntries(Object.entries(we).map(([M,T])=>[M,T.createState(n,a)])),l={...t,setSnapping:M=>{this.snapping=M},getSnapping:()=>this.snapping,getHoverCoords:()=>t.getHoverCoords()},c=Object.fromEntries(Object.entries(we).map(([M,T])=>[M,T.dragState(l,a)])),h=({colorPickerType:M,colorOpacity:T,color:A,opacity:D})=>{const I=t.datum(this.active);I&&(M==="text-color"&&t.updateTextInputColor(A),ar(I,M,T,A,D),t.update())},p=M=>{const T=t.datum(this.active),A=t.node(this.active);!T||!A||(Di(T)?(T.fontSize=M,t.updateTextInputFontSize(M)):Ws(T)&&(T.text.fontSize=M),t.update())},u=M=>{const T=t.datum(this.active),A=t.node(this.active);!T||!A||!mo(T)||(Xg(T,M),t.update())},y=M=>{const T=t.node(this.active);!T||!("setTextInputBBox"in T)||(T.setTextInputBBox(M),t.update())},g=({textInputValue:M,bbox:T})=>{const A=t.datum(this.active);if(M!=null&&M.length>0){if(!Di(A))return;const D=tr(A,M,T.width);A.set({text:D}),t.update(),t.recordAction(`Change ${A.type} annotation text`)}else t.delete(this.active),t.recordAction(`Delete ${A?.type} annotation`)},f=()=>{t.updateTextInputBBox(void 0)},m=()=>this.active!=null,v=()=>this.copied!=null,b=()=>{if(this.active==null)return!1;const M=t.datum(this.active);return M?Ws(M)&&!M.locked:!1},S=()=>this.active!=null&&!fo(t.datum(this.active)),x=()=>this.hovered!=null;super("idle",{idle:{onEnter:()=>{t.select(this.active,this.active);const M=t.getHoverCoords();M&&(this.hovered=t.hoverAtCoords(M,this.active))},hover:({offset:M})=>{this.hovered=t.hoverAtCoords(M,this.active)},keyDown:({shiftKey:M})=>{this.snapping=M},keyUp:({shiftKey:M})=>{this.snapping=M},translate:{guard:m,action:({translation:M})=>{t.startInteracting(),t.translate(this.active,M),t.update()}},translateEnd:{guard:m,action:()=>{t.stopInteracting()}},copy:{guard:S,action:()=>{this.copied=t.copy(this.active)}},cut:{guard:S,action:()=>{this.copied=t.copy(this.active),s()}},paste:{guard:v,action:()=>{t.paste(this.copied)}},selectLast:()=>{const M=this.active;this.active=t.selectLast(),t.select(this.active,M)},click:[{guard:()=>{if(this.active==null||this.hovered!==this.active)return!1;const M=t.datum(this.active);return M?Di(M)&&!M.locked:!1},target:"text-input"},{action:()=>{const M=this.active;this.active=this.hovered,t.select(this.hovered,M)}}],dblclick:{guard:b,action:({offset:M})=>{const T=t.getNodeAtCoords(M,this.active)==="text"?"text":"line";t.showAnnotationSettings(this.active,void 0,T)}},dragStart:[{guard:x,target:"dragging",action:()=>{const M=this.active;this.active=this.hovered,t.select(this.hovered,M),t.startInteracting()}},{action:()=>{const M=this.active;this.active=this.hovered,t.select(this.hovered,M)}}],color:{guard:m,action:h},fontSize:{guard:m,action:p},lineProps:{guard:m,action:M=>{const T=Zi(t.datum(this.active));T?.set(M),t.update(),t.recordAction(`Change ${T?.type} ${Object.entries(M).map(([A,D])=>`${A} to ${D}`).join(", ")}`)}},lineStyle:{guard:m,action:u},lineText:{guard:m,action:M=>{const T=Zi(t.datum(this.active));Ws(T)&&(Ki(T)&&M.position==="center"&&(M.position="inside"),T.text.set(M),t.update())}},updateTextInputBBox:{guard:m,action:y},toolbarPressSettings:{guard:b,action:M=>{t.showAnnotationSettings(this.active,M)}},reset:()=>{this.active!=null&&t.node(this.active)?.toggleActive(!1),this.hovered=void 0,this.active=void 0,t.select(this.active,this.active),t.resetToIdle()},delete:()=>{if(this.active==null)return;t.delete(this.active);const M=t.datum(this.active);fo(M)||t.recordAction(`Delete ${M?.type} annotation`)},deleteAll:()=>{t.deleteAll()},...r},dragging:{onEnter:(M,T)=>{if(this.active==null)return;const A=t.getAnnotationType(this.active);A&&(this.transition(A),this.transition("dragStart",T))},...c},"text-input":{onEnter:()=>{if(this.active==null)return;const M=Zi(t.datum(this.active));!M||!("getTextInputCoords"in M)||(t.startInteracting(),t.showTextInput(this.active),M.visible=!1,t.update())},updateTextInputBBox:{guard:m,action:y},zoomChange:{target:"idle",action:g},click:{target:"idle",action:g},drag:{target:"idle",action:g},keyDown:[{guard:ph,target:"idle",action:f},{guard:uh,target:"idle",action:g}],color:{guard:m,action:h},fontSize:{guard:m,action:p},cancel:{target:"idle",action:f},onExit:()=>{t.stopInteracting(),t.hideTextInput();const M=this.active;if(this.active=this.hovered=void 0,t.select(this.active,M),M==null)return;const T=t.datum(M),A=t.node(M);!T||!A||(T.visible=!0)}}}),this.debug=DI.Debug.create(!0,"annotations"),this.snapping=!1}getActive(){return this.active}isActive(t){return t===this.active}};import{_ModuleSupport as Yy}from"ag-charts-community";var{BaseModuleInstance:NI,InteractionState:tn,Validate:OI,BOOLEAN:LI,createElement:CI,REGIONS:EI,ChartAxisDirection:_I}=Yy,Qo="ag-charts-annotations__axis-button",jy=class extends NI{constructor(t,e,i,o){super(),this.ctx=t,this.axisCtx=e,this.onButtonClick=i,this.seriesRect=o,this.enabled=!0,this.snap=!1,this.padding=0;const{button:s,wrapper:a}=this.setup();this.wrapper=a,this.button=s,this.toggleVisibility(!1),this.updateButtonElement(),this.snap=e.scaleBandwidth()>0;const n=this.ctx.regionManager.getRegion(EI.SERIES),r=tn.Default|tn.Annotations|tn.AnnotationsSelected;this.destroyFns.push(n.addListener("hover",l=>this.show(l),r),n.addListener("drag",l=>this.show(l),tn.Annotations|tn.AnnotationsSelected),n.addListener("leave",()=>this.hide(),r),t.highlightManager.addListener("highlight-change",l=>this.onHighlightChange(l)),t.keyNavManager.addListener("nav-hori",()=>this.onKeyPress()),t.keyNavManager.addListener("nav-vert",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.hide()),t.zoomManager.addListener("zoom-change",()=>this.hide()),()=>this.destroyElements(),()=>this.wrapper.remove(),()=>this.button.remove())}update(t,e){this.seriesRect=t,this.padding=e}setup(){const t=this.ctx.domManager.addChild("canvas-overlay",`${Qo}-${this.axisCtx.axisId}`);t.classList.add(`${Qo}-wrapper`);const e=CI("button");return e.classList.add(Qo),e.tabIndex=-1,t.appendChild(e),{wrapper:t,button:e}}destroyElements(){this.ctx.domManager.removeChild("canvas-overlay",Qo)}show(t){const{offsetX:e,offsetY:i}=t;if(!(this.enabled&&this.seriesRect.containsPoint(e,i))){this.hide();return}this.toggleVisibility(!0);const o=this.getButtonCoordinates({x:e,y:i});this.coords=this.getAxisCoordinates(o),this.updatePosition(o)}hide(){this.toggleVisibility(!1)}onHighlightChange(t){t.currentHighlight||this.hide()}onKeyPress(){this.snap||this.hide()}getButtonCoordinates({x:t,y:e}){const{axisCtx:{direction:i,position:o},seriesRect:s,snap:a,axisCtx:n,padding:r}=this,{clientWidth:l,clientHeight:c}=this.button,[h,p]=[s.y,s.y+s.height],[u,y]=[s.x,s.x+s.width];if(a&&(t=jo(Ya(t-s.x,n),n)+s.x,e=jo(Ya(e-s.y,n),n)+s.y),i===_I.X){const f=c-Math.max(0,r-5);t=t-l/2,e=o==="top"?h-c+f:p-f}else{const f=l-Math.max(0,r-9);t=o==="left"?u-l+f:y-f,e=e-c/2}return{x:t,y:e}}getAxisCoordinates(t){const{seriesRect:e}=this,{clientWidth:i,clientHeight:o}=this.button,s=t.x-e.x+i/2,a=t.y-e.y+o/2;return{x:s,y:a}}toggleVisibility(t){const{button:e}=this;if(e==null)return;const i=this.enabled&&t;this.toggleClass("-hidden",!i)}toggleClass(t,e){this.wrapper.classList.toggle(`${Qo}-wrapper-${t}`,e)}updatePosition({x:t,y:e}){this.wrapper.style.transform=`translate(${Math.round(t)}px, ${Math.round(e)}px)`}updateButtonElement(){const{button:t,ctx:e}=this;t.onclick=Yy.makeAccessibleClickListener(t,()=>this.onButtonClick(this.coords)),t.innerHTML=`<span class="${e.domManager.getIconClassNames("zoom-in")} ${Qo}-icon"></span>`}};d([OI(LI)],jy.prototype,"enabled",2);import{_ModuleSupport as RI}from"ag-charts-community";import{_ModuleSupport as wI,_Util as PI}from"ag-charts-community";var{Vec2:ft,createButton:ur,createCheckbox:BI,createElement:Mo,createElementId:Xy,createIcon:zI,createSelect:FI,createTextArea:VI,initRovingTabIndex:Zy,getWindow:UI,mapValues:bh}=wI,{Color:$y,setAttribute:HI,setAttributes:vh}=PI,Qy=class Du extends ug{constructor(e,i){super(e,i),this.colorPicker=new mg(this.ctx,{detached:!0}),this.destroyFns.push(e.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)))}showWithChildren(e,i){i.initialFocus??(i.initialFocus=this.initialFocus);const o=super.showWithChildren(e,i);return o.classList.add("ag-charts-dialog"),o.setAttribute("role","dialog"),o.addEventListener("mousedown",s=>{s.target.classList?.contains("ag-charts-dialog__color-picker-button")||this.colorPicker.hide()}),o.addEventListener("keydown",this.onKeyDown.bind(this)),UI().requestAnimationFrame(()=>this.reposition()),this.colorPicker.attachTo(this),o}updatePosition(e){super.updatePosition(e);const{anchor:i,fallbackAnchor:o}=this.getColorPickerAnchors()??{};i&&this.colorPicker.setAnchor(i,o)}createTabs(e,i,o){const s=Mo("div","ag-charts-dialog__tabs"),a=bh(o,()=>Xy("ag-charts-dialog__tab")),n=bh(o,()=>Xy("ag-charts-dialog__tab-panel"));for(const[y,g]of Object.entries(o))vh(g.panel,{id:n[y],role:"tabpanel","aria-labelledby":a[y]});const r=y=>{for(const[g,f]of Object.entries(o))f.panel.classList.toggle("ag-charts-dialog__tab-panel--active",g===y),h[g].classList.toggle("ag-charts-dialog__tab-button--active",g===y),HI(h[g],"aria-selected",g===y),g===y&&f.onShow?.()},l=Mo("div","ag-charts-dialog__header");l.addEventListener("mousedown",y=>{y.target instanceof Element&&y.target.classList.contains("ag-charts-dialog__header")&&this.onDragStart(y)});const c=this.createHeaderDragHandle(),h=bh(o,(y,g)=>ur({label:this.ctx.localeManager.t(y.label),onPress:()=>r(g)},{id:a[g],class:"ag-charts-dialog__tab-button",role:"tab","aria-controls":n[g]})),p=Mo("div","ag-charts-dialog__tab-list");vh(p,{role:"tablist","aria-label":this.ctx.localeManager.t(e)}),p.append(...Object.values(h));const u=this.createHeaderCloseButton();return l.append(c,p,u),s.append(l,...Object.values(o).map(y=>y.panel)),r(i),Zy({orientation:"horizontal",buttons:Object.values(h)}),this.initialFocus=h[i],s}createTabPanel(){return Mo("div","ag-charts-dialog__tab-panel")}createInputGroupLine(){return Mo("div","ag-charts-dialog__input-group-line")}createRadioGroup({label:e,options:i,value:o,onChange:s}){const a=this.createInputGroup(e);vh(a,{role:"radiogroup",tabindex:-1,"aria-label":this.ctx.localeManager.t(e)});const n="ag-charts-dialog__button--active",r=[];for(const l of i){const{icon:c,altText:h}=l,p=this.ctx.localeManager.t(h),u=ur({icon:c,altText:p,onPress:()=>{for(const y of Array.from(a.children))y.classList.remove(n),y.ariaChecked="false";u.classList.add(n),u.ariaChecked="true",s(l.value)}},{"aria-checked":l.value===o,class:"ag-charts-dialog__button",role:"radio",title:p});l.value===o&&u.classList.add(n),a.appendChild(u),r.push(u)}return Zy({orientation:"horizontal",buttons:r}),a}createSelect({altText:e,label:i,options:o,value:s,onChange:a}){const n=this.createInputGroup(i),r=this.ctx.localeManager.t(e),l=FI({value:s,options:o,onChange:a},{class:"ag-charts-dialog__select","aria-label":r,title:r});return n.append(l),n}createTextArea({placeholder:e,value:i,onChange:o}){const s=e?this.ctx.localeManager.t(e):void 0;return VI({value:i,onChange:o},{placeholder:s})}createCheckbox({label:e,checked:i,onChange:o}){const s=`ag-charts__${e}`,a=this.createInputGroup(e,{for:s}),n=BI({checked:i,onChange:o},{class:"ag-charts-dialog__checkbox",role:"switch",id:s});return a.append(n),a}createColorPicker({color:e,opacity:i,label:o,altText:s,onChange:a,onChangeHide:n}){const r=this.createInputGroup(o),l=this.ctx.localeManager.t(s),c=ur({label:l,onPress:h=>{const{anchor:p,fallbackAnchor:u}=this.getColorPickerAnchors(c)??{};this.colorPicker.show({anchor:p,fallbackAnchor:u,color:e,opacity:i,sourceEvent:h,onChange:(y,g,f)=>{c.style.setProperty("--color",y),a(y,g,f)},onChangeHide:n})}},{"aria-label":l,tabindex:0,class:"ag-charts-dialog__color-picker-button",title:l});if(e){const h=$y.fromHexString(e),p=new $y(h.r,h.g,h.b,i);c.style.setProperty("--color",p.toHexString())}return r.append(c),this.hideFns.push(()=>{this.colorPicker.hide()}),r}createHeaderDragHandle(){const e=Mo("div","ag-charts-dialog__drag-handle"),i=zI("drag-handle");return e.append(i),e.addEventListener("mousedown",o=>this.onDragStart(o,e)),e}createHeaderCloseButton(){return ur({icon:"close",altText:this.ctx.localeManager.t("iconAltTextClose"),onPress:()=>this.hide()},{class:"ag-charts-dialog__close-button"})}createInputGroup(e,i){const o=Mo("div","ag-charts-dialog__input-group"),s=Mo("label","ag-charts-dialog__input-group-label");return s.innerText=this.ctx.localeManager.t(e),i?.for&&s.setAttribute("for",i.for),o.appendChild(s),o}onLayoutComplete(e){this.seriesRect=e.series.paddedRect,this.reposition()}onKeyDown(e){e.altKey||e.ctrlKey||e.metaKey||e.isComposing||e.key!=="Escape"||this.hide()}onDragStart(e,i){const o=this.getPopoverElement();if(!o)return;const{ctx:{domManager:s}}=this;e.preventDefault(),this.dragStartState={client:ft.from(e.clientX,e.clientY),position:ft.from(Number(o.style.getPropertyValue("left").replace("px","")),Number(o.style.getPropertyValue("top").replace("px","")))},i?.classList.add("ag-charts-dialog__drag-handle--dragging");const a=this.onDrag.bind(this),n=()=>{s.removeEventListener("mousemove",a),i?.classList.remove("ag-charts-dialog__drag-handle--dragging")};s.addEventListener("mousemove",a),s.addEventListener("mouseup",n,{once:!0}),o.addEventListener("mouseup",()=>n,{once:!0})}onDrag(e){const{dragStartState:i}=this,o=this.getPopoverElement();if(!i||!o)return;const s=ft.sub(ft.from(e.clientX,e.clientY),i.client),a=ft.add(i.position,s),n=this.ctx.domManager.getBoundingClientRect();a.x>=n.x&&a.x+o.offsetWidth<=n.width&&o.style.setProperty("left",`${a.x}px`),a.y>=n.y&&a.y+o.offsetHeight<=n.height&&o.style.setProperty("top",`${a.y}px`)}reposition(){const{seriesRect:e,ctx:i}=this,o=i.domManager.getBoundingClientRect(),s=this.getPopoverElement();if(!e||!s)return;const a=ft.from(0,e.y),n=ft.from(o.width,e.height),r=ft.from(s),l=ft.from(.5,1);let c;if(e.width>1e3){const h=ft.sub(ft.add(a,ft.multiply(n,l)),ft.multiply(r,l));c=ft.sub(h,ft.from(0,Du.offset))}else{const h=ft.sub(ft.add(a,n),r);c=ft.sub(h,Du.offset)}this.updatePosition(c)}getColorPickerAnchors(e){if(e&&(this.colorPickerAnchorElement=e),!this.colorPickerAnchorElement)return;const i=this.colorPickerAnchorElement.getBoundingClientRect(),o=this.ctx.domManager.getBoundingClientRect(),s=ft.sub(ft.from(i.x,i.y),ft.from(o.left,o.top)),a=ft.add(s,ft.from(0,i.height+5)),n=ft.sub(s,ft.from(0,5));return{anchor:a,fallbackAnchor:n}}};Qy.offset=60;var GI=Qy,{focusCursorAtEnd:WI}=RI,KI=class extends GI{constructor(t){super(t,"settings")}show(t,e){const i=this.createLinearLineTab(t,e),o=this.createLinearTextTab(t,e);let s="dialogHeaderLine";Ki(t)?s="dialogHeaderChannel":t.type==="date-range"?s="dialogHeaderDateRange":t.type==="price-range"?s="dialogHeaderPriceRange":t.type==="date-price-range"&&(s="dialogHeaderDatePriceRange");const a=this.createTabs("ariaLabelSettingsTabBar",e.initialSelectedTab,{line:{label:s,panel:i},text:{label:"dialogHeaderText",panel:o.panel,onShow:o.onShow}});this.showWithChildren([a],e).classList.add("ag-charts-dialog--annotation-settings")}createLinearLineTab(t,e){const i=this.createTabPanel(),o=this.createInputGroupLine(),s=this.createInputGroupLine(),a=this.createColorPickerInput("line-color",t.getDefaultColor("line-color"),t.getDefaultOpacity("line-color"),e.onChangeLineColor,e.onChangeHideLineColor),n=this.createStrokeWidthSelect(t.strokeWidth??2,e.onChangeLineStyleWidth),r=this.createLineStyleRadioGroup(t.lineStyle??"solid",e.onChangeLineStyleType);if("background"in t){const l=this.createColorPickerInput("fill-color",t.getDefaultColor("fill-color"),t.getDefaultOpacity("fill-color"),e.onChangeFillColor,e.onChangeHideFillColor);o.append(a,l),s.append(n,r)}else o.append(a,n),s.append(r);return i.append(o,s),"extendStart"in t&&"extendEnd"in t&&i.append(this.createCheckbox({label:Ki(t)?"dialogInputExtendChannelStart":"dialogInputExtendLineStart",checked:t.extendStart??!1,onChange:l=>e.onChangeLine({extendStart:l})}),this.createCheckbox({label:Ki(t)?"dialogInputExtendChannelEnd":"dialogInputExtendLineEnd",checked:t.extendEnd??!1,onChange:l=>e.onChangeLine({extendEnd:l})})),"extendAbove"in t&&"extendBelow"in t&&i.append(this.createCheckbox({label:"dialogInputExtendAbove",checked:t.extendAbove??!1,onChange:l=>e.onChangeLine({extendAbove:l})}),this.createCheckbox({label:"dialogInputExtendBelow",checked:t.extendBelow??!1,onChange:l=>e.onChangeLine({extendBelow:l})})),"extendLeft"in t&&"extendRight"in t&&i.append(this.createCheckbox({label:"dialogInputExtendLeft",checked:t.extendLeft??!1,onChange:l=>e.onChangeLine({extendLeft:l})}),this.createCheckbox({label:"dialogInputExtendRight",checked:t.extendRight??!1,onChange:l=>e.onChangeLine({extendRight:l})})),i}createLinearTextTab(t,e){const i=this.createTabPanel(),o=this.createTextArea({placeholder:"inputTextareaPlaceholder",value:t.text.label,onChange:p=>e.onChangeText({label:p})}),s=this.createInputGroupLine(),a=this.createFontSizeSelect(t.text.fontSize,e.onChangeTextFontSize),n=this.createColorPickerInput("text-color",t.text.color,1,e.onChangeTextColor,e.onChangeHideTextColor);s.append(a,n);const r=this.createInputGroupLine(),l=t.text.position==="inside"?"center":t.text.position,c=this.createPositionRadioGroup(l??"top",p=>e.onChangeText({position:p})),h=this.createAlignmentRadioGroup(t.text.alignment??"center",p=>e.onChangeText({alignment:p}));return r.append(c,h),i.append(o,s,r),{panel:i,onShow:()=>WI(o)}}createColorPickerInput(t,e,i,o,s){const a=t==="fill-color"?"dialogInputFillColorPicker":"dialogInputColorPicker",n=t==="fill-color"?"dialogInputFillColorPickerAltText":"dialogInputColorPickerAltText";return this.createColorPicker({label:a,altText:n,color:e,opacity:i,onChange:o,onChangeHide:s})}createStrokeWidthSelect(t,e){return this.createSelect({label:"dialogInputStrokeWidth",altText:"dialogInputStrokeWidthAltText",options:Wy.map(({label:i,value:o})=>({label:i,value:`${o}`})),value:String(t),onChange:i=>e(Number(i))})}createLineStyleRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputLineStyle",options:[{icon:"line-style-solid",altText:"iconAltTextLineStyleSolid",value:"solid"},{icon:"line-style-dashed",altText:"iconAltTextLineStyleDashed",value:"dashed"},{icon:"line-style-dotted",altText:"iconAltTextLineStyleDotted",value:"dotted"}],value:t,onChange:e})}createFontSizeSelect(t,e){return this.createSelect({label:"dialogInputFontSize",altText:"dialogInputFontSizeAltText",options:Ky.map(({label:i,value:o})=>({label:i,value:String(o)})),value:String(t),onChange:i=>e(Number(i))})}createPositionRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputPosition",options:[{icon:"position-top",altText:"iconAltTextPositionTop",value:"top"},{icon:"position-center",altText:"iconAltTextPositionCenter",value:"center"},{icon:"position-bottom",altText:"iconAltTextPositionBottom",value:"bottom"}],value:t,onChange:e})}createAlignmentRadioGroup(t,e){return this.createRadioGroup({label:"dialogInputAlign",options:[{icon:"align-left",altText:"iconAltTextAlignLeft",value:"left"},{icon:"align-center",altText:"iconAltTextAlignCenter",value:"center"},{icon:"align-right",altText:"iconAltTextAlignRight",value:"right"}],value:t,onChange:e})}};function Mh(t){return t.gridPadding+t.seriesAreaPadding+t.tickSize+t.label.padding}function YI(t,e,i){for(const{update:o}of Object.values(we))o(t,e,i)}var{BOOLEAN:jI,ChartUpdateType:XI,InteractionState:$i,ObserveChanges:ZI,PropertiesArray:$I,ToolbarManager:Th,Validate:QI,REGIONS:gr,ChartAxisDirection:qI,Vec2:Ni,isValidDate:Ah,keyProperty:JI,valueProperty:tN}=Oc,qy=class extends Oc.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!0,this.axesButtons=new Rc,this.data=void 0,this.xKey=void 0,this.volumeKey=void 0,this.annotationData=new $I(this.createAnnotationDatum),this.defaults=new ZD,this.container=new Lc.Group({name:"static-annotations"}),this.annotations=new Lc.Selection(this.container,this.createAnnotationScene.bind(this)),this.colorPicker=new mg(this.ctx),this.textSizeMenu=new Ha(this.ctx,"text-size"),this.lineStyleTypeMenu=new Ha(this.ctx,"annotations-line-style-type"),this.lineStrokeWidthMenu=new Ha(this.ctx,"annotations-line-stroke-width"),this.annotationMenu=new Ha(this.ctx,"annotations"),this.settingsDialog=new KI(this.ctx),this.textInput=new lA(this.ctx),this.postUpdateFns=[],this.state=this.setupStateMachine(),this.setupListeners(),this.ctx.historyManager.addMementoOriginator(t.annotationManager),this.ctx.historyManager.addMementoOriginator(this.defaults),this.textInput.setKeyDownHandler(this.onTextInput.bind(this))}setupStateMachine(){const{ctx:t}=this;return new II({resetToIdle:()=>{t.cursorManager.updateCursor("annotations"),t.toolbarManager.toggleGroup("annotations","annotationOptions",{visible:!1}),t.tooltipManager.unsuppressTooltip("annotations"),this.hideOverlays(),this.deleteEphemeralAnnotations(),this.resetToolbarButtonStates(),this.toggleAnnotationOptionsButtons(),this.update()},hoverAtCoords:(e,i)=>{let o;return this.annotations.each((s,a,n)=>{const r=s.containsPoint(e.x,e.y);r&&(o??(o=n)),s.toggleHovered(r||i===n)}),this.ctx.cursorManager.updateCursor("annotations",o==null?void 0:this.annotations.at(o)?.getCursor()),o},getHoverCoords:()=>this.hoverCoords,getNodeAtCoords:(e,i)=>{const o=this.annotations.at(i);if(o)return o.getNodeAtCoords(e.x,e.y)},translate:(e,i)=>{const o=this.annotations.at(e),s=Zi(this.annotationData.at(e));if(!(!o||!s))return this.translateNode(o,s,i)},copy:e=>{const i=this.annotations.at(e),o=Zi(this.annotationData.at(e));if(!(!i||!o))return this.createAnnotationDatumCopy(i,o)},paste:e=>{this.createAnnotation(e.type,e,!1),this.postUpdateFns.push(()=>{this.state.transitionAsync("selectLast"),this.state.transitionAsync("copy")})},select:(e,i)=>{const{annotations:o,ctx:{toolbarManager:s,tooltipManager:a}}=this;this.hideOverlays();const n=e!=null?o.at(e):null,r=i!=null?o.at(i):null;r===n&&n!=null||(r?.toggleActive(!1),s.toggleGroup("annotations","annotationOptions",{visible:!1}),n?(this.ctx.interactionManager.pushState($i.AnnotationsSelected),n.toggleActive(!0),a.suppressTooltip("annotations"),this.toggleAnnotationOptionsButtons(),this.postUpdateFns.push(()=>{s.toggleGroup("annotations","annotationOptions",{visible:!0}),s.changeFloatingAnchor("annotationOptions",n.getAnchor())})):(this.ctx.interactionManager.popState($i.AnnotationsSelected),this.ctx.interactionManager.popState($i.Annotations),a.unsuppressTooltip("annotations")),s.updateButton("annotations","line-menu",{icon:void 0}),s.updateButton("annotations","text-menu",{icon:void 0}),s.updateButton("annotations","shape-menu",{icon:void 0}),s.updateButton("annotations","measurer-menu",{icon:void 0}),this.deleteEphemeralAnnotations(),this.update())},selectLast:()=>(this.ctx.interactionManager.pushState($i.AnnotationsSelected),this.annotationData.length-1),startInteracting:()=>{this.ctx.interactionManager.pushState($i.Annotations)},stopInteracting:()=>{this.ctx.interactionManager.popState($i.Annotations)},create:(e,i)=>{this.createAnnotation(e,i)},delete:e=>{this.annotationData.splice(e,1)},deleteAll:()=>{this.annotationData.splice(0,this.annotationData.length)},validatePoint:e=>{const i=this.getAnnotationContext();return i?Wi(i,e):!0},getAnnotationType:e=>Mg(this.annotationData[e].type),datum:e=>this.annotationData.at(e),node:e=>this.annotations.at(e),recordAction:e=>{this.recordActionAfterNextUpdate(e)},update:()=>{this.postUpdateFns.push(()=>{const e=this.state.getActive(),i=e!=null?this.annotations.at(e):null;i!=null&&t.toolbarManager.changeFloatingAnchor("annotationOptions",i.getAnchor())}),this.update()},addPostUpdateFns:(...e)=>{this.postUpdateFns.push(...e)},showTextInput:e=>{const i=Zi(this.annotationData.at(e));if(!this.annotations.at(e)||!i||!("getTextInputCoords"in i)||!("getTextPosition"in i))return;const s={color:i.color,fontFamily:i.fontFamily,fontSize:i.fontSize,fontStyle:i.fontStyle,fontWeight:i.fontWeight,placeholderColor:i.getPlaceholderColor()},a=this.getAnnotationContext(),n=l=>Ni.add(i.getTextInputCoords(a,l),Ni.required(this.seriesRect)),r=()=>i.getTextPosition();this.textInput.show({styles:s,layout:{getTextInputCoords:n,getTextPosition:r,alignment:i.alignment,textAlign:i.textAlign,width:i.width},text:i.text,placeholderText:i.placeholderText,onChange:(l,c)=>{this.state.transition("updateTextInputBBox",c)}}),this.ctx.cursorManager.updateCursor("annotations",void 0)},hideTextInput:()=>{this.textInput.hide()},updateTextInputColor:e=>{this.textInput.updateColor(e)},updateTextInputFontSize:e=>{const i=this.textInput.updateFontSize(e);this.state.transition("updateTextInputBBox",i)},updateTextInputBBox:e=>{this.state.transition("updateTextInputBBox",e)},showAnnotationOptions:e=>{const i=this.annotations.at(e);!i||fo(this.annotationData.at(e))||(this.toggleAnnotationOptionsButtons(),t.toolbarManager.toggleGroup("annotations","annotationOptions",{visible:!0}),t.toolbarManager.changeFloatingAnchor("annotationOptions",i.getAnchor()))},showAnnotationSettings:(e,i,o="line")=>{const s=this.annotationData.at(e);if(!sr(s)&&!Ki(s)&&!$a(s)||fo(s))return;const a=l=>(c,h,p)=>{this.setColorAndDefault(s.type,l,c,h,p),this.updateToolbarColorPickerFill(l,h,p)},n=l=>()=>{this.recordActionAfterNextUpdate(`Change ${s.type} ${l} to ${s.getDefaultColor(l)}`,["annotations","defaults"]),this.update()},r={initialSelectedTab:o,ariaLabel:this.ctx.localeManager.t("ariaLabelAnnotationSettingsDialog"),sourceEvent:i,onChangeLine:l=>{this.state.transition("lineProps",l)},onChangeText:l=>{this.state.transition("lineText",l),l.alignment&&this.defaults.setDefaultLineTextAlignment(s.type,l.alignment),l.position&&this.defaults.setDefaultLineTextPosition(s.type,l.position),this.recordActionAfterNextUpdate(`Change ${s.type} text ${Object.entries(l).map(([c,h])=>`${c} to ${h}`).join(", ")}`)},onChangeFillColor:a("fill-color"),onChangeHideFillColor:n("fill-color"),onChangeLineColor:a("line-color"),onChangeHideLineColor:n("line-color"),onChangeLineStyleType:l=>{this.setLineStyleTypeAndDefault(s.type,l),this.updateToolbarLineStyleType(Ja.find(c=>c.value===l)??Ja[0])},onChangeLineStyleWidth:l=>{this.setLineStyleWidthAndDefault(s.type,l),this.updateToolbarStrokeWidth({strokeWidth:l,value:l,label:String(l)})},onChangeTextColor:a("text-color"),onChangeHideTextColor:n("text-color"),onChangeTextFontSize:l=>{this.setFontSizeAndDefault(s.type,l)}};this.settingsDialog.show(s,r)}})}setupListeners(){const{ctx:t}=this,{All:e,Default:i,Annotations:o,AnnotationsSelected:s,ZoomDrag:a}=$i,n=t.regionManager.getRegion(gr.SERIES),r=Object.values(gr).filter(c=>![gr.SERIES,gr.NAVIGATOR].includes(c)).map(c=>t.regionManager.getRegion(c)),l=i|a|o|s;this.destroyFns.push(n.addListener("hover",this.onHover.bind(this),e),n.addListener("click",this.onClick.bind(this),e),n.addListener("dblclick",this.onDoubleClick.bind(this),e),n.addListener("drag-start",this.onDragStart.bind(this),l),n.addListener("drag",this.onDrag.bind(this),l),n.addListener("drag-end",this.onDragEnd.bind(this),e),t.interactionManager.addListener("keydown",this.onKeyDown.bind(this),e),t.interactionManager.addListener("keyup",this.onKeyUp.bind(this),e),...r.map(c=>c.addListener("click",this.onCancel.bind(this),e)),t.annotationManager.addListener("restore-annotations",this.onRestoreAnnotations.bind(this)),t.toolbarManager.addListener("button-pressed",this.onToolbarButtonPress.bind(this)),t.toolbarManager.addListener("button-moved",this.onToolbarButtonMoved.bind(this)),t.toolbarManager.addListener("group-moved",this.onToolbarGroupMoved.bind(this)),t.toolbarManager.addListener("cancelled",this.onToolbarCancelled.bind(this)),t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),t.updateService.addListener("pre-scene-render",this.onPreRender.bind(this)),t.zoomManager.addListener("zoom-change",()=>this.onZoomChange()),t.annotationManager.attachNode(this.container),()=>this.colorPicker.destroy(),()=>t.domManager.removeStyles(Qo))}destroy(){super.destroy()}async processData(t){if(!this.enabled||this.data==null||this.xKey==null||this.volumeKey==null)return;const e=[JI(this.xKey,void 0,{id:"date"}),tN(this.volumeKey,"number",{id:"volume"})],{dataModel:i,processedData:o}=await t.request("annotations",this.data,{props:e});this.dataModel=i,this.processedData=o}createAnnotationScene(t){if(t.type in we)return new we[t.type].scene;throw new Error(`AG Charts - Cannot create annotation scene of type [${t.type}], expected one of [${Object.keys(we)}], ignoring.`)}createAnnotationDatum(t){if(t.type in we)return new we[t.type].datum().set(t);throw new Error(`AG Charts - Cannot create annotation datum of unknown type [${t.type}], expected one of [${Object.keys(we)}], ignoring.`)}createAnnotation(t,e,i=!0){if(this.annotationData.push(e),i){const o=this.ctx.annotationManager.getAnnotationTypeStyles(t);o&&e.set(o),this.defaults.applyDefaults(e)}this.injectDatumDependencies(e),this.resetToolbarButtonStates(),this.update()}injectDatumDependencies(t){"setLocaleManager"in t&&t.setLocaleManager(this.ctx.localeManager),"getVolume"in t&&(t.getVolume=this.getDatumRangeVolume.bind(this))}getDatumRangeVolume(t,e){if(!Ah(t)||!Ah(e)||!this.dataModel||!this.processedData)return;t>e&&([t,e]=[e,t]);const i=this.dataModel.resolveProcessedDataDefById({id:"annotations"},"date"),o=this.dataModel.resolveProcessedDataDefById({id:"annotations"},"volume");return this.processedData.data.reduce((s,a)=>{const n=a.keys[i.index];return Ah(n)&&n>=t&&n<=e?s+a.values[o.index]:s},0)}translateNode(t,e,i){const o=this.getAnnotationConfig(e),s=this.getAnnotationContext();s&&o.translate(t,e,i,s)}createAnnotationDatumCopy(t,e){const i=this.getAnnotationConfig(e),o=new i.datum;o.set(e.toJson());const s=this.getAnnotationContext();if(s)return i.copy(t,e,o,s)}getAnnotationConfig(t){if(t.type in we)return we[t.type];throw new Error(`AG Charts - Cannot get annotation config of unknown type [${t.type}], expected one of [${Object.keys(we)}], ignoring.`)}onRestoreAnnotations(t){this.enabled&&(this.clear(),this.annotationData.set(t.annotations),this.update())}onToolbarButtonPress(t){if(Th.isGroup("annotationOptions",t)){this.onToolbarAnnotationOptionButtonPress(t);return}if(!Th.isGroup("annotations",t)){this.reset();return}if(t.value==="clear"){this.clear(),this.recordActionAfterNextUpdate("Clear all annotations");return}if(t.value==="line-menu"){this.onToolbarButtonPressMenu(t,"toolbarAnnotationsLineAnnotations",bI);return}if(t.value==="text-menu"){this.onToolbarButtonPressMenu(t,"toolbarAnnotationsTextAnnotations",vI);return}if(t.value==="shape-menu"){this.onToolbarButtonPressMenu(t,"toolbarAnnotationsShapeAnnotations",MI);return}if(t.value==="measurer-menu"){this.onToolbarButtonPressMenu(t,"toolbarAnnotationsMeasurerAnnotations",TI);return}this.onToolbarButtonPressAnnotation(t)}onToolbarAnnotationOptionButtonPress(t){if(!Th.isGroup("annotationOptions",t))return;const{annotationData:e,state:i}=this,o=i.getActive();if(o==null)return;this.hideOverlays();const s=Zi(e[o]),a=this.annotations.at(o);switch(t.value){case"line-style-type":{const n=mo(s)?ja(s.lineDash,s.lineStyle):void 0;this.lineStyleTypeMenu.show({items:Ja,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStyle"),value:n,sourceEvent:t.sourceEvent,onPress:r=>this.onLineStyleTypeMenuPress(r,s),class:"annotations__line-style-type"});break}case"line-stroke-width":{const n=mo(s)?s.strokeWidth:void 0;this.lineStrokeWidthMenu.show({items:Wy,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsLineStrokeWidth"),value:n,sourceEvent:t.sourceEvent,onPress:r=>this.onLineStrokeWidthMenuPress(r,s),class:"annotations__line-stroke-width"});break}case"line-color":case"fill-color":case"text-color":{this.colorPicker.show({color:s?.getDefaultColor(t.value),opacity:s?.getDefaultOpacity(t.value),sourceEvent:t.sourceEvent,onChange:s!=null?this.onColorPickerChange.bind(this,t.value,s):void 0,onChangeHide:(n=>{this.recordActionAfterNextUpdate(`Change ${a?.type} ${t.value} to ${s?.getDefaultColor(n)}`,["annotations","defaults"])}).bind(this,t.value)});break}case"text-size":{const n=Di(s)?s.fontSize:void 0;this.textSizeMenu.show({items:Ky,ariaLabel:this.ctx.localeManager.t("toolbarAnnotationsTextSize"),value:n,sourceEvent:t.sourceEvent,onPress:r=>this.onTextSizeMenuPress(r,s),class:"ag-charts-annotations-text-size-menu"});break}case"delete":{this.cancel(),this.delete(),this.reset();break}case"lock":{e[o].locked=!e[o].locked,this.toggleAnnotationOptionsButtons();break}case"settings":{i.transition("toolbarPressSettings",t.sourceEvent);break}}this.update()}onToolbarButtonPressMenu(t,e,i){const{x:o,y:s,width:a}=t.rect;this.cancel(),this.reset(),this.annotationMenu.setAnchor({x:o+a+6,y:s}),this.annotationMenu.show({items:i,ariaLabel:this.ctx.localeManager.t(e),sourceEvent:t.sourceEvent,onPress:this.onAnnotationsMenuPress.bind(this,t)})}onToolbarButtonPressAnnotation(t){this.ctx.tooltipManager.suppressTooltip("annotations");const e=Mg(t.value);e?this.beginAnnotationPlacement(e):(Cc.Logger.errorOnce(`Can not create unknown annotation type [${t.value}], ignoring.`),this.update())}onToolbarButtonMoved(t){const{group:e,rect:i,groupRect:o,value:s}=t;if(e!=="annotationOptions")return;const a={x:i.x,y:i.y+i.height-1};switch(s){case"fill-color":case"line-color":case"text-color":{const n=Ni.add(o,Ni.from(0,o.height+4)),r={y:o.y-4};this.colorPicker.setAnchor(n,r);break}case"line-stroke-width":{this.lineStrokeWidthMenu.setAnchor(a);break}case"line-style-type":{this.lineStyleTypeMenu.setAnchor(a);break}case"text-size":{this.textSizeMenu.setAnchor(a);break}default:break}}onToolbarGroupMoved(t){this.hideOverlays()}onColorPickerChange(t,e,i,o,s){this.setColorAndDefault(e.type,t,i,o,s),this.updateToolbarColorPickerFill(t,i)}updateToolbarColorPickerFill(t,e,i){if(e!=null&&i!=null){const{r:o,g:s,b:a}=Cc.Color.fromString(e);e=Cc.Color.fromArray([o,s,a,i]).toHexString()}this.ctx.toolbarManager.updateButton("annotationOptions",t,{fill:e})}updateToolbarFills(){const t=this.state.getActive(),e=t!=null?this.annotationData[t]:void 0,i=Zi(e);this.updateToolbarColorPickerFill("line-color",i?.getDefaultColor("line-color"),i?.getDefaultOpacity("line-color")),this.updateToolbarColorPickerFill("fill-color",i?.getDefaultColor("fill-color"),i?.getDefaultOpacity("fill-color")),this.updateToolbarColorPickerFill("text-color",i?.getDefaultColor("text-color"),i?.getDefaultOpacity("text-color"))}updateToolbarFontSize(t){this.ctx.toolbarManager.updateButton("annotationOptions","text-size",{label:t!=null?String(t):void 0})}updateToolbarLineStyleType(t){this.ctx.toolbarManager.updateButton("annotationOptions","line-style-type",{icon:t.icon})}updateToolbarStrokeWidth(t){this.ctx.toolbarManager.updateButton("annotationOptions","line-stroke-width",{label:t.label,strokeWidth:t.value})}onTextSizeMenuPress(t,e){if(!jg(e))return;const i=t.value;this.setFontSizeAndDefault(e.type,i),this.textSizeMenu.hide(),this.updateToolbarFontSize(i)}onLineStyleTypeMenuPress(t,e){if(!mo(e))return;const i=t.value;this.setLineStyleTypeAndDefault(e.type,i),this.lineStyleTypeMenu.hide(),this.updateToolbarLineStyleType(t)}onLineStrokeWidthMenuPress(t,e){if(!mo(e))return;const i=t.value;this.setLineStyleWidthAndDefault(e.type,i),this.lineStrokeWidthMenu.hide(),this.updateToolbarStrokeWidth(t)}onAnnotationsMenuPress(t,e){const{toolbarManager:i}=this.ctx;i.toggleButton("annotations",t.id,{active:!0}),i.updateButton("annotations",t.id,{icon:e.icon}),this.beginAnnotationPlacement(e.value),this.annotationMenu.hide()}onToolbarCancelled(t){t.group==="annotations"&&this.cancelPlacementInteraction()}cancelPlacementInteraction(){this.cancel(),this.resetToolbarButtonStates(),this.reset(),this.update()}onLayoutComplete(t){const e=t.series.paddedRect;this.seriesRect=e;for(const i of t.axes??[])i.direction===Oc.ChartAxisDirection.X?this.xAxis=this.getAxis(i,e,this.xAxis?.button):this.yAxis=this.getAxis(i,e,this.yAxis?.button)}onPreRender(){this.updateAnnotations(),this.state.transition("render")}getAxis(t,e,i){const o=this.ctx.axisManager.getAxisContext(t.direction)[0],{position:s="bottom",direction:a}=o,n=t.gridPadding+t.seriesAreaPadding,r=yg(new Lc.BBox(0,0,e.width,e.height),s,n),l=o.direction===qI.X?"vertical":"horizontal",{axesButtons:c}=this;if(this.enabled&&c.enabled&&(c.axes==="xy"||c.axes===a)){i??(i=new jy(this.ctx,o,u=>this.onAxisButtonClick(u,l),e));const p=Mh(t);i.update(e,p)}else i?.destroy(),i=void 0;return{layout:t,context:o,bounds:r,button:i}}recordActionAfterNextUpdate(t,e=["annotations"]){const{defaults:i,ctx:{annotationManager:o,historyManager:s}}=this,a=e.map(n=>n==="defaults"?i:o);this.postUpdateFns.push(()=>{s.record(t,...a)})}setColorAndDefault(t,e,i,o,s){this.state.transition("color",{colorPickerType:e,colorOpacity:i,color:o,opacity:s}),this.defaults.setDefaultColor(t,e,i,o,s)}setFontSizeAndDefault(t,e){this.state.transition("fontSize",e),this.defaults.setDefaultFontSize(t,e),this.recordActionAfterNextUpdate(`Change ${t} font size to ${e}`,["annotations","defaults"])}setLineStyleTypeAndDefault(t,e){this.state.transition("lineStyle",{type:e}),this.defaults.setDefaultLineStyleType(t,e),this.recordActionAfterNextUpdate(`Change ${t} line style to ${e}`,["annotations","defaults"])}setLineStyleWidthAndDefault(t,e){this.state.transition("lineStyle",{strokeWidth:e}),this.defaults.setDefaultLineStyleWidth(t,e),this.recordActionAfterNextUpdate(`Change ${t} stroke width to ${e}`,["annotations","defaults"])}updateAnnotations(){const{annotationData:t,annotations:e,seriesRect:i,ctx:{annotationManager:o,toolbarManager:s}}=this,a=this.getAnnotationContext();if(!i||!a)return;o.updateData(t.toJson().filter(r=>!fo(r)));const n=t.length>0;s.toggleButton("annotations","clear",{enabled:n}),e.update(t??[],void 0,r=>r.id).each((r,l)=>{if(!this.validateDatum(l)){r.visible=!1;return}this.injectDatumDependencies(l),YI(r,l,a)}),this.postUpdateFns.forEach(r=>r()),this.postUpdateFns=[]}validateDatum(t){const e=this.getAnnotationContext();return e?t.isValidWithContext(e,`Annotation [${t.type}] `):!0}getAnnotationContext(){const{seriesRect:t,xAxis:e,yAxis:i}=this;if(t&&e&&i)return{seriesRect:t,xAxis:{...e.context,bounds:e.bounds,labelPadding:Mh(e.layout)},yAxis:{...i.context,bounds:i.bounds,labelPadding:Mh(e.layout)}}}getPointFn(t,e,i){return(o,s=1)=>Pt(t?ch(e,o?xt(o,i):Ni.origin(),s):e,i)}onHover(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const o=t.sourceEvent.shiftKey,s=Ni.from(t);this.hoverCoords=s;const a=this.getPointFn(o,s,i);e.transition("hover",{offset:s,point:a})}onClick(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const o=Ni.from(t),s=()=>Pt(o,i),a=this.textInput.getValue(),n=this.textInput.getBBox();e.transition("click",{offset:o,point:s,textInputValue:a,bbox:n})}onDoubleClick(t){const{state:e}=this;if(!this.getAnnotationContext())return;const o=Ni.from(t);e.transition("dblclick",{offset:o})}onAxisButtonClick(t,e){this.cancel(),this.reset();const i=this.getAnnotationContext();if(!this.annotationData||!i)return;const{state:o,ctx:{toolbarManager:s,interactionManager:a}}=this;a.pushState($i.Annotations);const n=e==="horizontal";if(o.transition(n?"horizontal-line":"vertical-line"),s.toggleGroup("annotations","annotationOptions",{visible:!1}),!t)return;const r=()=>Pt(t,i);Wi(i,r())&&(o.transition("click",{point:r}),this.update())}onZoomChange(){const t=this.textInput.getValue(),e=this.textInput.getBBox();this.state.transition("zoomChange",{textInputValue:t,bbox:e})}onDragStart(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const o=Ni.from(t);this.hoverCoords=o;const s=t.sourceEvent.shiftKey,a=this.getPointFn(s,o,i),n=this.textInput.getValue(),r=this.textInput.getBBox();e.transition("dragStart",{context:i,offset:o,point:a,textInputValue:n,bbox:r})}onDrag(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const o=Ni.from(t);this.hoverCoords=o;const s=t.sourceEvent.shiftKey,a=this.getPointFn(s,o,i);e.transition("drag",{context:i,offset:o,point:a})}onDragEnd(){this.hoverCoords=void 0,this.state.transition("dragEnd")}onCancel(){this.cancel(),this.reset()}onDelete(){this.textInput.isVisible()||(this.cancel(),this.delete(),this.reset(),this.update())}onTextInput(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const{key:o,shiftKey:s}=t,a=this.textInput.getValue(),n=this.textInput.getBBox();e.transition("keyDown",{key:o,shiftKey:s,textInputValue:a,bbox:n,context:i})}onKeyDown(t){const{state:e}=this,i=this.getAnnotationContext();if(!i)return;const{sourceEvent:o}=t,{shiftKey:s,ctrlKey:a,metaKey:n}=o,r=a||n,l=a||s,c=this.hoverCoords?this.getPointFn(s,this.hoverCoords,i):void 0;this.state.transition("keyDown",{shiftKey:s,context:i,point:c});const h={x:0,y:0},p=Math.max(i?.xAxis.scaleBandwidth()??0,l?10:1),u=Math.max(i?.yAxis.scaleBandwidth()??0,l?10:1);switch(o.key){case"ArrowDown":h.y=u;break;case"ArrowUp":h.y=-u;break;case"ArrowLeft":h.x=-p;break;case"ArrowRight":h.x=p;break;case"Escape":this.onCancel();return;case"Backspace":case"Delete":this.onDelete();return}if((h.x||h.y)&&(e.transition("translate",{translation:h,context:i}),o.stopPropagation(),o.preventDefault()),!!r)switch(o.key){case"c":e.transition("copy");return;case"x":e.transition("cut"),this.recordActionAfterNextUpdate("Cut annotation");return;case"v":e.transition("paste"),this.recordActionAfterNextUpdate("Paste annotation");return}}onKeyUp(t){const{shiftKey:e}=t.sourceEvent,i=this.getAnnotationContext();if(!i)return;const o=this.hoverCoords?this.getPointFn(e,this.hoverCoords,i):void 0;this.state.transition("keyUp",{shiftKey:e,context:i,point:o}),this.state.transition("translateEnd")}beginAnnotationPlacement(t){this.cancel(),this.ctx.interactionManager.pushState($i.Annotations),this.state.transition(t),this.update()}toggleAnnotationOptionsButtons(){const{annotationData:t,state:e,ctx:{toolbarManager:i}}=this,o=e.getActive();if(o==null)return;const s=Zi(t.at(o)),a=s?.locked??!1;i.toggleButton("annotationOptions","line-style-type",{enabled:!a,visible:mo(s)}),i.toggleButton("annotationOptions","line-stroke-width",{enabled:!a,visible:mo(s)}),i.toggleButton("annotationOptions","line-color",{enabled:!a,visible:WD(s)}),i.toggleButton("annotationOptions","text-color",{enabled:!a,visible:jD(s)}),i.toggleButton("annotationOptions","fill-color",{enabled:!a,visible:YD(s)}),i.toggleButton("annotationOptions","text-size",{enabled:!a,visible:jg(s)}),i.toggleButton("annotationOptions","settings",{enabled:!a,visible:Ws(s)}),i.toggleButton("annotationOptions","delete",{enabled:!a}),i.toggleButton("annotationOptions","lock",{checked:a}),i.updateGroup("annotationOptions"),this.updateToolbarFontSize(s!=null&&"fontSize"in s?s.fontSize:void 0),this.updateToolbarFills(),this.updateToolbarLineStyles(s)}updateToolbarLineStyles(t){if(!mo(t))return;const e=t.strokeWidth??1,i=ja(t.lineDash,t.lineStyle);this.updateToolbarStrokeWidth({strokeWidth:e,value:e,label:String(e)}),this.updateToolbarLineStyleType(Ja.find(o=>o.value===i)??Ja[0])}clear(){this.cancel(),this.deleteAll(),this.reset()}reset(){this.state.transition("reset")}cancel(){this.state.transition("cancel")}delete(){this.state.transition("delete")}deleteAll(){this.state.transition("deleteAll")}deleteEphemeralAnnotations(){for(const[t,e]of this.annotationData.entries())fo(e)&&this.annotationData.splice(t,1)}hideOverlays(){this.colorPicker.hide({lastFocus:null}),this.textSizeMenu.hide(),this.lineStyleTypeMenu.hide(),this.lineStrokeWidthMenu.hide(),this.annotationMenu.hide(),this.settingsDialog.hide()}resetToolbarButtonStates(){const{ctx:{toolbarManager:t}}=this;for(const e of gA)t.toggleButton("annotations",e,{active:!1});for(const e of yA)t.toggleButton("annotations",e,{active:!1})}update(t=XI.PRE_SCENE_RENDER){this.ctx.updateService.update(t,{skipAnimations:!0})}};d([ZI((t,e,i)=>{const{ctx:{annotationManager:o,stateManager:s,toolbarManager:a}}=t;e!==i&&(a.toggleGroup("annotations","annotations",{visible:!!e}),i===!1&&e===!0?s.restoreState(o):e===!1&&t.clear())}),QI(jI)],qy.prototype,"enabled",2);var Oi={stroke:ot.DEFAULT_ANNOTATION_COLOR,strokeOpacity:1,strokeWidth:2},xe={fill:ot.DEFAULT_ANNOTATION_HANDLE_FILL,strokeOpacity:1,strokeWidth:2},yr={color:ot.DEFAULT_TEXT_ANNOTATION_COLOR,fontSize:14,fontFamily:ot.DEFAULT_FONT_FAMILY},Jy={...yr,enabled:!0,color:"white",fill:ot.DEFAULT_ANNOTATION_COLOR,fontSize:12},fr={...yr,color:ot.DEFAULT_TEXT_ANNOTATION_COLOR,textAlign:"left"},qo={...yr,position:"top",alignment:"center",color:ot.DEFAULT_ANNOTATION_COLOR},Dh={...yr,fontSize:12,color:ot.DEFAULT_ANNOTATION_STATISTICS_COLOR,fill:ot.DEFAULT_ANNOTATION_STATISTICS_FILL,stroke:ot.DEFAULT_ANNOTATION_STATISTICS_STROKE,strokeWidth:1,divider:{stroke:ot.DEFAULT_ANNOTATION_STATISTICS_DIVIDER_STROKE,strokeWidth:1,strokeOpacity:.5}},kh={...Oi,background:{fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...xe},text:{...qo},statistics:{...Dh}},eN={type:"root",optionsKey:"annotations",packageType:"enterprise",chartTypes:["cartesian"],dependencies:["toolbar"],moduleFactory:t=>new qy(t),themeTemplate:{annotations:{line:{...Oi,handle:{...xe},text:{...qo}},"horizontal-line":{...Oi,handle:{...xe},axisLabel:{...Jy},text:{...qo}},"vertical-line":{...Oi,handle:{...xe},axisLabel:{...Jy},text:{...qo}},"disjoint-channel":{...Oi,background:{fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...xe},text:{...qo}},"parallel-channel":{...Oi,middle:{lineDash:[6,5],strokeWidth:1},background:{fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},handle:{...xe},text:{...qo}},callout:{...Oi,...fr,color:ot.DEFAULT_LABEL_COLOUR,handle:{...xe},fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2},comment:{...fr,color:"white",fontWeight:700,handle:{...xe},fill:ot.DEFAULT_ANNOTATION_COLOR},note:{...fr,color:ot.DEFAULT_TEXTBOX_COLOR,fill:ot.DEFAULT_ANNOTATION_COLOR,stroke:ot.DEFAULT_ANNOTATION_HANDLE_FILL,strokeWidth:1,strokeOpacity:1,handle:{...xe},background:{fill:ot.DEFAULT_TEXTBOX_FILL,stroke:ot.DEFAULT_TEXTBOX_STROKE,strokeWidth:1}},text:{...fr,handle:{...xe}},arrow:{...Oi,handle:{...xe},text:{...qo}},"arrow-up":{fill:ot.PALETTE_UP_FILL,handle:{...xe,stroke:ot.DEFAULT_ANNOTATION_COLOR}},"arrow-down":{fill:ot.PALETTE_DOWN_FILL,handle:{...xe,stroke:ot.DEFAULT_ANNOTATION_COLOR}},"date-range":{...kh},"price-range":{...kh},"date-price-range":{...kh},"quick-date-price-range":{up:{...Oi,fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,fillOpacity:.2,handle:{...xe},statistics:{...Dh,color:"#fff",fill:ot.DEFAULT_ANNOTATION_BACKGROUND_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}},down:{...Oi,stroke:ot.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE,fill:ot.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,fillOpacity:.2,handle:{...xe,stroke:ot.DEFAULT_ANNOTATION_STATISTICS_DOWN_STROKE},statistics:{...Dh,color:"#fff",fill:ot.DEFAULT_ANNOTATION_STATISTICS_DOWN_FILL,strokeWidth:0,divider:{stroke:"#fff",strokeWidth:1,strokeOpacity:.5}}}}}}};import{_ModuleSupport as Ih}from"ag-charts-community";import{_ModuleSupport as iN,_Scene as oN}from"ag-charts-community";var{BaseProperties:sN,ObserveChanges:aN,ProxyProperty:nN,Validate:Jo,NUMBER:mr,POSITIVE_NUMBER:tf,RATIO:rN,createElement:lN,calculatePlacement:cN}=iN,Li=class extends sN{constructor(){super(),this.opacity=1,this.loadedSynchronously=!0,this.containerWidth=0,this.containerHeight=0,this.onLoad=void 0,this.onImageLoad=()=>{this.loadedSynchronously||(this.node.visible=!1,this.performLayout(this.containerWidth,this.containerHeight),this.onLoad?.())},this.imageElement=lN("img"),this.imageElement.onload=this.onImageLoad,this.node=new oN.Image(this.imageElement)}get complete(){return this.imageElement.width>0&&this.imageElement.height>0}performLayout(t,e){this.containerWidth=t,this.containerHeight=e;const i={x:0,y:0,width:t,height:e},o=cN(this.imageElement.width,this.imageElement.height,i,this);return this.node.setProperties(this.complete?{visible:!0,opacity:this.opacity,...o}:{visible:!1}),o}};d([Jo(mr,{optional:!0})],Li.prototype,"top",2),d([Jo(mr,{optional:!0})],Li.prototype,"right",2),d([Jo(mr,{optional:!0})],Li.prototype,"bottom",2),d([Jo(mr,{optional:!0})],Li.prototype,"left",2),d([Jo(tf,{optional:!0})],Li.prototype,"width",2),d([Jo(tf,{optional:!0})],Li.prototype,"height",2),d([Jo(rN)],Li.prototype,"opacity",2),d([nN("imageElement.src"),aN(t=>t.loadedSynchronously=t.complete)],Li.prototype,"url",2);var{ActionOnSet:hN,OBJECT:dN,Validate:pN}=Ih,ef=class extends Ih.Background{constructor(){super(...arguments),this.image=new Li}onLayoutComplete(t){if(super.onLayoutComplete(t),this.image){const{width:e,height:i}=t.chart;this.image.performLayout(e,i)}}onImageLoad(){this.ctx.updateService.update(Ih.ChartUpdateType.SCENE_RENDER)}};d([pN(dN,{optional:!0}),hN({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],ef.prototype,"image",2);var uN={type:"root",optionsKey:"background",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new ef(t)};import"ag-charts-community";import{_ModuleSupport as of}from"ag-charts-community";var{ActionOnSet:gN,Validate:yN,BOOLEAN:fN}=of,Nh=[{label:"toolbarSeriesTypeOHLC",icon:"ohlc-series",value:"ohlc"},{label:"toolbarSeriesTypeCandles",icon:"candlestick-series",value:"candlestick"},{label:"toolbarSeriesTypeHollowCandles",icon:"hollow-candlestick-series",value:"hollow-candlestick"},{label:"toolbarSeriesTypeLine",icon:"line-series",value:"line"},{label:"toolbarSeriesTypeStepLine",icon:"step-line-series",value:"step-line"},{label:"toolbarSeriesTypeHLC",icon:"hlc-series",value:"hlc"},{label:"toolbarSeriesTypeHighLow",icon:"high-low-series",value:"high-low"}],ts="seriesType",xr="type",sf=class extends of.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.menu=new Ha(this.ctx,"chart-toolbar"),this.destroyFns.push(t.layoutManager.addListener("layout:complete",this.onLayoutComplete.bind(this)),t.toolbarManager.addListener("button-moved",this.onToolbarButtonMoved.bind(this)),t.toolbarManager.addListener("button-pressed",this.onToolbarButtonPressed.bind(this)))}onEnableChanged(t){this.ctx.toolbarManager.toggleGroup("chart-toolbar",ts,{visible:t})}onLayoutComplete(){if(!this.enabled)return;const t=this.getChartType(),e=Nh.find(i=>i.value===t)?.icon;e!=null&&this.ctx.toolbarManager.updateButton(ts,xr,{icon:e})}setAnchor(t){this.menu.setAnchor({x:t.x+t.width+6,y:t.y})}onToolbarButtonMoved(t){t.group===ts&&this.setAnchor(t.rect)}onToolbarButtonPressed(t){t.group===ts&&(this.setAnchor(t.rect),this.menu.show({items:Nh,menuItemRole:"menuitemradio",ariaLabel:this.ctx.localeManager.t("toolbarSeriesTypeDropdown"),value:this.getChartType(),sourceEvent:t.sourceEvent,onPress:e=>{this.setChartType(e.value),this.hidePopover()},onHide:()=>{this.ctx.toolbarManager.toggleButton(ts,xr,{active:!1})}}),this.ctx.toolbarManager.toggleButton(ts,xr,{active:!0}))}hidePopover(){this.ctx.toolbarManager.toggleButton(ts,xr,{active:!1}),this.menu.hide()}setChartType(t){const e={chartType:t};this.ctx.chartService.publicApi?.updateDelta(e)}getChartType(){const t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return t==null||!Nh.some(e=>e.value===t)?"candlestick":t}};d([yN(fN),gN({changeValue:function(t){this.onEnableChanged(t)}})],sf.prototype,"enabled",2);var mN={type:"root",optionsKey:"chartToolbar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new sf(t)};import{_Theme as xN}from"ag-charts-community";import{_ModuleSupport as aa,_Util as af}from"ag-charts-community";var Sr="ag-chart-context-menu",br="ag-charts-dark-context-menu",{BOOLEAN:nf,Validate:rf,createElement:Oh,initMenuKeyNav:SN,makeAccessibleClickListener:bN,ContextMenuRegistry:vr}=aa,{Logger:vN}=af,Lh="context-menu";function MN(t,e){const{children:i}=t??{};if(!i)return[];const o=[];for(let s=0;s<i.length;s++){const a=i[s];a instanceof e&&o.push(a)}return o}var Ch=class extends aa.BaseModuleInstance{constructor(t){if(super(),this.ctx=t,this.enabled=!0,this.darkTheme=!1,this.extraActions=[],this.extraNodeActions=[],this.extraLegendItemActions=[],this.x=0,this.y=0,this.interactionManager=t.interactionManager,this.registry=t.contextMenuRegistry,this.groups={default:[],extra:[],extraSeries:[],extraNode:[],extraLegendItem:[]},this.element=t.domManager.addChild("canvas-overlay",Lh),this.element.classList.add(Sr),this.element.addEventListener("contextmenu",e=>e.preventDefault()),this.destroyFns.push(()=>this.element.parentNode?.removeChild(this.element)),this.doClose(),this.destroyFns.push(t.domManager.addListener("hidden",()=>this.hide())),typeof MutationObserver<"u"){const e=new MutationObserver(()=>{this.menuElement&&this.element.contains(this.menuElement)&&this.reposition()});e.observe(this.element,{childList:!0}),this.mutationObserver=e,this.destroyFns.push(()=>e.disconnect())}this.destroyFns.push(this.registry.registerDefaultAction({id:"download",type:"all",label:"contextMenuDownload",action:()=>{const e=t.chartService.title;let i="image";e?.enabled&&e?.text!==void 0&&(i=e.text.replace(/\.+/,"")),this.ctx.chartService.publicApi?.download({fileName:i}).catch(o=>{vN.error("Unable to download chart",o)})}})),this.destroyFns.push(this.registry.addListener(e=>this.onContext(e)))}onContext(t){if(!this.enabled)return;t.preventDefault(),this.showEvent=t.sourceEvent,this.x=t.x,this.y=t.y,this.groups.default=this.registry.filterActions(t.type),this.pickedNode=void 0,this.pickedLegendItem=void 0,this.groups.extra=this.extraActions.map(({label:n,action:r})=>({type:"all",label:n,action:r})),vr.check("series",t)&&(this.pickedNode=t.context.pickedNode,this.pickedNode&&(this.groups.extraNode=this.extraNodeActions.map(({label:n,action:r})=>({type:"node",label:n,action:r})))),vr.check("legend",t)&&(this.pickedLegendItem=t.context.legendItem,this.pickedLegendItem&&(this.groups.extraLegendItem=this.extraLegendItemActions.map(({label:n,action:r})=>({type:"legend",label:n,action:r}))));const{default:e,extra:i,extraNode:o,extraLegendItem:s}=this.groups;[e,i,o,s].reduce((n,r)=>r.length+n,0)!==0&&this.show(t.sourceEvent)}show(t){this.interactionManager.pushState(aa.InteractionState.ContextMenu),this.element.classList.toggle(br,this.darkTheme);const e=this.renderMenu();this.menuCloser?.close(),this.menuElement?this.element.replaceChild(e,this.menuElement):this.element.appendChild(e),this.menuElement=e,this.element.style.display="block";const i=MN(e,HTMLButtonElement);this.menuCloser=SN({menu:e,buttons:i,orientation:"vertical",sourceEvent:t,autoCloseOnBlur:!0,closeCallback:()=>this.doClose()})}hide(){this.menuCloser?.close()}doClose(){this.interactionManager.popState(aa.InteractionState.ContextMenu),this.menuElement&&(this.element.removeChild(this.menuElement),this.menuElement=void 0,this.menuCloser=void 0),this.element.style.display="none"}renderMenu(){const t=Oh("div");return t.classList.add(`${Sr}__menu`),t.classList.toggle(br,this.darkTheme),t.role="menu",this.appendMenuGroup(t,this.groups.default,!1),this.appendMenuGroup(t,this.groups.extra),this.pickedNode&&this.appendMenuGroup(t,this.groups.extraNode),this.pickedLegendItem&&this.appendMenuGroup(t,this.groups.extraLegendItem),t}appendMenuGroup(t,e,i=!0){e.length!==0&&(i&&t.appendChild(this.createDividerElement()),e.forEach(o=>{const s=this.renderItem(o);s&&t.appendChild(s)}))}renderItem(t){if(t&&typeof t=="object"&&t.constructor===Object)return this.createActionElement(t)}createDividerElement(){const t=Oh("div");return t.classList.add(`${Sr}__divider`),t.classList.toggle(br,this.darkTheme),t.role="separator",t}createActionElement({id:t,label:e,type:i,action:o}){const s=!!(t&&this.registry.isDisabled(t));return this.createButtonElement(i,e,o,s)}createButtonOnClick(t,e){return vr.checkCallback("legend",t,e)?i=>{if(this.pickedLegendItem){const{seriesId:o,itemId:s,enabled:a}=this.pickedLegendItem;e({type:"contextmenu",seriesId:o,itemId:s,enabled:a,event:i}),this.hide()}}:vr.checkCallback("node",t,e)?()=>{const{pickedNode:i,showEvent:o}=this,s=i?.series.createNodeContextMenuActionEvent(o,i);s?e(s):af.Logger.error("series node not found"),this.hide()}:()=>{e({type:"contextMenuEvent",event:this.showEvent}),this.hide()}}createButtonElement(t,e,i,o){const s=Oh("button");return s.classList.add(`${Sr}__item`),s.classList.toggle(br,this.darkTheme),s.ariaDisabled=o.toString(),s.textContent=this.ctx.localeManager.t(e),s.role="menuitem",s.onclick=bN(s,this.createButtonOnClick(t,i)),s.addEventListener("mouseover",()=>s.focus()),s}reposition(){let{x:t,y:e}=this;this.element.style.top="unset",this.element.style.bottom="unset";const i=this.ctx.domManager.getBoundingClientRect(),{offsetWidth:o,offsetHeight:s}=this.element;t=aa.clamp(0,t,i.width-o),e=aa.clamp(0,e,i.height-s),this.element.style.left=`${t}px`,this.element.style.top=`calc(${e}px - 0.5em)`}destroy(){super.destroy(),this.mutationObserver?.disconnect(),this.ctx.domManager.removeStyles(Lh),this.ctx.domManager.removeChild("canvas-overlay",Lh)}};d([rf(nf)],Ch.prototype,"enabled",2),d([rf(nf)],Ch.prototype,"darkTheme",2);var TN={type:"root",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],optionsKey:"contextMenu",moduleFactory:t=>new Ch(t),themeTemplate:{contextMenu:{enabled:!0,darkTheme:xN.IS_DARK_THEME}}};import{_Theme as AN}from"ag-charts-community";import{_ModuleSupport as Mr,_Scene as lf,_Util as DN}from"ag-charts-community";import{_ModuleSupport as kN,_Scene as cf,_Util as hf}from"ag-charts-community";var{ActionOnSet:IN,BaseProperties:NN,BOOLEAN:df,FUNCTION:pf,NUMBER:Tr,STRING:Ar,Validate:Ye}=kN,{setAttribute:ON}=hf,LN="ag-crosshair-label",es=class extends cf.ChangeDetectableProperties{constructor(){super(...arguments),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.format=void 0,this.renderer=void 0}};d([Ye(df)],es.prototype,"enabled",2),d([Ye(Ar,{optional:!0})],es.prototype,"className",2),d([Ye(Tr)],es.prototype,"xOffset",2),d([Ye(Tr)],es.prototype,"yOffset",2),d([Ye(Ar,{optional:!0})],es.prototype,"format",2),d([Ye(pf,{optional:!0})],es.prototype,"renderer",2);var is=class extends NN{constructor(t,e,i){super(),this.domManager=t,this.id=hf.createId(this),this.enabled=!0,this.xOffset=0,this.yOffset=0,this.renderer=void 0,this.element=t.addChild("canvas-overlay",`crosshair-label-${this.id}`),this.element.classList.add(LN),ON(this.element,"aria-hidden",!0),this.element.setAttribute("data-key",e),this.element.setAttribute("data-axis-id",i)}show(t){const{element:e}=this,i=t.x+this.xOffset,o=t.y+this.yOffset;e.style.top=`${Math.round(o)}px`,e.style.left=`${Math.round(i)}px`,this.toggle(!0)}setLabelHtml(t){t!==void 0&&(this.element.innerHTML=t)}getBBox(){const{element:t}=this;return new cf.BBox(t.clientLeft,t.clientTop,t.clientWidth,t.clientHeight)}toggle(t){this.element.classList.toggle("ag-crosshair-label-hidden",!t)}destroy(){this.domManager.removeChild("canvas-overlay",`crosshair-label-${this.id}`)}toLabelHtml(t,e){if(typeof t=="string")return t;e=e??{};const{text:i=e.text??"",color:o=e.color,backgroundColor:s=e.backgroundColor,opacity:a=e.opacity??1}=t;return`<div class="ag-crosshair-label-content" style="${`opacity: ${a}; background-color: ${s?.toLowerCase()}; color: ${o}`}">
                    <span>${i}</span>
                </div>`}};d([Ye(df)],is.prototype,"enabled",2),d([Ye(Ar,{optional:!0}),IN({changeValue(t,e){t!==e&&(e&&this.element.classList.remove(e),t&&this.element.classList.add(t))}})],is.prototype,"className",2),d([Ye(Tr)],is.prototype,"xOffset",2),d([Ye(Tr)],is.prototype,"yOffset",2),d([Ye(Ar,{optional:!0})],is.prototype,"format",2),d([Ye(pf,{optional:!0})],is.prototype,"renderer",2);var{Group:CN,TranslatableLayer:EN,Line:uf,BBox:Eh}=lf,{createId:_N}=DN,{POSITIVE_NUMBER:gf,RATIO:RN,BOOLEAN:yf,COLOR_STRING:wN,LINE_DASH:PN,OBJECT:BN,InteractionState:en,Validate:To,ZIndexMap:ff}=Mr,Qi=class extends Mr.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.id=_N(this),this.enabled=!1,this.stroke="rgb(195, 195, 195)",this.lineDash=[6,3],this.lineDashOffset=0,this.strokeWidth=1,this.strokeOpacity=1,this.snap=!0,this.label=new es,this.seriesRect=new Eh(0,0,0,0),this.hoverRect=new Eh(0,0,0,0),this.bounds=new Eh(0,0,0,0),this.crosshairGroup=new EN({name:"crosshairs",zIndex:ff.SERIES_CROSSHAIR}),this.lineGroup=this.crosshairGroup.appendChild(new CN({name:`${this.id}-crosshair-lines`,zIndex:ff.SERIES_CROSSHAIR})),this.lineGroupSelection=lf.Selection.select(this.lineGroup,uf,!1),this.activeHighlight=void 0,this.axisCtx=t.parent,this.labels={};const e=t.regionManager.getRegion("series"),i=en.Default|en.Annotations|en.AnnotationsSelected;this.hideCrosshairs(),this.destroyFns.push(t.scene.attachNode(this.crosshairGroup),e.addListener("hover",o=>this.onMouseMove(o),i),e.addListener("drag",o=>this.onMouseMove(o),en.Annotations|en.AnnotationsSelected),e.addListener("leave",()=>this.onMouseOut(),i),t.keyNavManager.addListener("nav-hori",()=>this.onKeyPress()),t.keyNavManager.addListener("nav-vert",()=>this.onKeyPress()),t.zoomManager.addListener("zoom-pan-start",()=>this.onMouseOut()),t.zoomManager.addListener("zoom-change",()=>this.onMouseOut()),t.highlightManager.addListener("highlight-change",o=>this.onHighlightChange(o)),t.layoutManager.addListener("layout:complete",o=>this.layout(o)),()=>Object.entries(this.labels).forEach(([o,s])=>s.destroy()))}layout({series:{rect:t,paddedRect:e,visible:i},axes:o}){if(!(i&&o&&this.enabled))return;this.seriesRect=t,this.hoverRect=e;const{position:s="left",axisId:a}=this.axisCtx,n=o.find(p=>p.id===a);if(!n)return;this.axisLayout=n;const r=n.gridPadding+n.seriesAreaPadding;this.bounds=yg(t,s,r);const{crosshairGroup:l,bounds:c}=this;l.translationX=Math.round(c.x),l.translationY=Math.round(c.y);const h=["pointer",...this.axisCtx.seriesKeyProperties()];this.updateSelections(h),this.updateLines(),this.updateLabels(h)}updateSelections(t){this.lineGroupSelection.update(t,e=>e.append(new uf),e=>e)}updateLabels(t){const{labels:e,ctx:i}=this;t.forEach(o=>{e[o]??(e[o]=new is(i.domManager,o,this.axisCtx.axisId)),this.updateLabel(e[o])}),this.labelFormatter=this.axisCtx.scaleValueFormatter(this.label.format)}updateLabel(t){const{enabled:e,className:i,xOffset:o,yOffset:s,format:a,renderer:n}=this.label;t.enabled=e,t.className=i,t.xOffset=o,t.yOffset=s,t.format=a,t.renderer=n}updateLines(){const{lineGroupSelection:t,bounds:e,stroke:i,strokeWidth:o,strokeOpacity:s,lineDash:a,lineDashOffset:n,axisLayout:r}=this;if(!r)return;const l=this.isVertical();t.each(c=>{c.stroke=i,c.strokeWidth=o,c.strokeOpacity=s,c.lineDash=a,c.lineDashOffset=n,c.y1=0,c.y2=l?e.height:0,c.x1=0,c.x2=l?0:e.width})}isVertical(){return this.axisCtx.direction==="x"}formatValue(t){const{labelFormatter:e,axisLayout:i,ctx:{callbackCache:o}}=this;if(e){const n=o.call(e,t);if(n!==void 0)return n}const s=t%1===0,a=(i?.label.fractionDigits??0)+(s?0:1);return typeof t=="number"?t.toFixed(a):String(t)}onMouseMove(t){if(!this.enabled||this.snap)return;const{crosshairGroup:e,hoverRect:i}=this,{offsetX:o,offsetY:s}=t;if(i.containsPoint(o,s)){const a=this.getData(t);this.updatePositions(a),e.visible=!0}else this.hideCrosshairs();this.ctx.updateService.update(Mr.ChartUpdateType.SCENE_RENDER)}onMouseOut(){this.hideCrosshairs(),this.ctx.updateService.update(Mr.ChartUpdateType.SCENE_RENDER)}onKeyPress(){this.enabled&&!this.snap&&this.hideCrosshairs()}onHighlightChange(t){if(!this.enabled)return;const{crosshairGroup:e,axisCtx:i}=this,{datum:o,series:s}=t.currentHighlight??{},a=o&&(s?.axes.x?.id===i.axisId||s?.axes.y?.id===i.axisId);if(this.activeHighlight=a?t.currentHighlight:void 0,!this.activeHighlight)this.hideCrosshairs();else if(this.snap){const n=this.getActiveHighlightData(this.activeHighlight);this.updatePositions(n),e.visible=!0}}isInRange(t){return this.axisCtx.inRange(t)}updatePositions(t){const{seriesRect:e,lineGroupSelection:i}=this;i.each((o,s)=>{const a=t[s];if(!a){o.visible=!1;return}o.visible=!0;const{value:n,position:r}=a;let l=0,c=0;this.isVertical()?(l=r,o.x=Math.round(l)):(c=r,o.y=Math.round(c)),this.label.enabled?this.showLabel(l+e.x,c+e.y,n,s):this.hideLabel(s)})}getData(t){const{axisCtx:e}=this,i="pointer",{datum:o,xKey:s="",yKey:a=""}=this.activeHighlight??{},{regionOffsetX:n,regionOffsetY:r}=t,l=this.isVertical(),c=l?n:r;return{[i]:{position:c,value:e.continuous?e.scaleInvert(c):o?.[l?s:a]??""}}}getActiveHighlightData(t){const{axisCtx:e}=this,{datum:i,series:o,xKey:s="",aggregatedValue:a,cumulativeValue:n,midPoint:r}=t,l=o.getKeyProperties(e.direction),c=e.scaleBandwidth()/2,h=o.axes[e.direction]?.id===e.axisId,p=l.indexOf("yKey")>-1&&h,u=l.indexOf("xKey")>-1&&h,y=a??n;if(p&&y!==void 0){const f=e.scaleConvert(y)+c;return this.isInRange(f)?{yKey:{value:y,position:f}}:{}}if(u){const f=(this.isVertical()?r?.x:r?.y)??0,m=e.continuous?e.scaleInvert(f):i[s];return this.isInRange(f)?{xKey:{value:m,position:f}}:{}}const g={};return l.forEach(f=>{const m=o.properties[f],v=i[m],b=e.scaleConvert(v)+c;this.isInRange(b)&&(g[f]={value:v,position:b})}),g}getLabelHtml(t,e){const{label:{renderer:i},axisLayout:{label:{fractionDigits:o=0}={}}={}}=this,s={text:this.formatValue(t)};if(i){const a={value:t,fractionDigits:o};return e.toLabelHtml(i(a),s)}return e.toLabelHtml(s)}showLabel(t,e,i,o){const{axisCtx:{position:s,direction:a},bounds:n,axisLayout:r}=this;if(!r)return;const{label:{padding:l},tickSize:c}=r,h=l+c,p=this.labels[o],u=this.getLabelHtml(i,p);p.setLabelHtml(u);const y=p.getBBox(),g=tA({x:t,y:e,labelBBox:y,bounds:n,axisPosition:s,axisDirection:a,padding:h});p.show(g)}hideCrosshairs(){this.crosshairGroup.visible=!1;for(const t in this.labels)this.hideLabel(t)}hideLabel(t){this.labels[t].toggle(!1)}};d([To(yf)],Qi.prototype,"enabled",2),d([To(wN,{optional:!0})],Qi.prototype,"stroke",2),d([To(PN,{optional:!0})],Qi.prototype,"lineDash",2),d([To(gf)],Qi.prototype,"lineDashOffset",2),d([To(gf)],Qi.prototype,"strokeWidth",2),d([To(RN)],Qi.prototype,"strokeOpacity",2),d([To(yf)],Qi.prototype,"snap",2),d([To(BN)],Qi.prototype,"label",2);var zN={type:"axis-option",optionsKey:"crosshair",packageType:"enterprise",chartTypes:["cartesian"],axisTypes:["category","ordinal-time","number","log","time"],moduleFactory:t=>new Qi(t),themeTemplate:{crosshair:{snap:!0,stroke:AN.DEFAULT_MUTED_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,lineDash:[5,6],lineDashOffset:0,label:{enabled:!0}}}};import{_ModuleSupport as mf}from"ag-charts-community";var{BOOLEAN:FN,FUNCTION:VN,ActionOnSet:on,Validate:xf}=mf,na=class extends mf.BaseModuleInstance{constructor(t){super(),this.enabled=!1,this.getData=()=>Promise.resolve(),this.dataService=t.dataService}updateCallback(t,e){this.dataService&&(t&&e!=null?this.dataService.updateCallback(e):this.dataService.clearCallback())}};d([on({newValue(t){this.updateCallback(t,this.getData)}}),xf(FN)],na.prototype,"enabled",2),d([on({newValue(t){this.updateCallback(this.enabled,t)}}),xf(VN)],na.prototype,"getData",2),d([on({newValue(t){this.dataService.requestThrottle=t}})],na.prototype,"requestThrottle",2),d([on({newValue(t){this.dataService.dispatchThrottle=t}})],na.prototype,"updateThrottle",2),d([on({newValue(t){this.dataService.dispatchOnlyLatest=!t}})],na.prototype,"updateDuringInteraction",2);var UN={type:"root",optionsKey:"dataSource",packageType:"enterprise",chartTypes:["cartesian","hierarchy","polar","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new na(t),themeTemplate:{dataSource:{enabled:!1}}};import{AgErrorBarSupportedSeriesTypes as HN}from"ag-charts-community";import{AgErrorBarSupportedSeriesTypes as Sf,_ModuleSupport as _h,_Scene as GN,_Util as WN}from"ag-charts-community";import{_ModuleSupport as KN,_Scene as sn}from"ag-charts-community";var{nearestSquaredInContainer:YN,partialAssign:jN,mergeDefaults:bf}=KN,{BBox:qi}=sn,XN=class{constructor(t){this.components=t,this.union=qi.merge(t)}containsPoint(t,e){if(!this.union.containsPoint(t,e))return!1;for(const i of this.components)if(i.containsPoint(t,e))return!0;return!1}},ZN=class extends sn.Group{constructor(){super(),this.capLength=NaN,this._datum=void 0,this.whiskerPath=new sn.Path,this.capsPath=new sn.Path,this.bboxes=new XN([]),this.append([this.whiskerPath,this.capsPath])}get datum(){return this._datum}set datum(t){this._datum=t}calculateCapLength(t,e){const{lengthRatio:i=1,length:o}=t,{lengthRatioMultiplier:s,lengthMax:a}=e,n=o??i*s;return Math.min(n,a)}getItemStylerParams(t,e,i){const{datum:o}=this;if(o==null||t.itemStyler==null)return;const{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r}=t;return{...e,datum:o.datum,seriesId:o.datum.seriesId,xKey:o.xKey,yKey:o.yKey,xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,highlighted:i}}formatStyles(t,e,i){let{cap:o,...s}=t;const a=this.getItemStylerParams(e,t,i);if(a!=null&&e.itemStyler!=null){const n=e.itemStyler(a);s=bf(n,s),o=bf(n?.cap,n,o)}return{whiskerStyle:s,capsStyle:o}}applyStyling(t,e){jN(["visible","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],t,e)}update(t,e,i){if(this.datum===void 0)return;const{whiskerStyle:o,capsStyle:s}=this.formatStyles(t,e,i),{xBar:a,yBar:n,capDefaults:r}=this.datum,l=this.whiskerPath;this.applyStyling(l,o),l.path.clear(!0),n!==void 0&&(l.path.moveTo(n.lowerPoint.x,n.lowerPoint.y),l.path.lineTo(n.upperPoint.x,n.upperPoint.y)),a!==void 0&&(l.path.moveTo(a.lowerPoint.x,a.lowerPoint.y),l.path.lineTo(a.upperPoint.x,a.upperPoint.y)),l.path.closePath(),this.capLength=this.calculateCapLength(s??{},r);const c=this.capLength/2,h=this.capsPath;this.applyStyling(h,s),h.path.clear(!0),n!==void 0&&(h.path.moveTo(n.lowerPoint.x-c,n.lowerPoint.y),h.path.lineTo(n.lowerPoint.x+c,n.lowerPoint.y),h.path.moveTo(n.upperPoint.x-c,n.upperPoint.y),h.path.lineTo(n.upperPoint.x+c,n.upperPoint.y)),a!==void 0&&(h.path.moveTo(a.lowerPoint.x,a.lowerPoint.y-c),h.path.lineTo(a.lowerPoint.x,a.lowerPoint.y+c),h.path.moveTo(a.upperPoint.x,a.upperPoint.y-c),h.path.lineTo(a.upperPoint.x,a.upperPoint.y+c)),h.path.closePath()}updateBBoxes(){const{capLength:t,whiskerPath:e,capsPath:i}=this,{yBar:o,xBar:s}=this.datum??{},a=t/2,n=[];if(o!==void 0){const r=o.lowerPoint.y-o.upperPoint.y;n.push(new qi(o.lowerPoint.x,o.upperPoint.y,e.strokeWidth,r),new qi(o.lowerPoint.x-a,o.lowerPoint.y,t,i.strokeWidth),new qi(o.upperPoint.x-a,o.upperPoint.y,t,i.strokeWidth))}if(s!==void 0){const r=s.upperPoint.x-s.lowerPoint.x;n.push(new qi(s.lowerPoint.x,s.upperPoint.y,r,e.strokeWidth),new qi(s.lowerPoint.x,s.lowerPoint.y-a,i.strokeWidth,t),new qi(s.upperPoint.x,s.upperPoint.y-a,i.strokeWidth,t))}this.bboxes.components=n,this.bboxes.union=qi.merge(n)}containsPoint(t,e){return this.bboxes.containsPoint(t,e)}pickNode(t,e){return this.containsPoint(t,e)?this:void 0}nearestSquared(t,e,i){const{bboxes:o}=this;if(o.union.distanceSquared(t,e)>i)return{nearest:void 0,distanceSquared:1/0};const{distanceSquared:s}=qi.nearestBox(t,e,o.components);return{nearest:this,distanceSquared:s}}},$N=class extends sn.Group{nearestSquared(t,e){const{nearest:i,distanceSquared:o}=YN(t,e,{children:this.children()});if(i!==void 0&&!isNaN(o))return{datum:i.datum,distanceSquared:o}}};import{_ModuleSupport as QN}from"ag-charts-community";var{BaseProperties:vf,Validate:St,BOOLEAN:Mf,COLOR_STRING:Tf,FUNCTION:qN,LINE_DASH:Af,NUMBER:JN,OBJECT:t0,POSITIVE_NUMBER:Dr,RATIO:Rh,STRING:Ao}=QN,Ji=class extends vf{};d([St(Mf,{optional:!0})],Ji.prototype,"visible",2),d([St(Tf,{optional:!0})],Ji.prototype,"stroke",2),d([St(Dr,{optional:!0})],Ji.prototype,"strokeWidth",2),d([St(Rh,{optional:!0})],Ji.prototype,"strokeOpacity",2),d([St(Af,{optional:!0})],Ji.prototype,"lineDash",2),d([St(Dr,{optional:!0})],Ji.prototype,"lineDashOffset",2),d([St(JN,{optional:!0})],Ji.prototype,"length",2),d([St(Rh,{optional:!0})],Ji.prototype,"lengthRatio",2);var $t=class extends vf{constructor(){super(...arguments),this.visible=!0,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.cap=new Ji}};d([St(Ao,{optional:!0})],$t.prototype,"yLowerKey",2),d([St(Ao,{optional:!0})],$t.prototype,"yLowerName",2),d([St(Ao,{optional:!0})],$t.prototype,"yUpperKey",2),d([St(Ao,{optional:!0})],$t.prototype,"yUpperName",2),d([St(Ao,{optional:!0})],$t.prototype,"xLowerKey",2),d([St(Ao,{optional:!0})],$t.prototype,"xLowerName",2),d([St(Ao,{optional:!0})],$t.prototype,"xUpperKey",2),d([St(Ao,{optional:!0})],$t.prototype,"xUpperName",2),d([St(Mf,{optional:!0})],$t.prototype,"visible",2),d([St(Tf,{optional:!0})],$t.prototype,"stroke",2),d([St(Dr,{optional:!0})],$t.prototype,"strokeWidth",2),d([St(Rh,{optional:!0})],$t.prototype,"strokeOpacity",2),d([St(Af,{optional:!0})],$t.prototype,"lineDash",2),d([St(Dr,{optional:!0})],$t.prototype,"lineDashOffset",2),d([St(qN,{optional:!0})],$t.prototype,"itemStyler",2),d([St(t0)],$t.prototype,"cap",2);var{fixNumericExtent:e0,groupAccumulativeValueProperty:i0,isDefined:Ne,mergeDefaults:o0,valueProperty:kr,ChartAxisDirection:wh}=_h;function s0(t){for(const e of Sf)if(e===t.series.type)return t.series;throw new Error(`AG Charts - unsupported series type '${t.series.type}', error bars supported series types: ${Sf.join(", ")}`)}var a0=class Un extends _h.BaseModuleInstance{constructor(e){super(),this.properties=new $t;const i=s0(e),{annotationGroup:o,annotationSelections:s}=i;this.cartesianSeries=i,this.groupNode=new $N({name:`${o.id}-errorBars`,zIndex:_h.ZIndexMap.SERIES_LAYER,zIndexSubOrder:i.getGroupZIndexSubOrder("annotation")}),o.appendChild(this.groupNode),this.selection=GN.Selection.select(this.groupNode,()=>this.errorBarFactory()),s.add(this.selection),this.destroyFns.push(i.addListener("data-processed",a=>this.onDataProcessed(a)),i.addListener("data-update",a=>this.onDataUpdate(a)),i.addListener("visibility-changed",a=>this.onToggleSeriesItem(a)),e.highlightManager.addListener("highlight-change",a=>this.onHighlightChange(a)),()=>o.removeChild(this.groupNode),()=>s.delete(this.selection))}hasErrorBars(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties;return Ne(e)&&Ne(i)||Ne(o)&&Ne(s)}isStacked(){const e=this.cartesianSeries.seriesGrouping?.stackCount;return e==null?!1:e>0}getUnstackPropertyDefinition(e){const i=[],{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n,xErrorsID:r,yErrorsID:l}=this.getMaybeFlippedKeys(),{xScaleType:c,yScaleType:h}=e;return a!=null&&n!=null&&i.push(kr(a,h,{id:`${l}-lower`}),kr(n,h,{id:`${l}-upper`})),o!=null&&s!=null&&i.push(kr(o,c,{id:`${r}-lower`}),kr(s,c,{id:`${r}-upper`})),i}getStackPropertyDefinition(e){const i=[],{cartesianSeries:o}=this,{xLowerKey:s,xUpperKey:a,yLowerKey:n,yUpperKey:r,xErrorsID:l,yErrorsID:c}=this.getMaybeFlippedKeys(),{xScaleType:h,yScaleType:p}=e,u=o.seriesGrouping?.groupIndex??o.id,y={invalidValue:null,missingValue:0,separateNegative:!0,...o.visible?{}:{forceValue:0}},g=(m,v,b,S)=>i0(m,"normal","current",{id:`${v}-${b}`,groupId:`errorGroup-${u}-${b}`,...y},S),f=(m,v,b,S)=>{i.push(...g(m,b,"lower",S),...g(v,b,"upper",S))};return n!=null&&r!=null&&f(n,r,c,p),s!=null&&a!=null&&f(s,a,l,h),i}getPropertyDefinitions(e){return this.isStacked()?this.getStackPropertyDefinition(e):this.getUnstackPropertyDefinition(e)}onDataProcessed(e){this.dataModel=e.dataModel,this.processedData=e.processedData}getDomain(e){const{xLowerKey:i,xUpperKey:o,xErrorsID:s,yLowerKey:a,yUpperKey:n,yErrorsID:r}=this.getMaybeFlippedKeys();if(e===wh.X?Ne(i)&&Ne(o):Ne(a)&&Ne(n)){const{dataModel:c,processedData:h,cartesianSeries:p}=this;if(c!=null&&h!=null){const u={x:s,y:r}[e],y=c.getDomain(p,`${u}-lower`,"value",h),g=c.getDomain(p,`${u}-upper`,"value",h),f=[Math.min(...y,...g),Math.max(...y,...g)];return e0(f)}}return[]}onDataUpdate(e){this.dataModel=e.dataModel,this.processedData=e.processedData,Ne(e.dataModel)&&Ne(e.processedData)&&(this.createNodeData(),this.update())}getNodeData(){return this.cartesianSeries.contextNodeData?.nodeData}createNodeData(){const e=this.getNodeData(),i=this.cartesianSeries.axes[wh.X]?.scale,o=this.cartesianSeries.axes[wh.Y]?.scale;if(!(!this.hasErrorBars()||!i||!o||!e))for(let s=0;s<e.length;s++){const{midPoint:a,xLower:n,xUpper:r,yLower:l,yUpper:c}=this.getDatum(e,s);if(a!=null){let h,p;Ne(n)&&Ne(r)&&(h={lowerPoint:{x:this.convert(i,n),y:a.y},upperPoint:{x:this.convert(i,r),y:a.y}}),Ne(l)&&Ne(c)&&(p={lowerPoint:{x:a.x,y:this.convert(o,l)},upperPoint:{x:a.x,y:this.convert(o,c)}}),e[s].xBar=h,e[s].yBar=p}}}getMaybeFlippedKeys(){let{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s}=this.properties,[a,n]=["xValue-errors","yValue-errors"];return this.cartesianSeries.shouldFlipXY()&&([e,o]=[o,e],[i,s]=[s,i],[a,n]=[n,a]),{xLowerKey:e,xUpperKey:i,xErrorsID:a,yLowerKey:o,yUpperKey:s,yErrorsID:n}}static getDatumKey(e,i,o){if(i==null)return;const s=e.datum[i];if(s!=null){if(typeof s!="number"){WN.Logger.warnOnce(`Found [${i}] error value of type ${typeof s}. Expected number type`);return}return s+o}}getDatum(e,i){const{xLowerKey:o,xUpperKey:s,yLowerKey:a,yUpperKey:n}=this.getMaybeFlippedKeys(),r=e[i],l=r.cumulativeValue==null||!this.isStacked()?0:r.cumulativeValue-r.yValue,[c,h]=this.cartesianSeries.shouldFlipXY()?[l,0]:[0,l];return{midPoint:r.midPoint,xLower:Un.getDatumKey(r,o,c),xUpper:Un.getDatumKey(r,s,c),yLower:Un.getDatumKey(r,a,h),yUpper:Un.getDatumKey(r,n,h)}}convert(e,i){const o=(e.bandwidth??0)/2;return e.convert(i)+o}update(){const e=this.getNodeData();e!=null&&(this.selection.update(e),this.selection.each((i,o,s)=>this.updateNode(i,o,s)))}updateNode(e,i,o){e.datum=i,e.update(this.getDefaultStyle(),this.properties,!1),e.updateBBoxes()}pickNodeExact(e){const{x:i,y:o}=e,s=this.groupNode.pickNode(i,o);if(s!=null)return{datum:s.datum,distanceSquared:0}}pickNodeNearest(e){return this.groupNode.nearestSquared(e.x,e.y)}pickNodeMainAxisFirst(e){return this.groupNode.nearestSquared(e.x,e.y)}getTooltipParams(){const{xLowerKey:e,xUpperKey:i,yLowerKey:o,yUpperKey:s,xLowerName:a=e,xUpperName:n=i,yLowerName:r=o,yUpperName:l=s}=this.properties;return{xLowerKey:e,xLowerName:a,xUpperKey:i,xUpperName:n,yLowerKey:o,yLowerName:r,yUpperKey:s,yUpperName:l}}onToggleSeriesItem(e){this.groupNode.visible=e.enabled}makeStyle(e){return{visible:e.visible,lineDash:e.lineDash,lineDashOffset:e.lineDashOffset,stroke:e.stroke,strokeWidth:e.strokeWidth,strokeOpacity:e.strokeOpacity,cap:o0(this.properties.cap,e)}}getDefaultStyle(){return this.makeStyle(this.getWhiskerProperties())}getHighlightStyle(){return this.makeStyle(this.getWhiskerProperties())}restyleHighlightChange(e,i,o){const s=this.getNodeData();if(s!=null){for(let a=0;a<s.length;a++)if(e===s[a]){this.selection.at(a)?.update(i,this.properties,o);break}}}onHighlightChange(e){const{previousHighlight:i,currentHighlight:o}=e;o?.series===this.cartesianSeries&&this.restyleHighlightChange(o,this.getHighlightStyle(),!0),i?.series===this.cartesianSeries&&this.restyleHighlightChange(i,this.getDefaultStyle(),!1),this.groupNode.opacity=this.cartesianSeries.getOpacity()}errorBarFactory(){return new ZN}getWhiskerProperties(){const{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=this.properties;return{stroke:e,strokeWidth:i,visible:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}}};import{_Theme as n0}from"ag-charts-community";var r0={series:{errorBar:{visible:!0,stroke:n0.DEFAULT_LABEL_COLOUR,strokeWidth:1,strokeOpacity:1,cap:{length:void 0,lengthRatio:void 0}}}},l0={type:"series-option",identifier:"error-bars",optionsKey:"errorBar",packageType:"enterprise",chartTypes:["cartesian"],seriesTypes:HN,moduleFactory:t=>new a0(t),themeTemplate:r0};import{_ModuleSupport as Ph,_Scene as c0}from"ag-charts-community";var{ZIndexMap:h0,ActionOnSet:d0,Validate:Bh,ProxyPropertyOnWrite:Df,OBJECT:p0,RATIO:u0,COLOR_STRING:g0}=Ph,Ir=class extends Ph.Background{constructor(){super(...arguments),this.image=new Li,this.fill="transparent",this.fillOpacity=void 0}createNode(){return new c0.Layer({name:"foreground",zIndex:h0.FOREGROUND})}onLayoutComplete(t){super.onLayoutComplete(t);const{width:e,height:i}=t.chart;let o={x:0,y:0,width:e,height:i};this.image&&(o=this.image.performLayout(e,i)),this.text&&this.updateTextNode(o)}onImageLoad(){this.ctx.updateService.update(Ph.ChartUpdateType.SCENE_RENDER)}updateTextNode(t){const{textNode:e}=this;e.fontWeight="bold",e.fontFamily="Impact, sans-serif",e.fontSize=19,e.opacity=.7,e.fill="#9b9b9b",e.textBaseline="top";const i=this.textNode.getBBox(),o=10;e.x=t.x+t.width/2-i.width/2,e.y=t.y+t.height+o}};d([Bh(p0,{optional:!0}),d0({newValue(t){this.node.appendChild(t.node),t.onLoad=()=>this.onImageLoad()},oldValue(t){this.node.removeChild(t.node),t.onLoad=void 0}})],Ir.prototype,"image",2),d([Bh(g0,{optional:!0}),Df("rectNode","fill")],Ir.prototype,"fill",2),d([Bh(u0,{optional:!0}),Df("rectNode","fillOpacity")],Ir.prototype,"fillOpacity",2);var y0={type:"root",optionsKey:"foreground",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],moduleFactory:t=>new Ir(t)};import{_ModuleSupport as kf,_Theme as If}from"ag-charts-community";import{_ModuleSupport as Nf}from"ag-charts-community";import{_ModuleSupport as Of,_Scene as f0,_Util as m0}from"ag-charts-community";var{Validate:zh,BOOLEAN:x0,POSITIVE_NUMBER:Lf,ZIndexMap:Fh,ActionOnSet:Cf,CategoryAxis:S0,GroupedCategoryAxis:b0,TextUtils:v0}=Of,{Padding:M0,Logger:Ef}=m0,{Group:T0,BBox:_f,TranslatableLayer:A0,Layer:Rf}=f0,Vh=class{constructor(){this.top=0,this.bottom=0}};d([zh(Lf)],Vh.prototype,"top",2),d([zh(Lf)],Vh.prototype,"bottom",2);var Nr=class extends Of.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.padding=new Vh,this.root=new T0({name:"root"}),this.seriesRoot=this.root.appendChild(new A0({name:"Series-root",zIndex:Fh.SERIES_LAYER})),this.axisGridGroup=this.root.appendChild(new Rf({name:"Axes-Grids",zIndex:Fh.AXIS_GRID})),this.axisGroup=this.root.appendChild(new Rf({name:"Axes-Grids",zIndex:Fh.AXIS_GRID})),this.data=[],this._destroyed=!1,this.miniChartAnimationPhase="initial",this.axes=[],this.series=[]}destroy(){this._destroyed||(this.destroySeries(this.series),this.axes.forEach(t=>t.destroy()),this.axes=[],this._destroyed=!0)}onSeriesChange(t,e){const i=e?.filter(o=>!t.includes(o))??[];this.destroySeries(i);for(const o of t){if(e?.includes(o))continue;o.rootGroup.isRoot()&&this.seriesRoot.appendChild(o.rootGroup);const s=this;o.chart={get mode(){return"standalone"},get isMiniChart(){return!0},get seriesRect(){return s.seriesRect},placeLabels(){return new Map}},o.resetAnimation(this.miniChartAnimationPhase==="initial"?"initial":"disabled")}}destroySeries(t){t?.forEach(e=>{e.destroy(),e.rootGroup?.remove(),e.chart=void 0})}assignSeriesToAxes(){this.axes.forEach(t=>{t.boundSeries=this.series.filter(e=>e.axes[t.direction]===t)})}assignAxesToSeries(){const t={};this.axes.forEach(e=>{const i=e.direction;(t[i]??(t[i]=[])).push(e)}),this.series.forEach(e=>{e.directions.forEach(i=>{const o=t[i];if(!o){Ef.warnOnce(`no available axis for direction [${i}]; check series and axes configuration.`);return}const s=e.getKeys(i),a=this.findMatchingAxis(o,s);if(!a){Ef.warnOnce(`no matching axis for direction [${i}] and keys [${s}]; check series and axes configuration.`);return}e.axes[i]=a})})}findMatchingAxis(t,e){for(const i of t){if(!i.keys.length)return i;if(e){for(const o of e)if(i.keys.includes(o))return i}}}updateData(t){this.series.forEach(e=>e.setChartData(t)),this.miniChartAnimationPhase==="initial"&&this.ctx.animationManager.onBatchStop(()=>{this.miniChartAnimationPhase="ready",this.series.forEach(e=>e.resetAnimation("disabled"))})}async processData(t){this.series.some(e=>e.canHaveAxes)&&(this.assignAxesToSeries(),this.assignSeriesToAxes()),await Promise.all(this.series.map(e=>e.processData(t)))}computeAxisPadding(){const t=new M0;return this.enabled&&this.axes.forEach(({position:e,thickness:i=0,line:o,label:s})=>{if(e==null)return;let a;i>0?a=i:a=(o.enabled?o.width:0)+(s.enabled?v0.getLineHeight(s.fontSize??0)+s.padding+5:0),t[e]=Math.ceil(a)}),t}async layout(t,e){const{padding:i}=this,o=this.seriesRect!=null,s=new _f(0,0,t,e-(i.top+i.bottom));this.seriesRect=s,this.seriesRoot.translationY=i.top,this.seriesRoot.setClipRectCanvasSpace(new _f(0,-i.top,t,e)),this.axes.forEach(a=>{const{position:n="left"}=a;switch(n){case"top":case"bottom":a.range=[0,s.width],a.gridLength=s.height;break;case"right":case"left":{const r=a instanceof S0||a instanceof b0;a.range=r?[0,s.height]:[s.height,0],a.gridLength=s.width;break}}a.gridPadding=0,a.translation.x=0,a.translation.y=0,n==="right"?a.translation.x=t:n==="bottom"&&(a.translation.y=e),a.calculateLayout(),a.updatePosition(),a.update(o)}),await Promise.all(this.series.map(a=>a.update({seriesRect:s})))}};d([zh(x0)],Nr.prototype,"enabled",2),d([Cf({changeValue(t,e=[]){for(const i of e)t.includes(i)||(i.detachAxis(this.axisGroup,this.axisGridGroup),i.destroy());for(const i of t)e?.includes(i)||i.attachAxis(this.axisGroup,this.axisGridGroup)}})],Nr.prototype,"axes",2),d([Cf({changeValue(t,e){this.onSeriesChange(t,e)}})],Nr.prototype,"series",2);var{ObserveChanges:D0}=Nf,wf=class extends Nf.Navigator{constructor(t){super(t),this.miniChart=new Nr(t)}updateData(t){return this.miniChart.updateData(t)}processData(t){return this.miniChart.processData(t)}onLayoutStart(t){if(super.onLayoutStart(t),this.enabled){const{top:e,bottom:i}=this.miniChart.computeAxisPadding();t.layoutBox.shrink(e+i,"bottom"),this.y-=i}}async onLayoutComplete(t){super.onLayoutComplete(t),await this.miniChart.layout(this.width,this.height)}};d([D0((t,e,i)=>{t.updateBackground(i?.root,e?.root)})],wf.prototype,"miniChart",2);var k0={type:"root",optionsKey:"navigator",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new wf(t),themeTemplate:{...kf.NavigatorModule.themeTemplate,navigator:{...kf.NavigatorModule.themeTemplate.navigator,miniChart:{enabled:!1,label:{color:If.DEFAULT_LABEL_COLOUR,fontStyle:void 0,fontWeight:void 0,fontSize:10,fontFamily:If.DEFAULT_FONT_FAMILY,formatter:void 0,padding:0},padding:{top:0,bottom:0}}}}};import{_Theme as ra}from"ag-charts-community";import{_ModuleSupport as Pf,_Scene as Bf}from"ag-charts-community";var{CachedTextMeasurerPool:an,ZIndexMap:I0,LayoutElement:N0,Validate:Se,BaseProperties:O0,OBJECT:la,BOOLEAN:L0,STRING:ca,COLOR_STRING:C0,RATIO:E0,valueProperty:_0,TextUtils:R0}=Pf,{Label:nn,Rect:w0,Text:Gt}=Bf,zf={ohlc:62,candlestick:62,"hollow-candlestick":62,line:96,"step-line":96,"range-area":30,hlc:184,"high-low":800},P0={up:"positive",down:"negative"},B0={hlc:"altNeutral"},Uh=class extends O0{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};d([Se(C0)],Uh.prototype,"fill",2),d([Se(E0)],Uh.prototype,"fillOpacity",2);var Oe=class extends Pf.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.openKey=void 0,this.highKey=void 0,this.lowKey=void 0,this.closeKey=void 0,this.volumeKey=void 0,this.title=new nn,this.positive=new nn,this.negative=new nn,this.neutral=new nn,this.altNeutral=new nn,this.background=new Uh,this.layoutStyle="block",this.id="status-bar",this.data=void 0,this.labelGroup=new Bf.TranslatableLayer({name:"StatusBar",zIndex:I0.STATUS_BAR}),this.backgroundNode=this.labelGroup.appendChild(new w0),this.labels=[{label:"O",configuration:2,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"openValue",key:"openKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:16,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"H",configuration:256,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),style:"neutral",id:"highValue",key:"highKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:8,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"L",configuration:512,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),style:"neutral",id:"lowValue",key:"lowKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:4,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"C",configuration:128,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"closeValue",key:"closeKey",style:"neutral",domain:void 0,formatter:new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},{label:"",configuration:64,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),style:"neutral",id:"closeValue",key:"closeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})},{label:"Vol",configuration:32,title:this.labelGroup.appendChild(new Gt),value:this.labelGroup.appendChild(new Gt),id:"volumeValue",key:"volumeKey",domain:void 0,formatter:new Intl.NumberFormat("en-US",{notation:"compact",minimumFractionDigits:2,maximumFractionDigits:2})}],this.highlightManager=t.highlightManager,this.labelGroup.visible=!1,this.destroyFns.push(t.scene.attachNode(this.labelGroup),t.layoutManager.registerElement(N0.Overlay,e=>this.startPerformLayout(e)),t.layoutManager.addListener("layout:complete",e=>this.onLayoutComplete(e)),t.highlightManager.addListener("highlight-change",()=>this.updateHighlight()))}async processData(t){if(!this.enabled||this.data==null)return;const e=[];for(const s of this.labels){const{id:a,key:n}=s,r=this[n];r==null?s.domain=void 0:e.push(_0(r,"number",{id:a}))}if(e.length===0)return;const{processedData:i,dataModel:o}=await t.request(this.id,this.data,{props:e});for(const s of this.labels){const{id:a,key:n}=s;this[n]!=null&&(s.domain=o.getDomain(this,a,"value",i))}}startPerformLayout(t){if(this.labelGroup.translationX=0,this.labelGroup.translationY=0,!this.enabled)return;const{layoutBox:e}=t,i=4,o=12,s=0,a=8;this.labelGroup.translationY=e.y+s;const n=Math.max(this.title.fontSize,this.positive.fontSize,this.negative.fontSize),r=R0.getLineHeight(n),l=zf[this.getChartType()]??0;let c=0,h,p="alphabetic";if(this.layoutStyle==="block")e.shrink(s+r+a,"top"),h=n+(r-n)/2;else{const{title:u}=this.ctx.chartService;if(p="top",h=s+u.padding,u.enabled){const y=u.node.getBBox();c=y.x+y.width+o}else c=u.padding}for(const{label:u,configuration:y,title:g,value:f,domain:m,formatter:v}of this.labels){if(m==null||!(l&y)){g.visible=!1,f.visible=!1;continue}const b=Math.max(an.measureText(v.format(m[0]),{font:this.positive.getFont(),textBaseline:p,textAlign:"left"}).width,an.measureText(v.format(m[1]),{font:this.positive.getFont(),textBaseline:p,textAlign:"left"}).width,an.measureText(v.format(m[0]),{font:this.negative.getFont(),textBaseline:p,textAlign:"left"}).width,an.measureText(v.format(m[1]),{font:this.negative.getFont(),textBaseline:p,textAlign:"left"}).width);g.visible=!0,f.visible=!0;const S=an.measureText(u,{font:this.title.getFont(),textBaseline:p,textAlign:"left"});g.setFont(this.title),g.fill=this.title.color,g.text=u,g.textBaseline=p,g.y=h,g.x=c,c+=S.width+i,f.textBaseline=p,f.y=h,f.x=c,c+=b+o}this.backgroundNode.x=0,this.backgroundNode.y=0,this.backgroundNode.width=c-o,this.backgroundNode.height=r+s+a,this.backgroundNode.fill=this.background.fill,this.backgroundNode.fillOpacity=this.background.fillOpacity}onLayoutComplete(t){this.labelGroup.translationX=t.series.rect.x,this.updateHighlight()}updateHighlight(){if(!this.enabled)return;const t=this.highlightManager.getActiveHighlight(),e=t?.datum??this.data?.at(-1);if(e==null){this.labelGroup.visible=!1;return}this.labelGroup.visible=!0;const i=t?.itemId;let o=i!=null?P0[i]:void 0;o==null&&this.openKey!=null&&this.closeKey!=null&&(e[this.openKey]<e[this.closeKey]?o="positive":o="negative");for(const{domain:s,value:a,key:n,formatter:r,style:l}of this.labels){if(s==null)continue;let c=l??o??"neutral";c==="neutral"&&(c=B0[this.getChartType()]??c);const h=this[n],p=h!=null?e?.[h]:void 0;a.setFont(this[c]),a.fill=this[c].color,a.text=typeof p=="number"?r.format(p):""}}getChartType(){let t=this.ctx.chartService.publicApi?.getOptions()?.chartType;return(t==null||zf[t]==null)&&(t="candlestick"),t}};d([Se(L0)],Oe.prototype,"enabled",2),d([Se(ca,{optional:!0})],Oe.prototype,"openKey",2),d([Se(ca,{optional:!0})],Oe.prototype,"highKey",2),d([Se(ca,{optional:!0})],Oe.prototype,"lowKey",2),d([Se(ca,{optional:!0})],Oe.prototype,"closeKey",2),d([Se(ca,{optional:!0})],Oe.prototype,"volumeKey",2),d([Se(la)],Oe.prototype,"title",2),d([Se(la)],Oe.prototype,"positive",2),d([Se(la)],Oe.prototype,"negative",2),d([Se(la)],Oe.prototype,"neutral",2),d([Se(la)],Oe.prototype,"altNeutral",2),d([Se(la)],Oe.prototype,"background",2),d([Se(ca)],Oe.prototype,"layoutStyle",2);var z0={type:"root",identifier:"status-bar",optionsKey:"statusBar",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new Oe(t),themeTemplate:{statusBar:{enabled:!1,layoutStyle:ra.DEFAULT_CAPTION_LAYOUT_STYLE,title:{color:ra.DEFAULT_LABEL_COLOUR},positive:{color:ra.PALETTE_UP_STROKE},negative:{color:ra.PALETTE_DOWN_STROKE},neutral:{color:ra.PALETTE_NEUTRAL_STROKE},background:{fill:ra.DEFAULT_BACKGROUND_COLOUR,fillOpacity:.5},altNeutral:{color:"gray"}}}};import{_ModuleSupport as F0,_Util as V0}from"ag-charts-community";var{BOOLEAN:Hh,STRING:U0,UNION:H0,BaseProperties:G0,CartesianAxis:Ff,ChartUpdateType:Vf,isDate:W0,isDefined:K0,isFiniteNumber:Or,unique:Y0,ObserveChanges:rn,TooltipManager:j0,Validate:ln}=F0,{Logger:X0}=V0,os=class extends G0{constructor(t){super(),this.moduleContext=t,this.enabled=!1,this.axes="x",this.nodeInteraction=!0,this.zoom=!0}updateSiblings(t){const{syncManager:e}=this.moduleContext;for(const i of e.getGroupSiblings(t??this.groupId))this.updateChart(i)}updateChart(t,e=Vf.UPDATE_DATA){t.ctx.updateService.update(e,{skipSync:!0})}enabledZoomSync(){const{syncManager:t,zoomManager:e}=this.moduleContext;this.disableZoomSync=e.addListener("zoom-change",()=>{for(const i of t.getGroupSiblings(this.groupId))i.modulesManager.getModule("sync")?.zoom&&i.ctx.zoomManager.updateZoom("sync",this.mergeZoom(i))})}enabledNodeInteractionSync(){const{highlightManager:t,syncManager:e}=this.moduleContext;this.disableNodeInteractionSync=t.addListener("highlight-change",i=>{for(const o of e.getGroupSiblings(this.groupId))if(o.modulesManager.getModule("sync")?.nodeInteraction){if(!i.currentHighlight?.datum){o.ctx.highlightManager.updateHighlight(o.id),o.ctx.tooltipManager.removeTooltip(o.id);continue}for(const s of o.axes){const a=this.axes==="xy"?"x":this.axes;if(!Ff.is(s)||s.direction!==a)continue;const n=o.series.map(r=>{const l=r.getKeys(s.direction);if(s.keys.length&&!s.keys.some(g=>l.includes(g)))return;const{nodeData:c}=r.contextNodeData;if(!c?.length)return;const h=c[0][`${s.direction}Key`];let p=i.currentHighlight.datum[h];const u=W0(p);u&&(p=p.getTime());const y=c.find(g=>{const f=g.datum[h];return u?f.getTime()===p:f===p});return y?{series:r,nodeDatum:y}:null}).filter(K0);if(n.length<2&&n[0]?.nodeDatum!==o.ctx.highlightManager.getActiveHighlight()){const{series:r,nodeDatum:l}=n[0]??{};if(o.ctx.highlightManager.updateHighlight(o.id,l),l){const c=l.midPoint?.x??l.point?.x??0,h=l.midPoint?.y??l.point?.y??0,p=j0.makeTooltipMeta({type:"hover",offsetX:c,offsetY:h},l);delete p.lastPointerEvent,o.ctx.tooltipManager.updateTooltip(o.id,p,r.getTooltipHtml(l))}else o.ctx.tooltipManager.removeTooltip(o.id);this.updateChart(o,Vf.SERIES_UPDATE)}}}})}getSyncedDomain(t){if(!Ff.is(t)||this.axes!=="xy"&&this.axes!==t.direction)return;const{syncManager:e}=this.moduleContext,i=e.getGroup(this.groupId),[{axes:o}]=i,{direction:s,min:a,max:n,nice:r,reverse:l}=t;for(const c of o)if(s===c.direction&&(r!==c.nice||l!==c.reverse||a!==c.min&&(Or(a)||Or(c.min))||n!==c.max&&(Or(n)||Or(c.max)))){X0.warnOnce("To allow synchronization, ensure that all charts have matching min, max, nice, and reverse properties on the synchronized axes."),this.enabled=!1;return}return Y0(i.flatMap(c=>c.series).filter(c=>{if(c.visible){const h=c.getKeys(t.direction);return t.keys.length?t.keys.some(p=>h.includes(p)):!0}}).flatMap(c=>c.getDomain(t.direction)))}mergeZoom(t){const{zoomManager:e}=this.moduleContext;if(this.axes==="xy")return e.getZoom();const i=t.ctx.zoomManager.getZoom()??{};return i[this.axes]=e.getZoom()?.[this.axes],i}onEnabledChange(){const{syncManager:t}=this.moduleContext;this.enabled?t.subscribe(this.groupId):t.unsubscribe(this.groupId),this.updateSiblings(),this.onNodeInteractionChange(),this.onZoomChange()}onGroupIdChange(t,e){if(!this.enabled||t===e)return;const{syncManager:i}=this.moduleContext;i.unsubscribe(e),i.subscribe(t),this.updateSiblings(e),this.updateSiblings(t)}onAxesChange(){if(!this.enabled)return;const{syncManager:t}=this.moduleContext;this.updateChart(t.getChart())}onNodeInteractionChange(){this.enabled&&this.nodeInteraction?this.enabledNodeInteractionSync():this.disableNodeInteractionSync?.()}onZoomChange(){this.enabled&&this.zoom?this.enabledZoomSync():this.disableZoomSync?.()}destroy(){const{syncManager:t}=this.moduleContext;t.unsubscribe(this.groupId),this.updateSiblings(),this.disableZoomSync?.()}};os.className="Sync",d([ln(Hh),rn(t=>t.onEnabledChange())],os.prototype,"enabled",2),d([ln(U0,{optional:!0}),rn((t,e,i)=>t.onGroupIdChange(e,i))],os.prototype,"groupId",2),d([ln(H0(["x","y","xy"],"an axis")),rn(t=>t.onAxesChange())],os.prototype,"axes",2),d([ln(Hh),rn(t=>t.onNodeInteractionChange())],os.prototype,"nodeInteraction",2),d([ln(Hh),rn(t=>t.onZoomChange())],os.prototype,"zoom",2);var Z0={type:"root",optionsKey:"sync",packageType:"enterprise",chartTypes:["cartesian"],moduleFactory:t=>new os(t),themeTemplate:{sync:{enabled:!1}}};import{_ModuleSupport as Ci}from"ag-charts-community";import{_ModuleSupport as $0,_Scene as Q0}from"ag-charts-community";var{COLOR_STRING:q0,RATIO:J0,Validate:Uf}=$0,Lr=class extends Q0.Rect{constructor(){super(...arguments),this.fill="rgb(33, 150, 243)",this.fillOpacity=.2}};Lr.className="ZoomRect",d([Uf(q0)],Lr.prototype,"fill",2),d([Uf(J0)],Lr.prototype,"fillOpacity",2);import{_ModuleSupport as Gh}from"ag-charts-community";import{_ModuleSupport as tO}from"ag-charts-community";var{clamp:eO,isEqual:Hf,round:Gf}=tO,st={min:0,max:1},Wh="end",Kh="middle",Cr=(t,e=st.min,i=st.max)=>eO(e,t,i);function Yh(){return{x:{...st},y:{...st}}}function Wt(t){return t.x.max-t.x.min}function je(t){return t.y.max-t.y.min}function jh(t,e,i=1e-10){return Hf(t.min,e.min,i)&&Hf(t.max,e.max,i)}function Xh(t,e,i){return jh(t.x,e.x,i)&&jh(t.y,e.y,i)}function Zh(t,e,i){const o=Gf(Wt(t),10)<=e,s=Gf(je(t),10)<=i;return o||s}function ne(t){return{x:{min:t?.x?.min??st.min,max:t?.x?.max??st.max},y:{min:t?.y?.min??st.min,max:t?.y?.max??st.max}}}function Ei(t,e,i){if(!t)return{x:0,y:0};const o=Cr(e-t.x,0,t.x+t.width),s=Cr(i-t.y,0,t.y+t.height),a=1/t.width*o,n=1-1/t.height*s;return{x:Cr(a),y:Cr(n)}}function ss(t,e,i){return{x:{min:t.x.min+e,max:t.x.max+e},y:{min:t.y.min+i,max:t.y.max+i}}}function Wf(t,e,i){return{x:{min:t.x.min,max:t.x.min+Wt(t)*e},y:{min:t.y.min,max:t.y.min+je(t)*i}}}function Kf(t,e,i){const o=Wt(t),s=je(t),a=t.x.min+o/2,n=t.y.min+s/2;return{x:{min:a-o*e/2,max:a+o*e/2},y:{min:n-s*i/2,max:n+s*i/2}}}function hi(t,e,i,o){const{min:s,max:a}=e,n=s+(a-s)/2,r=t.max-t.min;switch(i){case"start":return{min:s,max:e.min+r};case"end":return{min:e.max-r,max:a};case"middle":return{min:n-r/2,max:n+r/2};case"pointer":return $h(t,e,o??n);default:return{min:s,max:a}}}function $h(t,e,i){const o=t.max-t.min,s=e.max-e.min,a=i*(1-(s-o)),n=i-a,r=t.min+n,l=t.max+n;return{min:r,max:l}}function iO(t,e,i){return{x:{min:t.x.min*e,max:t.x.max*e},y:{min:t.y.min*i,max:t.y.max*i}}}function Pe(t){const e=Yh();return e.x=Er(t.x),e.y=Er(t.y),e}function Er(t){const e=t.max-t.min;let i=t.max>st.max?st.max-e:t.min,o=t.min<st.min?e:t.max;return i=Math.max(st.min,i),o=Math.min(st.max,o),{min:i,max:o}}function Yf({min:t,max:e},i,o){if(e===i.max)t=e-o;else if(t===i.min)e=t+o;else{const s=i.min+(i.max-i.min)/2;t=s-o/2,e=s+o/2}return{min:t,max:e}}var oO=class{update(t,e,i,o,s,a){return this.oldZoom??(this.oldZoom=ne(e===Gh.ChartAxisDirection.X?{...s,x:a}:{...s,y:a})),this.updateCoords(t.offsetX,t.offsetY),this.updateZoom(e,i,o)}stop(){this.coords=void 0,this.oldZoom=void 0}updateCoords(t,e){this.coords?(this.coords.x2=t,this.coords.y2=e):this.coords={x1:t,y1:e,x2:t,y2:e}}updateZoom(t,e,i){const{coords:o,oldZoom:s}=this;let a=ne(s);if(!o||!s)return t===Gh.ChartAxisDirection.X?a.x:a.y;const n=Ei(i,o.x1,o.y1),r=Ei(i,o.x2,o.y2);if(t===Gh.ChartAxisDirection.X){const c=(r.x-n.x)*Wt(s);return a.x.max+=c,a.x=hi(a.x,s.x,e,n.x),a=Pe(a),a.x}const l=(r.y-n.y)*je(s);return a.y.max-=l,a.y=hi(a.y,s.y,e,n.y),a=Pe(a),a.y}},Qh="zoom-action",qh="pan-action",sO=class{constructor(t,e,i,o,s){this.contextMenuRegistry=t,this.zoomManager=e,this.getModuleProperties=i,this.getRect=o,this.updateZoom=s}registerActions(t,e){if(!t)return;const{contextMenuRegistry:i}=this,o=i.registerDefaultAction({id:Qh,type:"series",label:"contextMenuZoomToCursor",action:this.onZoomToHere.bind(this)}),s=i.registerDefaultAction({id:qh,type:"series",label:"contextMenuPanToCursor",action:this.onPanToHere.bind(this)});return this.toggleActions(e),()=>{o(),s()}}toggleActions(t){const{contextMenuRegistry:e}=this,{minRatioX:i,minRatioY:o}=this.getModuleProperties();Zh(t,i,o)?e.disableAction(Qh):e.enableAction(Qh),Xh(t,Yh())?e.disableAction(qh):e.enableAction(qh)}onZoomToHere({event:t}){const e=this.getRect(),{enabled:i,isScalingX:o,isScalingY:s,minRatioX:a,minRatioY:n}=this.getModuleProperties();if(!i||!e||!t||!t.target||!(t instanceof MouseEvent))return;const r=ne(this.zoomManager.getZoom()),l=Ei(e,t.offsetX,t.offsetX),c=l.x*Wt(r),h=l.y*je(r),p=st.max-st.min,u=p/2;let y={x:{min:l.x-u,max:l.x+u},y:{min:l.y-u,max:l.y+u}};y=Kf(y,o?a:p,s?n:p),y=ss(y,r.x.min-l.x+c,r.y.min-l.y+h),this.updateZoom(Pe(y))}onPanToHere({event:t}){const e=this.getRect(),{enabled:i}=this.getModuleProperties();if(!i||!e||!t||!t.target||!(t instanceof MouseEvent))return;const o=ne(this.zoomManager.getZoom()),s=Ei(e,t.offsetX,t.offsetY),a=Wt(o),n=je(o),r=s.x*a,l=s.y*n,c=(st.max-st.min)/2;let h={x:{min:s.x-c,max:s.x+c},y:{min:s.y-c,max:s.y+c}};h=Kf(h,a,n),h=ss(h,o.x.min-s.x+r,o.y.min-s.y+l),this.updateZoom(Pe(h))}};import{_ModuleSupport as aO}from"ag-charts-community";var jf=16,nO={off:1,short:.01,long:.002},rO=class{constructor(){this.deceleration=1,this.zoomCoordsHistoryIndex=0,this.coordsHistory=[]}get decelerationValue(){const{deceleration:t}=this;return Math.max(typeof t=="number"?t:nO[t]??1,1e-4)}addListener(t,e){return this.onUpdate=e,()=>{this.onUpdate=void 0}}stopInteractions(){this.inertiaHandle!=null&&(cancelAnimationFrame(this.inertiaHandle),this.inertiaHandle=void 0)}update(t){this.updateCoords(t.offsetX,t.offsetY);const{x1:e=0,y1:i=0,x2:o=0,y2:s=0}=this.coords??{};this.onUpdate?.({type:"update",deltaX:e-o,deltaY:i-s})}start(){this.coordsMonitorTimeout=setInterval(this.recordCurrentZoomCoords.bind(this),16)}stop(){const{coordsHistory:t}=this;let e=0,i=0,o=0;if(t.length>0){const s=this.zoomCoordsHistoryIndex%jf;let a=s-1;a<0&&(a=t.length-1);let n=s;n>=t.length&&(n=0);const r=t[a],l=t[n];e=r.x-l.x,i=r.y-l.y,o=r.t-l.t}if(this.coords=void 0,clearInterval(this.coordsMonitorTimeout),this.coordsMonitorTimeout=void 0,this.zoomCoordsHistoryIndex=0,this.coordsHistory.length=0,o>0&&this.decelerationValue<1){const s=e/o,a=i/o,n=Math.hypot(s,a),r=Math.atan2(a,s),l=performance.now();this.inertiaHandle=aO.getWindow().requestAnimationFrame(c=>{this.animateInertia(c,c,l,n,r)})}}recordCurrentZoomCoords(){const{coords:t,coordsHistory:e,zoomCoordsHistoryIndex:i}=this;if(!t)return;const{x2:o,y2:s}=t,a=Date.now();e[i%jf]={x:o,y:s,t:a},this.zoomCoordsHistoryIndex+=1}animateInertia(t,e,i,o,s){const a=1-this.decelerationValue,n=-o/Math.log(a),r=o*(a**(e-i)-1)/Math.log(a),l=o*(a**(t-i)-1)/Math.log(a);this.onUpdate?.({type:"update",deltaX:-Math.cos(s)*(l-r),deltaY:-Math.sin(s)*(l-r)}),!(l>=n-1)&&(this.inertiaHandle=requestAnimationFrame(c=>{this.animateInertia(c,t,i,o,s)}))}updateCoords(t,e){this.coords?this.coords={x1:this.coords.x2,y1:this.coords.y2,x2:t,y2:e}:this.coords={x1:t,y1:e,x2:t,y2:e}}translateZooms(t,e,i,o){const s=Ei(t,t.x+Math.abs(i),t.y+t.height-Math.abs(o)),a=Math.sign(i)*s.x,n=-Math.sign(o)*s.y,r={};for(const[l,{direction:c,zoom:h}]of Object.entries(e)){if(h&&h.min===st.min&&h.max===st.max)continue;let p=ne({[c]:h});p=Pe(ss(p,a*Wt(p),n*je(p))),r[l]={direction:c,zoom:p[c]}}return r}};import{_ModuleSupport as lO}from"ag-charts-community";var{AND:Xf,DATE:Zf,NUMBER:$f,OR:Qf,ObserveChanges:qf,Validate:Jf}=lO,_r=class{constructor(t){this.onChange=t}getRange(){return this.getRangeWithValues(this.start,this.end)}getInitialRange(){return this.getRangeWithValues(this.initialStart,this.initialEnd)}updateDomain(t){this.domain=t}restore(t,e){this.initialStart=t,this.initialEnd=e,this.start=t,this.end=e,this.onChange(this.getRange())}extendToEnd(t){return this.extendWith(e=>Number(e)-t)}extendWith(t){if(!this.domain)return;const[,e]=this.domain;if(e==null)return;const i=t(e),o=this.start!==i||this.end!==e;return this.end=e,this.start=i,o||this.onChange?.(this.getRange()),{start:i,end:e}}updateWith(t){if(!this.domain)return;let[e,i]=this.domain;[e,i]=t(e,i);const o=this.start!==e||this.end!==i;return this.end=i,this.start=e,o||this.onChange?.(this.getRange()),{start:e,end:i}}extendAll(){if(!this.domain)return;const[t,e]=this.domain,i=this.start!==t||this.end!==e;this.start=t,this.end=e,i||this.onChange?.(this.getRange())}getRangeWithValues(t,e){let[i,o]=this.domain??[];if(t==null&&e==null||i==null||o==null)return;i=Number(i),o=Number(o);let s=0,a=1;return t!=null&&(s=(Number(t)-i)/(o-i)),e!=null&&(a=(Number(e)-i)/(o-i)),{min:s,max:a}}};d([qf((t,e)=>{t.initialStart??(t.initialStart=e);const i=t.getRangeWithValues(e,t.end);i&&t.onChange?.(i)}),Jf(Xf(Qf(Zf,$f)),{optional:!0})],_r.prototype,"start",2),d([qf((t,e)=>{t.initialEnd??(t.initialEnd=e);const i=t.getRangeWithValues(t.start,e);i&&t.onChange?.(i)}),Jf(Xf(Qf(Zf,$f)),{optional:!0})],_r.prototype,"end",2);import{_ModuleSupport as cO,_Util as hO}from"ag-charts-community";var{AND:tm,GREATER_THAN:dO,LESS_THAN:pO,RATIO:em,ObserveChanges:im,Validate:om}=cO,{Logger:sm}=hO,Rr=class{constructor(t){this.onChange=t,this.hasRestored=!1}getRatio(){return this.getRatioWithValues(this.start,this.end)}getInitialRatio(){return this.getRatioWithValues(this.initialStart,this.initialEnd)}restore(t,e){this.hasRestored=!0,this.initialStart=t,this.initialEnd=e,this.start=t,this.end=e,this.onChange(this.getRatio())}getRatioWithValues(t,e){if(!(t==null&&e==null))return{min:t??st.min,max:e??st.max}}};d([im((t,e)=>{t.initialStart==null&&!t.hasRestored&&sm.warnOnce("Property [zoom.ratioX] is deprecated. Use [initialState.zoom.ratioX] instead."),t.initialStart??(t.initialStart=e);const i=t.getRatioWithValues(e,t.end);i&&t.onChange?.(i)}),om(tm(em,pO("end")),{optional:!0})],Rr.prototype,"start",2),d([im((t,e)=>{t.initialEnd==null&&!t.hasRestored&&sm.warnOnce("Property [zoom.ratioY] is deprecated. Use [initialState.zoom.ratioY] instead."),t.initialEnd??(t.initialEnd=e);const i=t.getRatioWithValues(t.start,e);i&&t.onChange?.(i)}),om(tm(em,dO("start")),{optional:!0})],Rr.prototype,"end",2);import{_ModuleSupport as uO}from"ag-charts-community";var gO=200,yO=class{update(t,e,i,o){const s=t.deltaX*e*gO;return this.translateZooms(i,o,s)}translateZooms(t,e,i){const o={},s=Ei(t,t.x+Math.abs(i),0),a=i<0?-s.x:s.x;for(const[n,{direction:r,zoom:l}]of Object.entries(e)){if(r!==uO.ChartAxisDirection.X)continue;let c=ne({x:l});c=Pe(ss(c,a*Wt(c),0)),o[n]={direction:r,zoom:c.x}}return o}};import{_ModuleSupport as am}from"ag-charts-community";var fO=class{updateAxes(t,e,i,o){const s=t.sourceEvent,a={},{anchorPointX:n,anchorPointY:r,isScalingX:l,isScalingY:c,scrollingStep:h}=e,p=Ei(i,s.offsetX??s.clientX,s.offsetY??s.clientY);for(const[u,{direction:y,zoom:g}]of Object.entries(o)){if(g==null)continue;let f={...g};const m=h*t.deltaY*(g.max-g.min);if(y===am.ChartAxisDirection.X&&l)f.max+=m,f=hi(f,g,n,p.x);else if(y===am.ChartAxisDirection.Y&&c)f.max+=m,f=hi(f,g,r,p.y);else continue;a[u]={direction:y,zoom:Er(f)}}return a}update(t,e,i,o){const s=t.sourceEvent,{anchorPointX:a,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:c}=e,h=Ei(i,s.offsetX??s.clientX,s.offsetY??s.clientY),p=t.deltaY;let u=ne(o);return u.x.max+=r?c*p*Wt(o):0,u.y.max+=l?c*p*je(o):0,r&&(u.x=hi(u.x,o.x,a,h.x)),l&&(u.y=hi(u.y,o.y,n,h.y)),u=Pe(u),u}updateDelta(t,e,i){const{anchorPointX:o,anchorPointY:s,isScalingX:a,isScalingY:n,scrollingStep:r}=e;let l=ne(i);return l.x.max+=a?r*-t*Wt(i):0,l.y.max+=n?r*-t*je(i):0,a&&(l.x=hi(l.x,i.x,o)),n&&(l.y=hi(l.y,i.y,s)),l=Pe(l),l}},mO=class{constructor(t){this.rect=t,this.rect.visible=!1}update(t,e,i,o){this.rect.visible=!0,this.updateCoords(t.offsetX,t.offsetY,e,i,o),this.updateRect(i)}stop(t,e,i){let o=ne();if(!t||!e)return o;this.coords&&(o=this.createZoomFromCoords(e,i));const s=e.width/t.width,a=e.height/t.height;return o=Pe(iO(o,s,a)),this.reset(),o}reset(){this.coords=void 0,this.rect.visible=!1}didUpdate(){return this.rect.visible}updateCoords(t,e,i,o,s){if(!this.coords){this.coords={x1:t,y1:e,x2:t,y2:e};return}if(this.coords.x2=t,this.coords.y2=e,!o)return;const{isScalingX:a,isScalingY:n,minRatioX:r,minRatioY:l}=i,c=ne(s),h=this.getNormalisedDimensions(),p=o.width/o.height,u=c.x.max-c.x.min,y=c.y.max-c.y.min,g=r/u,f=l/y;h.width/o.width<g&&(this.coords.x2<this.coords.x1?this.coords.x2=this.coords.x1-o.width*g:this.coords.x2=this.coords.x1+o.width*g),n&&!a?h.height/o.height<f&&(this.coords.y2<this.coords.y1?this.coords.y2=this.coords.y1-o.width*g:this.coords.y2=this.coords.y1+o.height*f):this.coords.y2<this.coords.y1?this.coords.y2=Math.min(this.coords.y1-h.width/p,this.coords.y1-o.height*f):this.coords.y2=Math.max(this.coords.y1+h.width/p,this.coords.y1+o.height*f),a||(this.coords.x1=o.x,this.coords.x2=o.x+o.width),n||(this.coords.y1=o.y,this.coords.y2=o.y+o.height)}updateRect(t){if(!t)return;const{rect:e}=this,i=this.getNormalisedDimensions(),{width:o,height:s}=i;let{x:a,y:n}=i;a=Math.max(a,t.x),a-=Math.max(0,a+o-(t.x+t.width)),n=Math.max(n,t.y),n-=Math.max(0,n+s-(t.y+t.height)),e.x=a,e.y=n,e.width=o,e.height=s}createZoomFromCoords(t,e){const i=ne(e),o=this.getNormalisedDimensions(),s=Ei(t,o.x,o.y+o.height),a=o.width/t.width,n=o.height/t.height;let r=Wf(i,a,n);const l=s.x*(i.x.max-i.x.min),c=s.y*(i.y.max-i.y.min);return r=ss(r,l,c),r=Pe(r),r}getNormalisedDimensions(){const{x1:t=0,y1:e=0,x2:i=0,y2:o=0}=this.coords??{},s=t<=i?t:i,a=e<=o?e:o,n=t<=i?i-t:t-i,r=e<=o?o-e:e-o;return{x:s,y:a,width:n,height:r}}};import{_ModuleSupport as xO}from"ag-charts-community";var{ChartAxisDirection:SO,ToolbarManager:wr}=xO,bO=class{constructor(t,e,i,o,s){this.toolbarManager=t,this.zoomManager=e,this.getResetZoom=i,this.updateZoom=o,this.updateAxisZoom=s,this.selectedZoom=void 0,this.destroyFns=[],this.destroyFns.push(e.addListener("zoom-change",this.onZoomChanged.bind(this)))}destroy(){for(const t of this.destroyFns)t()}toggle(t,e,i){this.toggleGroups(t),t&&this.toggleButtons(e,i)}toggleButtons(t,e){const{toolbarManager:i}=this,o=Xh(t,Yh()),s=Zh(t,e.minRatioX,e.minRatioY),a=Xh(t,this.getResetZoom());i.toggleButton("zoom","pan-start",{enabled:t.x.min>st.min}),i.toggleButton("zoom","pan-end",{enabled:t.x.max<st.max}),i.toggleButton("zoom","pan-left",{enabled:t.x.min>st.min}),i.toggleButton("zoom","pan-right",{enabled:t.x.max<st.max}),i.toggleButton("zoom","zoom-out",{enabled:!o}),i.toggleButton("zoom","zoom-in",{enabled:!s}),i.toggleButton("zoom","reset",{enabled:!a})}onButtonPress(t,e){this.onButtonPressRanges(t,e),this.onButtonPressZoom(t,e)}toggleGroups(t){this.toolbarManager?.toggleGroup("zoom","ranges",{visible:!!t}),this.toolbarManager?.toggleGroup("zoom","zoom",{visible:!!t})}onButtonPressRanges(t,e){if(!wr.isGroup("ranges",t))return;const{id:i}=t,{rangeX:o}=e,s=t.value;typeof s=="number"?o.extendToEnd(s):Array.isArray(s)?o.updateWith(()=>s):typeof s=="function"&&o.updateWith(s);const a=o.getRange();this.selectedZoom=a!=null?{id:i,range:a}:void 0,this.toolbarManager.toggleGroup("zoom-toolbar","ranges",{active:!1}),this.toolbarManager.toggleButton("ranges",i,{active:!0})}onZoomChanged(t){const{selectedZoom:e}=this,{x:i}=t;this.toolbarManager.toggleGroup("zoom-toolbar","ranges",{active:!1}),e!=null&&i!=null&&jh(e.range,i)?this.toolbarManager.toggleButton("ranges",e.id,{active:!0}):this.selectedZoom=void 0}onButtonPressZoom(t,e){if(wr.isGroup("zoom",t))if(e.independentAxes&&t.value!=="reset"){const i=this.zoomManager.getAxisZooms();for(const[o,{direction:s,zoom:a}]of Object.entries(i))a!=null&&this.onButtonPressZoomAxis(t,e,o,s,a)}else this.onButtonPressZoomUnified(t,e)}onButtonPressZoomAxis(t,e,i,o,s){if(!wr.isGroup("zoom",t))return;const{anchorPointX:a,anchorPointY:n,isScalingX:r,isScalingY:l,scrollingStep:c}=e;let h={...s};const p=s.max-s.min;switch(t.value){case"pan-start":h.max=p,h.min=0;break;case"pan-end":h.min=h.max-p,h.max=st.max;break;case"pan-left":h.min-=p*c,h.max-=p*c;break;case"pan-right":h.min+=p*c,h.max+=p*c;break;case"zoom-in":case"zoom-out":{const u=o===SO.X,y=u&&r||!u&&l;let g=t.value==="zoom-in"?1-c:1+c;y||(g=1);const v=u?a==="pointer"?Wh:a:n==="pointer"?Kh:n;h.max=h.min+(h.max-h.min)*g,h=hi(h,s,v);break}}this.updateAxisZoom(i,o,Er(h))}onButtonPressZoomUnified(t,e){if(!wr.isGroup("zoom",t))return;const{anchorPointX:i,anchorPointY:o,isScalingX:s,isScalingY:a,scrollingStep:n}=e,r=ne(this.zoomManager.getZoom());let l=ne(r);switch(t.value){case"reset":l=this.getResetZoom();break;case"pan-start":l.x.max=Wt(l),l.x.min=0;break;case"pan-end":l.x.min=st.max-Wt(l),l.x.max=st.max;break;case"pan-left":l=ss(l,-Wt(l)*n,0);break;case"pan-right":l=ss(l,Wt(l)*n,0);break;case"zoom-in":case"zoom-out":{const c=t.value==="zoom-in"?1-n:1+n,h=i==="pointer"?Wh:i,p=o==="pointer"?Kh:o;l=Wf(l,s?c:1,a?c:1),l.x=hi(l.x,r.x,h),l.y=hi(l.y,r.y,p);break}}this.updateZoom(Pe(l))}},{ARRAY:vO,BOOLEAN:Do,NUMBER:nm,RATIO:rm,REGIONS:Jh,STRING:td,UNION:Pr,OR:MO,ActionOnSet:TO,ChartAxisDirection:Lt,ChartUpdateType:AO,Validate:Ct,ProxyProperty:DO,arraysEqual:kO,round:IO}=Ci,lm=t=>IO(t,10),cm=Pr(["pointer","start","middle","end"],"an anchor cord"),Br="zoom-cursor",ed="zoom-tooltip",ha=class extends Ci.BaseProperties{constructor(t){super(),this.onChange=t,this.enabled=!1,this.position="floating-bottom",this.size="small",this.align="center"}};d([Ci.ObserveChanges(t=>{t.onChange()}),Ct(Do)],ha.prototype,"enabled",2),d([Ci.ObserveChanges(t=>{t.onChange()}),Ct(vO,{optional:!0})],ha.prototype,"buttons",2),d([Ct(td)],ha.prototype,"position",2),d([Ct(td)],ha.prototype,"size",2),d([Ct(td)],ha.prototype,"align",2);var re=class extends Ci.BaseModuleInstance{constructor(t){super(),this.ctx=t,this.enabled=!1,this.enableAxisDragging=!0,this.buttons=new ha(()=>this.onZoomButtonsChange(this.enabled)),this.enableDoubleClickToReset=!0,this.enablePanning=!0,this.enableScrolling=!0,this.enableSelecting=!1,this.panKey="alt",this.axes="x",this.scrollingStep=(st.max-st.min)/10,this.minVisibleItemsX=2,this.minVisibleItemsY=2,this.anchorPointX=Wh,this.anchorPointY=Kh,this.rangeX=new _r(this.onRangeChange.bind(this,Lt.X)),this.rangeY=new _r(this.onRangeChange.bind(this,Lt.Y)),this.ratioX=new Rr(this.onRangeChange.bind(this,Lt.X)),this.ratioY=new Rr(this.onRangeChange.bind(this,Lt.Y)),this.axisDragger=new oO,this.panner=new rO,this.scroller=new fO,this.scrollPanner=new yO,this.deceleration="short",this.dragState=0,this.axisIds={},this.axisDomains={},this.minRatioX=0,this.minRatioY=0,this.hasPerformedLayout=!1,this._destroyContextMenuActions=void 0;const e=new Lr;this.selector=new mO(e),this.contextMenu=new sO(t.contextMenuRegistry,t.zoomManager,this.getModuleProperties.bind(this),()=>this.paddedRect,this.updateZoom.bind(this)),this.toolbar=new bO(t.toolbarManager,t.zoomManager,this.getResetZoom.bind(this),this.updateUnifiedZoom.bind(this),this.updateAxisZoom.bind(this));const{Default:i,ZoomDrag:o,Animation:s,Annotations:a,AnnotationsSelected:n}=Ci.InteractionState,r=i|s|o,l=i|s,c=r|a|n,h=t.regionManager.getRegion(Jh.SERIES),p=t.regionManager.getRegion(Jh.HORIZONTAL_AXES),u=t.regionManager.getRegion(Jh.VERTICAL_AXES),y="drag-start";this.destroyFns.push(t.scene.attachNode(e),t.regionManager.listenAll("dblclick",g=>this.onDoubleClick(g),l),t.keyNavManager.addListener("nav-zoom",g=>this.onNavZoom(g)),h.addListener("drag",g=>this.onDrag(g),r),h.addListener(y,g=>this.onDragStart(g),r),h.addListener("drag-end",g=>this.onDragEnd(g),r),u.addListener("drag",g=>this.onDrag(g),r),u.addListener(y,g=>this.onDragStart(g),r),u.addListener("drag-end",g=>this.onDragEnd(g),r),u.addListener("leave",()=>this.onAxisLeave(),l),u.addListener("hover",g=>this.onAxisHover(g,Lt.Y)),p.addListener("drag",g=>this.onDrag(g),r),p.addListener(y,g=>this.onDragStart(g),r),p.addListener("drag-end",g=>this.onDragEnd(g),r),p.addListener("leave",()=>this.onAxisLeave(),l),p.addListener("hover",g=>this.onAxisHover(g,Lt.X)),h.addListener("wheel",g=>this.onWheel(g),c),t.gestureDetector.addListener("pinch-move",g=>this.onPinchMove(g)),t.toolbarManager.addListener("button-pressed",g=>this.toolbar.onButtonPress(g,this.getModuleProperties())),t.layoutManager.addListener("layout:complete",g=>this.onLayoutComplete(g)),t.updateService.addListener("update-complete",g=>this.onUpdateComplete(g)),t.zoomManager.addListener("zoom-change",g=>this.onZoomChange(g)),t.zoomManager.addListener("zoom-pan-start",g=>this.onZoomPanStart(g)),t.zoomManager.addListener("restore-zoom",g=>this.onRestoreZoom(g)),this.panner.addListener("update",g=>this.onPanUpdate(g)),()=>this.toolbar.destroy())}destroy(){super.destroy(),this._destroyContextMenuActions?.()}onEnabledChange(t){if(!this.contextMenu||!this.toolbar)return;const e=this.getZoom(),i=this.getModuleProperties({enabled:t});this._destroyContextMenuActions?.(),this._destroyContextMenuActions=this.contextMenu.registerActions(t,e),this.onZoomButtonsChange(t),this.toolbar.toggle(t,e,i)}onZoomButtonsChange(t){if(!this.buttons)return;const e=this.buttons.toJson();e.enabled&&(e.enabled=t),this.ctx.toolbarManager.proxyGroupOptions("zoom","zoom",e)}onRangeChange(t,e){const i=this.axisIds[t];!i||!e||this.updateAxisZoom(i,t,e)}onDoubleClick(t){const{enabled:e,enableDoubleClickToReset:i,hoveredAxis:o}=this;if(!e||!i)return;const s=this.getResetZoom();if(o){const{id:a,direction:n}=o;this.updateAxisZoom(a,n,s[n])}else t.preventZoomDblClick||this.updateZoom(s)}onDragStart(t){const{enabled:e,enableAxisDragging:i,enablePanning:o,enableSelecting:s,hoveredAxis:a,ctx:{cursorManager:n,zoomManager:r}}=this;if(!e||t.button!==0)return;this.panner.stopInteractions();let l=0;if(i&&a)l=1;else{const c=this.isPanningKeyPressed(t.sourceEvent);o&&(!s||c)?(n.updateCursor(Br,"grabbing"),l=2,this.panner.start()):s&&!this.isMinZoom(this.getZoom())&&!c&&(l=3)}(this.dragState=l)!==0&&r.fireZoomPanStartEvent("zoom")}onDrag(t){const{anchorPointX:e,anchorPointY:i,axisDragger:o,dragState:s,enabled:a,paddedRect:n,panner:r,selector:l,seriesRect:c,hoveredAxis:h,ctx:{interactionManager:p,tooltipManager:u,updateService:y,zoomManager:g}}=this;if(!a||!n||!c)return;p.pushState(Ci.InteractionState.ZoomDrag);const f=this.getZoom();switch(s){case 1:{if(!h)break;const{id:m,direction:v}=h,b=v===Ci.ChartAxisDirection.X?e:i,S=g.getAxisZoom(m),x=o.update(t,v,b,c,f,S);this.updateAxisZoom(m,v,x);break}case 2:r.update(t);break;case 3:l.update(t,this.getModuleProperties(),n,f);break;case 0:return}u.updateTooltip(ed),y.update(AO.PERFORM_LAYOUT,{skipAnimations:!0})}onDragEnd(t){const{axisDragger:e,dragState:i,enabled:o,panner:s,selector:a,ctx:{cursorManager:n,interactionManager:r,tooltipManager:l}}=this;if(r.popState(Ci.InteractionState.ZoomDrag),!(!o||i===0)){switch(i){case 1:e.stop();break;case 2:s.stop();break;case 3:{if(!a.didUpdate())break;const c=this.getZoom();if(this.isMinZoom(c))break;const h=a.stop(this.seriesRect,this.paddedRect,c);this.updateZoom(h);break}}this.dragState=0,n.updateCursor(Br),l.removeTooltip(ed)}}onNavZoom(t){const{enabled:e,enableScrolling:i,scroller:o}=this;!e||!i||(t.preventDefault(),this.updateZoom(o.updateDelta(t.delta,this.getModuleProperties(),this.getZoom())))}onWheel(t){const{enabled:e,enablePanning:i,enableScrolling:o,paddedRect:s}=this;if(!e||!o||!s)return;const a=t.sourceEvent,{deltaX:n,deltaY:r}=a,l=n!=null&&r!=null&&Math.abs(n)>Math.abs(r);i&&l?this.onWheelPanning(t):this.onWheelScrolling(t)}onWheelPanning(t){const{scrollingStep:e,scrollPanner:i,seriesRect:o,ctx:{zoomManager:s}}=this;if(!o)return;t.preventDefault();const a=i.update(t,e,o,s.getAxisZooms());for(const[n,{direction:r,zoom:l}]of Object.entries(a))this.updateAxisZoom(n,r,l)}onWheelScrolling(t){const{enableAxisDragging:e,enableIndependentAxes:i,hoveredAxis:o,scroller:s,seriesRect:a,ctx:{zoomManager:n}}=this;if(!a)return;t.preventDefault();const r=e&&o!=null;let l=this.isScalingX(),c=this.isScalingY();r&&(l=o.direction===Ci.ChartAxisDirection.X,c=!l);const h=this.getModuleProperties({isScalingX:l,isScalingY:c});if(i===!0){const p=s.updateAxes(t,h,a,n.getAxisZooms());for(const[u,{direction:y,zoom:g}]of Object.entries(p))r&&o.id!==u||this.updateAxisZoom(u,y,g)}else{const p=s.update(t,h,a,this.getZoom());this.updateUnifiedZoom(p)}}onAxisLeave(){const{enabled:t,ctx:{cursorManager:e}}=this;t&&(this.hoveredAxis=void 0,e.updateCursor(Br))}onAxisHover(t,e){const{enabled:i,enableAxisDragging:o,ctx:{cursorManager:s}}=this;i&&(this.hoveredAxis={id:t.bboxProviderId??"unknown",direction:e},o&&s.updateCursor(Br,e===Lt.X?"ew-resize":"ns-resize"))}onPinchMove(t){const{enabled:e,enableScrolling:i,paddedRect:o,seriesRect:s}=this;if(!e||!i||!o||!s)return;const a=this.getZoom(),n=ne(a),r=t.deltaDistance*-.01,l=Ei(s,t.origin.x,t.origin.y);this.isScalingX()&&(n.x.max+=r*Wt(a),n.x=$h(n.x,a.x,l.x)),this.isScalingY()&&(n.y.max+=r*(a.y.max-a.y.min),n.y=$h(n.y,a.y,l.y)),this.updateZoom(Pe(n)),t.preventDefault()}onLayoutComplete(t){const{enabled:e,rangeX:i,rangeY:o,ratioX:s,ratioY:a}=this;if(!e)return;const{series:{rect:n,paddedRect:r,shouldFlipXY:l},axes:c}=t;if(this.seriesRect=n,this.paddedRect=r,this.shouldFlipXY=l,this.restoreEvent&&(this.restoreZoom(this.restoreEvent),this.restoreEvent=void 0),this.hasPerformedLayout=!0,!this.updateAxes(c))return;i.updateDomain(this.axisDomains[Lt.X]),o.updateDomain(this.axisDomains[Lt.Y]);const p={x:i.getRange()??s.getRatio(),y:o.getRange()??a.getRatio()};(p.x!=null||p.y!=null)&&this.updateZoom(Pe(ne(p)))}onUpdateComplete(t){const{minRect:e,minVisibleRect:i}=t,{enabled:o,minVisibleItemsX:s,minVisibleItemsY:a,paddedRect:n,shouldFlipXY:r}=this;if(!o||!n||!e||!i)return;const l=this.getZoom(),c=r?a:s,h=r?s:a,p=i.width*c/n.width,u=i.height*h/n.height,y=lm(p*Wt(l)),g=lm(u*je(l));this.isScalingX()&&(this.minRatioX=Math.min(1,y)),this.isScalingY()&&(this.minRatioY=Math.min(1,g)),this.minRatioX||(this.minRatioX=this.minRatioY||0),this.minRatioY||(this.minRatioY=this.minRatioX||0)}onZoomChange(t){t.callerId!=="zoom"&&this.panner.stopInteractions();const e=this.getZoom(),i=this.getModuleProperties();this.contextMenu.toggleActions(e),this.toolbar.toggleButtons(e,i)}onRestoreZoom(t){this.hasPerformedLayout?this.restoreZoom(t):this.restoreEvent=t}onZoomPanStart(t){t.callerId==="zoom"&&this.panner.stopInteractions()}onPanUpdate(t){const{panner:e,seriesRect:i,ctx:{tooltipManager:o,zoomManager:s}}=this;if(!i)return;const a=e.translateZooms(i,s.getAxisZooms(),t.deltaX,t.deltaY);for(const[n,{direction:r,zoom:l}]of Object.entries(a))this.updateAxisZoom(n,r,l);o.updateTooltip(ed)}updateAxes(t){if(!t)return;const e=this.getPrimaryAxis(t,Lt.X),i=this.getPrimaryAxis(t,Lt.Y);if(!(!e||!i))return this.axisIds={[Lt.X]:e.axisId,[Lt.Y]:i.axisId},this.axisDomains={[Lt.X]:e.domain,[Lt.Y]:i.domain},e.changed||i.changed}getPrimaryAxis(t,e){const i=t.find(n=>n.direction===e);if(!i)return;let o=[i.domain[0],i.domain.at(-1)];o[0]instanceof Date&&o[1]instanceof Date&&(o=[o[0].getTime(),o[1].getTime()]);const s=this.axisDomains[e],a=s==null||!kO(s,o);return{axisId:i.id,changed:a,domain:o}}isPanningKeyPressed(t){switch(this.panKey){case"alt":return t.altKey;case"ctrl":return t.ctrlKey;case"shift":return t.shiftKey;case"meta":return t.metaKey}}isScalingX(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="y":this.axes==="x"}isScalingY(){return this.axes==="xy"?!0:this.shouldFlipXY?this.axes==="x":this.axes==="y"}getAnchorPointX(){return this.shouldFlipXY?this.anchorPointY:this.anchorPointX}getAnchorPointY(){return this.shouldFlipXY?this.anchorPointX:this.anchorPointY}isMinZoom(t){return Zh(t,this.minRatioX,this.minRatioY)}updateZoom(t){this.enableIndependentAxes?this.updatePrimaryAxisZooms(t):this.updateUnifiedZoom(t)}updatePrimaryAxisZooms(t){const e=this.axisIds[Lt.X],i=this.axisIds[Lt.Y];e&&this.updateAxisZoom(e,Lt.X,t.x),i&&this.updateAxisZoom(i,Lt.Y,t.y)}updateUnifiedZoom(t){const{minRatioX:e,minRatioY:i,ctx:{zoomManager:o}}=this,s=Wt(t),a=je(t),n=this.getZoom(),r=s<=Wt(n)&&s<e,l=a<=je(n)&&a<i;r&&(t.x=Yf(t.x,n.x,e)),l&&(t.y=Yf(t.y,n.y,i)),o.updateZoom("zoom",t)}updateAxisZoom(t,e,i){const{enableIndependentAxes:o,minRatioX:s,minRatioY:a,ctx:{zoomManager:n}}=this;if(!i)return;const r=this.getZoom();if(o!==!0){r[e]=i,this.updateUnifiedZoom(r);return}const l=i.max-i.min,c=r[e].max-r[e].min,h=e===Lt.X?s:a;l<=c&&l<h||n.updateAxisZoom("zoom",t,i)}restoreZoom(t){const{rangeX:e,rangeY:i,ratioX:o,ratioY:s}=t;e&&this.rangeX.restore(e.start,e.end),i&&this.rangeY.restore(i.start,i.end),o&&!e&&this.ratioX.restore(o.start,o.end),s&&!i&&this.ratioY.restore(s.start,s.end)}getZoom(){return ne(this.ctx.zoomManager.getZoom())}getResetZoom(){const t=this.rangeX.getInitialRange()??this.ratioX.getInitialRatio()??st,e=this.rangeY.getInitialRange()??this.ratioY.getInitialRatio()??st;return{x:t,y:e}}getModuleProperties(t){return{anchorPointX:t?.anchorPointX??this.getAnchorPointX(),anchorPointY:t?.anchorPointY??this.getAnchorPointY(),enabled:t?.enabled??this.enabled,independentAxes:t?.independentAxes??this.enableIndependentAxes===!0,isScalingX:t?.isScalingX??this.isScalingX(),isScalingY:t?.isScalingY??this.isScalingY(),minRatioX:t?.minRatioX??this.minRatioX,minRatioY:t?.minRatioY??this.minRatioY,rangeX:t?.rangeX??this.rangeX,scrollingStep:t?.scrollingStep??this.scrollingStep}}};d([TO({newValue(t){this.onEnabledChange(t)}}),Ct(Do)],re.prototype,"enabled",2),d([Ct(Do)],re.prototype,"enableAxisDragging",2),d([Ct(Do)],re.prototype,"enableDoubleClickToReset",2),d([Ct(Do,{optional:!0})],re.prototype,"enableIndependentAxes",2),d([Ct(Do)],re.prototype,"enablePanning",2),d([Ct(Do)],re.prototype,"enableScrolling",2),d([Ct(Do)],re.prototype,"enableSelecting",2),d([Ct(Pr(["alt","ctrl","meta","shift"],"a pan key"))],re.prototype,"panKey",2),d([Ct(Pr(["x","y","xy"],"an axis"))],re.prototype,"axes",2),d([Ct(rm)],re.prototype,"scrollingStep",2),d([Ct(nm.restrict({min:1}))],re.prototype,"minVisibleItemsX",2),d([Ct(nm.restrict({min:1}))],re.prototype,"minVisibleItemsY",2),d([Ct(cm)],re.prototype,"anchorPointX",2),d([Ct(cm)],re.prototype,"anchorPointY",2),d([DO("panner.deceleration"),Ct(MO(rm,Pr(["off","short","long"],"a deceleration")))],re.prototype,"deceleration",2);var NO={enabled:!0,buttons:[{icon:"zoom-out",tooltip:"toolbarZoomZoomOut",value:"zoom-out",section:"scale"},{icon:"zoom-in",tooltip:"toolbarZoomZoomIn",value:"zoom-in",section:"scale"},{icon:"pan-left",tooltip:"toolbarZoomPanLeft",value:"pan-left",section:"pan"},{icon:"pan-right",tooltip:"toolbarZoomPanRight",value:"pan-right",section:"pan"},{icon:"reset",tooltip:"toolbarZoomReset",value:"reset",section:"reset"}]},OO={type:"root",optionsKey:"zoom",packageType:"enterprise",chartTypes:["cartesian","topology"],dependencies:["toolbar"],moduleFactory:t=>new re(t),themeTemplate:{zoom:{anchorPointX:"end",anchorPointY:"middle",axes:"x",buttons:NO,enabled:!1,enableAxisDragging:!0,enableDoubleClickToReset:!0,enablePanning:!0,enableScrolling:!0,enableSelecting:!1,deceleration:"short",minVisibleItemsX:2,minVisibleItemsY:2,panKey:"alt",scrollingStep:.1}}};import{_Theme as id}from"ag-charts-community";import{_ModuleSupport as LO,_Scene as CO,_Util as EO}from"ag-charts-community";var{BOOLEAN:hm,OBJECT:_O,POSITION:RO,POSITIVE_NUMBER:od,BaseProperties:wO,AxisTicks:PO,ZIndexMap:BO,ProxyProperty:sd,Validate:as,LayoutElement:zO}=LO,{Group:FO,Rect:VO,Triangle:UO,TranslatableLayer:HO,LinearGradient:GO}=CO,{createId:WO}=EO,ad=class extends wO{constructor(){super(...arguments),this.thickness=16,this.preferredLength=100}};d([as(od)],ad.prototype,"thickness",2),d([as(od)],ad.prototype,"preferredLength",2);var zr=class{constructor(t){this.axisTicks=t}};d([sd("axisTicks.label")],zr.prototype,"label",2),d([sd("axisTicks.interval")],zr.prototype,"interval",2),d([sd("axisTicks.padding")],zr.prototype,"padding",2);var ns=class{constructor(t){this.ctx=t,this.id=WO(this),this.legendGroup=new HO({name:"legend",zIndex:BO.LEGEND}),this.gradientRect=new VO,this.arrow=new UO,this.ticksGroup=new FO({name:"legend-axis-group"}),this.destroyFns=[],this.enabled=!1,this.position="bottom",this.reverseOrder=!1,this.gradient=new ad,this.spacing=20,this.data=[],this.highlightManager=t.highlightManager,this.axisTicks=new PO,this.axisTicks.attachAxis(this.ticksGroup),this.scale=new zr(this.axisTicks),this.legendGroup.append([this.gradientRect,this.arrow,this.ticksGroup]),this.destroyFns.push(t.highlightManager.addListener("highlight-change",()=>this.onChartHoverChange()),t.layoutManager.registerElement(zO.Legend,e=>this.onStartLayout(e)),()=>this.legendGroup.remove())}isVertical(){return this.position==="right"||this.position==="left"}destroy(){this.destroyFns.forEach(t=>t())}attachLegend(t){t.appendChild(this.legendGroup)}onStartLayout(t){const[e]=this.data;if(!this.enabled||!e?.enabled){this.legendGroup.visible=!1;return}const{colorRange:i}=this.normalizeColorArrays(e);this.updateGradientRect(t.layoutBox,i);const o=this.updateAxis(e),{left:s,top:a}=this.getMeasurements(t.layoutBox,o);this.updateArrow(),this.legendGroup.visible=!0,this.legendGroup.translationX=s,this.legendGroup.translationY=a}normalizeColorArrays(t){let e=t.colorDomain.slice();const i=t.colorRange.slice();if(e.length===i.length)return{colorDomain:e,colorRange:i};e.length>i.length&&i.splice(e.length);const[o,s]=e,a=i.length;return e=i.map((n,r)=>r===0?o:r===a-1?s:o+(s-o)*r/(a-1)),{colorDomain:e,colorRange:i}}updateGradientRect(t,e){const{gradientRect:i}=this,{preferredLength:o,thickness:s}=this.gradient;let a;this.isVertical()?(a=0,i.width=s,i.height=Math.min(t.height,o)):(a=90,i.width=Math.min(t.width,o),i.height=s);const n=new GO("oklch",e.map((r,l)=>({offset:l/(e.length-1),color:r})),a);i.fill=n}updateAxis(t){const{axisTicks:e}=this,i=this.isVertical(),o=this.reverseOrder!==i;return e.position=this.position,e.translationX=i?this.gradient.thickness:0,e.translationY=i?0:this.gradient.thickness,e.scale.domain=o?t.colorDomain.slice().reverse():t.colorDomain,e.scale.range=i?[0,this.gradientRect.height]:[0,this.gradientRect.width],e.calculateLayout()}updateArrow(){const t=this.highlightManager.getActiveHighlight(),{arrow:e}=this;if(t?.colorValue==null){e.visible=!1;return}const{scale:i,label:o}=this.axisTicks,s=o.fontSize??0,a=i.convert(t.colorValue);let{x:n,y:r}=this.gradientRect,l=Math.PI;this.isVertical()?(n-=s/2,r+=a,l/=2):(n+=a,r-=s/2),e.visible=!0,e.fill=o.color,e.rotation=l,e.size=s,e.translationX=n,e.translationY=r}getMeasurements(t,e){let{x:i,y:o}=t,{width:s,height:a}=this.gradientRect;switch(this.isVertical()?s+=e.width+5:a+=e.height+5,this.position){case"left":o+=t.height/2-a/2,t.shrink(s+this.spacing,"left");break;case"right":i+=t.width-s,o+=t.height/2-a/2,t.shrink(s+this.spacing,"right");break;case"top":i+=t.width/2-s/2,t.shrink(a+this.spacing,"top");break;case"bottom":i+=t.width/2-s/2,o+=t.height-a,t.shrink(a+this.spacing,"bottom")}return{top:o,left:i}}onChartHoverChange(){this.enabled&&this.updateArrow()}};ns.className="GradientLegend",d([as(hm)],ns.prototype,"enabled",2),d([as(RO)],ns.prototype,"position",2),d([as(hm)],ns.prototype,"reverseOrder",2),d([as(_O)],ns.prototype,"gradient",2),d([as(od)],ns.prototype,"spacing",2);var KO={type:"legend",optionsKey:"gradientLegend",packageType:"enterprise",chartTypes:["cartesian","polar","hierarchy","topology","flow-proportion","standalone","gauge"],identifier:"gradient",moduleFactory:t=>new ns(t),themeTemplate:{enabled:!1,position:"bottom",spacing:20,scale:{padding:13,label:{color:id.DEFAULT_LABEL_COLOUR,fontSize:id.FONT_SIZE.SMALL,fontFamily:id.DEFAULT_FONT_FAMILY},interval:{minSpacing:1}},gradient:{preferredLength:100,thickness:16},reverseOrder:!1}},YO=class{constructor(){this.ieCompatibility=!1}init(){this.ieCompatibility=this.md5("hello")!="5d41402abc4b2a76b9719d911017c592"}md5cycle(t,e){let i=t[0],o=t[1],s=t[2],a=t[3];i=this.ff(i,o,s,a,e[0],7,-680876936),a=this.ff(a,i,o,s,e[1],12,-389564586),s=this.ff(s,a,i,o,e[2],17,606105819),o=this.ff(o,s,a,i,e[3],22,-1044525330),i=this.ff(i,o,s,a,e[4],7,-176418897),a=this.ff(a,i,o,s,e[5],12,1200080426),s=this.ff(s,a,i,o,e[6],17,-1473231341),o=this.ff(o,s,a,i,e[7],22,-45705983),i=this.ff(i,o,s,a,e[8],7,1770035416),a=this.ff(a,i,o,s,e[9],12,-1958414417),s=this.ff(s,a,i,o,e[10],17,-42063),o=this.ff(o,s,a,i,e[11],22,-1990404162),i=this.ff(i,o,s,a,e[12],7,1804603682),a=this.ff(a,i,o,s,e[13],12,-40341101),s=this.ff(s,a,i,o,e[14],17,-1502002290),o=this.ff(o,s,a,i,e[15],22,1236535329),i=this.gg(i,o,s,a,e[1],5,-165796510),a=this.gg(a,i,o,s,e[6],9,-1069501632),s=this.gg(s,a,i,o,e[11],14,643717713),o=this.gg(o,s,a,i,e[0],20,-373897302),i=this.gg(i,o,s,a,e[5],5,-701558691),a=this.gg(a,i,o,s,e[10],9,38016083),s=this.gg(s,a,i,o,e[15],14,-660478335),o=this.gg(o,s,a,i,e[4],20,-405537848),i=this.gg(i,o,s,a,e[9],5,568446438),a=this.gg(a,i,o,s,e[14],9,-1019803690),s=this.gg(s,a,i,o,e[3],14,-187363961),o=this.gg(o,s,a,i,e[8],20,1163531501),i=this.gg(i,o,s,a,e[13],5,-1444681467),a=this.gg(a,i,o,s,e[2],9,-51403784),s=this.gg(s,a,i,o,e[7],14,1735328473),o=this.gg(o,s,a,i,e[12],20,-1926607734),i=this.hh(i,o,s,a,e[5],4,-378558),a=this.hh(a,i,o,s,e[8],11,-2022574463),s=this.hh(s,a,i,o,e[11],16,1839030562),o=this.hh(o,s,a,i,e[14],23,-35309556),i=this.hh(i,o,s,a,e[1],4,-1530992060),a=this.hh(a,i,o,s,e[4],11,1272893353),s=this.hh(s,a,i,o,e[7],16,-155497632),o=this.hh(o,s,a,i,e[10],23,-1094730640),i=this.hh(i,o,s,a,e[13],4,681279174),a=this.hh(a,i,o,s,e[0],11,-358537222),s=this.hh(s,a,i,o,e[3],16,-722521979),o=this.hh(o,s,a,i,e[6],23,76029189),i=this.hh(i,o,s,a,e[9],4,-640364487),a=this.hh(a,i,o,s,e[12],11,-421815835),s=this.hh(s,a,i,o,e[15],16,530742520),o=this.hh(o,s,a,i,e[2],23,-995338651),i=this.ii(i,o,s,a,e[0],6,-198630844),a=this.ii(a,i,o,s,e[7],10,1126891415),s=this.ii(s,a,i,o,e[14],15,-1416354905),o=this.ii(o,s,a,i,e[5],21,-57434055),i=this.ii(i,o,s,a,e[12],6,1700485571),a=this.ii(a,i,o,s,e[3],10,-1894986606),s=this.ii(s,a,i,o,e[10],15,-1051523),o=this.ii(o,s,a,i,e[1],21,-2054922799),i=this.ii(i,o,s,a,e[8],6,1873313359),a=this.ii(a,i,o,s,e[15],10,-30611744),s=this.ii(s,a,i,o,e[6],15,-1560198380),o=this.ii(o,s,a,i,e[13],21,1309151649),i=this.ii(i,o,s,a,e[4],6,-145523070),a=this.ii(a,i,o,s,e[11],10,-1120210379),s=this.ii(s,a,i,o,e[2],15,718787259),o=this.ii(o,s,a,i,e[9],21,-343485551),t[0]=this.add32(i,t[0]),t[1]=this.add32(o,t[1]),t[2]=this.add32(s,t[2]),t[3]=this.add32(a,t[3])}cmn(t,e,i,o,s,a){return e=this.add32(this.add32(e,t),this.add32(o,a)),this.add32(e<<s|e>>>32-s,i)}ff(t,e,i,o,s,a,n){return this.cmn(e&i|~e&o,t,e,s,a,n)}gg(t,e,i,o,s,a,n){return this.cmn(e&o|i&~o,t,e,s,a,n)}hh(t,e,i,o,s,a,n){return this.cmn(e^i^o,t,e,s,a,n)}ii(t,e,i,o,s,a,n){return this.cmn(i^(e|~o),t,e,s,a,n)}md51(t){const e=t.length,i=[1732584193,-271733879,-1732584194,271733878];let o;for(o=64;o<=t.length;o+=64)this.md5cycle(i,this.md5blk(t.substring(o-64,o)));t=t.substring(o-64);const s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(o=0;o<t.length;o++)s[o>>2]|=t.charCodeAt(o)<<(o%4<<3);if(s[o>>2]|=128<<(o%4<<3),o>55)for(this.md5cycle(i,s),o=0;o<16;o++)s[o]=0;return s[14]=e*8,this.md5cycle(i,s),i}md5blk(t){const e=[];for(let i=0;i<64;i+=4)e[i>>2]=t.charCodeAt(i)+(t.charCodeAt(i+1)<<8)+(t.charCodeAt(i+2)<<16)+(t.charCodeAt(i+3)<<24);return e}rhex(t){const e="0123456789abcdef".split("");let i="",o=0;for(;o<4;o++)i+=e[t>>o*8+4&15]+e[t>>o*8&15];return i}hex(t){for(let e=0;e<t.length;e++)t[e]=this.rhex(t[e]);return t.join("")}md5(t){return this.hex(this.md51(t))}add32(t,e){return this.ieCompatibility?this.add32Compat(t,e):this.add32Std(t,e)}add32Std(t,e){return t+e&4294967295}add32Compat(t,e){const i=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(i>>16)<<16|i&65535}};function nd(t){return t==null||t.length===0}var Fr={"01":"GRID","02":"CHARTS","0102":"BOTH"},dm="https://ag-grid.com/charts/licensing/",pm=class Je{constructor(e){this.gridContext=!1,this.watermarkMessage=void 0,this.totalMessageLength=124,this.document=e,this.md5=new YO,this.md5.init()}validateLicense(){const e=this.getLicenseDetails(this.licenseKey,this.gridContext),i=`AG ${e.currentLicenseType==="BOTH"?"Grid and ":""}Charts Enterprise`,o=e.suppliedLicenseType===void 0?"":`AG ${e.suppliedLicenseType==="BOTH"?"Grid and AG Charts":e.suppliedLicenseType==="GRID"?"Grid":"Charts"} Enterprise`;if(e.missing)(!this.isWebsiteUrl()||this.isForceWatermark())&&this.outputMissingLicenseKey(i);else if(e.expired){const s=Je.getChartsReleaseDate(),a=Je.formatDate(s);this.outputExpiredKey(e.expiry,a,o)}else e.valid?e.isTrial&&e.trialExpired&&this.outputExpiredTrialKey(e.expiry,i,o):this.outputInvalidLicenseKey(!!e.incorrectLicenseType,i,o)}static extractExpiry(e){const i=e.substring(e.lastIndexOf("_")+1,e.length);return new Date(parseInt(Je.decode(i),10))}static extractLicenseComponents(e){let i=e.replace(/[\u200B-\u200D\uFEFF]/g,"");if(i=i.replace(/\r?\n|\r/g,""),e.length<=32)return{md5:null,license:e,version:null,isTrial:null};const o=i.length-32,s=i.substring(o),a=i.substring(0,o),[n,r,l]=Je.extractBracketedInformation(i);return{md5:s,license:a,version:n,isTrial:r,type:l}}getLicenseDetails(e,i=!1){const o="CHARTS";if(nd(e))return{licenseKey:e,valid:!1,missing:!0,currentLicenseType:o};const s=Je.getChartsReleaseDate(),{md5:a,license:n,version:r,isTrial:l,type:c}=Je.extractLicenseComponents(e);let h=a===this.md5.md5(n)&&e.indexOf("For_Trialing_ag-Grid_Only")===-1,p,u,y=null,g=!1,f;function m(){p=y<new Date,u=void 0}if(h&&(y=Je.extractExpiry(n),h=!isNaN(y.getTime()),h))switch(u=s>y,r){case"legacy":case"2":{h=!1;break}case"3":nd(c)?h=!1:(f=c,c!==Fr["02"]&&c!==Fr["0102"]?(h=!1,g=!0):l&&m())}return h?{licenseKey:e,valid:h,expiry:Je.formatDate(y),expired:u,version:r,isTrial:l,trialExpired:p,invalidLicenseTypeForCombo:i?f!=="BOTH":void 0,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:f}:{licenseKey:e,valid:h,incorrectLicenseType:g,currentLicenseType:o,suppliedLicenseType:f}}isDisplayWatermark(){return this.isForceWatermark()||!this.isLocalhost()&&!this.isWebsiteUrl()&&!nd(this.watermarkMessage)}getWatermarkMessage(){return this.watermarkMessage??""}getHostname(){if(!this.document)return"localhost";const e=this.document.defaultView??window;if(!e)return"localhost";const i=e.location,{hostname:o=""}=i;return o}isForceWatermark(){if(!this.document)return!1;const e=this.document?.defaultView??typeof window<"u"?window:void 0;if(!e)return!1;const{pathname:i}=e.location;return i?i.indexOf("forceWatermark")!==-1:!1}isWebsiteUrl(){return this.getHostname().match(/^((?:[\w-]+\.)?ag-grid\.com)$/)!==null}isLocalhost(){return this.getHostname().match(/^(?:127\.0\.0\.1|localhost)$/)!==null}static formatDate(e){const i=["January","February","March","April","May","June","July","August","September","October","November","December"],o=e.getDate(),s=e.getMonth(),a=e.getFullYear();return o+" "+i[s]+" "+a}static getChartsReleaseDate(){return new Date(parseInt(Je.decode(Je.RELEASE_INFORMATION),10))}static decode(e){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let o="",s,a,n,r,l,c,h,p=0;const u=e.replace(/[^A-Za-z0-9+/=]/g,"");for(;p<u.length;)r=i.indexOf(u.charAt(p++)),l=i.indexOf(u.charAt(p++)),c=i.indexOf(u.charAt(p++)),h=i.indexOf(u.charAt(p++)),s=r<<2|l>>4,a=(l&15)<<4|c>>2,n=(c&3)<<6|h,o=o+String.fromCharCode(s),c!=64&&(o=o+String.fromCharCode(a)),h!=64&&(o=o+String.fromCharCode(n));return o=Je.utf8_decode(o),o}static utf8_decode(e){e=e.replace(/rn/g,"n");let i="";for(let o=0;o<e.length;o++){const s=e.charCodeAt(o);s<128?i+=String.fromCharCode(s):s>127&&s<2048?(i+=String.fromCharCode(s>>6|192),i+=String.fromCharCode(s&63|128)):(i+=String.fromCharCode(s>>12|224),i+=String.fromCharCode(s>>6&63|128),i+=String.fromCharCode(s&63|128))}return i}setLicenseKey(e,i=!1){this.gridContext=i,this.licenseKey=e}static extractBracketedInformation(e){if(!e.includes("["))return["legacy",!1,void 0];const i=e.match(/\[(.*?)\]/g).map(r=>r.replace("[","").replace("]",""));if(!i||i.length===0)return["legacy",!1,void 0];const o=i.filter(r=>r==="TRIAL").length===1,s=i.filter(r=>r.indexOf("v")===0)[0],a=s?s.replace("v",""):"legacy",n=Fr[i.filter(r=>Fr[r])[0]];return[a,o,n]}centerPadAndOutput(e){const i=this.totalMessageLength-e.length;console.error(e.padStart(i/2+e.length,"*").padEnd(this.totalMessageLength,"*"))}padAndOutput(e,i="*",o=""){console.error(e.padEnd(this.totalMessageLength-o.length,i)+o)}outputInvalidLicenseKey(e,i,o){this.gridContext||(e?(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Incompatible License Key "),this.padAndOutput(`* Your license key is for ${o} only and does not cover you for ${i}.`," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${dm}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")):(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Invalid License Key "),this.padAndOutput("* Your license key is not valid."," ","*"),this.padAndOutput(`* To troubleshoot your license key visit ${dm}.`," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput(""))),this.watermarkMessage="Invalid License"}outputExpiredTrialKey(e,i,o){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${i} License `),this.centerPadAndOutput(" Trial Period Expired. "),this.padAndOutput(`* Your trial only license for ${o} expired on ${e}.`," ","*"),this.padAndOutput("* Please email info@ag-grid.com to purchase a license."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="Trial Period Expired"}outputMissingLicenseKey(e){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${e} License `),this.centerPadAndOutput(" License Key Not Found "),this.padAndOutput(`* All ${e} features are unlocked for trial.`," ","*"),this.padAndOutput("* If you want to hide the watermark please email info@ag-grid.com for a trial license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="For Trial Use Only"}outputExpiredKey(e,i,o){this.gridContext||(this.centerPadAndOutput(""),this.centerPadAndOutput(` ${o} License `),this.centerPadAndOutput(" Incompatible Software Version "),this.padAndOutput(`* Your license key works with versions of ${o} released before ${e}.`," ","*"),this.padAndOutput(`* The version you are trying to use was released on ${i}.`," ","*"),this.padAndOutput("* Please contact info@ag-grid.com to renew your license key."," ","*"),this.centerPadAndOutput(""),this.centerPadAndOutput("")),this.watermarkMessage="License Expired"}};pm.RELEASE_INFORMATION="MTc0Mzc4MTI5MTExNw==";var jO=pm;import{_ModuleSupport as XO}from"ag-charts-community";var{createElement:ZO}=XO;function $O(t,e){const i=t.addChild("canvas-overlay","watermark"),o=ZO("span");o.innerText=e,i.addEventListener("animationend",()=>{t.removeChild("canvas-overlay","watermark"),t.removeStyles("watermark")}),i.classList.add("ag-watermark"),i.appendChild(o)}import{_Theme as da,_Util as QO}from"ag-charts-community";import{_ModuleSupport as Vr,_Scale as qO,_Scene as JO,_Util as rd}from"ag-charts-community";function tL(t){return{from:t?{scalingX:1,scalingY:0}:{scalingX:0,scalingY:1},to:{scalingX:1,scalingY:1}}}function eL(t){return(e,i)=>t?{scalingCenterY:i.scaledValues.medianValue}:{scalingCenterX:i.scaledValues.medianValue}}import{_ModuleSupport as iL,_Scene as oL,_Util as sL}from"ag-charts-community";var{ScalableGroup:aL,Rect:pa,Line:cn,BBox:nL,Selection:um}=oL,{Logger:rL}=sL,lL=class extends aL{constructor(){super(),this.append([new pa({tag:0}),new pa({tag:0}),new pa({tag:2}),new pa({tag:1}),new cn({tag:3}),new cn({tag:3}),new cn({tag:4}),new cn({tag:4})])}updateDatumStyles(t,e,i,o){const{bandwidth:s,scaledValues:{xValue:a,medianValue:n}}=t;let{minValue:r,q1Value:l,q3Value:c,maxValue:h}=t.scaledValues;(i&&!o||!i&&o)&&([h,c,l,r]=[r,l,c,h]);const p=(R,z,F,U)=>i?{y:R,x:z,width:U,height:F}:{x:R,y:z,width:F,height:U},u=(R,z,F)=>i?{y1:R,y2:z,x:F}:{x1:R,x2:z,y:F},y=(R,z,F)=>i?{x1:z,x2:F,y:R}:{x:R,y1:z,y2:F},g=(R,z,F,U)=>({x:R,y:z,width:F,height:U}=p(R,z,F,U),new nL(R,z,F,U)),{fill:f,fillOpacity:m,stroke:v,strokeWidth:b,strokeOpacity:S,lineDash:x,lineDashOffset:M,cornerRadius:T,cap:A,whisker:D}=e,I=um.select(this,pa),N=I.selectByTag(0),[O]=I.selectByTag(2),[L]=I.selectByTag(1),C=I.selectByTag(3),k=I.selectByTag(4);D.strokeWidth>s&&(D.strokeWidth=s);const E=p(l,a,c-l,s);O.setProperties(E),N[0].setProperties(E),N[0].setProperties({cornerRadius:T,clipBBox:g(l,a,Math.round(n-l+b/2),s)}),N[1].setProperties(E),N[1].setProperties({cornerRadius:T,clipBBox:g(Math.round(n-b/2),a,Math.floor(c-n+b/2),s)});const _=Math.max(Math.round(n-b/2),l+b),w=Math.min(Math.round(n+b/2),c-b);L.setProperties(E),L.setProperties({visible:_<w,cornerRadius:T,clipBBox:g(_,a+b,w-_,Math.max(0,s-b*2))});const B=Math.floor(a+s*(1-A.lengthRatio)/2),P=Math.ceil(a+s*(1+A.lengthRatio)/2);k[0].setProperties(y(r,B,P)),k[1].setProperties(y(h,B,P)),C[0].setProperties(u(Math.round(r+D.strokeWidth/2),l,Math.floor(a+s/2))),C[1].setProperties(u(c,Math.round(h-D.strokeWidth/2),Math.floor(a+s/2)));for(const R of N)R.setProperties({fill:f,fillOpacity:m,strokeWidth:b*2,strokeOpacity:0});L.setProperties({fill:v,fillOpacity:S,strokeWidth:0});for(const R of[...C,...k])R.setProperties(D);O.setProperties({stroke:v,strokeWidth:b,strokeOpacity:S,lineDash:x,lineDashOffset:M,cornerRadius:T,fillOpacity:0})}distanceSquared(t,e){const i=um.selectByClass(this,pa,cn);return iL.nearestSquared(t,e,i).distanceSquared}get midPoint(){const t=this.datum;return t.midPoint===void 0?(rL.error("BoxPlotGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}};import{_ModuleSupport as cL}from"ag-charts-community";var{BaseProperties:gm,AbstractBarSeriesProperties:hL,SeriesTooltip:dL,Validate:at,COLOR_STRING:Ur,FUNCTION:pL,LINE_DASH:ym,OBJECT:ld,POSITIVE_NUMBER:hn,RATIO:Hr,STRING:Be,mergeDefaults:uL}=cL,fm=class extends gm{constructor(){super(...arguments),this.lengthRatio=.5}};d([at(Hr)],fm.prototype,"lengthRatio",2);var ua=class extends gm{};d([at(Ur,{optional:!0})],ua.prototype,"stroke",2),d([at(hn)],ua.prototype,"strokeWidth",2),d([at(Hr)],ua.prototype,"strokeOpacity",2),d([at(ym,{optional:!0})],ua.prototype,"lineDash",2),d([at(hn)],ua.prototype,"lineDashOffset",2);var ut=class extends hL{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.cap=new fm,this.whisker=new ua,this.tooltip=new dL,this.backgroundFill="white"}toJson(){const{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}=this,a=super.toJson();return a.whisker=uL(a.whisker,{stroke:t,strokeWidth:e,strokeOpacity:i,lineDash:o,lineDashOffset:s}),a}};d([at(Be)],ut.prototype,"xKey",2),d([at(Be)],ut.prototype,"minKey",2),d([at(Be)],ut.prototype,"q1Key",2),d([at(Be)],ut.prototype,"medianKey",2),d([at(Be)],ut.prototype,"q3Key",2),d([at(Be)],ut.prototype,"maxKey",2),d([at(Be,{optional:!0})],ut.prototype,"xName",2),d([at(Be,{optional:!0})],ut.prototype,"yName",2),d([at(Be,{optional:!0})],ut.prototype,"minName",2),d([at(Be,{optional:!0})],ut.prototype,"q1Name",2),d([at(Be,{optional:!0})],ut.prototype,"medianName",2),d([at(Be,{optional:!0})],ut.prototype,"q3Name",2),d([at(Be,{optional:!0})],ut.prototype,"maxName",2),d([at(Ur,{optional:!0})],ut.prototype,"fill",2),d([at(Hr)],ut.prototype,"fillOpacity",2),d([at(Ur)],ut.prototype,"stroke",2),d([at(hn)],ut.prototype,"strokeWidth",2),d([at(Hr)],ut.prototype,"strokeOpacity",2),d([at(ym)],ut.prototype,"lineDash",2),d([at(hn)],ut.prototype,"lineDashOffset",2),d([at(hn)],ut.prototype,"cornerRadius",2),d([at(pL,{optional:!0})],ut.prototype,"itemStyler",2),d([at(ld)],ut.prototype,"cap",2),d([at(ld)],ut.prototype,"whisker",2),d([at(ld)],ut.prototype,"tooltip",2),d([at(Ur)],ut.prototype,"backgroundFill",2);var{extractDecoratedProperties:mm,fixNumericExtent:gL,keyProperty:yL,mergeDefaults:cd,SeriesNodePickMode:xm,SMALLEST_KEY_INTERVAL:fL,valueProperty:dn,diff:mL,animationValidation:xL,convertValuesToScaleByDefs:SL,computeBarFocusBounds:bL}=Vr,{motion:Sm}=JO,{ContinuousScale:vL}=qO,{Color:hd}=rd,ML=class extends Vr.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.minKey=o.properties.minKey,this.q1Key=o.properties.q1Key,this.medianKey=o.properties.medianKey,this.q3Key=o.properties.q3Key,this.maxKey=o.properties.maxKey}},dd=class extends Vr.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[xm.NEAREST_NODE,xm.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["medianKey","q1Key","q3Key","minKey","maxKey"]},directionNames:{x:["xName"],y:["medianName","q1Name","q3Name","minName","maxName"]},pathsPerSeries:[],hasHighlightedLabels:!0}),this.properties=new ut,this.NodeEvent=ML}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n}=this.properties,r=!this.ctx.animationManager.isSkipped(),l=this.getCategoryAxis()?.scale,c=this.getValueAxis()?.scale,{isContinuousX:h,xScaleType:p,yScaleType:u}=this.getScaleInformation({xScale:l,yScale:c}),y=[];r&&this.processedData&&y.push(mL(this.processedData)),r&&y.push(xL());const{processedData:g}=await this.requestDataModel(t,this.data,{props:[yL(e,p,{id:"xValue"}),dn(i,u,{id:"minValue"}),dn(o,u,{id:"q1Value"}),dn(s,u,{id:"medianValue"}),dn(a,u,{id:"q3Value"}),dn(n,u,{id:"maxValue"}),...h?[fL]:[],...y]});this.smallestDataInterval=g.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];if(t===this.getBarDirection()){const n=i.getDomain(this,"minValue","value",e),r=i.getDomain(this,"maxValue","value",e);return gL([Math.min(...n),Math.max(...r)])}const{index:o,def:s}=i.resolveProcessedDataDefById(this,"xValue"),a=e.domain.keys[o];return s.type==="key"&&s.valueType==="category"?a:this.padBandExtent(a)}async createNodeData(){const{visible:t,dataModel:e}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(e&&i&&o))return;const{xKey:s,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p,cap:u,whisker:y}=this.properties,g=[],f=e.resolveProcessedDataDefsByIds(this,["xValue","minValue","q1Value","medianValue","q3Value","maxValue"]),{barWidth:m,groupIndex:v}=this.updateGroupScale(i),b=vL.is(i.scale)?m*-.5:0,{groupScale:S,processedData:x}=this,M=this.isVertical(),T={itemId:s,nodeData:g,labelData:[],scales:this.calculateScaling(),visible:this.visible};return t&&x?.data.forEach(({datum:A,keys:D,values:I})=>{const{xValue:N,minValue:O,q1Value:L,medianValue:C,q3Value:k,maxValue:E}=e.resolveProcessedDataDefsValues(f,{keys:D,values:I});if([O,L,C,k,E].some(U=>typeof U!="number")||O>L||L>C||C>k||k>E)return;const _=SL({defs:f,values:{xValue:N,minValue:O,q1Value:L,medianValue:C,q3Value:k,maxValue:E},xAxis:i,yAxis:o});_.xValue+=Math.round(S.convert(String(v)))+b;const w=Math.round(m),B=Math.abs(_.q3Value-_.q1Value),P=_.xValue+w/2,R=Math.min(_.q3Value,_.q1Value)+B/2,z={x:M?P:R,y:M?R:P};let F;M?F={x:z.x-w/2,y:_.minValue,width:w,height:_.maxValue-_.minValue}:F={x:_.minValue,y:z.y-w/2,width:_.maxValue-_.minValue,height:w},g.push({series:this,itemId:N,datum:A,xKey:s,bandwidth:w,scaledValues:_,cap:u,whisker:y,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p,midPoint:z,focusRect:F})}),T}getLegendData(t){const{id:e,data:i}=this,{xKey:o,yName:s,fill:a,fillOpacity:n,stroke:r,strokeWidth:l,strokeOpacity:c,showInLegend:h,legendItemName:p,visible:u}=this.properties;return!h||!i?.length||!o||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:u,label:{text:p??s??e},symbols:[{marker:{fill:a,fillOpacity:n,stroke:r,strokeOpacity:c,strokeWidth:l}}],legendItemName:p}]}getTooltipHtml(t){const{xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n,xName:r,yName:l,minName:c,q1Name:h,medianName:p,q3Name:u,maxName:y,tooltip:g,fill:f}=this.properties,{datum:m,itemId:v}=t,b=this.getCategoryAxis(),S=this.getValueAxis();if(!b||!S||!this.properties.isValid())return Vr.EMPTY_TOOLTIP_CONTENT;const x=rd.sanitizeHtml(l),T=[[e,r,b],[i,c,S],[o,h,S],[s,p,S],[a,u,S],[n,y,S]].map(([D,I,N])=>rd.sanitizeHtml(`${I??D}: ${N.formatDatum(m[D])}`)).join(x?"<br/>":", "),{fill:A}=this.getFormattedStyles(t);return g.toTooltipHtml({title:x,content:T,backgroundColor:f},{seriesId:this.id,itemId:v,datum:m,fill:f,xKey:e,minKey:i,q1Key:o,medianKey:s,q3Key:a,maxKey:n,xName:r,minName:c,q1Name:h,medianName:p,q3Name:u,maxName:y,yName:l,title:x,color:f??A})}animateEmptyUpdateReady({datumSelection:t}){const e=this.isVertical(),{from:i,to:o}=tL(e);Sm.resetMotion([t],eL(e)),Sm.staticFromToMotion(this.id,"datums",this.ctx.animationManager,[t],i,o,{phase:"initial"})}isLabelEnabled(){return!1}async updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}async updateDatumNodes({datumSelection:t,isHighlight:e}){const i=this.isVertical(),o=this.getValueAxis()?.isReversed();t.each((s,a)=>{let n=this.getFormattedStyles(a,e);e&&(n=cd(this.properties.highlightStyle.item,n));const{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=n;n.whisker=cd(n.whisker,{stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}),s.updateDatumStyles(a,n,i,o)})}async updateLabelNodes(t){}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}nodeFactory(){return new lL}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o},properties:s}=this,{xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h,itemStyler:p,backgroundFill:u,cornerRadius:y}=s,{datum:g,stroke:f,strokeWidth:m,strokeOpacity:v,lineDash:b,lineDashOffset:S,cap:x,whisker:M}=t;let T,A;if(!0)T=t.fill,A=s.fillOpacity;else{try{T=hd.mix(hd.fromString(u),hd.fromString(t.fill),s.fillOpacity).toString()}catch{T=t.fill}A=void 0}const I={fill:T,fillOpacity:A,stroke:f,strokeWidth:m,strokeOpacity:v,lineDash:b,lineDashOffset:S,cornerRadius:y,cap:mm(x),whisker:mm(M)};if(p){const N=o.call(p,{datum:g,seriesId:i,highlighted:e,...I,xKey:a,minKey:n,q1Key:r,medianKey:l,q3Key:c,maxKey:h});if(N)return cd(N,I)}return I}computeFocusBounds({datumIndex:t,seriesRect:e}){return bL(this.contextNodeData?.nodeData[t].focusRect,this.contentGroup,e)}};dd.className="BoxPlotSeries",dd.type="box-plot";import{_Theme as bm}from"ag-charts-community";var TL={series:{direction:"vertical",strokeWidth:2},axes:{[bm.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[bm.CARTESIAN_AXIS_TYPE.CATEGORY]:{groupPaddingInner:.2,crosshair:{enabled:!1,snap:!1}}}},{Color:pd}=QO,AL={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"box-plot",moduleFactory:t=>new dd(t),tooltipDefaults:{range:"exact"},defaultAxes:da.swapAxisCondition([{type:da.CARTESIAN_AXIS_TYPE.NUMBER,position:da.CARTESIAN_POSITION.LEFT},{type:da.CARTESIAN_AXIS_TYPE.CATEGORY,position:da.CARTESIAN_POSITION.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:TL,groupable:!0,paletteFactory:({takeColors:t,themeTemplateParameters:e})=>{const i=e.get(da.DEFAULT_BACKGROUND_COLOUR),o=(Array.isArray(i)?i[0]:i)??"white",{fills:[s],strokes:[a]}=t(1);let n;try{n=pd.mix(pd.fromString(o),pd.fromString(s),.3).toString()}catch{n=s}return{fill:n,stroke:a,backgroundFill:o}}};import{_Theme as rs}from"ag-charts-community";import{_ModuleSupport as ls,_Scene as cs,_Util as ud}from"ag-charts-community";import{_ModuleSupport as DL}from"ag-charts-community";var{AbstractBarSeriesProperties:kL,BaseProperties:gd,PropertiesArray:IL,SeriesTooltip:NL,Validate:dt,ARRAY:OL,COLOR_STRING:ga,LINE_DASH:vm,OBJECT:yd,POSITIVE_NUMBER:ya,RATIO:fa,STRING:Gr}=DL,to=class extends gd{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.lengthRatio=.75}};d([dt(ga)],to.prototype,"fill",2),d([dt(fa)],to.prototype,"fillOpacity",2),d([dt(ga)],to.prototype,"stroke",2),d([dt(ya)],to.prototype,"strokeWidth",2),d([dt(fa)],to.prototype,"strokeOpacity",2),d([dt(vm)],to.prototype,"lineDash",2),d([dt(ya)],to.prototype,"lineDashOffset",2),d([dt(fa)],to.prototype,"lengthRatio",2);var Mm=class extends gd{};d([dt(ya,{optional:!0})],Mm.prototype,"max",2);var Wr=class extends gd{constructor(){super(...arguments),this.color="lightgrey"}};d([dt(ga)],Wr.prototype,"color",2),d([dt(ya,{optional:!0})],Wr.prototype,"stop",2);var Kt=class extends kL{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.widthRatio=.5,this.colorRanges=new IL(Wr),this.target=new to,this.scale=new Mm,this.tooltip=new NL,this.backgroundFill="white"}};d([dt(Gr)],Kt.prototype,"valueKey",2),d([dt(Gr,{optional:!0})],Kt.prototype,"valueName",2),d([dt(Gr,{optional:!0})],Kt.prototype,"targetKey",2),d([dt(Gr,{optional:!0})],Kt.prototype,"targetName",2),d([dt(ga)],Kt.prototype,"fill",2),d([dt(fa)],Kt.prototype,"fillOpacity",2),d([dt(ga)],Kt.prototype,"stroke",2),d([dt(ya)],Kt.prototype,"strokeWidth",2),d([dt(fa)],Kt.prototype,"strokeOpacity",2),d([dt(vm)],Kt.prototype,"lineDash",2),d([dt(ya)],Kt.prototype,"lineDashOffset",2),d([dt(fa)],Kt.prototype,"widthRatio",2),d([dt(OL.restrict({minLength:0}))],Kt.prototype,"colorRanges",2),d([dt(yd)],Kt.prototype,"target",2),d([dt(yd)],Kt.prototype,"scale",2),d([dt(yd)],Kt.prototype,"tooltip",2),d([dt(ga)],Kt.prototype,"backgroundFill",2);var{animationValidation:LL,collapsedStartingBarPosition:Tm,diff:CL,keyProperty:EL,partialAssign:fd,prepareBarAnimationFunctions:Am,resetBarSelectionsFn:_L,seriesLabelFadeInAnimation:Dm,valueProperty:km,createDatumId:RL,computeBarFocusBounds:wL}=ls,{fromToMotion:Im}=cs.motion,{sanitizeHtml:Nm,Color:md}=ud,Om=["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","lineDash","lineDashOffset"],PL=class extends ls.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:{y:["targetKey","valueKey"]},directionNames:{y:["targetName","valueName"]},pickModes:[ls.SeriesNodePickMode.NEAREST_NODE,ls.SeriesNodePickMode.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,animationResetFns:{datum:_L}}),this.properties=new Kt,this.normalizedColorRanges=[],this.colorRangesGroup=new cs.Group({name:`${this.id}-colorRanges`}),this.colorRangesSelection=cs.Selection.select(this.colorRangesGroup,cs.Rect,!1),this.rootGroup.append(this.colorRangesGroup),this.targetLinesSelection=cs.Selection.select(this.annotationGroup,cs.Line,!1)}destroy(){this.rootGroup.removeChild(this.colorRangesGroup),super.destroy()}async processData(t){if(!this.properties.isValid()||!this.data||!this.visible)return;const{valueKey:e,targetKey:i}=this.properties,o=this.getCategoryAxis()?.scale,s=this.getValueAxis()?.scale,{xScaleType:a,yScaleType:n}=this.getScaleInformation({xScale:o,yScale:s}),r=[];i!==void 0&&r.push(km(i,n,{id:"target"})),this.ctx.animationManager.isSkipped()||(this.processedData!==void 0&&r.push(CL(this.processedData)),r.push(LL())),await this.requestDataModel(t,this.data.slice(0,1),{props:[EL(e,a,{id:"xValue"}),km(e,n,{id:"value"}),...r],groupByKeys:!0}),this.animationState.transition("updateData")}getBandScalePadding(){return{inner:0,outer:0}}getMaxValue(){return Math.max(...this.getValueAxis()?.dataDomain.domain??[0])}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!e||!i)return[];const{valueKey:o,targetKey:s,valueName:a,scale:n}=this.properties;if(t===this.getCategoryDirection())return[a??o];if(t==this.getValueAxis()?.direction){const r=e.getDomain(this,"value","value",i),l=s===void 0?[]:e.getDomain(this,"target","value",i);return[0,n.max??Math.max(...r,...l)]}throw new Error(`unknown direction ${t}`)}getKeys(t){return t===this.getBarDirection()?[this.properties.valueKey]:super.getKeys(t)}async createNodeData(){const{dataModel:t,processedData:e}=this,{valueKey:i,targetKey:o,widthRatio:s,target:{lengthRatio:a}}=this.properties,n=this.getCategoryAxis()?.scale,r=this.getValueAxis()?.scale;if(!i||!t||!e||!n||!r||s===void 0||a===void 0)return;const l=n.bandwidth??NaN,c=this.getMaxValue(),h=t.resolveProcessedDataIndexById(this,"value"),p=o===void 0?NaN:t.resolveProcessedDataIndexById(this,"target"),u={itemId:i,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return u;for(const{datum:f,values:m}of e.data){if(!Array.isArray(f)||f.length<1)continue;m[0][h]<0&&ud.Logger.warnOnce("negative values are not supported, clipping to 0.");const v=this.properties.valueName??this.properties.valueKey,b=Math.min(c,Math.max(0,m[0][h])),S=r.convert(b),x=s*l,M=r.convert(0),T=this.getBarDirection()===ls.ChartAxisDirection.X,A={x:l*(1-s)/2,y:Math.min(S,M),width:x,height:Math.abs(M-S)};T&&([A.x,A.y,A.width,A.height]=[A.y,A.x,A.height,A.width]);let D;if(m[0][p]<0&&ud.Logger.warnOnce("negative targets are not supported, ignoring."),this.properties.targetKey&&m[0][p]>=0){const N=a*l,O=Math.min(c,m[0][p]);if(!isNaN(O)&&O!==void 0){const L=r.convert(O);let C=l*(1-a)/2,k=C+N,[E,_]=[L,L];T&&([C,k,E,_]=[E,_,C,k]),D={value:O,x1:C,x2:k,y1:E,y2:_}}}const I={series:this,datum:f[0],xKey:i,xValue:v,yKey:i,yValue:b,cumulativeValue:b,target:D,...A,midPoint:{x:A.x+A.width/2,y:A.y+A.height/2},opacity:1};u.nodeData.push(I)}const y=[...this.getColorRanges()].sort((f,m)=>(f.stop??c)-(m.stop??c));let g=0;return this.normalizedColorRanges=y.map(f=>{const m=Math.min(c,f.stop??1/0),v={color:f.color,start:g,stop:m};return g=m,v}),u}getColorRanges(){const{colorRanges:t,fill:e,backgroundFill:i}=this.properties;if(t!==void 0&&t.length>0)return t;const o=new Wr;try{o.color=md.mix(md.fromString(e),md.fromString(i),.7).toString()}catch{o.color=e}return[o]}getLegendData(t){return[]}getTooltipHtml(t){const{valueKey:e,valueName:i,targetKey:o,targetName:s}=this.properties,a=this.getValueAxis(),{yValue:n,target:{value:r}={value:void 0},datum:l,itemId:c}=t;if(e===void 0||n===void 0||a===void 0)return ls.EMPTY_TOOLTIP_CONTENT;const h=(y,g,f)=>{const m=Nm(g??y),v=Nm(a.formatDatum(f));return`<b>${m}</b>: ${v}`},p=void 0,u=o===void 0||r===void 0?h(e,i,n):`${h(e,i,n)}<br/>${h(o,s,r)}`;return this.properties.tooltip.toTooltipHtml({title:p,content:u,backgroundColor:this.properties.fill},{datum:l,itemId:c,title:p,seriesId:this.id,valueKey:e,valueName:i,targetKey:o,targetName:s,color:void 0})}isLabelEnabled(){return!1}nodeFactory(){return new cs.Rect}async updateDatumSelection(t){return this.targetLinesSelection.update(t.nodeData,void 0,void 0),t.datumSelection.update(t.nodeData,void 0,void 0)}async updateDatumNodes(t){for(const{node:e}of t.datumSelection){const i=this.properties;fd(Om,e,i)}for(const{node:e,datum:i}of this.targetLinesSelection)if(i.target===void 0)e.visible=!1;else{const o=this.properties.target;fd(["x1","x2","y1","y2"],e,i.target),fd(Om,e,o)}}async updateColorRanges(){const t=this.getValueAxis(),e=this.getCategoryAxis();if(!t||!e)return;const[i,o]=[0,Math.max(...e.scale.range)],s=this.getBarDirection()===ls.ChartAxisDirection.Y?(a,n)=>{a.x=i,a.y=t.scale.convert(n.stop),a.height=t.scale.convert(n.start)-a.y,a.width=o}:(a,n)=>{a.x=t.scale.convert(n.start),a.y=i,a.height=o,a.width=t.scale.convert(n.stop)-a.x};this.colorRangesSelection.update(this.normalizedColorRanges);for(const{node:a,datum:n}of this.colorRangesSelection)s(a,n),a.fill=n.color}async updateNodes(t,e,i){await super.updateNodes(t,e,i),await this.updateColorRanges()}async updateLabelSelection(t){return t.labelSelection}async updateLabelNodes(t){}animateEmptyUpdateReady(t){const{datumSelection:e,annotationSelections:i}=t,o=Am(Tm(this.isVertical(),this.axes,"normal"));Im(this.id,"nodes",this.ctx.animationManager,[e],o),Dm(this,"annotations",this.ctx.animationManager,...i)}animateWaitingUpdateReady(t){const{datumSelection:e,annotationSelections:i}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id);const o=this.processedData?.reduced?.diff,s=Am(Tm(this.isVertical(),this.axes,"normal"));Im(this.id,"nodes",this.ctx.animationManager,[e],s,(n,r)=>RL(r.xValue),o),(o?.changed??!0)&&Dm(this,"annotations",this.ctx.animationManager,...i)}computeFocusBounds({datumIndex:t,seriesRect:e}){return wL(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};import{_Theme as BL}from"ag-charts-community";var zL={series:{direction:"vertical",strokeWidth:0,strokeOpacity:1,fillOpacity:1,widthRatio:.5,target:{strokeWidth:3,strokeOpacity:1,lengthRatio:.75}},axes:{[BL.CARTESIAN_AXIS_TYPE.NUMBER]:{nice:!1,crosshair:{enabled:!1}}}},FL={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"bullet",solo:!0,moduleFactory:t=>new PL(t),tooltipDefaults:{range:"exact"},defaultAxes:rs.swapAxisCondition([{type:rs.CARTESIAN_AXIS_TYPE.NUMBER,position:rs.CARTESIAN_POSITION.LEFT},{type:rs.CARTESIAN_AXIS_TYPE.CATEGORY,position:rs.CARTESIAN_POSITION.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:zL,paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:[o],strokes:[s]}=t(e),a=i.get(rs.DEFAULT_BACKGROUND_COLOUR),n=(Array.isArray(a)?a[0]:a)??"white",r=i.get(rs.DEFAULT_CROSS_LINES_COLOUR);return{fill:o,stroke:s,target:{stroke:r},backgroundFill:n}}};import{_Theme as Kr}from"ag-charts-community";import{_ModuleSupport as VL}from"ag-charts-community";import{_ModuleSupport as Yr,_Scale as UL,_Scene as HL,_Util as GL}from"ag-charts-community";import{_ModuleSupport as WL}from"ag-charts-community";var{computeBarFocusBounds:KL,NODE_UPDATE_STATE_TO_PHASE_MAPPING:YL}=WL;function Lm(t,e){return jr(e)}function Cm(t){return{toFn:(o,s,a)=>{if(a==="removed"){const{x:n,yLow:r,yHigh:l,width:c}=jr(s),h=s.itemId==="up"?r:l;return{x:n,y:h,yBottom:h,yHigh:h,yLow:h,width:c,height:0}}return jr(s)},fromFn:(o,s,a)=>{const n=t?"initial":YL[a];if(a==="unknown"||a==="added"&&s!=null){const{x:r,y:l,yLow:c,yHigh:h,width:p,height:u}=jr(s);let y=s.itemId==="up"?c:h;return a==="unknown"&&(y=l+u/2),{x:r,y,yBottom:y,yHigh:y,yLow:y,width:p,height:0,phase:n}}return{x:o.x,y:o.y,yBottom:o.yBottom,yHigh:o.yHigh,yLow:o.yLow,width:o.width,height:o.height,phase:n}}}}function jr(t){const{bandwidth:e,scaledValues:{xValue:i,openValue:o,closeValue:s,highValue:a,lowValue:n}}=t,r=Math.min(o,s),l=isNaN(o)?s:Math.max(o,s),c=Math.min(a,n),h=Math.max(a,n);return{x:i,y:r,yBottom:l,yHigh:c,yLow:h,width:e,height:Math.max(l-r,.001)}}function Em(t,e){const i=t.getNodeData()?.at(e.datumIndex),o=i?{x:i.scaledValues.xValue,y:i.scaledValues.highValue,width:i.bandwidth,height:i.scaledValues.lowValue-i.scaledValues.highValue}:void 0;return KL(o,t.contentGroup,e.seriesRect)}var{motion:_m}=HL,{fixNumericExtent:jL,keyProperty:XL,SeriesNodePickMode:Rm,SMALLEST_KEY_INTERVAL:ZL,valueProperty:Xr,diff:$L,animationValidation:QL,convertValuesToScaleByDefs:qL}=Yr,{sanitizeHtml:wm,Logger:Pm}=GL,{ContinuousScale:JL}=UL,t2=class extends Yr.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.openKey=o.properties.openKey,this.closeKey=o.properties.closeKey,this.highKey=o.properties.highKey,this.lowKey=o.properties.lowKey}},Bm=class extends Yr.AbstractBarSeries{constructor(t,e){super({moduleCtx:t,pickModes:[Rm.AXIS_ALIGNED,Rm.EXACT_SHAPE_MATCH],directionKeys:{x:["xKey"],y:["lowKey","highKey","openKey","closeKey"]},directionNames:{x:["xName"],y:["lowName","highName","openName","closeName"]},pathsPerSeries:[],datumSelectionGarbageCollection:!1,animationAlwaysUpdateSelections:!0,animationResetFns:{datum:e}}),this.NodeEvent=t2}animateEmptyUpdateReady({datumSelection:t}){const e=Cm(!0);_m.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],e)}animateWaitingUpdateReady({datumSelection:t}){const{processedData:e}=this,i=e?.reduced?.diff,o=Cm(!1);_m.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],o,(s,a)=>String(a.xValue),i)}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a}=this.properties,n=!this.ctx.animationManager.isSkipped(),r=this.getCategoryAxis()?.scale,l=this.getValueAxis()?.scale,{isContinuousX:c,xScaleType:h,yScaleType:p}=this.getScaleInformation({xScale:r,yScale:l}),u=[];n&&(this.processedData&&u.push($L(this.processedData)),u.push(QL())),i&&u.push(Xr(i,p,{id:"openValue",invalidValue:void 0,missingValue:void 0}));const{processedData:y}=await this.requestDataModel(t,this.data,{props:[XL(e,h,{id:"xValue"}),Xr(o,p,{id:"closeValue"}),Xr(s,p,{id:"highValue"}),Xr(a,p,{id:"lowValue"}),...c?[ZL]:[],...u]});this.smallestDataInterval=y.reduced?.smallestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];const{openKey:o}=this.properties;if(t===this.getBarDirection()){const r=i.getDomain(this,"lowValue","value",e),l=i.getDomain(this,"highValue","value",e),c=o?i.getDomain(this,"openValue","value",e):[],h=i.getDomain(this,"closeValue","value",e);return jL([Math.min(...r,...l,...c,...h),Math.max(...l,...r,...c,...h)])}const{index:s,def:a}=i.resolveProcessedDataDefById(this,"xValue"),n=e.domain.keys[s];return a.type==="key"&&a.valueType==="category"?n:this.padBandExtent(n)}createBaseNodeData(){const{visible:t,dataModel:e}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!(e&&i&&o))return;const s=[],{xKey:a,highKey:n,lowKey:r}=this.properties,l=e.resolveProcessedDataDefsByIds(this,["xValue","openValue","closeValue","highValue","lowValue"]),{barWidth:c,groupIndex:h}=this.updateGroupScale(i),p=JL.is(i.scale)?c*-.5:0,{groupScale:u,processedData:y}=this,g={itemId:a,nodeData:s,labelData:[],scales:this.calculateScaling(),visible:this.visible};return t&&y?.data.forEach(({datum:f,keys:m,values:v})=>{const{xValue:b,openValue:S,closeValue:x,highValue:M,lowValue:T}=e.resolveProcessedDataDefsValues(l,{keys:m,values:v}),A=T!=null&&T<=S&&T<=x,D=M!=null&&M>=S&&M>=x;if(!A){Pm.warnOnce(`invalid low value for key [${r}] in data element, low value cannot be higher than datum open or close values`);return}if(!D){Pm.warnOnce(`invalid high value for key [${n}] in data element, high value cannot be lower than datum open or close values.`);return}const I=qL({defs:l,values:{xValue:b,openValue:S,closeValue:x,highValue:M,lowValue:T},xAxis:i,yAxis:o});I.xValue+=Math.round(u.convert(String(h)))+p;const N=x>S,O=this.getSeriesItemType(N),[L,C]=N?[I.openValue,I.closeValue]:[I.closeValue,I.openValue],k=C-L,E={x:I.xValue+Math.round(c)/2,y:L+k/2};s.push({series:this,itemId:O,datum:f,xKey:a,xValue:b,openValue:S,closeValue:x,highValue:M,lowValue:T,bandwidth:c>=1?c:u.rawBandwidth,scaledValues:I,midPoint:E,aggregatedValue:x})}),g}getSeriesItemType(t){return t?"up":"down"}getItemConfig(t){return this.properties.item[t]}getLegendData(t){const{id:e,data:i}=this,{xKey:o,yName:s,item:{up:a,down:n},showInLegend:r,legendItemName:l,visible:c}=this.properties;return!r||!i?.length||!o||t!=="category"?[]:[{legendType:"category",id:e,itemId:e,seriesId:e,enabled:c,label:{text:l??s??e},symbols:[{marker:{fill:a.fill??a.stroke,fillOpacity:a.fillOpacity??1,stroke:a.stroke,strokeWidth:a.strokeWidth??1,strokeOpacity:a.strokeOpacity??1,padding:0}},{marker:{fill:n.fill??n.stroke,fillOpacity:n.fillOpacity??1,stroke:n.stroke,strokeWidth:n.strokeWidth??1,strokeOpacity:n.strokeOpacity??1}}],legendItemName:l}]}getTooltipHtml(t){const{xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a,xName:n,yName:r,openName:l,closeName:c,highName:h,lowName:p,tooltip:u}=this.properties,{datum:y,itemId:g}=t,f=this.getCategoryAxis(),m=this.getValueAxis();if(!f||!m||!this.properties.isValid())return Yr.EMPTY_TOOLTIP_CONTENT;const v=T=>T.charAt(0).toUpperCase()+T.substring(1),b=wm(r),x=[[e,n,f],[i,l,m],[s,h,m],[a,p,m],[o,c,m]].map(([T,A,D])=>wm(`${A??v(T)}: ${D.formatDatum(y[T])}`)).join("<br/>"),M=this.getFormattedStyles(t);return u.toTooltipHtml({title:b,content:x,backgroundColor:M.stroke},{seriesId:this.id,highlighted:!1,datum:y,...M,xKey:e,openKey:i,closeKey:o,highKey:s,lowKey:a,xName:n,yName:r,openName:l,closeName:c,highName:h,lowName:p,title:b,color:M.fill,fill:M.fill,itemId:g})}isVertical(){return!0}isLabelEnabled(){return!1}async updateDatumSelection(t){const e=t.nodeData??[];return t.datumSelection.update(e)}async updateDatumNodes({datumSelection:t,isHighlight:e}){t.each((i,o)=>{const s=this.getActiveStyles(o,e);i.updateDatumStyles(o,s)})}async updateLabelNodes(t){}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e)}};import{_ModuleSupport as e2,_Scene as Xe,_Util as i2}from"ag-charts-community";var{SceneChangeDetection:hs,BBox:o2,RedrawType:ds}=Xe,eo=class extends Xe.Group{constructor(){super(...arguments),this.x=0,this.y=0,this.yBottom=0,this.yHigh=0,this.yLow=0,this.width=0,this.height=0}distanceSquared(t,e){const i=Xe.Selection.selectByClass(this,Xe.Rect,Xe.Line);return e2.nearestSquared(t,e,i).distanceSquared}get midPoint(){const t=this.datum;return t.midPoint===void 0?(i2.Logger.error("CandlestickBaseGroup.datum.midPoint is undefined"),{x:NaN,y:NaN}):t.midPoint}preRender(){return this.updateCoordinates(),super.preRender()}};d([hs({redraw:ds.MAJOR})],eo.prototype,"x",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"y",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"yBottom",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"yHigh",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"yLow",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"width",2),d([hs({redraw:ds.MAJOR})],eo.prototype,"height",2);var s2=class extends eo{constructor(){super(),this.append([new Xe.Rect({tag:0}),new Xe.Line({tag:1}),new Xe.Line({tag:2})])}updateCoordinates(){const{x:t,y:e,yBottom:i,yHigh:o,yLow:s,width:a,height:n}=this,r=Xe.Selection.select(this,Xe.Rect),[l]=r.selectByTag(0),[c]=r.selectByTag(1),[h]=r.selectByTag(2);if(a===0||n===0){l.visible=!1,c.visible=!1,h.visible=!1;return}l.visible=!0,c.visible=!0,h.visible=!0,l.setProperties({x:t,y:e,width:a,height:n,crisp:!0,clipBBox:new o2(t,e,a,n)});const p=a/2;c.setProperties({y1:Math.round(s+c.strokeWidth/2),y2:i,x:t+p}),h.setProperties({y1:Math.round(o+h.strokeWidth/2),y2:e,x:t+p})}updateDatumStyles(t,e){const{bandwidth:i}=t,{fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h={},cornerRadius:p}=e;h.strokeWidth??(h.strokeWidth=1);const u=Xe.Selection.select(this,Xe.Rect),[y]=u.selectByTag(0),[g]=u.selectByTag(1),[f]=u.selectByTag(2);h.strokeWidth>i&&(h.strokeWidth=i),y.setProperties({fill:o,fillOpacity:s,strokeWidth:n,strokeOpacity:r,stroke:a,lineDash:l,lineDashOffset:c,cornerRadius:p}),g.setProperties(h),f.setProperties(h)}};import{_ModuleSupport as a2}from"ag-charts-community";var{BaseProperties:xd,AbstractBarSeriesProperties:n2,SeriesTooltip:r2,Validate:rt,COLOR_STRING:Sd,FUNCTION:l2,LINE_DASH:zm,OBJECT:pn,POSITIVE_NUMBER:un,RATIO:bd,STRING:di}=a2,ma=class extends xd{};d([rt(Sd,{optional:!0})],ma.prototype,"stroke",2),d([rt(un)],ma.prototype,"strokeWidth",2),d([rt(bd)],ma.prototype,"strokeOpacity",2),d([rt(zm,{optional:!0})],ma.prototype,"lineDash",2),d([rt(un)],ma.prototype,"lineDashOffset",2);var pi=class extends xd{constructor(){super(...arguments),this.fill="#c16068",this.fillOpacity=1,this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.wick=new ma}};d([rt(Sd,{optional:!0})],pi.prototype,"fill",2),d([rt(bd)],pi.prototype,"fillOpacity",2),d([rt(Sd)],pi.prototype,"stroke",2),d([rt(un)],pi.prototype,"strokeWidth",2),d([rt(bd)],pi.prototype,"strokeOpacity",2),d([rt(zm)],pi.prototype,"lineDash",2),d([rt(un)],pi.prototype,"lineDashOffset",2),d([rt(un)],pi.prototype,"cornerRadius",2),d([rt(pn)],pi.prototype,"wick",2);var vd=class extends xd{constructor(){super(...arguments),this.up=new pi,this.down=new pi}};d([rt(pn)],vd.prototype,"up",2),d([rt(pn)],vd.prototype,"down",2);var le=class extends n2{constructor(){super(...arguments),this.tooltip=new r2,this.item=new vd}};d([rt(di)],le.prototype,"xKey",2),d([rt(di)],le.prototype,"openKey",2),d([rt(di)],le.prototype,"closeKey",2),d([rt(di)],le.prototype,"highKey",2),d([rt(di)],le.prototype,"lowKey",2),d([rt(di,{optional:!0})],le.prototype,"xName",2),d([rt(di,{optional:!0})],le.prototype,"yName",2),d([rt(di,{optional:!0})],le.prototype,"openName",2),d([rt(di,{optional:!0})],le.prototype,"closeName",2),d([rt(di,{optional:!0})],le.prototype,"highName",2),d([rt(di,{optional:!0})],le.prototype,"lowName",2),d([rt(pn)],le.prototype,"tooltip",2),d([rt(pn)],le.prototype,"item",2),d([rt(l2,{optional:!0})],le.prototype,"itemStyler",2);var{extractDecoratedProperties:c2,mergeDefaults:Md}=VL,Td=class extends Bm{constructor(t){super(t,Lm),this.properties=new le}async createNodeData(){const t=this.createBaseNodeData();if(!t)return;const e=t.nodeData.map(i=>{const{fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h,cornerRadius:p}=this.getItemConfig(i.itemId);return{...i,fill:o,fillOpacity:s,stroke:a,strokeWidth:n,strokeOpacity:r,lineDash:l,lineDashOffset:c,wick:h,cornerRadius:p}});return{...t,nodeData:e}}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o}}=this,{xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,itemStyler:c}=this.properties,{fill:h,fillOpacity:p,stroke:u,strokeWidth:y,strokeOpacity:g,lineDash:f,lineDashOffset:m}=this.getItemConfig(t.itemId);if(c){const v=o.call(c,{datum:t.datum,itemId:t.itemId,seriesId:i,highlighted:e,xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,fill:h,fillOpacity:p,stroke:u,strokeWidth:y,strokeOpacity:g,lineDash:f,lineDashOffset:m});if(v)return Md(v,this.getSeriesStyles(t))}return this.getSeriesStyles(t)}nodeFactory(){return new s2}getSeriesStyles(t){const{fill:e,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,wick:l,cornerRadius:c}=t;return{fill:e,fillOpacity:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r,wick:c2(l),cornerRadius:c}}getActiveStyles(t,e){let i=this.getFormattedStyles(t,e);e&&(i=Md(this.properties.highlightStyle.item,i));const{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=i;return i.wick=Md(i.wick,{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}),i}computeFocusBounds(t){return Em(this,t)}};Td.className="CandleStickSeries",Td.type="candlestick";import{_Theme as Fm}from"ag-charts-community";var h2={series:{highlightStyle:{item:{strokeWidth:3}}},animation:{enabled:!1},axes:{[Fm.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[Fm.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},d2={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"candlestick",moduleFactory:t=>new Td(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Kr.CARTESIAN_AXIS_TYPE.NUMBER,position:Kr.CARTESIAN_POSITION.LEFT},{type:Kr.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:Kr.CARTESIAN_POSITION.BOTTOM}],themeTemplate:h2,groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{item:{up:{fill:"transparent",stroke:a[0]},down:{fill:s[0],stroke:a[0]}}}}return{item:{up:o.up,down:o.down}}}};import{_Theme as p2}from"ag-charts-community";import{_ModuleSupport as u2,_Scene as g2,_Util as y2}from"ag-charts-community";import{_ModuleSupport as f2,_Scene as m2}from"ag-charts-community";import{_Util as x2}from"ag-charts-community";var{Logger:S2}=x2;function Vm(t,e,i){i||(e=b2(e));const o=new Map;for(const a of t)o.set(a.id,{datum:a,linksBefore:[],linksAfter:[],maxPathLengthBefore:-1,maxPathLengthAfter:-1});let s=0;return o.forEach((a,n)=>{s=Math.max(s,Ad(o,e,a,n,-1,[])+Ad(o,e,a,n,1,[])+1)}),{links:e,nodeGraph:o,maxPathLength:s}}function Um(t,e,i,o){const s=o.indexOf(e);if(s!==-1){for(let n=s;n<o.length;n+=1)i.add(o[n]);return}o.push(e);const{toNode:a}=e;for(const n of t)n.fromNode===a&&Um(t,n,i,o);o.pop()}function b2(t){const e=new Set;for(const i of t)Um(t,i,e,[]);return e.size!==0&&S2.warnOnce("Some links formed circular references. These will be removed from the output."),e.size===0?t:t.filter(i=>!e.has(i))}function Ad(t,e,i,o,s,a){if(a.includes(o))return 1/0;let n=s===-1?i.maxPathLengthBefore:i.maxPathLengthAfter;if(n===-1){n=0;const r=s===-1?i.linksBefore:i.linksAfter;for(const l of e){const{fromNode:c,toNode:h}=l,p=s===-1?h.id:c.id,u=s===-1?c.id:h.id,y=o===p?t.get(u):void 0;y!=null&&(r.push({node:y,link:l}),a?.push(o),n=Math.max(n,Ad(t,e,y,u,s,a)+1),a?.pop())}s===-1?i.maxPathLengthBefore=n:i.maxPathLengthAfter=n}return n}var{DataModelSeries:v2,DataController:M2,Validate:T2,ARRAY:A2,keyProperty:D2,valueProperty:Zr}=f2,{Selection:ps,Group:xa,TransformableText:k2}=m2,Dd=class extends v2{constructor(){super(...arguments),this._chartNodes=void 0,this.nodeCount=0,this.linkCount=0,this.nodesDataController=new M2("standalone"),this.nodesDataModel=void 0,this.nodesProcessedData=void 0,this.processedNodes=new Map,this.linkGroup=this.contentGroup.appendChild(new xa({name:"linkGroup"})),this.nodeGroup=this.contentGroup.appendChild(new xa({name:"nodeGroup"})),this.focusLinkGroup=this.highlightNode.appendChild(new xa({name:"linkGroup"})),this.focusNodeGroup=this.highlightNode.appendChild(new xa({name:"nodeGroup"})),this.highlightLinkGroup=this.highlightNode.appendChild(new xa({name:"linkGroup"})),this.highlightNodeGroup=this.highlightNode.appendChild(new xa({name:"nodeGroup"})),this.labelSelection=ps.select(this.labelGroup,k2),this.linkSelection=ps.select(this.linkGroup,()=>this.linkFactory()),this.nodeSelection=ps.select(this.nodeGroup,()=>this.nodeFactory()),this.focusLinkSelection=ps.select(this.focusLinkGroup,()=>this.linkFactory()),this.focusNodeSelection=ps.select(this.focusNodeGroup,()=>this.nodeFactory()),this.highlightLinkSelection=ps.select(this.highlightLinkGroup,()=>this.linkFactory()),this.highlightNodeSelection=ps.select(this.highlightNodeGroup,()=>this.nodeFactory())}get nodes(){return this.properties.nodes??this._chartNodes}setChartNodes(t){this._chartNodes=t,this.nodes===t&&(this.nodeDataRefresh=!0)}getNodeData(){return this.contextNodeData?.nodeData}async processData(t){const{nodesDataController:e,data:i,nodes:o}=this;if(i==null||!this.properties.isValid())return;const{fromKey:s,toKey:a,sizeKey:n,idKey:r,labelKey:l}=this.properties,c=o!=null?e.request(this.id,o,{props:[D2(r,void 0,{id:"idValue",includeProperty:!1}),...l!=null?[Zr(l,void 0,{id:"labelValue",includeProperty:!1})]:[]],groupByKeys:!0}):null,h=this.requestDataModel(t,i,{props:[Zr(s,void 0,{id:"fromValue",includeProperty:!1}),Zr(a,void 0,{id:"toValue",includeProperty:!1}),...n!=null?[Zr(n,void 0,{id:"sizeValue",includeProperty:!1,missingValue:0})]:[]],groupByKeys:!1});o!=null&&e.execute();const[p,u]=await Promise.all([c,h]);this.nodesDataModel=p?.dataModel,this.nodesProcessedData=p?.processedData;const{fills:y,strokes:g}=this.properties,f=new Map;if(p==null){const m=u.dataModel.resolveProcessedDataIndexById(this,"fromValue"),v=u.dataModel.resolveProcessedDataIndexById(this,"toValue"),b=S=>{const x=f.size,M=S,T=y[x%y.length],A=g[x%g.length];return{series:this,itemId:void 0,datum:{},type:1,index:x,id:S,label:M,fill:T,stroke:A}};u.processedData.data.forEach(({values:S})=>{const x=S[m],M=S[v];x==null||M==null||(f.has(x)||f.set(x,b(x)),f.has(M)||f.set(M,b(M)))})}else{const m=p.dataModel.resolveProcessedDataIndexById(this,"idValue"),v=l!=null?p.dataModel.resolveProcessedDataIndexById(this,"labelValue"):void 0;p.processedData.data.forEach(({datum:b,keys:S,values:x},M)=>{const T=x[0],A=S[m],D=v!=null?T[v]:void 0,I=y[M%y.length],N=g[M%g.length];f.set(A,{series:this,itemId:void 0,datum:b,type:1,index:M,id:A,label:D,fill:I,stroke:N})})}this.processedNodes=f}getNodeGraph(t,e,{includeCircularReferences:i}){const{dataModel:o,processedData:s}=this;if(o==null||s==null){const{links:g,nodeGraph:f,maxPathLength:m}=Vm(new Map().values(),[],i);return this.nodeCount=0,this.linkCount=0,{nodeGraph:f,links:g,maxPathLength:m}}const{sizeKey:a}=this.properties,n=o.resolveProcessedDataIndexById(this,"fromValue"),r=o.resolveProcessedDataIndexById(this,"toValue"),l=a!=null?o.resolveProcessedDataIndexById(this,"sizeValue"):void 0,c=new Map;this.processedNodes.forEach(g=>{const f=t(g);c.set(g.id,f)});const h=[];s.data.forEach(({datum:g,values:f},m)=>{const v=f[n],b=f[r],S=l!=null?f[l]:1,x=c.get(v),M=c.get(b);if(S<=0||x==null||M==null)return;const T=e({series:this,itemId:void 0,datum:g,type:0,index:m,fromNode:x,toNode:M,size:S});h.push(T)});const{links:p,nodeGraph:u,maxPathLength:y}=Vm(c.values(),h,i);return this.nodeCount=u.size,this.linkCount=p.length,{nodeGraph:u,links:p,maxPathLength:y}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(t){const{seriesRect:e}=t,i={seriesRectWidth:e?.width??0,seriesRectHeight:e?.height??0};(this._nodeDataDependencies==null||this._nodeDataDependencies.seriesRectWidth!==i.seriesRectWidth||this._nodeDataDependencies.seriesRectHeight!==i.seriesRectHeight)&&(this._nodeDataDependencies=i),await this.updateSelections();const o=this.contextNodeData?.nodeData??[],s=this.contextNodeData?.labelData??[];let a=this.ctx.highlightManager?.getActiveHighlight();if(a?.series===this&&a.type==null){const{itemId:h}=a;a=h!=null?o.find(p=>p.type===1&&p.id===h):void 0}else a?.series!==this&&(a=void 0);this.contentGroup.visible=this.visible,this.contentGroup.opacity=a!=null?this.properties.highlightStyle.series.dimOpacity??1:1,this.labelSelection=await this.updateLabelSelection({labelData:s,labelSelection:this.labelSelection}),await this.updateLabelNodes({labelSelection:this.labelSelection}),this.linkSelection=await this.updateLinkSelection({nodeData:o.filter(h=>h.type===0),datumSelection:this.linkSelection}),await this.updateLinkNodes({datumSelection:this.linkSelection,isHighlight:!1}),this.nodeSelection=await this.updateNodeSelection({nodeData:o.filter(h=>h.type===1),datumSelection:this.nodeSelection}),await this.updateNodeNodes({datumSelection:this.nodeSelection,isHighlight:!1});let n,r,l,c;a?.type===1?(n=o.filter(h=>h.type===0&&(h.toNode===a||h.fromNode===a)),r=n.map(h=>h.fromNode===a?h.toNode:h.fromNode),r.push(a),l=[],c=[a]):a?.type===0?(n=[a],r=[a.fromNode,a.toNode],l=[a],c=[]):(n=[],r=[],l=[],c=[]),this.focusLinkSelection=await this.updateLinkSelection({nodeData:n,datumSelection:this.focusLinkSelection}),await this.updateLinkNodes({datumSelection:this.focusLinkSelection,isHighlight:!1}),this.focusNodeSelection=await this.updateNodeSelection({nodeData:r,datumSelection:this.focusNodeSelection}),await this.updateNodeNodes({datumSelection:this.focusNodeSelection,isHighlight:!1}),this.highlightLinkSelection=await this.updateLinkSelection({nodeData:l,datumSelection:this.highlightLinkSelection}),await this.updateLinkNodes({datumSelection:this.highlightLinkSelection,isHighlight:!0}),this.highlightNodeSelection=await this.updateNodeSelection({nodeData:c,datumSelection:this.highlightNodeSelection}),await this.updateNodeNodes({datumSelection:this.highlightNodeSelection,isHighlight:!0})}resetAnimation(t){}getSeriesDomain(t){return[]}getLegendData(t){return t!=="category"?[]:Array.from(this.processedNodes.values(),({id:e,label:i,fill:o,stroke:s})=>({legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:!0,label:{text:i??e},symbols:[{marker:{fill:o,fillOpacity:1,stroke:s,strokeWidth:0,strokeOpacity:1}}]}))}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.linkSelection.each((s,a)=>{const n=s.containsPoint(t,e)?0:1/0;n<i&&(i=n,o=a)}),this.nodeSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getDatumAriaText(t,e){if(t.type===0)return this.ctx.localeManager.t("ariaAnnounceFlowProportionLink",{index:t.index+1,count:this.linkCount,from:t.fromNode.id,to:t.toNode.id,size:t.size,sizeName:this.properties.sizeName??this.properties.sizeKey});if(t.type===1)return this.ctx.localeManager.t("ariaAnnounceFlowProportionNode",{index:t.index+1,count:this.nodeCount,description:e})}};d([T2(A2,{optional:!0,property:"nodes"})],Dd.prototype,"_chartNodes",2);import{_Scene as I2}from"ag-charts-community";var{BBox:N2,Path:O2,ScenePathChangeDetection:ko}=I2;function $r({radius:t,startAngle:e,endAngle:i,tension:o}){const s=t*Math.cos(e),a=t*Math.sin(e),n=t*Math.cos(i),r=t*Math.sin(i),l=s*o,c=a*o,h=n*o,p=r*o;return{x:[s,l,h,n],y:[a,c,p,r]}}var io=class extends O2{constructor(){super(...arguments),this.centerX=0,this.centerY=0,this.radius=0,this.startAngle1=0,this.endAngle1=0,this.startAngle2=0,this.endAngle2=0,this.tension=1}computeBBox(){const{centerX:t,centerY:e,radius:i,startAngle1:o,endAngle1:s,startAngle2:a,endAngle2:n,tension:r}=this,l=$r({radius:i,startAngle:o,endAngle:n,tension:r}),c=$r({radius:i,startAngle:a,endAngle:s,tension:r}),h=Math.min(...l.x,...c.x),p=Math.max(...l.x,...c.x)-h,u=Math.min(...l.y,...c.y),y=Math.max(...l.y,...c.y)-u;return new N2(t+h,e+u,p,y)}tensionedCurveTo(t,e,i,o,s,a,n,r){const{path:l,tension:c}=this,h=1-c;l.cubicCurveTo((i-t)*h+t,(o-e)*h+e,(s-n)*h+n,(a-r)*h+r,n,r)}updatePath(){const{path:t,centerX:e,centerY:i,radius:o}=this;let{startAngle1:s,endAngle1:a,startAngle2:n,endAngle2:r}=this;s>n&&([s,n]=[n,s],[a,r]=[r,a]),t.clear();const l=e+o*Math.cos(s),c=i+o*Math.sin(s);t.moveTo(l,c),this.tensionedCurveTo(l,c,e,i,e,i,e+o*Math.cos(r),i+o*Math.sin(r)),t.arc(e,i,o,r,n,!0),this.tensionedCurveTo(e+o*Math.cos(n),i+o*Math.sin(n),e,i,e,i,e+o*Math.cos(a),i+o*Math.sin(a)),t.arc(e,i,o,a,s,!0),t.closePath()}};d([ko()],io.prototype,"centerX",2),d([ko()],io.prototype,"centerY",2),d([ko()],io.prototype,"radius",2),d([ko()],io.prototype,"startAngle1",2),d([ko()],io.prototype,"endAngle1",2),d([ko()],io.prototype,"startAngle2",2),d([ko()],io.prototype,"endAngle2",2),d([ko()],io.prototype,"tension",2);import{_ModuleSupport as L2,_Scene as C2}from"ag-charts-community";var{BaseProperties:Hm,SeriesTooltip:E2,SeriesProperties:_2,ARRAY:R2,COLOR_STRING:Qr,COLOR_STRING_ARRAY:Gm,FUNCTION:Wm,LINE_DASH:Km,OBJECT:qr,POSITIVE_NUMBER:Io,RATIO:gn,STRING:No,Validate:Q}=L2,{Label:w2}=C2,kd=class extends w2{constructor(){super(...arguments),this.spacing=1,this.maxWidth=1}};d([Q(Io)],kd.prototype,"spacing",2),d([Q(Io)],kd.prototype,"maxWidth",2);var _i=class extends Hm{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0,this.tension=0}};d([Q(Qr,{optional:!0})],_i.prototype,"fill",2),d([Q(gn)],_i.prototype,"fillOpacity",2),d([Q(Qr,{optional:!0})],_i.prototype,"stroke",2),d([Q(gn)],_i.prototype,"strokeOpacity",2),d([Q(Io)],_i.prototype,"strokeWidth",2),d([Q(Km)],_i.prototype,"lineDash",2),d([Q(Io)],_i.prototype,"lineDashOffset",2),d([Q(gn)],_i.prototype,"tension",2),d([Q(Wm,{optional:!0})],_i.prototype,"itemStyler",2);var ui=class extends Hm{constructor(){super(...arguments),this.spacing=1,this.width=1,this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([Q(Io)],ui.prototype,"spacing",2),d([Q(Io)],ui.prototype,"width",2),d([Q(Qr,{optional:!0})],ui.prototype,"fill",2),d([Q(gn)],ui.prototype,"fillOpacity",2),d([Q(Qr,{optional:!0})],ui.prototype,"stroke",2),d([Q(gn)],ui.prototype,"strokeOpacity",2),d([Q(Io)],ui.prototype,"strokeWidth",2),d([Q(Km)],ui.prototype,"lineDash",2),d([Q(Io)],ui.prototype,"lineDashOffset",2),d([Q(Wm,{optional:!0})],ui.prototype,"itemStyler",2);var ce=class extends _2{constructor(){super(...arguments),this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.nodes=void 0,this.fills=[],this.strokes=[],this.label=new kd,this.link=new _i,this.node=new ui,this.tooltip=new E2}};d([Q(No)],ce.prototype,"fromKey",2),d([Q(No)],ce.prototype,"toKey",2),d([Q(No)],ce.prototype,"idKey",2),d([Q(No,{optional:!0})],ce.prototype,"idName",2),d([Q(No,{optional:!0})],ce.prototype,"labelKey",2),d([Q(No,{optional:!0})],ce.prototype,"labelName",2),d([Q(No,{optional:!0})],ce.prototype,"sizeKey",2),d([Q(No,{optional:!0})],ce.prototype,"sizeName",2),d([Q(R2,{optional:!0})],ce.prototype,"nodes",2),d([Q(Gm)],ce.prototype,"fills",2),d([Q(Gm)],ce.prototype,"strokes",2),d([Q(qr)],ce.prototype,"label",2),d([Q(qr)],ce.prototype,"link",2),d([Q(qr)],ce.prototype,"node",2),d([Q(qr)],ce.prototype,"tooltip",2);var{SeriesNodePickMode:Ym,CachedTextMeasurerPool:P2,TextWrapper:B2,TextUtils:z2,createDatumId:jm,EMPTY_TOOLTIP_CONTENT:F2}=u2,{angleBetween:Jr,normalizeAngle360:V2,isBetweenAngles:Xm,sanitizeHtml:Zm,Logger:U2}=y2,{Sector:H2,evaluateBezier:tl}=g2,el=t=>t.startAngle+Jr(t.startAngle,t.endAngle)/2,Id=class extends Dd{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,pickModes:[Ym.NEAREST_NODE,Ym.EXACT_SHAPE_MATCH]}),this.properties=new ce}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new io}nodeFactory(){return new H2}async createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n,maxWidth:r,fontSize:l},node:{width:c,spacing:h}}=this.properties,p=e/2,u=i/2;let y=[];const{nodeGraph:g,links:f}=this.getNodeGraph(k=>({...k,size:0,centerX:p,centerY:u,innerRadius:NaN,outerRadius:NaN,startAngle:NaN,endAngle:NaN}),k=>({...k,centerX:p,centerY:u,radius:NaN,startAngle1:NaN,endAngle1:NaN,startAngle2:NaN,endAngle2:NaN}),{includeCircularReferences:!0}),m=k=>String(k);let v=0;g.forEach(({datum:k,linksBefore:E,linksAfter:_},w)=>{const B=E.reduce((P,{link:R})=>P+R.size,0)+_.reduce((P,{link:R})=>P+R.size,0);if(B===0)g.delete(w);else{k.size=B,v+=k.size;const P=this.getLabelText(this.properties.label,{datum:k.datum,value:k.label,fromKey:o,toKey:s,sizeKey:a,size:k.size},m);k.label=String(P)}});let b=0;if(this.isLabelEnabled()){const k=this.properties.label.getFont();let E=0;g.forEach(({datum:_})=>{const{id:w,label:B}=_;if(B==null)return;const P=B2.wrapText(B,{maxWidth:r,font:this.properties.label,textWrap:"never"}),{width:R}=P2.measureText(P,{font:k,textAlign:"left",textBaseline:"middle"});E=Math.max(R,E),y.push({id:w,text:P,centerX:p,centerY:u,angle:NaN,radius:NaN})}),b=E+n}const S=g.size;let x=Math.min(e,i)/2-c-b,M=h/x;if(b!==0&&(S*M>=1.5*Math.PI||x<=0)&&(y=[],x=Math.min(e,i)/2-c,M=h/x),S*M>=2*Math.PI||x<=0){U2.warnOnce("There was insufficient space to display the Chord Series.");return}const T=x,A=x+c,D=Math.max((2*Math.PI-S*M)/v,0);let I=0;g.forEach(({datum:k})=>{k.innerRadius=T,k.outerRadius=A,k.startAngle=I,k.endAngle=I+k.size*D,I=k.endAngle+M;const E=(k.innerRadius+k.outerRadius)/2,_=el(k);k.midPoint={x:k.centerX+E*Math.cos(_),y:k.centerY+E*Math.sin(_)}});const N=[];g.forEach(({datum:k,linksBefore:E,linksAfter:_})=>{const w=el(k),B=[...E.map(R=>({link:R.link,distance:Jr(el(R.node.datum),w),after:!1})),..._.map(R=>({link:R.link,distance:Jr(el(R.node.datum),w),after:!0}))];let P=k.startAngle;B.sort((R,z)=>R.distance-z.distance).forEach(({link:R,after:z})=>{const F=R.size*D;z?(R.startAngle1=P,R.endAngle1=P+F):(R.startAngle2=P,R.endAngle2=P+F),P+=R.size*D}),N.push(k)});const{tension:O}=this.properties.link;f.forEach(k=>{k.radius=x;const E=$r({radius:x,startAngle:k.startAngle1,endAngle:k.endAngle2,tension:O}),_=$r({radius:x,startAngle:k.startAngle2,endAngle:k.endAngle1,tension:O}),w=tl(...E.x,.5),B=tl(...E.y,.5),P=tl(..._.x,.5),R=tl(..._.y,.5);k.midPoint={x:k.centerX+(w+P)/2,y:k.centerY+(B+R)/2},N.push(k)}),y.forEach(k=>{const E=g.get(k.id)?.datum;E!=null&&(k.radius=A+n,k.angle=V2(E.startAngle+Jr(E.startAngle,E.endAngle)/2))}),y.sort((k,E)=>k.angle-E.angle);let L=1/0,C=-1/0;return y=y.filter(k=>{const E=z2.getLineHeight(l),_=Math.atan2(E/2,k.radius),w=k.angle-_,B=k.angle+_;return Xm(L,w,B)||Xm(C,w,B)?!1:(L=Math.min(w,L),C=Math.max(B,C),!0)}),{itemId:t,nodeData:N,labelData:y}}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{text:l,centerX:c,centerY:h,radius:p,angle:u})=>{r.visible=!0,r.translationX=c+p*Math.cos(u),r.translationY=h+p*Math.sin(u),r.text=l,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textBaseline="middle",Math.cos(u)>=0?(r.textAlign="left",r.rotation=u):(r.textAlign="right",r.rotation=u-Math.PI)})}async updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>jm([e.type,e.id]))}async updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=this.properties,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,itemStyler:f}=s.node,m=i?s.highlightStyle.item:void 0,v=this.getStrokeWidth(s.node.strokeWidth);e.each((b,S)=>{const x=c??S.fill,M=p??S.stroke;let T;if(f!=null){const{label:A,size:D}=S;T=a.call(f,{seriesId:o,datum:S.datum,label:A,size:D,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:M,strokeWidth:v,lineDash:y,lineDashOffset:g,highlighted:i})}b.centerX=S.centerX,b.centerY=S.centerY,b.innerRadius=S.innerRadius,b.outerRadius=S.outerRadius,b.startAngle=S.startAngle,b.endAngle=S.endAngle,b.fill=m?.fill??T?.fill??x,b.fillOpacity=m?.fillOpacity??T?.fillOpacity??h,b.stroke=m?.stroke??T?.stroke??M,b.strokeOpacity=m?.strokeOpacity??T?.strokeOpacity??u,b.strokeWidth=m?.strokeWidth??T?.strokeWidth??v,b.lineDash=m?.lineDash??T?.lineDash??y,b.lineDashOffset=m?.lineDashOffset??T?.lineDashOffset??g,b.inset=b.strokeWidth/2})}async updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>jm([e.type,e.index,e.fromNode.id,e.toNode.id]))}async updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=s,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,tension:f,itemStyler:m}=s.link,v=i?s.highlightStyle.item:void 0,b=this.getStrokeWidth(s.link.strokeWidth);e.each((S,x)=>{const M=c??x.fromNode.fill,T=p??x.fromNode.stroke;let A;m!=null&&(A=a.call(m,{seriesId:o,datum:x.datum,fromKey:n,toKey:r,sizeKey:l,fill:M,fillOpacity:h,strokeOpacity:u,stroke:T,strokeWidth:b,lineDash:y,lineDashOffset:g,tension:f,highlighted:i})),S.centerX=x.centerX,S.centerY=x.centerY,S.radius=x.radius,S.startAngle1=x.startAngle1,S.endAngle1=x.endAngle1,S.startAngle2=x.startAngle2,S.endAngle2=x.endAngle2,S.fill=v?.fill??A?.fill??M,S.fillOpacity=v?.fillOpacity??A?.fillOpacity??h,S.stroke=v?.stroke??A?.stroke??T,S.strokeOpacity=v?.strokeOpacity??A?.strokeOpacity??u,S.strokeWidth=v?.strokeWidth??A?.strokeWidth??b,S.lineDash=v?.lineDash??A?.lineDash??y,S.lineDashOffset=v?.lineDashOffset??A?.lineDashOffset??g,S.tension=A?.tension??f})}resetAnimation(t){}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return F2;const{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datum:h,itemId:p,size:u}=t;let y;const g=[];let f;if(t.type===0){const{fillOpacity:b,strokeOpacity:S,strokeWidth:x,lineDash:M,lineDashOffset:T,tension:A,itemStyler:D}=s.link,{fromNode:I,toNode:N}=t;y=`${I.label??I.id} - ${N.label??N.id}`,r!=null&&g.push(Zm(`${l??r}: `+u)),f=s.link.fill??I.fill;const O=s.link.stroke??I.stroke;let L;D!=null&&(L=o.call(D,{seriesId:e,datum:h.datum,fromKey:a,toKey:n,sizeKey:r,fill:f,fillOpacity:b,strokeOpacity:S,stroke:O,strokeWidth:x,lineDash:M,lineDashOffset:T,tension:A,highlighted:!0})),f=L?.fill??f}else{const{fillOpacity:b,strokeOpacity:S,strokeWidth:x,lineDash:M,lineDashOffset:T,itemStyler:A}=s.node,{id:D,label:I}=t;y=I??D,r!=null&&g.push(Zm(`${l??r}: `+u)),f=s.link.fill??t.fill;const N=s.link.stroke??t.stroke;let O;A!=null&&(O=o.call(A,{seriesId:e,datum:h.datum,label:I,size:u,fromKey:a,toKey:n,sizeKey:r,fill:f,fillOpacity:b,strokeOpacity:S,stroke:N,strokeWidth:x,lineDash:M,lineDashOffset:T,highlighted:!0})),f=O?.fill??t.fill}const m=g.join("<br>"),v=f;return c.toTooltipHtml({title:y,content:m,backgroundColor:v},{seriesId:e,datum:h,title:y,color:v,itemId:p,fromKey:a,toKey:n,sizeKey:r,sizeName:l,size:u,...this.getModuleTooltipParams()})}getLabelData(){return[]}computeFocusBounds({datumIndex:t}){const e=this.contextNodeData?.nodeData[t];if(e?.type===1){for(const i of this.nodeSelection)if(i.datum===e)return i.node;return}else if(e?.type===0){for(const i of this.linkSelection)if(i.datum===e)return i.node;return}}};Id.className="ChordSeries",Id.type="chord";var{DEFAULT_FONT_FAMILY:G2,DEFAULT_LABEL_COLOUR:W2}=p2,K2={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"chord",tooltipDefaults:{range:"exact"},moduleFactory:t=>new Id(t),themeTemplate:{series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:G2,color:W2,spacing:5,maxWidth:100},node:{spacing:8,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0,tension:.4}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){const{fills:i,strokes:o}=t(e);return{fills:i,strokes:o}}};import{_Theme as Y2}from"ag-charts-community";import{_Theme as Le}from"ag-charts-community";function $m(t){const{placement:e,...i}=t?.stageLabel??{};return t?.direction!=="horizontal"?[{type:Le.CARTESIAN_AXIS_TYPE.CATEGORY,position:e==="after"?Le.CARTESIAN_POSITION.RIGHT:Le.CARTESIAN_POSITION.LEFT,label:i},{type:Le.CARTESIAN_AXIS_TYPE.NUMBER,position:Le.CARTESIAN_POSITION.BOTTOM}]:[{type:Le.CARTESIAN_AXIS_TYPE.NUMBER,position:Le.CARTESIAN_POSITION.LEFT},{type:Le.CARTESIAN_AXIS_TYPE.CATEGORY,position:e==="before"?Le.CARTESIAN_POSITION.TOP:Le.CARTESIAN_POSITION.BOTTOM,label:i}]}var j2={series:{direction:"vertical",strokeWidth:0,spacingRatio:.25,label:{enabled:!0,fontSize:12,fontFamily:Le.DEFAULT_FONT_FAMILY,color:Le.DEFAULT_INSIDE_SERIES_LABEL_COLOUR},dropOff:{enabled:!0,fillOpacity:.2,strokeWidth:0}},axes:{[Le.CARTESIAN_AXIS_TYPE.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(t){return Math.abs(t.value).toFixed(t.fractionDigits??0)}}},[Le.CARTESIAN_AXIS_TYPE.CATEGORY]:{line:{enabled:!1}}}};import{_ModuleSupport as X2,_Scene as Z2}from"ag-charts-community";import{_ModuleSupport as il,_Scale as $2,_Scene as Q2,_Util as q2}from"ag-charts-community";import{_Scene as J2,_Util as ol}from"ag-charts-community";var{BBox:tC,Path:eC,ScenePathChangeDetection:Oo}=J2,Qm=1e-6;function qm([t,e],[i,o]){return Math.abs(t-i)<=Qm&&Math.abs(e-o)<=Qm}var Ri=class extends eC{constructor(){super(...arguments),this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0}get midPoint(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this;return{x:(t+i+s+n)/4,y:(e+o+a+r)/4}}distanceSquared(t,e){if(this.containsPoint(t,e))return 0;const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c}=this;return Math.min(ol.lineDistanceSquared(t,e,i,o,s,a,1/0),ol.lineDistanceSquared(t,e,s,a,n,r,1/0),ol.lineDistanceSquared(t,e,n,r,l,c,1/0),ol.lineDistanceSquared(t,e,l,c,i,o,1/0))}computeBBox(){const{x0:t,y0:e,x1:i,y1:o,x2:s,y2:a,x3:n,y3:r}=this,l=Math.min(t,i,s,n),c=Math.max(t,i,s,n)-l,h=Math.min(e,o,a,r),p=Math.max(e,o,a,r)-h;return new tC(l,h,c,p)}updatePath(){const{path:t,x0:e,y0:i,x1:o,y1:s,x2:a,y2:n,x3:r,y3:l}=this,c=[[e,i],[o,s],[a,n],[r,l]];t.clear();let h,p;c.forEach(u=>{if(h!=null&&qm(h,u)||p!=null&&qm(p,u))return;const[y,g]=u;h==null?t.moveTo(y,g):t.lineTo(y,g),h??(h=u),p=u}),t.closePath()}};d([Oo()],Ri.prototype,"x0",2),d([Oo()],Ri.prototype,"y0",2),d([Oo()],Ri.prototype,"x1",2),d([Oo()],Ri.prototype,"y1",2),d([Oo()],Ri.prototype,"x2",2),d([Oo()],Ri.prototype,"y2",2),d([Oo()],Ri.prototype,"x3",2),d([Oo()],Ri.prototype,"y3",2);import{_ModuleSupport as iC}from"ag-charts-community";var{NODE_UPDATE_STATE_TO_PHASE_MAPPING:oC}=iC;function Jm(t,e,i,o){const{x0:s,y0:a,x1:n,y1:r,x2:l,y2:c,x3:h,y3:p,opacity:u}=t;return i?{x0:(s+h)/2,y0:(a+p)/2,x1:(n+l)/2,y1:(r+c)/2,x2:(n+l)/2,y2:(r+c)/2,x3:(s+h)/2,y3:(a+p)/2,opacity:u}:{x0:(s+n)/2,y0:(a+r)/2,x1:(s+n)/2,y1:(a+r)/2,x2:(l+h)/2,y2:(c+p)/2,x3:(l+h)/2,y3:(c+p)/2,opacity:u}}function sC(t,e){const i=a=>a==null;return{fromFn:(a,n,r)=>{r==="updated"&&i(n)?r="removed":r==="updated"&&i(a.previousDatum)&&(r="added");let l;r==="added"&&a.previousDatum==null&&e==="fade"?l={...yn(a,n),opacity:0}:r==="unknown"||r==="added"?l=Jm(n,a.previousDatum,t,e):l={x0:a.x0,y0:a.y0,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2,x3:a.x3,y3:a.y3,opacity:a.opacity};const c=oC[r];return{...l,phase:c}},toFn:(a,n,r)=>{let l;return r==="removed"&&a.datum==null&&e==="fade"?l={...yn(a,n),opacity:0}:r==="removed"||i(n)?l=Jm(n,a.previousDatum,t,e):l=yn(a,n),l}}}function yn(t,e){const{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}=e;return{x0:i,y0:o,x1:s,y1:a,x2:n,y2:r,x3:l,y3:c,opacity:h}}var{SeriesNodePickMode:tx,ZIndexMap:aC,valueProperty:nC,keyProperty:rC,ChartAxisDirection:lC,updateLabelNode:cC,SMALLEST_KEY_INTERVAL:hC,LARGEST_KEY_INTERVAL:dC,diff:pC,fixNumericExtent:uC,seriesLabelFadeInAnimation:ex,resetMotion:gC,resetLabelFn:yC,animationValidation:fC,computeBarFocusBounds:mC}=il,{Group:xC,Selection:SC,PointerEvents:ix,motion:bC}=Q2,{sanitizeHtml:ox}=q2,{ContinuousScale:vC}=$2,MC=class extends il.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.stageKey,this.yKey=o.properties.valueKey}},sx=class extends il.AbstractBarSeries{constructor({moduleCtx:t,animationResetFns:e}){super({moduleCtx:t,pickModes:[tx.AXIS_ALIGNED,tx.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["stageKey"],y:["valueKey"]},directionNames:{x:[],y:[]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:e.datum,label:yC}}),this.NodeEvent=MC,this.connectorNodeGroup=this.contentGroup.appendChild(new xC({name:`${this.id}-series-connectorNodes`,zIndex:aC.SERIES_LAYER,zIndexSubOrder:this.getGroupZIndexSubOrder("data")})),this.connectorSelection=SC.select(this.connectorNodeGroup,()=>this.connectionFactory()),this.connectorNodeGroup.pointerEvents=ix.None}get pickModeAxis(){return"main-category"}isVertical(){return!super.isVertical()}connectionFactory(){return new Ri}async processData(t){if(!this.properties.isValid())return;const{stageKey:e,valueKey:i}=this.properties,o=this.getCategoryAxis()?.scale,s=this.getValueAxis()?.scale,{isContinuousX:a,xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:o,yScale:s}),l=[];this.ctx.animationManager.isSkipped()||(this.processedData&&l.push(pC(this.processedData)),l.push(fC()));const c=this.visible?{}:{forceValue:0},{processedData:h}=await this.requestDataModel(t,this.data,{props:[rC(e,n,{id:"xValue"}),nC(i,r,{id:"yValue",...c}),...a?[hC,dC]:[],...l],groupByKeys:!0});this.smallestDataInterval=h.reduced?.smallestKeyInterval,this.largestDataInterval=h.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");return a?.def.type==="key"&&a?.def.valueType==="category"?o:this.padBandExtent(o)}else{const a=i.resolveProcessedDataIndexById(this,"yValue"),n=s[a][1],r=[-n,n];return uC(r)}}async createNodeData(){const{data:t,dataModel:e,groupScale:i,processedData:o,properties:{visible:s}}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&a&&n&&e))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===lC.X,{stageKey:h,valueKey:p,fills:u,strokes:y}=this.properties,{strokeWidth:g}=this.barStyle(),f=`${p}`,m={itemId:f,nodeData:[],labelData:[],connectorData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return m;const v=e.resolveProcessedDataIndexById(this,"xValue"),b=e.resolveProcessedDataIndexById(this,"yValue"),{barWidth:S,groupIndex:x}=this.updateGroupScale(a),M=vC.is(r)?S*-.5:0;let T;return o?.data.forEach(({keys:A,datum:D,values:I},N)=>{I.forEach((O,L)=>{const C=A[v],k=Math.round(r.convert(C))+i.convert(String(x))+M,E=O[b],_=Math.round(l.convert(-E)),w=Math.round(l.convert(E)),B=Math.max(g,Math.abs(w-_)),P={x:c?Math.min(w,_):k,y:c?k:Math.min(w,_),width:c?B:S,height:c?S:B},R={x:P.x+P.width/2,y:P.y+P.height/2},z=this.createLabelData({rect:P,barAlongX:c,yDatum:E,datum:D[L]}),F=u[N%u.length]??"black",U=y[N%y.length]??"black",G={index:N,valueIndex:L,series:this,itemId:f,datum:D[L],xValue:C,yValue:E,xKey:p,yKey:h,x:P.x,y:P.y,width:P.width,height:P.height,midPoint:R,fill:F,stroke:U,strokeWidth:g,opacity:1,label:z};if(m.nodeData.push(G),z!=null&&m.labelData.push(z),T!=null){const V=T.rect;c?m.connectorData.push({datum:G,x0:V.x,y0:V.y+V.height,x1:V.x+V.width,y1:V.y+V.height,x2:P.x+P.width,y2:P.y,x3:P.x,y3:P.y,fill:T.fill,stroke:T.stroke,opacity:1}):m.connectorData.push({datum:G,x0:V.x+V.width,y0:V.y,x1:P.x,y1:P.y,x2:P.x,y2:P.y+P.height,x3:V.x+V.width,y3:V.y+V.height,fill:T.fill,stroke:T.stroke,opacity:1})}T={itemId:f,rect:P,fill:F,stroke:U}})}),m}async updateNodes(t,e,i){await super.updateNodes(t,e,i);const{connectorSelection:o}=this,s=this.contextNodeData?.connectorData??[];this.connectorSelection=await this.updateConnectorSelection({connectorSelection:o,connectorData:s}),await this.updateConnectorNodes({connectorSelection:o})}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}async updateConnectorSelection(t){const{connectorData:e,connectorSelection:i}=t;return i.update(this.connectorEnabled()?e:[],void 0,o=>this.getDatumId(o.datum))}async updateConnectorNodes(t){const{fill:e,fillOpacity:i,stroke:o,strokeOpacity:s,strokeWidth:a,lineDash:n,lineDashOffset:r}=this.connectorStyle();t.connectorSelection.each((l,c)=>{l.setProperties(yn(l,c)),l.fill=e??c.fill,l.fillOpacity=i,l.stroke=o??c.stroke,l.strokeOpacity=s,l.strokeWidth=a,l.lineDash=n,l.lineDashOffset=r})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}async updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=ix.None})}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{cC(e,this.properties.label,i)})}getTooltipHtml(t){const{id:e,ctx:{callbackCache:i}}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!this.properties.isValid()||!o||!s)return il.EMPTY_TOOLTIP_CONTENT;const{stageKey:a,valueKey:n,itemStyler:r,tooltip:l}=this.properties,{strokeWidth:c,fillOpacity:h,strokeOpacity:p,lineDash:u,lineDashOffset:y}=this.barStyle(),{datum:g,xValue:f,yValue:m,fill:v,stroke:b}=t;let S;r&&(S=i.call(r,{highlighted:!1,seriesId:e,datum:g,stageKey:a,valueKey:n,fill:v,fillOpacity:h,stroke:b,strokeWidth:c,strokeOpacity:p,lineDash:u,lineDashOffset:y}));const x=S?.fill??v??"gray",M=ox(o.formatDatum(f)),T=ox(s.formatDatum(m)),A=M,I={title:A,content:T,backgroundColor:x};return l.toTooltipHtml(I,{itemId:void 0,datum:g,stageKey:a,valueKey:n,color:x,seriesId:e,title:A})}getLegendData(t){const{id:e,visible:i}=this;if(t!=="category")return[];const{fills:[o],strokes:[s],valueKey:a}=this.properties,{strokeWidth:n,fillOpacity:r,strokeOpacity:l}=this.barStyle();return[{legendType:"category",id:e,itemId:a,seriesId:e,enabled:i,label:{text:`${a}`},symbols:[{marker:{fill:o,stroke:s,fillOpacity:r,strokeOpacity:l,strokeWidth:n}}]}]}resetConnectorAnimation(t){const{connectorSelection:e}=this;gC([e],yn)}resetAllAnimation(t){super.resetAllAnimation(t),this.resetConnectorAnimation(t)}animateEmptyUpdateReady({labelSelection:t}){const{connectorSelection:e}=this,i=this.isVertical(),s=sC(i,"normal");bC.fromToMotion(this.id,"connectors",this.ctx.animationManager,[e],s),ex(this,"labels",this.ctx.animationManager,t)}animateWaitingUpdateReady(t){const{labelSelection:e}=t;this.ctx.animationManager.stopByAnimationGroupId(this.id),ex(this,"labels",this.ctx.animationManager,e)}getDatumId(t){return`${t.xValue}-${t.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t,seriesRect:e}){return mC(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};import{_ModuleSupport as TC,_Scene as AC}from"ag-charts-community";var{Label:DC}=AC,{AbstractBarSeriesProperties:kC,SeriesTooltip:IC,AxisLabel:NC,Validate:be,UNION:ax,COLOR_STRING_ARRAY:nx,LINE_DASH:OC,OBJECT:Nd,POSITIVE_NUMBER:Od,RATIO:rx,STRING:lx}=TC,Ld=class extends DC{constructor(){super(...arguments),this.spacing=0}};d([be(ax(["before","middle","after"],"a placement"))],Ld.prototype,"placement",2),d([be(Od)],Ld.prototype,"spacing",2);var cx=class extends NC{};d([be(ax(["before","after"],"a placement"))],cx.prototype,"placement",2);var ze=class extends kC{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.label=new Ld,this.stageLabel=new cx,this.tooltip=new IC}};d([be(lx)],ze.prototype,"stageKey",2),d([be(lx)],ze.prototype,"valueKey",2),d([be(nx)],ze.prototype,"fills",2),d([be(rx)],ze.prototype,"fillOpacity",2),d([be(nx)],ze.prototype,"strokes",2),d([be(Od)],ze.prototype,"strokeWidth",2),d([be(rx)],ze.prototype,"strokeOpacity",2),d([be(OC)],ze.prototype,"lineDash",2),d([be(Od)],ze.prototype,"lineDashOffset",2),d([be(Nd)],ze.prototype,"label",2),d([be(Nd)],ze.prototype,"stageLabel",2),d([be(Nd)],ze.prototype,"tooltip",2);function hx(t,{x:e,y:i,width:o,height:s,opacity:a}){return{x1:e,y1:i,x2:e+o,y2:i+s,opacity:a}}var{isFiniteNumber:LC}=X2,{Line:CC}=Z2,Cd=class extends sx{constructor(t){super({moduleCtx:t,animationResetFns:{datum:hx}}),this.properties=new ze}getBandScalePadding(){return{inner:1,outer:0}}connectorEnabled(){return!0}barStyle(){return{fill:void 0,fillOpacity:1,stroke:void 0,strokeOpacity:1,strokeWidth:0,lineDash:[],lineDashOffset:0}}connectorStyle(){const{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}=this.properties;return{fill:void 0,fillOpacity:t,stroke:void 0,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}}nodeFactory(){return new CC}createLabelData({rect:t,barAlongX:e,yDatum:i,datum:o}){const{stageKey:s,valueKey:a,label:n}=this.properties,{spacing:r,placement:l}=n;let c,h,p,u;if(e)switch(c=t.x+t.width/2,p="center",l){case"before":h=t.y-r,u="bottom";break;case"after":h=t.y+t.height+r,u="top";break;default:h=t.y+t.height/2,u="middle"}else switch(h=t.y+t.height/2,u="middle",l){case"before":c=t.x-r,p="right";break;case"after":c=t.x+t.width+r,p="left";break;default:c=t.x+t.width/2,p="center"}return{x:c,y:h,textAlign:p,textBaseline:u,text:this.getLabelText(n,{itemId:a,value:i,datum:o,stageKey:s,valueKey:a},y=>LC(y)?y.toFixed(0):String(y)),itemId:a,datum:o,series:this}}async updateDatumNodes(t){const e=t.isHighlight?this.properties.highlightStyle.item:void 0;t.datumSelection.each((i,o)=>{i.setProperties(hx(i,o)),i.stroke=e?.stroke,i.strokeWidth=e?.strokeWidth??0,i.strokeOpacity=e?.strokeOpacity??1,i.lineDash=e?.lineDash,i.lineDashOffset=e?.lineDashOffset??0})}};Cd.className="ConeFunnelSeries",Cd.type="cone-funnel";import{_Theme as sl}from"ag-charts-community";var EC={series:{direction:"vertical",strokeWidth:0,label:{enabled:!0,fontSize:12,fontFamily:sl.DEFAULT_FONT_FAMILY,color:sl.DEFAULT_LABEL_COLOUR,placement:"before",spacing:4}},seriesArea:{padding:{top:20,bottom:20}},axes:{[sl.CARTESIAN_AXIS_TYPE.NUMBER]:{nice:!1,gridLine:{enabled:!1},crosshair:{enabled:!1},label:{enabled:!1,formatter(t){return Math.abs(t.value).toFixed(t.fractionDigits??0)}}},[sl.CARTESIAN_AXIS_TYPE.CATEGORY]:{line:{enabled:!1}}}},_C={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"cone-funnel",moduleFactory:t=>new Cd(t),solo:!0,tooltipDefaults:{range:"nearest"},defaultAxes:$m,themeTemplate:EC,paletteFactory:({userPalette:t,themeTemplateParameters:e,takeColors:i,colorsCount:o})=>{const{fills:s}=i(o),a=e.get(Y2.DEFAULT_FUNNEL_SERIES_COLOR_RANGE),n=t==="inbuilt"?a:[s[0],s[1]];return{fills:n,strokes:n.slice(0)}}};import{_ModuleSupport as RC,_Scene as wC}from"ag-charts-community";import{_ModuleSupport as PC,_Scene as BC}from"ag-charts-community";var{Label:zC,DropShadow:FC}=BC,{AbstractBarSeriesProperties:VC,BaseProperties:UC,SeriesTooltip:HC,AxisLabel:GC,Validate:mt,UNION:WC,BOOLEAN:KC,COLOR_STRING_ARRAY:dx,COLOR_STRING:px,FUNCTION:YC,LINE_DASH:ux,OBJECT:fn,POSITIVE_NUMBER:al,RATIO:mn,STRING:gx}=PC,jC=class extends zC{},yx=class extends GC{};d([mt(WC(["before","after"],"a placement"))],yx.prototype,"placement",2);var oo=class extends UC{constructor(){super(...arguments),this.enabled=!0,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([mt(KC)],oo.prototype,"enabled",2),d([mt(px,{optional:!0})],oo.prototype,"fill",2),d([mt(mn)],oo.prototype,"fillOpacity",2),d([mt(px,{optional:!0})],oo.prototype,"stroke",2),d([mt(al)],oo.prototype,"strokeWidth",2),d([mt(mn)],oo.prototype,"strokeOpacity",2),d([mt(ux)],oo.prototype,"lineDash",2),d([mt(al)],oo.prototype,"lineDashOffset",2);var Qt=class extends VC{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.spacingRatio=0,this.dropOff=new oo,this.shadow=new FC().set({enabled:!1}),this.label=new jC,this.stageLabel=new yx,this.tooltip=new HC}};d([mt(gx)],Qt.prototype,"stageKey",2),d([mt(gx)],Qt.prototype,"valueKey",2),d([mt(dx)],Qt.prototype,"fills",2),d([mt(mn)],Qt.prototype,"fillOpacity",2),d([mt(dx)],Qt.prototype,"strokes",2),d([mt(al)],Qt.prototype,"strokeWidth",2),d([mt(mn)],Qt.prototype,"strokeOpacity",2),d([mt(ux)],Qt.prototype,"lineDash",2),d([mt(al)],Qt.prototype,"lineDashOffset",2),d([mt(mn)],Qt.prototype,"spacingRatio",2),d([mt(YC,{optional:!0})],Qt.prototype,"itemStyler",2),d([mt(fn)],Qt.prototype,"dropOff",2),d([mt(fn)],Qt.prototype,"shadow",2),d([mt(fn)],Qt.prototype,"label",2),d([mt(fn)],Qt.prototype,"stageLabel",2),d([mt(fn)],Qt.prototype,"tooltip",2);var{ChartAxisDirection:fx,getRectConfig:XC,updateRect:ZC,checkCrisp:$C,resetBarSelectionsFn:QC,prepareBarAnimationFunctions:mx,midpointStartingBarPosition:xx,createDatumId:qC,isFiniteNumber:JC}=RC,{Rect:tE,motion:Sx}=wC,Ed=class extends sx{constructor(t){super({moduleCtx:t,animationResetFns:{datum:QC}}),this.properties=new Qt}getBandScalePadding(){return{inner:this.properties.spacingRatio,outer:0}}connectorEnabled(){return this.properties.dropOff.enabled}barStyle(){const{fillOpacity:t,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}=this.properties;return{fill:void 0,fillOpacity:t,stroke:void 0,strokeOpacity:e,strokeWidth:i,lineDash:o,lineDashOffset:s}}connectorStyle(){const{fill:t,fillOpacity:e,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}=this.properties.dropOff;return{fill:t,fillOpacity:e,stroke:i,strokeOpacity:o,strokeWidth:s,lineDash:a,lineDashOffset:n}}nodeFactory(){return new tE}createLabelData({rect:t,yDatum:e,datum:i}){const{valueKey:o,stageKey:s,label:a}=this.properties;return{x:t.x+t.width/2,y:t.y+t.height/2,textAlign:"center",textBaseline:"middle",text:this.getLabelText(a,{itemId:s,value:e,datum:i,valueKey:o,stageKey:s},n=>JC(n)?n.toFixed(0):String(n)),itemId:s,datum:i,series:this}}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,ctx:s}=this,{stageKey:a,valueKey:n,highlightStyle:{item:r},fillOpacity:l,strokeOpacity:c,strokeWidth:h,lineDash:p,lineDashOffset:u,itemStyler:y,shadow:g}=this.properties,f=this.axes[fx.X],m=$C(f?.scale,f?.visibleRange,this.smallestDataInterval,this.largestDataInterval),v=this.getCategoryDirection()===fx.X;e.each((b,S)=>{const x={fill:S.fill,stroke:S.stroke,fillOpacity:l,strokeOpacity:c,lineDash:p,lineDashOffset:u,fillShadow:g,strokeWidth:this.getStrokeWidth(h)},M=v?S.width>0:S.height>0,T=XC({datum:S,isHighlighted:i,style:x,highlightStyle:r,itemStyler:y,seriesId:o,ctx:s,stageKey:a,valueKey:n});T.crisp=m,T.visible=M,ZC(b,T)})}animateEmptyUpdateReady(t){super.animateEmptyUpdateReady(t);const{datumSelection:e}=t,i=this.isVertical(),s=mx(xx(i,"normal"));Sx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t);const{datumSelection:e}=t,{processedData:i}=this,o=i?.reduced?.diff,s=mx(xx(this.isVertical(),"fade"));Sx.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],s,(a,n)=>qC(n.xValue,n.valueIndex),o)}};Ed.className="FunnelSeries",Ed.type="funnel";var eE={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"funnel",moduleFactory:t=>new Ed(t),solo:!0,tooltipDefaults:{range:"exact"},defaultAxes:$m,themeTemplate:j2,paletteFactory:({takeColors:t})=>{const{fills:e,strokes:i}=t(1);return{fills:e,strokes:i}}};import{_Theme as Sa}from"ag-charts-community";import{_ModuleSupport as nl,_Scale as iE,_Scene as oE,_Util as sE}from"ag-charts-community";import{_ModuleSupport as aE,_Util as nE}from"ag-charts-community";var{CachedTextMeasurerPool:bx,TextUtils:vx,TextWrapper:rl,findMaxValue:Mx}=aE,{Logger:rE}=nE;function lE(t,e){const{fontSize:i,minimumFontSize:o=i}=t,{fontSize:s,minimumFontSize:a=s}=e,n=i-o,r=s-a;let l=t.fontSize,c=e.fontSize;const h=[{labelFontSize:i,secondaryLabelFontSize:s}];for(;l>o||c>a;){const p=n>0?(l-o)/n:-1,u=r>0?(c-a)/r:-1;p>u?l--:c--,h.push({labelFontSize:l,secondaryLabelFontSize:c})}return h.reverse(),h}function ba(t,e){return t.lineHeight!=null&&t.fontSize!=null?t.lineHeight*e/t.fontSize:vx.getLineHeight(e)}function Tx(t,e,i,o,{padding:s},a){const{spacing:n=0}=e,r=2*s,l=2*s+n,c=(e.minimumFontSize??e.fontSize)+(o.minimumFontSize??o.fontSize);if(c>a(c+l,!1).height-l)return;const h=lE(e,o),p={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight},u={fontFamily:o.fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight};let y,g;return Mx(0,h.length-1,f=>{const{labelFontSize:m,secondaryLabelFontSize:v}=h[f],b=f===0,S=ba(e,m),x=ba(o,v),M=a(S+x+l,b),T=M.width-r,A=M.height-l;if(S+x>A||((y==null||y.fontSize!==m)&&(p.fontSize=m,y=Dx(e,t,T,A,p,e.wrapping,b?e.overflowStrategy:"hide")),y==null||y.width>T||y.height>A)||((g==null||g.fontSize!==v)&&(u.fontSize=v,g=Dx(o,i,T,A,u,o.wrapping,b?o.overflowStrategy:"hide")),g==null))return;const D=y.height+g.height;if(!(g.width>T||D>A))return{width:Math.max(y.width,g.width),height:D+n,meta:M.meta,label:y,secondaryLabel:g}})}function xn(t,e,{padding:i},o){const s=2*i,a=Math.min(e.minimumFontSize??e.fontSize,e.fontSize),n={fontFamily:e.fontFamily,fontSize:e.fontSize,fontStyle:e.fontStyle,fontWeight:e.fontWeight};return Mx(a,e.fontSize,r=>{const l=ba(e,r),c=r===a,h=o(l+s,c),p=h.width-s,u=h.height-s;if(l>u)return;n.fontSize=r;const y=rl.wrapLines(t,{maxWidth:p,maxHeight:u,font:n,textWrap:e.wrapping,overflow:(c?e.overflowStrategy:void 0)??"hide"});if(!y.length)return;const g=cE(y,{lineHeight:l,font:n,maxWidth:p,maxHeight:u});if(g)return[{fontSize:r,lineHeight:l,...g},h.meta]})}function Ax(t){return t?.minimumFontSize!=null&&t?.fontSize&&t?.minimumFontSize>t?.fontSize}function _d(t,e,i,o,s,a){const n=e.enabled?t:void 0,r=o.enabled?i:void 0;(Ax(e)||Ax(o))&&rE.warnOnce("minimumFontSize should be set to a value less than or equal to the font size");let l;n!=null&&r!=null&&(l=Tx(n,e,r,o,s,a));let c;if(l==null&&n!=null&&(c=xn(n,e,s,a)),c!=null){const[p,u]=c;l={width:p.width,height:p.height,meta:u,label:p,secondaryLabel:void 0}}let h;if(l==null&&n==null&&r!=null&&(h=xn(r,o,s,a)),h!=null){const[p,u]=h;l={width:p.width,height:p.height,meta:u,label:void 0,secondaryLabel:p}}return l}function Dx(t,e,i,o,s,a,n){const r=rl.wrapLines(e,{maxWidth:i,maxHeight:o,font:s,textWrap:a,overflow:n});if(!r.length)return;const l=ba(t,s.fontSize),{width:c}=bx.measureLines(r,{font:s});return{width:c,lineHeight:l,text:r.join(`
`),height:r.length*l,fontSize:s.fontSize}}function cE(t,{font:e,lineHeight:i=vx.defaultLineHeight,maxWidth:o,maxHeight:s=1/0}){let a=i*t.length;for(;a>s;){if(t.length===1)return;t.pop(),t[t.length-1]=rl.appendEllipsis(t.at(-1)),a=i*t.length}const n=bx.measureLines(t,{font:e});let r,l;if(n.width>o){const c=[];l=0;for(const h of n.lineMetrics){if(h.width>o){if(!c.length)return;break}c.push(h.text),l=Math.max(l,h.width)}r=rl.appendEllipsis(c.join(`
`))}else r=t.join(`
`),l=n.width;return{text:r,width:l,height:a}}import{_ModuleSupport as hE}from"ag-charts-community";import{_ModuleSupport as dE,_Scene as pE}from"ag-charts-community";var{Validate:Sn,NUMBER:uE,POSITIVE_NUMBER:kx,TEXT_WRAP:gE,OVERFLOW_STRATEGY:yE}=dE,va=class extends pE.Label{constructor(){super(...arguments),this.wrapping="on-space",this.overflowStrategy="ellipsis"}};d([Sn(gE)],va.prototype,"wrapping",2),d([Sn(yE)],va.prototype,"overflowStrategy",2),d([Sn(kx,{optional:!0})],va.prototype,"lineHeight",2),d([Sn(kx,{optional:!0})],va.prototype,"minimumFontSize",2);var wi=class extends va{constructor(){super(...arguments),this.spacing=0}};d([Sn(uE)],wi.prototype,"spacing",2);var bn=class extends va{},{CartesianSeriesProperties:fE,SeriesTooltip:mE,Validate:qt,AND:xE,ARRAY:SE,COLOR_STRING:bE,COLOR_STRING_ARRAY:vE,FUNCTION:ME,OBJECT:Ix,POSITIVE_NUMBER:Nx,RATIO:TE,STRING:us,TEXT_ALIGN:AE,VERTICAL_ALIGN:DE}=hE,Yt=class extends fE{constructor(){super(...arguments),this.colorRange=["black","black"],this.stroke="black",this.strokeWidth=0,this.textAlign="center",this.verticalAlign="middle",this.itemPadding=0,this.label=new wi,this.tooltip=new mE}};d([qt(us,{optional:!0})],Yt.prototype,"title",2),d([qt(us)],Yt.prototype,"xKey",2),d([qt(us)],Yt.prototype,"yKey",2),d([qt(us,{optional:!0})],Yt.prototype,"colorKey",2),d([qt(us,{optional:!0})],Yt.prototype,"xName",2),d([qt(us,{optional:!0})],Yt.prototype,"yName",2),d([qt(us,{optional:!0})],Yt.prototype,"colorName",2),d([qt(xE(vE,SE.restrict({minLength:1})))],Yt.prototype,"colorRange",2),d([qt(bE,{optional:!0})],Yt.prototype,"stroke",2),d([qt(TE,{optional:!0})],Yt.prototype,"strokeOpacity",2),d([qt(Nx,{optional:!0})],Yt.prototype,"strokeWidth",2),d([qt(AE)],Yt.prototype,"textAlign",2),d([qt(DE)],Yt.prototype,"verticalAlign",2),d([qt(Nx)],Yt.prototype,"itemPadding",2),d([qt(ME,{optional:!0})],Yt.prototype,"itemStyler",2),d([qt(Ix)],Yt.prototype,"label",2),d([qt(Ix)],Yt.prototype,"tooltip",2);var{SeriesNodePickMode:Ox,computeBarFocusBounds:kE,getMissCount:IE,valueProperty:Rd,ChartAxisDirection:Pi,DEFAULT_CARTESIAN_DIRECTION_KEYS:NE,DEFAULT_CARTESIAN_DIRECTION_NAMES:OE}=nl,{Rect:LE,PointerEvents:CE}=oE,{ColorScale:EE}=iE,{sanitizeHtml:Ma,Logger:_E}=sE,RE=class extends nl.CartesianSeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.colorKey=o.properties.colorKey}},wE={left:-.5,center:0,right:-.5},PE={top:-.5,middle:0,bottom:-.5},wd=class extends nl.CartesianSeries{constructor(t){super({moduleCtx:t,directionKeys:NE,directionNames:OE,pickModes:[Ox.NEAREST_NODE,Ox.EXACT_SHAPE_MATCH],pathsPerSeries:[],hasMarkers:!1,hasHighlightedLabels:!0}),this.properties=new Yt,this.NodeEvent=RE,this.colorScale=new EE}async processData(t){const e=this.axes[Pi.X],i=this.axes[Pi.Y];if(!e||!i||!this.properties.isValid()||!this.data?.length)return;const{xKey:o,yKey:s,colorRange:a,colorKey:n}=this.properties,r=this.axes[Pi.X]?.scale,l=this.axes[Pi.Y]?.scale,{xScaleType:c,yScaleType:h}=this.getScaleInformation({xScale:r,yScale:l}),p=this.colorScale.type,{dataModel:u,processedData:y}=await this.requestDataModel(t,this.data,{props:[Rd(o,c,{id:"xValue"}),Rd(s,h,{id:"yValue"}),...n?[Rd(n,p,{id:"colorValue"})]:[]]});if(this.isColorScaleValid()){const g=u.resolveProcessedDataIndexById(this,"colorValue");this.colorScale.domain=y.domain.values[g],this.colorScale.range=a,this.colorScale.update()}}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=IE(this,i.defs.values[o].missing);return!(s===0||s===a)}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;return!e||!i?[]:t===Pi.X?e.getDomain(this,"xValue","value",i):e.getDomain(this,"yValue","value",i)}async createNodeData(){const{data:t,visible:e,axes:i,dataModel:o}=this,s=i[Pi.X],a=i[Pi.Y];if(!(t&&o&&e&&s&&a))return;if(s.type!=="category"||a.type!=="category"){_E.warnOnce(`Heatmap series expected axes to have "category" type, but received "${s.type}" and "${a.type}" instead.`);return}const{xKey:n,xName:r,yKey:l,yName:c,colorKey:h,colorName:p,textAlign:u,verticalAlign:y,itemPadding:g,colorRange:f,label:m}=this.properties,v=o.resolveProcessedDataIndexById(this,"xValue"),b=o.resolveProcessedDataIndexById(this,"yValue"),S=h?o.resolveProcessedDataIndexById(this,"colorValue"):void 0,x=s.scale,M=a.scale,T=(x.bandwidth??0)/2,A=(M.bandwidth??0)/2,D=this.isColorScaleValid(),I=[],N=[],O=x.bandwidth??10,L=M.bandwidth??10,C=(O-2*g)*wE[u],k=(L-2*g)*PE[y],E=()=>({width:O,height:L,meta:null});for(const{values:_,datum:w}of this.processedData?.data??[]){const B=_[v],P=_[b],R=x.convert(B)+T,z=M.convert(P)+A,F=_[S??-1],U=D&&F!=null?this.colorScale.convert(F):f[0],G=F==null?void 0:this.getLabelText(m,{value:F,datum:w,colorKey:h,colorName:p,xKey:n,yKey:l,xName:r,yName:c}),V=_d(G,this.properties.label,void 0,this.properties.label,{padding:g},E),j={x:R,y:z,size:0};if(I.push({series:this,itemId:l,yKey:l,xKey:n,xValue:B,yValue:P,colorValue:F,datum:w,point:j,width:O,height:L,fill:U,midPoint:{x:R,y:z},missing:F==null}),V?.label!=null){const{text:K,fontSize:Z,lineHeight:gt,height:nt}=V.label,{fontStyle:et,fontFamily:tt,fontWeight:ht,color:yt}=this.properties.label,it=j.x+C*(O-2*g),$=j.y+k*(L-2*g)-(V.height-nt)*.5;N.push({series:this,itemId:l,datum:w,text:K,fontSize:Z,lineHeight:gt,fontStyle:et,fontFamily:tt,fontWeight:ht,color:yt,textAlign:u,verticalAlign:y,x:it,y:$})}}return{itemId:this.properties.yKey??this.id,nodeData:I,labelData:N,scales:this.calculateScaling(),visible:this.visible}}nodeFactory(){return new LE}async update(t){return this.ctx.animationManager.skipCurrentBatch(),super.update(t)}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}async updateDatumNodes(t){const{isHighlight:e}=t,{id:i,ctx:{callbackCache:o},properties:s}=this,{xKey:a,yKey:n,colorKey:r,itemStyler:l}=s,c=e?s.highlightStyle.item:void 0,h=c?.fillOpacity??1,p=c?.stroke??s.stroke,u=c?.strokeWidth??this.getStrokeWidth(s.strokeWidth),y=c?.strokeOpacity??s.strokeOpacity??1,g=this.axes[Pi.X],[f,m]=g?.visibleRange??[],b=!(f!==0||m!==1);t.datumSelection.each((S,x)=>{const{datum:M,point:T,width:A,height:D}=x,I=c?.fill??x.fill;let N;l&&(N=o.call(l,{datum:M,fill:I,fillOpacity:h,stroke:p,strokeOpacity:y,strokeWidth:u,highlighted:e,xKey:a,yKey:n,colorKey:r,seriesId:i})),S.crisp=b,S.x=Math.floor(T.x-A/2),S.y=Math.floor(T.y-D/2),S.width=Math.ceil(A),S.height=Math.ceil(D),S.fill=N?.fill??I,S.fillOpacity=N?.fillOpacity??h,S.stroke=N?.stroke??p,S.strokeWidth=N?.strokeWidth??u,S.strokeOpacity=N?.strokeOpacity??y})}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t,{enabled:o}=this.properties.label,s=o?e:[];return i.update(s)}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{e.text=i.text,e.fontSize=i.fontSize,e.lineHeight=i.lineHeight,e.fontStyle=i.fontStyle,e.fontFamily=i.fontFamily,e.fontWeight=i.fontWeight,e.fill=i.color,e.textAlign=i.textAlign,e.textBaseline=i.verticalAlign,e.x=i.x,e.y=i.y,e.pointerEvents=CE.None})}getTooltipHtml(t){const e=this.axes[Pi.X],i=this.axes[Pi.Y];if(!this.properties.isValid()||!e||!i)return nl.EMPTY_TOOLTIP_CONTENT;const{xKey:o,yKey:s,colorKey:a,xName:n,yName:r,colorName:l,stroke:c,strokeWidth:h,strokeOpacity:p=1,colorRange:u,itemStyler:y,tooltip:g}=this.properties,{colorScale:f,id:m,ctx:{callbackCache:v}}=this,{datum:b,xValue:S,yValue:x,colorValue:M,itemId:T}=t,A=this.isColorScaleValid()?f.convert(M):u[0];let D;y&&(D=v.call(y,{datum:b,xKey:o,yKey:s,colorKey:a,fill:A,fillOpacity:1,stroke:c,strokeWidth:h,strokeOpacity:p,highlighted:!1,seriesId:m}));const I=D?.fill??A??"gray",N=this.properties.title??r,O=Ma(e.formatDatum(S)),L=Ma(i.formatDatum(x));let C=`<b>${Ma(n??o)}</b>: ${O}<br><b>${Ma(r??s)}</b>: ${L}`;return a&&(C=`<b>${Ma(l??a)}</b>: ${Ma(M)}<br>`+C),g.toTooltipHtml({title:N,content:C,backgroundColor:I},{seriesId:m,datum:b,xKey:o,yKey:s,xName:n,yName:r,title:N,color:I,colorKey:a,colorName:l,itemId:T})}getLegendData(t){return t!=="gradient"||!this.data?.length||!this.properties.isValid()||!this.isColorScaleValid()||!this.dataModel?[]:[{legendType:"gradient",enabled:this.visible,seriesId:this.id,colorName:this.properties.colorName,colorDomain:this.processedData.domain.values[this.dataModel.resolveProcessedDataIndexById(this,"colorValue")],colorRange:this.properties.colorRange}]}isLabelEnabled(){return this.properties.label.enabled&&!!this.properties.colorKey}getBandScalePadding(){return{inner:0,outer:0}}computeFocusBounds({datumIndex:t,seriesRect:e}){const i=this.contextNodeData?.nodeData[t];if(i===void 0)return;const{width:o,height:s,midPoint:a}=i,n={x:a.x-o/2,y:a.y-s/2,width:o,height:s};return kE(n,this.contentGroup,e)}};wd.className="HeatmapSeries",wd.type="heatmap";import{_Theme as Pd}from"ag-charts-community";var BE={series:{label:{enabled:!1,color:Pd.DEFAULT_LABEL_COLOUR,fontSize:Pd.FONT_SIZE.SMALL,fontFamily:Pd.DEFAULT_FONT_FAMILY,wrapping:"on-space",overflowStrategy:"ellipsis"},itemPadding:3},gradientLegend:{enabled:!0}},zE={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"heatmap",moduleFactory:t=>new wd(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Sa.CARTESIAN_AXIS_TYPE.CATEGORY,position:Sa.CARTESIAN_POSITION.LEFT},{type:Sa.CARTESIAN_AXIS_TYPE.CATEGORY,position:Sa.CARTESIAN_POSITION.BOTTOM}],themeTemplate:BE,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,themeTemplateParameters:o})=>{const s=o.get(Sa.DEFAULT_DIVERGING_SERIES_COLOR_RANGE),a=o.get(Sa.DEFAULT_BACKGROUND_COLOUR),n=(Array.isArray(a)?a[0]:a)??"white",{fills:r,strokes:l}=t(e);return{stroke:i==="inbuilt"?n:l[0],colorRange:i==="inbuilt"?s:[r[0],r[1]]}}};import{_Theme as Bd}from"ag-charts-community";import{_Scale as FE}from"ag-charts-community";var{ColorScale:VE}=FE;function Lx(t){if(t==null)return[];const e=new VE;e.domain=[0,1],e.range=t;const i=5;return Array.from({length:5},(o,s)=>e.convert(s/(i-1)))}import{_ModuleSupport as vn,_Scene as UE,_Util as HE}from"ag-charts-community";var Cx={fromFn:()=>({opacity:0,phase:"initial"}),toFn:()=>({opacity:1})};function Ex(t,e){if(t==null)return"";if(e==null)return String(t);const[i,o]=e.scale.domain,s=i!==0?Math.ceil(Math.log10(Math.abs(i))):0,a=o!==0?Math.ceil(Math.log10(Math.abs(o))):0,n=Math.max(2-Math.max(s,a),0);return t.toFixed(n)}function Mn(t,e,i){if(e.text!=null)return e.text;const o=i??e.value,s=e?.formatter?.({seriesId:t.id,datum:void 0,value:o});if(s!=null)return String(s)}import{Marker as GE}from"ag-charts-community";var zd=class extends GE{updatePath(){const{x:t,y:e,path:i,size:o}=this;i.clear(),i.moveTo(t,e-o/2),i.lineTo(t,e+o/2)}};zd.className="LineMarker";import{_ModuleSupport as WE,_Scale as KE,_Util as YE}from"ag-charts-community";var{BaseProperties:jE,Validate:_x,COLOR_STRING:XE,NUMBER:ZE}=WE,{ColorScale:$E}=KE,{Logger:QE}=YE,Ta=class extends jE{constructor(){super(...arguments),this.color="black"}};d([_x(ZE,{optional:!0})],Ta.prototype,"stop",2),d([_x(XE,{optional:!0})],Ta.prototype,"color",2);function qE(t){let e;for(const{stop:i}of t)if(i!=null){if(e!=null&&i<e)return!1;e=i}return!0}function Rx(t){return t.flatMap((e,i)=>{const{offset:o}=e,s=t.at(i+1)?.color;return s!=null?[e,{offset:o,color:s}]:[e]})}function JE(t,e){const i=e==="discrete"?1:0,o=t.map((s,a,{length:n})=>({offset:(a+i)/(n-1+i),color:s}));return e==="discrete"?Rx(o):o}function wx(t,e,i,o){if(t.length===0)return JE(e,o);if(!qE(t))return QE.warnOnce("[fills] must have the stops defined in ascending order"),[];const s=Math.min(...i),a=Math.max(...i),n=o==="discrete",r=new Float64Array(t.length);let l=0,c=-1;for(let y=0;y<t.length;y+=1){const g=t[y];if(y>=c){c=t.length-1;for(let v=y+1;v<t.length;v+=1)if(t[v].stop!=null){c=v;break}}let{stop:f}=g;if(f==null){const v=t[l].stop,b=t[c].stop,S=v??s,x=b??a,M=n&&v==null?1:0;f=S+(x-S)*(y-l+M)/(c-l+M)}else l=y;const m=(f-s)/(a-s);r[y]=m}let h=t.find(y=>y.color!=null)?.color,p;const u=t.map(({color:y},g)=>{const f=r[g];return y!=null?h=y:h!=null?y=h:(p==null&&(p=new $E,p.domain=[0,1],p.range=e),y=p.convert(f)),{offset:f,color:y}});return o==="discrete"?Rx(u):u}import{_ModuleSupport as t_,_Scene as e_}from"ag-charts-community";import{_ModuleSupport as i_}from"ag-charts-community";var{MARKER_SHAPE:o_,UNION:Fd,OR:s_}=i_,ll=Fd(["continuous","discrete"],"a fill mode"),Px=s_(o_,Fd(["line"],"a marker shape")),Bx=Fd(["container","item"],"a corner mode");import{_ModuleSupport as a_,_Util as n_}from"ag-charts-community";var{BaseProperties:zx,Validate:Aa,OBJECT:r_,BOOLEAN:l_,NUMBER:Vd,NUMBER_ARRAY:c_}=a_,{Logger:h_}=n_,cl=class extends zx{getSegments(t,e){const{values:i,step:o,count:s}=this,a=Math.min(...t.domain),n=Math.max(...t.domain);let r;if(i!=null){const l=i.filter(c=>c>a&&c<n).sort((c,h)=>c-h);r=[a,...l,n]}else if(o!=null){const l=[];for(let c=a;c<n;c+=o)l.push(c);l.push(n),r=l}else if(s!=null){const l=s+1;r=Array.from({length:l+1},(c,h)=>h/l*(n-a)+a)}else r=t.ticks?.();return r!=null&&r.length>e&&(h_.warnOnce("the configured segmentation results in more than 1 item per pixel, ignoring. Supply a segmentation configuration that results in larger segments or omit this configuration"),r=void 0),r??(r=[a,n]),r}};d([Aa(c_,{optional:!0})],cl.prototype,"values",2),d([Aa(Vd,{optional:!0})],cl.prototype,"step",2),d([Aa(Vd,{optional:!0})],cl.prototype,"count",2);var Tn=class extends zx{constructor(){super(...arguments),this.enabled=!1,this.interval=new cl,this.spacing=0}};d([Aa(l_)],Tn.prototype,"enabled",2),d([Aa(r_)],Tn.prototype,"interval",2),d([Aa(Vd)],Tn.prototype,"spacing",2);var{BaseProperties:Ud,SeriesTooltip:d_,SeriesProperties:p_,PropertiesArray:Hd,Validate:W,BOOLEAN:Fx,COLOR_STRING:gs,COLOR_STRING_ARRAY:u_,FUNCTION:g_,LINE_DASH:Gd,NUMBER:Da,OBJECT_ARRAY:Wd,OBJECT:ys,POSITIVE_NUMBER:Bi,RATIO:fs,STRING:Vx,UNION:Kd}=t_,{Label:y_}=e_,f_=Kd(["before","after","middle"],"a placement"),m_=Kd(["inside-start","outside-start","inside-end","outside-end","inside-center","bar-inside","bar-inside-end","bar-outside-end","bar-end"],"an placement"),x_=Kd(["horizontal","vertical"],"an orientation"),Ux=class extends y_{};d([W(Da,{optional:!0})],Ux.prototype,"spacing",2);var Jt=class extends Ud{constructor(){super(...arguments),this.value=0,this.label=new Ux}};d([W(Vx,{optional:!0})],Jt.prototype,"text",2),d([W(Da)],Jt.prototype,"value",2),d([W(Px,{optional:!0})],Jt.prototype,"shape",2),d([W(f_,{optional:!0})],Jt.prototype,"placement",2),d([W(Da,{optional:!0})],Jt.prototype,"spacing",2),d([W(Bi,{optional:!0})],Jt.prototype,"size",2),d([W(Da,{optional:!0})],Jt.prototype,"rotation",2),d([W(gs,{optional:!0})],Jt.prototype,"fill",2),d([W(fs,{optional:!0})],Jt.prototype,"fillOpacity",2),d([W(gs,{optional:!0})],Jt.prototype,"stroke",2),d([W(Bi,{optional:!0})],Jt.prototype,"strokeWidth",2),d([W(fs,{optional:!0})],Jt.prototype,"strokeOpacity",2),d([W(Gd,{optional:!0})],Jt.prototype,"lineDash",2),d([W(Bi,{optional:!0})],Jt.prototype,"lineDashOffset",2),d([W(ys)],Jt.prototype,"label",2);var Fe=class extends Ud{constructor(){super(...arguments),this.enabled=!0,this.thicknessRatio=1,this.fills=new Hd(Ta),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([W(Fx)],Fe.prototype,"enabled",2),d([W(Bi,{optional:!0})],Fe.prototype,"thickness",2),d([W(fs)],Fe.prototype,"thicknessRatio",2),d([W(Wd)],Fe.prototype,"fills",2),d([W(ll)],Fe.prototype,"fillMode",2),d([W(gs,{optional:!0})],Fe.prototype,"fill",2),d([W(fs)],Fe.prototype,"fillOpacity",2),d([W(gs)],Fe.prototype,"stroke",2),d([W(Bi)],Fe.prototype,"strokeWidth",2),d([W(fs)],Fe.prototype,"strokeOpacity",2),d([W(Gd)],Fe.prototype,"lineDash",2),d([W(Bi)],Fe.prototype,"lineDashOffset",2);var gi=class extends Ud{constructor(){super(...arguments),this.fills=new Hd(Ta),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black"}};d([W(Wd)],gi.prototype,"fills",2),d([W(ll)],gi.prototype,"fillMode",2),d([W(gs,{optional:!0})],gi.prototype,"fill",2),d([W(fs)],gi.prototype,"fillOpacity",2),d([W(gs)],gi.prototype,"stroke",2),d([W(Bi)],gi.prototype,"strokeWidth",2),d([W(fs)],gi.prototype,"strokeOpacity",2),d([W(Gd)],gi.prototype,"lineDash",2),d([W(Bi)],gi.prototype,"lineDashOffset",2),d([W(gs)],gi.prototype,"defaultFill",2);var hl=class extends wi{constructor(){super(...arguments),this.placement="inside-center",this.avoidCollisions=!0}};d([W(Vx,{optional:!0})],hl.prototype,"text",2),d([W(m_)],hl.prototype,"placement",2),d([W(Fx)],hl.prototype,"avoidCollisions",2);var he=class extends p_{constructor(){super(...arguments),this.value=0,this.segmentation=new Tn,this.defaultColorRange=[],this.targets=new Hd(Jt),this.defaultTarget=new Jt,this.direction="vertical",this.thickness=1,this.cornerRadius=0,this.cornerMode="container",this.margin=0,this.scale=new gi,this.bar=new Fe,this.label=new hl,this.tooltip=new d_}};d([W(Da)],he.prototype,"value",2),d([W(ys)],he.prototype,"segmentation",2),d([W(u_)],he.prototype,"defaultColorRange",2),d([W(Wd)],he.prototype,"targets",2),d([W(ys)],he.prototype,"defaultTarget",2),d([W(x_)],he.prototype,"direction",2),d([W(Bi)],he.prototype,"thickness",2),d([W(Bi)],he.prototype,"cornerRadius",2),d([W(Bx)],he.prototype,"cornerMode",2),d([W(Da)],he.prototype,"margin",2),d([W(ys)],he.prototype,"scale",2),d([W(ys)],he.prototype,"bar",2),d([W(g_,{optional:!0})],he.prototype,"itemStyler",2),d([W(ys)],he.prototype,"label",2),d([W(ys)],he.prototype,"tooltip",2);import{_ModuleSupport as S_,_Scene as b_}from"ag-charts-community";var{CachedTextMeasurerPool:v_}=S_,{BBox:M_}=b_;function Yd(t){const{x0:e,y0:i,x1:o,y1:s,horizontalInset:a,verticalInset:n}=t,r=Math.min(e,o)+a,l=Math.min(i,s)+n,c=Math.max(Math.abs(o-e)-2*a,0),h=Math.max(Math.abs(s-i)-2*n,0);return{x:r,y:l,width:c,height:h}}function T_(t,e){if(e==null)return!0;const i=Yd(t),o=1e-6,s=i.x+o,a=i.y+o,n=i.x+i.width-o,r=i.y+i.height-o,l=e.x,c=e.x+e.width,h=e.y,p=e.y+e.height;return Math.max(s,l)<=Math.min(n,c)&&Math.max(a,h)<=Math.min(r,p)}function jd(t){const{clipX0:e,clipX1:i,clipY0:o,clipY1:s}=t;return e!=null&&i!=null||o!=null&&s!=null}function A_(t){if(!jd(t))return;const{x0:e,y0:i,x1:o,y1:s}=t,{x:a,y:n,width:r,height:l}=Yd(t);let{clipX0:c,clipX1:h,clipY0:p,clipY1:u}=t;(c==null||h==null)&&(c=e,h=o),(p==null||u==null)&&(p=i,u=s);const y=Math.min(c,h),g=Math.min(p,u),f=Math.abs(h-c),m=Math.abs(u-p);return c=Math.max(a,y),p=Math.max(n,g),h=Math.min(a+r,y+f),u=Math.min(n+l,g+m),new M_(Math.min(c,h),Math.min(p,u),Math.abs(h-c),Math.abs(u-p))}function Hx(t,e){const i=t?"initial":"update";return{node:{fromFn(s,a){const n=s.previousDatum;let{x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:y,clipY1:g}=n??a;const{horizontalInset:f,verticalInset:m}=a,v=n!=null&&jd(n),b=jd(a);return v&&b||(!v&&b?({x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:y,clipY1:g}=a,t&&(e?y=a.clipX0:g=a.clipY0)):v&&!b?({x0:r,y0:l,x1:c,y1:h}=a,p=void 0,u=void 0,y=void 0,g=void 0):t&&(e?c=r:h=l)),{x0:r,y0:l,x1:c,y1:h,clipX0:p,clipY0:u,clipX1:y,clipY1:g,horizontalInset:f,verticalInset:m,phase:i}},toFn(s,a){const{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:p,clipX1:u,clipY1:y,horizontalInset:g,verticalInset:f}=a;return{x0:n,y0:r,x1:l,y1:c,clipX0:h,clipY0:p,clipX1:u,clipY1:y,horizontalInset:g,verticalInset:f}},applyFn(s,a){s.setProperties(dl(s,a))}}}}function dl(t,e){const{x:i,y:o,width:s,height:a}=Yd(e),n=A_(e),r=T_(e,n);return{x:i,y:o,width:s,height:a,clipBBox:n,visible:r}}var D_={Before:"right",Center:"center",After:"left"},k_={Before:"top",Center:"middle",After:"bottom"},I_={Before:-1,Center:-.5,After:0},N_={Before:0,Center:-.5,After:-1};function O_(t,e,i,o,s){const{scale:a,bar:n}=o,{padding:r,horizontal:l}=i;e.each((c,h)=>{const p=Mn(t,h,s?.label),u=()=>({width:a.width,height:a.height,meta:null});let y;const g=h.avoidCollisions&&h.placement!=="outside-start"&&h.placement!=="outside-end";if(p==null)return;if(g)y=xn(p,h,{padding:r},u)?.[0];else{const C={fontSize:h.fontSize,fontStyle:h.fontStyle,fontWeight:h.fontWeight,fontFamily:h.fontFamily,lineHeight:h.lineHeight},{width:k,height:E}=v_.measureText(p,{font:C});y={text:p,fontSize:h.fontSize,lineHeight:ba(h,h.fontSize),width:k,height:E}}if(y==null){c.visible=!1;return}const f=l?a.x:a.y+a.height,m=l?a.x+a.width:a.y,v=l?n.x:n.y+n.height,b=l?n.x+n.width:n.y,S=h.spacing*(l?1:-1);let x,M,T,A;switch(h.placement){case"outside-start":x=-1/0,M=1/0,T=f-S,A="Before";break;case"outside-end":x=-1/0,M=1/0,T=m+S,A="After";break;case"inside-start":x=f,M=b,T=f+S,A="After";break;case"inside-end":x=b,M=m,T=m-S,A="Before";break;case"inside-center":x=f,M=m,T=(f+m)/2,A="Center";break;case"bar-inside":x=v,M=b,T=(v+b)/2,A="Center";break;case"bar-inside-end":x=v,M=b,T=b-S,A="Before";break;case"bar-outside-end":x=b,M=m,T=b+S,A="After";break;case"bar-end":x=-1/0,M=1/0,T=b,A="Center";break}const D=l?T:a.x+a.width/2,I=l?a.y+a.height/2:T;let N,O;l?(N=D+I_[A]*y.width,O=N+y.width):(N=I+N_[A]*y.height,O=N+y.height);const L=Math.min(N,O)>=Math.min(x,M)&&Math.max(N,O)<=Math.max(x,M);if(h.avoidCollisions&&!L){c.visible=!1;return}c.visible=!0,c.text=y.text,c.fontSize=y.fontSize,c.lineHeight=y.lineHeight,c.textAlign=l?D_[A]:"center",c.textBaseline=l?"middle":k_[A],c.x=D,c.y=I})}var{fromToMotion:Xd,resetMotion:L_,SeriesNodePickMode:Gx,StateMachine:C_,createDatumId:Wx,ChartAxisDirection:yi,CachedTextMeasurerPool:E_,EMPTY_TOOLTIP_CONTENT:__}=vn,{BBox:pl,Group:ka,PointerEvents:Zd,Selection:Ia,Rect:R_,Text:Kx,LinearGradient:w_,getMarker:P_,easing:B_}=UE,{toRadians:z_}=HE,F_={before:180,middle:0,after:0},V_={before:90,middle:0,after:-90},$d=class extends vn.Series{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Gx.EXACT_SHAPE_MATCH,Gx.NEAREST_NODE]}),this.canHaveAxes=!0,this.properties=new he,this.originX=0,this.originY=0,this.scaleGroup=this.contentGroup.appendChild(new ka({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new ka({name:"itemGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new ka({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new ka({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new ka({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new ka({name:"itemTargetLabelGroup"})),this.scaleSelection=Ia.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Ia.select(this.itemGroup,()=>this.nodeFactory()),this.targetSelection=Ia.select(this.itemTargetGroup,e=>this.markerFactory(e)),this.targetLabelSelection=Ia.select(this.itemTargetLabelGroup,Kx),this.labelSelection=Ia.select(this.itemLabelGroup,Kx),this.highlightTargetSelection=Ia.select(this.highlightTargetGroup,e=>this.markerFactory(e)),this.nodeDatum={series:this,datum:{}},this.animationState=new C_("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.itemGroup.pointerEvents=Zd.None,this.itemTargetLabelGroup.pointerEvents=Zd.None,this.itemLabelGroup.pointerEvents=Zd.None}get horizontal(){return this.properties.direction==="horizontal"}get thickness(){return this.properties.thickness}computeInset(t,e){const{label:i}=this.properties;let o;switch(i.placement){case"outside-start":o=1;break;case"outside-end":o=-1;break;default:return 0}const s=i.text?.split(`
`);let a;if(t===yi.Y)a=ba(i,i.fontSize)*(s?.length??1);else{const n=i.getFont();a=(s??e.map(l=>Mn(this,this.labelDatum(i,l))??"")).reduce((l,c)=>{const{width:h}=E_.measureText(c,{font:n});return Math.max(l,h)},0)}return o*(i.spacing+a)}get hasData(){return!0}nodeFactory(){const t=new R_;return t.crisp=!0,t}markerFactory({shape:t}){const e=t!=="line"?P_(t):zd,i=new e;return i.size=1,i}async processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){const{axes:e,horizontal:i}=this,o=i?e[yi.X]:e[yi.Y];return Ex(t,o)}createLinearGradient(t,e){const{properties:i,originX:o,originY:s,horizontal:a,axes:n}=this,{thickness:r,defaultColorRange:l}=i,c=a?n[yi.X]:n[yi.Y],{domain:h,range:p}=c.scale,u=p[1]-p[0],y=wx(t,l,h,e);return new w_("oklch",y,a?90:0,new pl(o,s,a?u:r,a?r:u))}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:l=e.placement??"middle",spacing:c=e.spacing??0,size:h=e.size??0,fill:p=e.fill??"black",fillOpacity:u=e.fillOpacity??1,stroke:y=e.stroke??"black",strokeOpacity:g=e.strokeOpacity??1,lineDash:f=e.lineDash??[0],lineDashOffset:m=e.lineDashOffset??0}=i,{enabled:v=e.label.enabled,color:b=e.label.color??"black",fontStyle:S=e.label.fontStyle??"normal",fontWeight:x=e.label.fontWeight??"normal",fontSize:M=e.label.fontSize,fontFamily:T=e.label.fontFamily,spacing:A=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:h,rotation:n,fill:p,fillOpacity:u,stroke:y,strokeWidth:r,strokeOpacity:g,lineDash:f,lineDashOffset:m,label:{enabled:v,color:b,fontStyle:S,fontWeight:x,fontSize:M,fontFamily:T,spacing:A}}})}getTargetPoint(t){const e=this.axes[yi.X],i=this.axes[yi.Y];if(e==null||i==null)return{x:0,y:0};const{properties:o,originX:s,originY:a,horizontal:n}=this,{thickness:r}=o,{value:l,placement:c,spacing:h,size:p}=t,u=n?e:i,y=u.scale.convert(l)-u.scale.range[0];let g;switch(c){case"before":g=-(h+p/2);break;case"after":g=r+h+p/2;break;default:g=r/2;break}return{x:s+e.range[0]+(n?y:g),y:a+i.range[0]+(n?g:y)}}getTargetLabel(t){const{size:e,placement:i,label:o}=t,{spacing:s,color:a,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c}=o,h=void 0,p=e/2+s;let u,y,g=0,f=0;return this.horizontal?(u="center",i==="after"?(y="top",f=p):(y="bottom",f=-p)):(y="middle",i==="before"?(u="right",g=-p):(u="left",g=p)),{offsetX:g,offsetY:f,fill:a,textAlign:u,textBaseline:y,fontStyle:n,fontWeight:r,fontSize:l,fontFamily:c,lineHeight:h}}labelDatum(t,e){const{placement:i,avoidCollisions:o,spacing:s,text:a,color:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:p,lineHeight:u,wrapping:y,overflowStrategy:g,formatter:f=m=>this.formatLabel(m.value)}=t;return{placement:i,avoidCollisions:o,spacing:s,text:a,value:e,fill:n,fontSize:r,minimumFontSize:l,fontStyle:c,fontWeight:h,fontFamily:p,lineHeight:u,wrapping:y,overflowStrategy:g,formatter:f}}async createNodeData(){const{id:t,properties:e,originX:i,originY:o,horizontal:s}=this;if(!e.isValid())return;const{value:a,segmentation:n,thickness:r,cornerRadius:l,cornerMode:c,bar:h,scale:p,label:u}=e,y=this.getTargets(),g=this.axes[yi.X],f=this.axes[yi.Y];if(g==null||f==null)return;const m=s?g:f,v=g.scale,b=f.scale,S=m.scale;let{domain:x}=m.scale;m.isReversed()&&(x=x.slice().reverse());const M=[],T=[],A=[],D=[],[I,N]=S.range,O=Math.abs(N-I);let[L,C]=g.range;g.isReversed()&&([C,L]=[L,C]);let[k,E]=f.range;f.isReversed()&&([E,k]=[k,E]);const _=s?v.convert(a):C,w=s?E:b.convert(a),B=n.enabled?n.spacing/2:0,P=s?B:0,R=s?0:B,z=Math.min(h.thickness??Math.round(h.thicknessRatio*r),r),F=-(r-z)/2,U=s?0:F,G=s?F:0,V=c==="item",j=Math.ceil(O);let K=n.enabled?n.interval.getSegments(S,j):void 0;const Z=h.fill??this.createLinearGradient(h.fills,h.fillMode),gt=p.fill??(h.enabled&&p.fills.length===0?p.defaultFill:void 0)??this.createLinearGradient(p.fills,p.fillMode);if(K==null&&V){const et=Math.min(...x),tt=Math.max(...x),ht={value:a,segmentStart:et,segmentEnd:tt};if(h.enabled){const pt=Math.min(l,z/2,O/2)*(m.isReversed()?-1:1),ye=s?pt:0,Ut=s?0:pt;M.push({series:this,itemId:"value",datum:ht,type:0,x0:i+L-ye-U,y0:o+k-Ut-G,x1:i+_+ye+U,y1:o+w+Ut+G,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:Z,horizontalInset:P,verticalInset:R})}const it=Math.min(l,r/2,O/2)*(m.isReversed()?-1:1),$=s?it:0,Tt=s?0:it;D.push({series:this,itemId:"scale",datum:ht,type:0,x0:i+L-$,y0:o+k-Tt,x1:i+C+$,y1:o+E+Tt,clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:l,topRightCornerRadius:l,bottomRightCornerRadius:l,bottomLeftCornerRadius:l,fill:gt,horizontalInset:P,verticalInset:R})}else{K??(K=x);const et=i+L-U,tt=o+k-G,ht=i+_+U,yt=o+w+G;for(let it=0;it<K.length-1;it+=1){const $=K[it+0],Tt=K[it+1],Vt={value:a,segmentStart:$,segmentEnd:Tt},pt=it===0,ye=it===K.length-2,Ut=S.convert($),_e=S.convert(Tt),Ue=V||pt?l:0,Hi=V||ye?l:0,ws=s?Ue:Hi,Hn=Hi,za=s?Hi:Ue,ku=Ue;h.enabled&&M.push({series:this,itemId:`value-${it}`,datum:Vt,type:0,x0:i+(s?Ut:L),y0:o+(s?k:Ut),x1:i+(s?_e:C),y1:o+(s?E:_e),clipX0:et,clipY0:tt,clipX1:ht,clipY1:yt,topLeftCornerRadius:ws,topRightCornerRadius:Hn,bottomRightCornerRadius:za,bottomLeftCornerRadius:ku,fill:Z,horizontalInset:P,verticalInset:R}),D.push({series:this,itemId:`scale-${it}`,datum:Vt,type:0,x0:i+(s?Ut:L),y0:o+(s?k:Ut),x1:i+(s?_e:C),y1:o+(s?E:_e),clipX0:void 0,clipY0:void 0,clipX1:void 0,clipY1:void 0,topLeftCornerRadius:ws,topRightCornerRadius:Hn,bottomRightCornerRadius:za,bottomLeftCornerRadius:ku,fill:gt,horizontalInset:P,verticalInset:R})}}u.enabled&&A.push(this.labelDatum(u,a));const nt=s?F_:V_;for(let et=0;et<y.length;et+=1){const tt=y[et],{value:ht,text:yt,shape:it,size:$,fill:Tt,fillOpacity:Vt,stroke:pt,strokeWidth:ye,strokeOpacity:Ut,lineDash:_e,lineDashOffset:Ue}=tt,Hi=this.getTargetPoint(tt),ws=z_(tt.rotation+nt[tt.placement]);T.push({series:this,itemId:`target-${et}`,midPoint:Hi,datum:{value:ht},type:1,value:ht,text:yt,x:Hi.x,y:Hi.y,shape:it,size:$,rotation:ws,fill:Tt,fillOpacity:Vt,stroke:pt,strokeOpacity:Ut,strokeWidth:ye,lineDash:_e,lineDashOffset:Ue,label:this.getTargetLabel(tt)})}return{itemId:t,nodeData:M,targetData:T,labelData:A,scaleData:D}}async updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}async update({seriesRect:t}){const{datumSelection:e,labelSelection:i,targetSelection:o,targetLabelSelection:s,scaleSelection:a,highlightTargetSelection:n}=this,r=this.checkResize(t);await this.updateSelections(r),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const l=this.contextNodeData?.nodeData??[],c=this.contextNodeData?.labelData??[],h=this.contextNodeData?.targetData??[],p=this.contextNodeData?.scaleData??[],u=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=await this.updateScaleSelection({scaleData:p,scaleSelection:a}),await this.updateScaleNodes({scaleSelection:a}),this.targetSelection=await this.updateTargetSelection({targetData:h,targetSelection:o}),await this.updateTargetNodes({targetSelection:o,isHighlight:!1}),this.targetLabelSelection=await this.updateTargetLabelSelection({targetData:h,targetLabelSelection:s}),await this.updateTargetLabelNodes({targetLabelSelection:s}),this.datumSelection=await this.updateDatumSelection({nodeData:l,datumSelection:e}),await this.updateDatumNodes({datumSelection:e}),this.labelSelection=await this.updateLabelSelection({labelData:c,labelSelection:i}),await this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=await this.updateTargetSelection({targetData:u!=null?[u]:[],targetSelection:n}),await this.updateTargetNodes({targetSelection:n,isHighlight:!0}),r&&this.animationState.transition("resize"),this.animationState.transition("update")}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Wx(t.nodeData.length,e.itemId))}async updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i,properties:o}=this,{bar:s}=o,{fillOpacity:a,stroke:n,strokeOpacity:r,lineDash:l,lineDashOffset:c}=s,h=this.getStrokeWidth(s.strokeWidth),p=i.animationManager.isSkipped();e.each((u,y)=>{const{topLeftCornerRadius:g,topRightCornerRadius:f,bottomRightCornerRadius:m,bottomLeftCornerRadius:v,fill:b}=y;u.fill=b,u.fillOpacity=a,u.stroke=n,u.strokeOpacity=r,u.strokeWidth=h,u.lineDash=l,u.lineDashOffset=c,u.topLeftCornerRadius=g,u.topRightCornerRadius=f,u.bottomRightCornerRadius=m,u.bottomLeftCornerRadius=v,(p||u.previousDatum==null)&&u.setProperties(dl(u,y))})}async updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>Wx(t.scaleData.length,e.itemId))}async updateScaleNodes(t){const{scaleSelection:e}=t,{scale:i}=this.properties,{fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=i;e.each((c,h)=>{const{topLeftCornerRadius:p,topRightCornerRadius:u,bottomRightCornerRadius:y,bottomLeftCornerRadius:g,fill:f}=h;c.fill=f,c.fillOpacity=o,c.stroke=s,c.strokeOpacity=a,c.strokeWidth=n,c.lineDash=r,c.lineDashOffset=l,c.topLeftCornerRadius=p,c.topRightCornerRadius=u,c.bottomRightCornerRadius=y,c.bottomLeftCornerRadius=g,c.setProperties(dl(c,h))})}async updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}async updateTargetNodes(t){const{targetSelection:e,isHighlight:i}=t,o=i?this.properties.highlightStyle.item:void 0;e.each((s,a)=>{const{x:n,y:r,size:l,rotation:c,fill:h,fillOpacity:p,stroke:u,strokeOpacity:y,strokeWidth:g,lineDash:f,lineDashOffset:m}=a;s.size=l,s.fill=o?.fill??h,s.fillOpacity=o?.fillOpacity??p,s.stroke=o?.stroke??u,s.strokeOpacity=o?.strokeOpacity??y,s.strokeWidth=o?.strokeWidth??g,s.lineDash=o?.lineDash??f,s.lineDashOffset=o?.lineDashOffset??m,s.translationX=n,s.translationY=r,s.rotation=c})}async updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData)}async updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{x:s,y:a,text:n}=o,{offsetX:r,offsetY:l,fill:c,fontStyle:h,fontWeight:p,fontSize:u,fontFamily:y,textAlign:g,textBaseline:f}=o.label;i.visible=!0,i.x=s+r,i.y=a+l,i.text=n,i.fill=c,i.fontStyle=h,i.fontWeight=p,i.fontSize=u,i.fontFamily=y,i.textAlign=g,i.textBaseline=f})}async updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>"primary")}async updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){const{labelSelection:e,horizontal:i,axes:o}=this,s=o[yi.X],a=o[yi.Y];if(s==null||a==null)return;const[n,r]=s.range,[l,c]=a.range,h=this.originX+Math.min(n,r),p=this.originY+Math.min(l,c),u=Math.abs(r-n),y=Math.abs(c-l),g=t?.label??this.properties.value;let f;if(i){const b=s.scale.convert(g);f=new pl(h,p,b-h,y)}else{const b=a.scale.convert(g);f=new pl(h,b,u,y-b)}const m={scale:new pl(h,p,u,y),bar:f},{margin:v}=this.properties;O_(this,e,{padding:v,horizontal:i},m,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),L_([this.datumSelection],dl),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i=0,o=0;if(this.labelSelection.each((s,a)=>{s.opacity=1,i=s.previousDatum?.value??t.from??a.value,o=a.value}),!this.labelsHaveExplicitText())if(i===o)this.formatLabelText({label:o});else{const s=`${this.id}_labels`;e.animate({id:s,groupId:"label",from:{label:i},to:{label:o},phase:t.phase??"update",ease:B_.easeOut,onUpdate:a=>this.formatLabelText(a)})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=Hx(!0,this.horizontal);Xd(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),Xd(this.id,"label",t,[this.labelSelection],Cx,()=>"primary"),this.animateLabelText({from:0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e}=Hx(!1,this.horizontal);Xd(this.id,"node",t,[this.datumSelection],e,(i,o)=>o.itemId),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}pickNode(t,e){switch(e){case"event":case"context-menu":{const i=this.scaleGroup.pickNode(t.x,t.y);return i!=null?{pickMode:vn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:void 0}case"tooltip":case"highlight":case"highlight-tooltip":{const i=this.itemTargetGroup.pickNode(t.x,t.y);return i!=null?{pickMode:vn.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:{pickMode:vn.SeriesNodePickMode.NEAREST_NODE,match:this.nodeDatum,distance:0}}}}getTooltipHtml(t){const{id:e,properties:i}=this;if(!i.isValid())return __;const o=this.highlightDatum(t),s=o?.value??i.value,a=o?.text,{tooltip:n}=i,r=a??"",l=this.formatLabel(s),c=o?.itemId,h=void 0,p=o?.fill;return n.toTooltipHtml({title:r,content:l,backgroundColor:p},{seriesId:e,itemId:c,title:r,datum:h,color:p,value:s,...this.getModuleTooltipParams()})}pickFocus(t){const e=this.contextNodeData?.targetData;if(e==null||e.length===0)return;const i=Math.min(Math.max(t.datumIndex,0),e.length-1),o=e[i];for(const s of this.targetSelection)if(s.datum===o)return{bounds:s.node,showFocusBox:!0,datum:o,datumIndex:i}}getCaptionText(){const{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),e.join(". ")}};$d.className="LinearGaugeSeries",$d.type="linear-gauge";var{FONT_WEIGHT:Yx,DEFAULT_FONT_FAMILY:jx,DEFAULT_HIERARCHY_FILLS:U_,DEFAULT_LABEL_COLOUR:Qd,DEFAULT_INVERTED_LABEL_COLOUR:H_,CARTESIAN_AXIS_TYPE:Xx}=Bd,G_={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"linear-gauge",moduleFactory:t=>new $d(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Xx.NUMBER,line:{enabled:!1}},{type:Xx.NUMBER,line:{enabled:!1}}],themeTemplate:{minWidth:200,minHeight:200,series:{thickness:50,bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:1},defaultTarget:{fill:Qd,stroke:Qd,size:10,shape:"triangle",placement:"after",spacing:5,label:{enabled:!0,fontWeight:Yx.NORMAL,fontSize:12,fontFamily:jx,color:Qd,spacing:5}},label:{enabled:!1,placement:"inside-start",fontWeight:Yx.NORMAL,fontSize:24,minimumFontSize:12,spacing:18,fontFamily:jx,color:H_},margin:4,tooltip:{enabled:!1}},axes:{[Bd.CARTESIAN_AXIS_TYPE.NUMBER]:{line:{enabled:!1},gridLine:{enabled:!1}}}},paletteFactory(t){const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fills:a}=e(i),n=s.get(Bd.DEFAULT_GAUGE_SERIES_COLOR_RANGE),r=s.get(U_),l=o==="inbuilt"?n:[a[0],a[1]];return{scale:{defaultFill:r?.[1],stroke:r?.[2]},defaultColorRange:Lx(l)}}};import{_Theme as W_}from"ag-charts-community";var An={zoom:{axes:"xy",anchorPointX:"pointer",anchorPointY:"pointer"},legend:{enabled:!1},gradientLegend:{enabled:!1},tooltip:{range:"exact"}};import{_ModuleSupport as Zx,_Scene as K_,_Util as Y_}from"ag-charts-community";import{_Scene as j_}from"ag-charts-community";var X_=1e-9;function $x(t,e,i,o){const[s,a]=t,[n,r]=e,l=n-s,c=r-a,h=l*l+c*c;let p,u;if(Math.abs(h)<X_)p=s,u=a;else{let f=((i-s)*l+(o-a)*c)/h;f=Math.max(0,Math.min(1,f)),p=s+f*(n-s),u=a+f*(r-a)}const y=i-p,g=o-u;return y*y+g*g}function Qx(t,e,i){let o=1/0,s=t[t.length-1];for(const a of t)o=Math.min(o,$x(s,a,e,i)),s=a;return Math.sqrt(o)}function qd(t){let[e,i]=t[0],o=0;for(let s=1;s<t.length;s+=1){const[a,n]=t[s],r=Math.hypot(a-e,n-i);o+=r,e=a,i=n}return o}function ul(t){if(t.length===0)return;const e=qd(t)/2;let[i,o]=t[0],s=0;for(let a=1;a<t.length;a+=1){const[n,r]=t[a],l=Math.hypot(n-i,r-o),c=s+l;if(c>e){const h=(e-s)/l,p=[i+(n-i)*h,o+(r-o)*h],u=Math.atan2(r-o,n-i);return{point:p,angle:u}}s=c,i=n,o=r}}import{_ModuleSupport as Z_}from"ag-charts-community";var{LonLatBBox:$_}=Z_;function Dn(t,e,i,o,s){return t==null?t=new $_(e,i,o,s):(t.lon0=Math.min(t.lon0,e),t.lat0=Math.min(t.lat0,i),t.lon1=Math.max(t.lon1,o),t.lat1=Math.max(t.lat1,s)),t}var Q_=(t,e,i)=>{let o=t,s=o;for(const a of e)if(o==null||i(o.value,a)>0)o={value:a,next:o},s=o;else{for(s=s;s.next!=null&&i(s.next.value,a)<=0;)s=s.next;s.next={value:a,next:s.next}}return o};function ms(t,e){return t.forEach(i=>{const[o,s]=i;e=Dn(e,o,s,o,s)}),e}function q_(t){if(t.length===0)return;let e=0,i=0,o=0,[s,a]=t[t.length-1];for(const[n,r]of t){const l=s*r-n*a;o+=l,e+=(s+n)*l,i+=(a+r)*l,s=n,a=r}return o*=3,[e/o,i/o]}function gl(t,e,i){let o=!1,s=1/0;for(const a of t){let n=a[a.length-1],[r,l]=n;for(const c of a){const[h,p]=c;p>i!=l>i&&e<(r-h)*(i-p)/(l-p)+h&&(o=!o),s=Math.min(s,$x(n,c,e,i)),n=c,r=h,l=p}}return(o?-1:1)*Math.sqrt(s)}var{Path:J_,ExtendedPath2D:tR,BBox:eR,ScenePathChangeDetection:qx}=j_,Na=class extends J_{constructor(){super(...arguments),this.projectedGeometry=void 0,this.renderMode=3,this.strokePath=new tR}computeBBox(){return(this.dirtyPath||this.isDirtyPath())&&(this.updatePath(),this.dirtyPath=!1),this.bbox?.clone()}updatePath(){const{projectedGeometry:t}=this;this.strokePath.clear(),this.path.clear(),this.bbox=t!=null?this.drawGeometry(t,void 0):void 0}drawPath(t){super.drawPath(t),this.renderStroke(t,this.strokePath.getPath2D())}containsPoint(t,e){const{projectedGeometry:i}=this;return i==null||!this.getBBox().containsPoint(t,e)?!1:this.geometryDistance(i,t,e)<=0}distanceSquared(t,e){const{projectedGeometry:i}=this;if(i==null)return 1/0;const o=this.geometryDistance(i,t,e);return o>0?o*o:0}geometryDistance(t,e,i){const{renderMode:o,strokeWidth:s}=this,a=(o&1)!==0,n=(o&2)!==0,r=Math.max(s/2,1)+1;switch(t.type){case"GeometryCollection":return t.geometries.reduce((l,c)=>Math.min(l,this.geometryDistance(c,e,i)),1/0);case"MultiPolygon":return a?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(gl(c,e,i),0)),1/0):1/0;case"Polygon":return a?Math.max(gl(t.coordinates,e,i),0):1/0;case"MultiLineString":return n?t.coordinates.reduce((l,c)=>Math.min(l,Math.max(Qx(c,e,i)-r,0)),1/0):1/0;case"LineString":return n?Math.max(Qx(t.coordinates,e,i)-r,0):1/0;case"MultiPoint":case"Point":default:return 1/0}}drawGeometry(t,e){const{renderMode:i,path:o,strokePath:s}=this,a=(i&1)!==0,n=(i&2)!==0;switch(t.type){case"GeometryCollection":t.geometries.forEach(r=>{e=this.drawGeometry(r,e)});break;case"MultiPolygon":a&&t.coordinates.forEach(r=>{e=this.drawPolygon(o,r,e)});break;case"Polygon":a&&(e=this.drawPolygon(o,t.coordinates,e));break;case"LineString":n&&(e=this.drawLineString(s,t.coordinates,e,!1));break;case"MultiLineString":n&&t.coordinates.forEach(r=>{e=this.drawLineString(s,r,e,!1)});break;case"Point":case"MultiPoint":break}return e}drawPolygon(t,e,i){if(e.length<1)return i;i=this.drawLineString(t,e[0],i,!0);for(let o=1;o<e.length;o+=1){const s=e[o];this.drawLineString(t,s,void 0,!0)}return i}drawLineString(t,e,i,o){if(e.length<2)return i;const s=o?e.length-1:e.length;for(let a=0;a<s;a+=1){const[n,r]=e[a];if(a===0?t.moveTo(n,r):t.lineTo(n,r),i==null)i=new eR(n,r,0,0);else{const{x:l,y:c}=i,h=l+i.width,p=c+i.height;i.x=Math.min(l,n),i.y=Math.min(c,r),i.width=Math.max(h,n)-i.x,i.height=Math.max(p,r)-i.y}}return o&&t.closePath(),i}};d([qx()],Na.prototype,"projectedGeometry",2),d([qx()],Na.prototype,"renderMode",2);function Oa(t,e){if(t.bbox!=null){const[i,o,s,a]=t.bbox;return e=Dn(e,i,o,s,a),e}switch(t.type){case"GeometryCollection":t.geometries.forEach(i=>{e=Oa(i,e)});break;case"MultiPolygon":t.coordinates.forEach(i=>{i.length>0&&(e=ms(i[0],e))});break;case"Polygon":t.coordinates.length>0&&(e=ms(t.coordinates[0],e));break;case"MultiLineString":t.coordinates.forEach(i=>{e=ms(i,e)});break;case"LineString":e=ms(t.coordinates,e);break;case"MultiPoint":t.coordinates.forEach(i=>{const[o,s]=i;e=Dn(e,o,s,o,s)});break;case"Point":{const[i,o]=t.coordinates;e=Dn(e,i,o,i,o);break}}return e}function yl(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=yl(o);if(s==null)return;const a=ms(s[0],void 0);if(a==null)return;const n=Math.abs(a.lat1-a.lat0)*Math.abs(a.lon1-a.lon0);(e==null||n>e)&&(e=n,i=s)}),i}case"MultiPolygon":{let e,i;return t.coordinates.forEach(o=>{const s=ms(o[0],void 0);if(s==null)return;const a=Math.abs(s.lat1-s.lat0)*Math.abs(s.lon1-s.lon0);(e==null||a>e)&&(e=a,i=o)}),i}case"Polygon":return t.coordinates;case"MultiLineString":case"LineString":case"MultiPoint":case"Point":return}}function fl(t){switch(t.type){case"GeometryCollection":{let e,i;return t.geometries.forEach(o=>{const s=fl(o);if(s==null)return;const a=qd(s);a!=null&&(e==null||a>e)&&(e=a,i=s)}),i}case"MultiLineString":{let e=0,i;return t.coordinates.forEach(o=>{const s=qd(o);s>e&&(e=s,i=o)}),i}case"LineString":return t.coordinates;case"MultiPolygon":case"Polygon":case"MultiPoint":case"Point":return}}function Jd(t,e){if(t==null)return!1;switch(t.type){case"GeometryCollection":return t.geometries.some(i=>Jd(i,e));case"MultiPolygon":case"Polygon":return(e&1)!==0;case"MultiLineString":case"LineString":return(e&2)!==0;case"MultiPoint":case"Point":return(e&4)!==0}}function Lo(t,e){switch(t.type){case"GeometryCollection":return{type:"GeometryCollection",geometries:t.geometries.map(i=>Lo(i,e))};case"Polygon":return{type:"Polygon",coordinates:tp(t.coordinates,e)};case"MultiPolygon":return{type:"MultiPolygon",coordinates:iR(t.coordinates,e)};case"MultiLineString":return{type:"MultiLineString",coordinates:tp(t.coordinates,e)};case"LineString":return{type:"LineString",coordinates:ep(t.coordinates,e)};case"MultiPoint":return{type:"MultiPoint",coordinates:ep(t.coordinates,e)};case"Point":return{type:"Point",coordinates:e.convert(t.coordinates)}}}function iR(t,e){return t.map(i=>tp(i,e))}function tp(t,e){return t.map(i=>ep(i,e))}function ep(t,e){return t.map(i=>e.convert(i))}import{_ModuleSupport as Jx}from"ag-charts-community";function tS(t){return Array.isArray(t)&&t.length>=2&&t.every(Jx.isFiniteNumber)}function ml(t){return Array.isArray(t)&&t.length>=2&&t.every(tS)}var eS=.001;function oR(t){return Math.abs(t[0][0]-t[t.length-1][0])<eS&&Math.abs(t[0][1]-t[t.length-1][1])<eS}function iS(t){return Array.isArray(t)&&t.every(ml)&&t.every(oR)}function oS(t){if(t===null)return!0;if(typeof t!="object"||t.type==null)return!1;const{type:e,coordinates:i}=t;switch(e){case"GeometryCollection":return Array.isArray(t.geometries)&&t.geometries.every(oS);case"MultiPolygon":return Array.isArray(i)&&i.every(iS);case"Polygon":return iS(i);case"MultiLineString":return Array.isArray(i)&&i.every(ml);case"LineString":return ml(i);case"MultiPoint":return ml(i);case"Point":return tS(i)}}function sR(t){return t!==null&&typeof t=="object"&&t.type==="Feature"&&oS(t.geometry)}function aR(t){return t!==null&&typeof t=="object"&&t.type==="FeatureCollection"&&Array.isArray(t.features)&&t.features.every(sR)}var zi=Jx.predicateWithMessage(aR,"a GeoJSON object");import{_ModuleSupport as nR}from"ag-charts-community";var{COLOR_STRING:rR,LINE_DASH:lR,OBJECT:cR,POSITIVE_NUMBER:sS,RATIO:hR,Validate:xs,SeriesProperties:dR,SeriesTooltip:pR}=nR,Co=class extends dR{constructor(){super(...arguments),this.topology=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new pR}};d([xs(zi,{optional:!0})],Co.prototype,"topology",2),d([xs(rR)],Co.prototype,"stroke",2),d([xs(hR)],Co.prototype,"strokeOpacity",2),d([xs(sS)],Co.prototype,"strokeWidth",2),d([xs(lR)],Co.prototype,"lineDash",2),d([xs(sS)],Co.prototype,"lineDashOffset",2),d([xs(cR)],Co.prototype,"tooltip",2);var{createDatumId:uR,DataModelSeries:gR,SeriesNodePickMode:yR,Validate:fR}=Zx,{Group:mR,Selection:xR,PointerEvents:SR}=K_,{Logger:bR}=Y_,xl=class extends gR{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[yR.EXACT_SHAPE_MATCH]}),this.properties=new Co,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new mR({name:"itemGroup"})),this.datumSelection=xR.select(this.itemGroup,()=>this.nodeFactory())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}nodeFactory(){const t=new Na;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t.pointerEvents=SR.None,t}async processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:Oa(o,e)},void 0),t==null&&bR.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}async createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Lo(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t}=this;await this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=await this.updateDatumSelection({nodeData:e,datumSelection:t}),await this.updateDatumNodes({datumSelection:t})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>uR(e.index))}async updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{stroke:o,strokeOpacity:s,lineDash:a,lineDashOffset:n}=e,r=this.getStrokeWidth(e.strokeWidth);i.each((l,c)=>{const{projectedGeometry:h}=c;if(h==null){l.visible=!1,l.projectedGeometry=void 0;return}l.visible=!0,l.projectedGeometry=h,l.stroke=o,l.strokeWidth=r,l.strokeOpacity=s,l.lineDash=a,l.lineDashOffset=n})}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return Zx.EMPTY_TOOLTIP_CONTENT}computeFocusBounds(t){}};xl.className="MapLineBackgroundSeries",xl.type="map-line-background",d([fR(zi,{optional:!0,property:"topology"})],xl.prototype,"_chartTopology",2);var{DEFAULT_HIERARCHY_STROKES:vR}=W_,MR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line-background",moduleFactory:t=>new xl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...An,series:{strokeWidth:1,lineDash:[0],lineDashOffset:0}},paletteFactory:({themeTemplateParameters:t})=>({stroke:t.get(vR)?.[1]})};import{_Theme as TR}from"ag-charts-community";import{_ModuleSupport as aS,_Scale as AR,_Scene as nS,_Util as DR}from"ag-charts-community";function kR(){return{fromFn:(i,o,s)=>s==="removed"?{scalingX:1,scalingY:1}:i.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:i.scalingX,scalingY:i.scalingY},toFn:(i,o,s)=>s==="removed"?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}}function rS(t,e){const i=t.contextNodeData?.nodeData[e.datumIndex];if(i!==void 0){for(const o of t.datumSelection.nodes())if(o.datum===i)return o}}import{_ModuleSupport as IR,_Scene as NR}from"ag-charts-community";var{AND:OR,ARRAY:LR,COLOR_STRING:CR,COLOR_STRING_ARRAY:ER,FUNCTION:_R,LINE_DASH:RR,NUMBER_ARRAY:wR,OBJECT:lS,POSITIVE_NUMBER:ip,RATIO:PR,STRING:fi,Validate:vt,SeriesProperties:BR,SeriesTooltip:zR}=IR,{Label:FR}=NR,bt=class extends BR{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.topologyIdKey="name",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.maxStrokeWidth=void 0,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.label=new FR,this.tooltip=new zR}};d([vt(zi,{optional:!0})],bt.prototype,"topology",2),d([vt(fi,{optional:!0})],bt.prototype,"title",2),d([vt(fi,{optional:!0})],bt.prototype,"legendItemName",2),d([vt(fi)],bt.prototype,"idKey",2),d([vt(fi)],bt.prototype,"topologyIdKey",2),d([vt(fi,{optional:!0})],bt.prototype,"idName",2),d([vt(fi,{optional:!0})],bt.prototype,"labelKey",2),d([vt(fi,{optional:!0})],bt.prototype,"labelName",2),d([vt(fi,{optional:!0})],bt.prototype,"sizeKey",2),d([vt(fi,{optional:!0})],bt.prototype,"sizeName",2),d([vt(fi,{optional:!0})],bt.prototype,"colorKey",2),d([vt(fi,{optional:!0})],bt.prototype,"colorName",2),d([vt(wR,{optional:!0})],bt.prototype,"sizeDomain",2),d([vt(OR(ER,LR.restrict({minLength:1})),{optional:!0})],bt.prototype,"colorRange",2),d([vt(ip,{optional:!0})],bt.prototype,"maxStrokeWidth",2),d([vt(CR)],bt.prototype,"stroke",2),d([vt(PR)],bt.prototype,"strokeOpacity",2),d([vt(ip)],bt.prototype,"strokeWidth",2),d([vt(RR)],bt.prototype,"lineDash",2),d([vt(ip)],bt.prototype,"lineDashOffset",2),d([vt(_R,{optional:!0})],bt.prototype,"itemStyler",2),d([vt(lS)],bt.prototype,"label",2),d([vt(lS)],bt.prototype,"tooltip",2);var{getMissCount:VR,createDatumId:UR,DataModelSeries:HR,SeriesNodePickMode:cS,valueProperty:kn,CachedTextMeasurerPool:GR,Validate:WR}=aS,{ColorScale:KR,LinearScale:YR}=AR,{Selection:op,Text:jR}=nS,{sanitizeHtml:In,Logger:hS}=DR,Sl=class extends HR{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[cS.EXACT_SHAPE_MATCH,cS.NEAREST_NODE]}),this.properties=new bt,this._chartTopology=void 0,this.colorScale=new KR,this.sizeScale=new YR,this.datumSelection=op.select(this.contentGroup,()=>this.nodeFactory()),this.labelSelection=op.select(this.labelGroup,jR),this.highlightDatumSelection=op.select(this.highlightNode,()=>this.nodeFactory()),this._previousDatumMidPoint=void 0}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Na;return t.renderMode=2,t.lineJoin="round",t.lineCap="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,sizeKey:r,colorKey:l,labelKey:c,sizeDomain:h,colorRange:p}=this.properties,u=new Map;i?.features.forEach(S=>{const x=S.properties?.[a];x==null||!Jd(S.geometry,2)||u.set(x,S)});const y=this.sizeScale.type,g=this.colorScale.type,f=this.scale?.type,{dataModel:m,processedData:v}=await this.requestDataModel(t,e,{props:[kn(n,f,{id:"idValue",includeProperty:!1}),kn(n,f,{id:"featureValue",includeProperty:!1,processor:()=>S=>u.get(S)}),...c!=null?[kn(c,"band",{id:"labelValue"})]:[],...r!=null?[kn(r,y,{id:"sizeValue"})]:[],...l!=null?[kn(l,g,{id:"colorValue"})]:[]]}),b=m.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=v.data.reduce((S,{values:x})=>{const T=x[b]?.geometry;return T==null?S:Oa(T,S)},void 0),r!=null){const S=m.resolveProcessedDataIndexById(this,"sizeValue"),x=v.domain.values[S]??[];o.domain=h??x}if(p!=null&&this.isColorScaleValid()){const S=m.resolveProcessedDataIndexById(this,"colorValue");s.domain=v.domain.values[S],s.range=p,s.update()}i==null&&hS.warnOnce("no topology was provided for [MapLineSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=VR(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o){if(e==null||i==null)return;const s=fl(i);if(s==null)return;const{idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u,label:y}=this.properties,g=this.getLabelText(y,{value:e,datum:t,idKey:a,idName:n,sizeKey:r,sizeName:l,colorKey:c,colorName:h,labelKey:p,labelName:u});if(g==null)return;const f=GR.measureText(String(g),{font:o}),m=ul(s);if(m==null)return;const[v,b]=m.point,{width:S,height:x}=f;return{point:{x:v,y:b,size:0},label:{width:S,height:x,text:g},marker:void 0,placement:void 0}}async createNodeData(){const{id:t,dataModel:e,processedData:i,sizeScale:o,colorScale:s,properties:a,scale:n}=this,{idKey:r,sizeKey:l,colorKey:c,labelKey:h,label:p}=a;if(e==null||i==null)return;const u=this.isColorScaleValid(),y=e.resolveProcessedDataIndexById(this,"idValue"),g=e.resolveProcessedDataIndexById(this,"featureValue"),f=h!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,m=l!=null?e.resolveProcessedDataIndexById(this,"sizeValue"):void 0,v=c!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,b=a.maxStrokeWidth??a.strokeWidth;o.range=[Math.min(a.strokeWidth,b),b];const S=p.getFont(),x=new Map;i.data.forEach(({values:I})=>{const N=I[y],O=I[g]?.geometry,L=O!=null&&n!=null?Lo(O,n):void 0;N!=null&&L!=null&&x.set(N,L)});const M=[],T=[],A=[];i.data.forEach(({datum:I,values:N})=>{const O=N[y],L=v!=null?N[v]:void 0,C=m!=null?N[m]:void 0,k=f!=null?N[f]:void 0,E=u&&L!=null?s.convert(L):void 0,_=C!=null?o.convert(C,{clampMode:"clamped"}):void 0,w=x.get(O);w==null&&A.push(O);const B=this.getLabelDatum(I,k,w,S);B!=null&&T.push(B),M.push({series:this,itemId:r,datum:I,stroke:E,strokeWidth:_,idValue:O,labelValue:k,colorValue:L,sizeValue:C,projectedGeometry:w})});const D=10;if(A.length>D){const I=A.length-D;A.length=D,A.push(`(+${I} more)`)}return A.length>0&&hS.warnOnce("some data items do not have matches in the provided topology",A),{itemId:t,nodeData:M,labelData:T}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[];this.datumSelection=await this.updateDatumSelection({nodeData:s,datumSelection:t}),await this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=await this.updateLabelSelection({labelSelection:e}),await this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=await this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),await this.updateDatumNodes({datumSelection:i,isHighlight:!0})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>UR(e.idValue))}async updateDatumNodes(t){const{id:e,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:s,isHighlight:a}=t,{idKey:n,labelKey:r,sizeKey:l,colorKey:c,stroke:h,strokeOpacity:p,lineDash:u,lineDashOffset:y,itemStyler:g}=i,f=a?i.highlightStyle.item:void 0,m=this.getStrokeWidth(i.strokeWidth);s.each((v,b)=>{const{projectedGeometry:S}=b;if(S==null){v.visible=!1,v.projectedGeometry=void 0;return}let x;g!=null&&(x=o.call(g,{seriesId:e,datum:b.datum,idKey:n,labelKey:r,sizeKey:l,colorKey:c,strokeOpacity:p,stroke:h,strokeWidth:m,lineDash:u,lineDashOffset:y,highlighted:a})),v.visible=!0,v.projectedGeometry=S,v.stroke=f?.stroke??x?.stroke??b.stroke??h,v.strokeWidth=Math.max(f?.strokeWidth??0,x?.strokeWidth??b.strokeWidth??m),v.strokeOpacity=f?.strokeOpacity??x?.strokeOpacity??p,v.lineDash=f?.lineDash??x?.lineDash??u,v.lineDashOffset=f?.lineDashOffset??x?.lineDashOffset??y})}async updateLabelSelection(t){const e=(this.isLabelEnabled()?this.chart?.placeLabels().get(this):void 0)??[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){return this.contextNodeData?.labelData??[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?fl(i):void 0,s=o!=null?ul(o)?.point:void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idKey:a,idName:n,colorKey:r,colorName:l,colorRange:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,visible:g}=this.properties;if(t==="gradient"&&r!=null&&c!=null){const f=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:g,seriesId:this.id,colorName:l,colorRange:c,colorDomain:f}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??n??a,seriesId:this.id,enabled:g,label:{text:s??o??n??a},symbols:[{marker:{fill:h,fillOpacity:u,stroke:void 0,strokeWidth:0,strokeOpacity:0,enabled:!1},line:{stroke:h,strokeOpacity:u,strokeWidth:p,lineDash:y}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,properties:o,ctx:{callbackCache:s}}=this;if(!i||!o.isValid())return aS.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,colorKey:l,colorName:c,sizeKey:h,sizeName:p,labelKey:u,labelName:y,itemStyler:g,tooltip:f,strokeOpacity:m,lineDash:v,lineDashOffset:b}=o,{datum:S,stroke:x,idValue:M,colorValue:T,sizeValue:A,labelValue:D,itemId:I}=t,N=In(o.title??a)??"",O=[];O.push(In((r!=null?`${r}: `:"")+M)),T!=null&&O.push(In((c??l)+": "+T)),A!=null&&O.push(In((p??h)+": "+A)),D!=null&&u!==n&&O.push(In((y??u)+": "+D));const L=O.join("<br>");let C;g&&(C=s.call(g,{highlighted:!1,seriesId:e,datum:S,idKey:n,sizeKey:h,colorKey:l,labelKey:u,stroke:x,strokeWidth:this.getStrokeWidth(t.strokeWidth??o.strokeWidth),strokeOpacity:m,lineDash:v,lineDashOffset:b}));const k=C?.stroke??x??o.stroke;return f.toTooltipHtml({title:N,content:L,backgroundColor:k},{seriesId:e,datum:S,idKey:n,title:N,color:k,itemId:I,sizeKey:h,colorKey:l,colorName:c,idName:r,labelKey:u,labelName:y,sizeName:p,...this.getModuleTooltipParams()})}computeFocusBounds(t){const e=rS(this,t);return e?nS.Transformable.toCanvas(e):void 0}};Sl.className="MapLineSeries",Sl.type="map-line",d([WR(zi,{optional:!0,property:"topology"})],Sl.prototype,"_chartTopology",2);var{DEFAULT_DIVERGING_SERIES_COLOR_RANGE:XR,DEFAULT_FONT_FAMILY:ZR,DEFAULT_LABEL_COLOUR:$R,singleSeriesPaletteFactory:QR}=TR,qR={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-line",moduleFactory:t=>new Sl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...An,series:{strokeWidth:1,maxStrokeWidth:3,lineDash:[0],lineDashOffset:0,label:{enabled:!0,fontStyle:void 0,fontWeight:void 0,fontSize:12,fontFamily:ZR,color:$R}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=QR(t),n=s.get(XR),{fills:r}=e(i);return{colorRange:o==="inbuilt"?n:[r[0],r[1]],stroke:a}}};import{_Theme as JR}from"ag-charts-community";import{_ModuleSupport as dS,_Scale as tw,_Scene as ew,_Util as iw}from"ag-charts-community";function pS(t,e,i){const o=ms(t[0],void 0);if(o==null)return;const s=(o.lon0+o.lon1)/2,a=(o.lat0+o.lat1)/2,n=Math.abs(o.lon1-o.lon0),r=Math.abs(o.lat1-o.lat0),l=q_(t[0]),[c,h]=l,p=-gl(t,c,h);let u;const y=(M,T)=>{const D=Math.max(T-p,0);return M-.5*D},g=(M,T,A)=>{const{distance:D,maxDistance:I}=i(t,M,T,A),N=Math.hypot(c-M,h-T),O=Math.min(Math.max(c,M-A/2),M+A/2),L=Math.min(Math.max(h,T-A/2),T+A/2),C=Math.hypot(c-O,h-L),k=y(D,N),E=y(I,C);return{distance:D,maxDistance:I,value:k,maxValue:E,x:M,y:T,stride:A}},f=(M,T,A,D)=>{const I=g(T,A,D);I.maxDistance>=0&&M.push(I)},m=Math.min(n,r)/2;let v={value:g(s,a,m),next:null};for(;v!=null;){const M=v.value,{distance:T,value:A,maxValue:D,x:I,y:N,stride:O}=M;if(v=v.next,T>0&&(u==null||A>u.value)&&(u=M),u!=null&&D-u.value<=e)continue;const L=O/2,C=[];f(C,I-L,N-L,L),f(C,I+L,N-L,L),f(C,I-L,N+L,L),f(C,I+L,N+L,L),C.sort(uS),v=Q_(v,C,uS)}if(u==null)return;const{distance:b,x:S,y:x}=u;return{x:S,y:x,distance:b}}var uS=(t,e)=>e.maxValue-t.maxValue;function sp(t,e){const i=pS(t,e,(a,n,r,l)=>{const c=-gl(a,n,r),h=c+l*Math.SQRT2;return{distance:c,maxDistance:h}});if(i==null)return;const{x:o,y:s}=i;return[o,s]}function gS(t,e){let i;switch(t.type){case"GeometryCollection":return t.geometries.flatMap(o=>gS(o,e));case"MultiPoint":return t.coordinates;case"Point":return[t.coordinates];case"MultiPolygon":{const o=yl(t);i=o!=null?sp(o,e):void 0;break}case"Polygon":{const o=t.coordinates;i=o!=null?sp(o,e):void 0;break}case"MultiLineString":{const o=fl(t);i=o!=null?ul(o)?.point:void 0;break}case"LineString":{const o=t.coordinates;i=ul(o)?.point;break}}return i!=null?[i]:[]}import{_ModuleSupport as ow,_Scene as sw,_Util as aw}from"ag-charts-community";var{AND:nw,ARRAY:rw,COLOR_STRING:yS,COLOR_STRING_ARRAY:lw,FUNCTION:cw,NUMBER_ARRAY:hw,OBJECT:fS,POSITIVE_NUMBER:ap,RATIO:mS,STRING:de,MARKER_SHAPE:dw,Validate:lt,SeriesProperties:pw,SeriesTooltip:uw}=ow,{Label:gw,Circle:yw}=sw,{Logger:fw}=aw,xS=class extends gw{constructor(){super(...arguments),this.placement="bottom"}};d([lt(de)],xS.prototype,"placement",2);var ct=class extends pw{constructor(){super(...arguments),this.topology=void 0,this.idKey=void 0,this.topologyIdKey="name",this.idName=void 0,this.latitudeKey=void 0,this.latitudeName=void 0,this.longitudeKey=void 0,this.longitudeName=void 0,this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.shape=yw,this.size=6,this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.label=new xS,this.tooltip=new uw}isValid(){const t=super.isValid(),e=this.idKey!=null,i=this.latitudeKey!=null&&this.longitudeKey!=null;return!e&&!i?(fw.warnOnce("Either both [topology] and [idKey] or both [latitudeKey] and [longitudeKey] must be set to render a map marker series."),!1):t}};d([lt(zi,{optional:!0})],ct.prototype,"topology",2),d([lt(de,{optional:!0})],ct.prototype,"title",2),d([lt(de,{optional:!0})],ct.prototype,"legendItemName",2),d([lt(de,{optional:!0})],ct.prototype,"idKey",2),d([lt(de)],ct.prototype,"topologyIdKey",2),d([lt(de,{optional:!0})],ct.prototype,"idName",2),d([lt(de,{optional:!0})],ct.prototype,"latitudeKey",2),d([lt(de,{optional:!0})],ct.prototype,"latitudeName",2),d([lt(de,{optional:!0})],ct.prototype,"longitudeKey",2),d([lt(de,{optional:!0})],ct.prototype,"longitudeName",2),d([lt(de,{optional:!0})],ct.prototype,"labelKey",2),d([lt(de,{optional:!0})],ct.prototype,"labelName",2),d([lt(de,{optional:!0})],ct.prototype,"sizeKey",2),d([lt(de,{optional:!0})],ct.prototype,"sizeName",2),d([lt(de,{optional:!0})],ct.prototype,"colorKey",2),d([lt(de,{optional:!0})],ct.prototype,"colorName",2),d([lt(nw(lw,rw.restrict({minLength:1})),{optional:!0})],ct.prototype,"colorRange",2),d([lt(dw)],ct.prototype,"shape",2),d([lt(ap)],ct.prototype,"size",2),d([lt(ap,{optional:!0})],ct.prototype,"maxSize",2),d([lt(hw,{optional:!0})],ct.prototype,"sizeDomain",2),d([lt(yS,{optional:!0})],ct.prototype,"fill",2),d([lt(mS)],ct.prototype,"fillOpacity",2),d([lt(yS,{optional:!0})],ct.prototype,"stroke",2),d([lt(ap)],ct.prototype,"strokeWidth",2),d([lt(mS)],ct.prototype,"strokeOpacity",2),d([lt(cw,{optional:!0})],ct.prototype,"itemStyler",2),d([lt(fS)],ct.prototype,"label",2),d([lt(fS)],ct.prototype,"tooltip",2);var{CachedTextMeasurerPool:mw,Validate:xw,fromToMotion:Sw,StateMachine:bw,getMissCount:vw,createDatumId:Mw,DataModelSeries:Tw,SeriesNodePickMode:SS,ZIndexMap:Aw,valueProperty:Ss,computeMarkerFocusBounds:Dw}=dS,{ColorScale:kw,LinearScale:Iw}=tw,{Layer:Nw,Selection:np,Text:Ow,getMarker:bS}=ew,{sanitizeHtml:La,Logger:Lw}=iw,bl=class extends Tw{constructor(t){super({moduleCtx:t,contentGroupVirtual:!0,useLabelLayer:!0,pickModes:[SS.EXACT_SHAPE_MATCH,SS.NEAREST_NODE]}),this.properties=new ct,this._chartTopology=void 0,this.colorScale=new kw,this.sizeScale=new Iw,this.markerGroup=this.contentGroup.appendChild(new Nw({name:"markerGroup",zIndex:Aw.SERIES_LAYER,zIndexSubOrder:this.getGroupZIndexSubOrder("marker")})),this.labelSelection=np.select(this.labelGroup,Ow,!1),this.markerSelection=np.select(this.markerGroup,()=>this.markerFactory(),!1),this.highlightMarkerSelection=np.select(this.highlightNode,()=>this.markerFactory()),this.animationState=new bw("empty",{empty:{update:{target:"ready",action:()=>this.animateMarkers()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.resetAllAnimation(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateMarkers()},resize:{target:"ready",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty",action:()=>this.resetAllAnimation()},reset:"empty",skip:"ready"}},()=>this.checkProcessedDataAnimatable())}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){const t=this.properties.latitudeKey!=null&&this.properties.longitudeKey!=null;return super.hasData&&(this.topology!=null||t)}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}markerFactory(){const{shape:t}=this.properties,e=bS(t);return new e}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,sizeScale:o,colorScale:s}=this,{topologyIdKey:a,idKey:n,latitudeKey:r,longitudeKey:l,sizeKey:c,colorKey:h,labelKey:p,sizeDomain:u,colorRange:y}=this.properties,g=new Map;i?.features.forEach(D=>{const I=D.properties?.[a];I!=null&&g.set(I,D)});const f=this.sizeScale.type,m=this.colorScale.type,v=this.scale?.type,b=r!=null&&l!=null,{dataModel:S,processedData:x}=await this.requestDataModel(t,e,{props:[...n!=null?[Ss(n,v,{id:"idValue",includeProperty:!1}),Ss(n,v,{id:"featureValue",includeProperty:!1,processor:()=>D=>g.get(D)})]:[],...b?[Ss(r,v,{id:"latValue"}),Ss(l,v,{id:"lonValue"})]:[],...p?[Ss(p,"band",{id:"labelValue"})]:[],...c?[Ss(c,f,{id:"sizeValue"})]:[],...h?[Ss(h,m,{id:"colorValue"})]:[]]}),M=n!=null?S.resolveProcessedDataIndexById(this,"featureValue"):void 0,T=b?S.resolveProcessedDataIndexById(this,"latValue"):void 0,A=b?S.resolveProcessedDataIndexById(this,"lonValue"):void 0;if(this.topologyBounds=x.data.reduce((D,{values:I})=>{const O=(M!=null?I[M]:void 0)?.geometry;if(O!=null&&(D=Oa(O,D)),T!=null&&A!=null){const L=I[A],C=I[T];D=Dn(D,L,C,L,C)}return D},void 0),c!=null){const D=S.resolveProcessedDataIndexById(this,"sizeValue"),I=x.domain.values[D]??[];o.domain=u??I}if(y!=null&&this.isColorScaleValid()){const D=S.resolveProcessedDataIndexById(this,"colorValue");s.domain=x.domain.values[D],s.range=y,s.update()}this.animationState.transition("updateData")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=vw(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelDatum(t,e,i,o,s,a){if(e==null)return;const{idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:y,colorKey:g,colorName:f,labelKey:m,labelName:v,label:b}=this.properties,{placement:S}=b,x=this.getLabelText(b,{value:e,datum:t,idKey:n,idName:r,latitudeKey:l,latitudeName:c,longitudeKey:h,longitudeName:p,sizeKey:u,sizeName:y,colorKey:g,colorName:f,labelKey:m,labelName:v});if(x==null)return;const{width:M,height:T}=mw.measureText(String(x),{font:a});return{point:{x:i,y:o,size:s},label:{width:M,height:T,text:x},marker:bS(this.properties.shape),placement:S}}async createNodeData(){const{id:t,dataModel:e,processedData:i,colorScale:o,sizeScale:s,properties:a,scale:n}=this,{idKey:r,latitudeKey:l,longitudeKey:c,sizeKey:h,colorKey:p,labelKey:u,label:y}=a;if(e==null||i==null||n==null)return;const g=this.isColorScaleValid(),f=l!=null&&c!=null,m=r!=null?e.resolveProcessedDataIndexById(this,"idValue"):void 0,v=r!=null?e.resolveProcessedDataIndexById(this,"featureValue"):void 0,b=f?e.resolveProcessedDataIndexById(this,"latValue"):void 0,S=f?e.resolveProcessedDataIndexById(this,"lonValue"):void 0,x=u!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,M=h!=null?e.resolveProcessedDataIndexById(this,"sizeValue"):void 0,T=p!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,A=a.maxSize??a.size;s.range=[Math.min(a.size,A),A];const D=y.getFont();let I;m!=null&&v!=null&&(I=new Map,i.data.forEach(({values:k})=>{const E=k[m],_=k[v]?.geometry,w=_!=null&&n!=null?Lo(_,n):void 0;E!=null&&w!=null&&I.set(E,w)}));const N=[],O=[],L=[];i.data.forEach(({datum:k,values:E})=>{const _=m!=null?E[m]:void 0,w=S!=null?E[S]:void 0,B=b!=null?E[b]:void 0,P=T!=null?E[T]:void 0,R=M!=null?E[M]:void 0,z=x!=null?E[x]:void 0,F=g&&P!=null?o.convert(P):void 0,U=R!=null?s.convert(R,{clampMode:"clamped"}):a.size,G=_!=null?I?.get(_):void 0;if(_!=null&&Lo==null&&L.push(_),w!=null&&B!=null){const[V,j]=n.convert([w,B]),K=this.getLabelDatum(k,z,V,j,U,D);K&&O.push(K),N.push({series:this,itemId:l,datum:k,index:-1,fill:F,idValue:_,lonValue:w,latValue:B,labelValue:z,sizeValue:R,colorValue:P,point:{x:V,y:j,size:U},midPoint:{x:V,y:j}})}else G!=null&&gS(G,1).forEach(([V,j],K)=>{const Z=this.getLabelDatum(k,z,V,j,U,D);Z&&O.push(Z),N.push({series:this,itemId:l,datum:k,index:K,fill:F,idValue:_,lonValue:w,latValue:B,labelValue:z,sizeValue:R,colorValue:P,point:{x:V,y:j,size:U},midPoint:{x:V,y:j}})})});const C=10;if(L.length>C){const k=L.length-C;L.length=C,L.push(`(+${k} more)`)}return L.length>0&&Lw.warnOnce("some data items do not have matches in the provided topology",L),{itemId:t,nodeData:N,labelData:O}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}checkScaleChange(){return this.previousScale===this.scale?!1:(this.previousScale=this.scale,!0)}async update({seriesRect:t}){const e=this.checkResize(t),i=this.checkScaleChange(),{labelSelection:o,markerSelection:s,highlightMarkerSelection:a}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let n=this.ctx.highlightManager?.getActiveHighlight();n!=null&&(n.series!==this||n.datum==null)&&(n=void 0);const r=this.contextNodeData?.nodeData??[];this.labelSelection=await this.updateLabelSelection({labelSelection:o}),await this.updateLabelNodes({labelSelection:o}),this.markerSelection=await this.updateMarkerSelection({markerData:r,markerSelection:s}),await this.updateMarkerNodes({markerSelection:s,isHighlight:!1,highlightedDatum:n}),this.highlightMarkerSelection=await this.updateMarkerSelection({markerData:n!=null?[n]:[],markerSelection:a}),await this.updateMarkerNodes({markerSelection:a,isHighlight:!0,highlightedDatum:n}),(i||e)&&this.animationState.transition("resize"),this.animationState.transition("update")}async updateLabelSelection(t){const e=(this.isLabelEnabled()?this.chart?.placeLabels().get(this):void 0)??[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,width:h,height:p,text:u})=>{r.visible=!0,r.x=l+h/2,r.y=c+p/2,r.text=u,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign="center",r.textBaseline="middle"})}async updateMarkerSelection(t){const{markerData:e,markerSelection:i}=t;return i.update(e,void 0,o=>Mw([o.index,o.idValue,o.lonValue,o.latValue]))}async updateMarkerNodes(t){const{properties:e}=this,{markerSelection:i,isHighlight:o,highlightedDatum:s}=t,{fill:a,fillOpacity:n,stroke:r,strokeOpacity:l}=e,c=o?e.highlightStyle.item:void 0,h=this.getStrokeWidth(e.strokeWidth);i.each((p,u)=>{const{datum:y,point:g}=u,f=this.getMapMarkerStyle(u,o);p.size=f?.size??g.size,p.fill=c?.fill??f?.fill??u.fill??a,p.fillOpacity=c?.fillOpacity??f?.fillOpacity??n,p.stroke=c?.stroke??f?.stroke??r,p.strokeWidth=c?.strokeWidth??f?.strokeWidth??h,p.strokeOpacity=c?.strokeOpacity??f?.strokeOpacity??l,p.translationX=g.x,p.translationY=g.y,p.zIndex=!o&&s!=null&&y===s.datum?1:0})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}isProcessedDataAnimatable(){return!0}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),this.ctx.animationManager.skipCurrentBatch(),this.labelSelection.cleanup(),this.markerSelection.cleanup(),this.highlightMarkerSelection.cleanup()}animateMarkers(){const{animationManager:t}=this.ctx,e=kR();Sw(this.id,"markers",t,[this.markerSelection,this.highlightMarkerSelection],e)}getLabelData(){return this.contextNodeData?.labelData??[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum(t){const{x:e,y:i}=t;let o=1/0,s;return this.contextNodeData?.nodeData.forEach(a=>{const{x:n,y:r,size:l}=a.point,c=Math.max(Math.abs(n-e)-l,0),h=Math.max(Math.abs(r-i)-l,0),p=c*c+h*h;p<o&&(o=p,s=a)}),s!=null?{datum:s,distance:Math.sqrt(o)}:void 0}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idName:a,idKey:n,colorKey:r,colorName:l,colorRange:c,visible:h,shape:p,fill:u,stroke:y,fillOpacity:g,strokeOpacity:f,strokeWidth:m}=this.properties;if(t==="gradient"&&r!=null&&c!=null){const v=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:h,seriesId:this.id,colorName:l,colorRange:c,colorDomain:v}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??a??n??this.id,seriesId:this.id,enabled:h,label:{text:s??o??a??n??this.id},symbols:[{marker:{shape:p,fill:u,fillOpacity:g,stroke:y,strokeWidth:m,strokeOpacity:f}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!this.properties.isValid())return dS.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,latitudeKey:l,longitudeKey:c,sizeKey:h,sizeName:p,colorKey:u,colorName:y,labelKey:g,labelName:f,itemStyler:m,tooltip:v,latitudeName:b,longitudeName:S,shape:x,size:M,fillOpacity:T,stroke:A,strokeWidth:D,strokeOpacity:I}=s,{datum:N,fill:O,idValue:L,latValue:C,lonValue:k,sizeValue:E,colorValue:_,labelValue:w,itemId:B}=t,P=La(s.title??a)??"",R=[];L!=null&&R.push(La((r!=null?`${r}: `:"")+L)),_!=null&&R.push(La((y??u)+": "+_)),E!=null&&R.push(La((p??h)+": "+E)),w!=null&&(n==null||n!==g)&&R.push(La((f??g)+": "+w)),C!=null&&k!=null&&R.push(La(`${Math.abs(C).toFixed(4)}\xB0 ${C>=0?"N":"S"}, ${Math.abs(k).toFixed(4)}\xB0 ${C>=0?"W":"E"}`));const z=R.join("<br>");let F;m&&(F=o.call(m,{highlighted:!1,seriesId:e,datum:N,idKey:n,sizeKey:h,colorKey:u,labelKey:g,latitudeKey:l,longitudeKey:c,shape:x,size:M,fill:O,fillOpacity:T,stroke:A,strokeWidth:D,strokeOpacity:I}));const U=F?.fill??O??s.fill;return v.toTooltipHtml({title:P,content:z,backgroundColor:U},{seriesId:e,datum:N,idKey:n,latitudeKey:l,longitudeKey:c,title:P,color:U,colorKey:u,colorName:y,idName:r,itemId:B,labelKey:g,labelName:f,latitudeName:b,longitudeName:S,sizeKey:h,sizeName:p,...this.getModuleTooltipParams()})}getMapMarkerStyle(t,e){const{id:i,properties:o,ctx:{callbackCache:s}}=this,{datum:a,point:n}=t,{idKey:r,latitudeKey:l,longitudeKey:c,labelKey:h,sizeKey:p,colorKey:u,fill:y,fillOpacity:g,stroke:f,strokeOpacity:m,shape:v,itemStyler:b}=o,S=this.getStrokeWidth(o.strokeWidth);if(b!==void 0)return s.call(b,{seriesId:i,datum:a,size:n.size,idKey:r,latitudeKey:l,longitudeKey:c,labelKey:h,sizeKey:p,colorKey:u,fill:y,fillOpacity:g,stroke:f,strokeWidth:S,strokeOpacity:m,shape:v,highlighted:e})}getFormattedMarkerStyle(t){return{size:this.getMapMarkerStyle(t,!0)?.size??t.point.size}}computeFocusBounds(t){return Dw(this,t)}};bl.className="MapMarkerSeries",bl.type="map-marker",d([xw(zi,{optional:!0,property:"topology"})],bl.prototype,"_chartTopology",2);var{DEFAULT_LABEL_COLOUR:Cw,DEFAULT_DIVERGING_SERIES_COLOR_RANGE:Ew,singleSeriesPaletteFactory:_w}=JR,Rw={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-marker",moduleFactory:t=>new bl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...An,series:{shape:"circle",maxSize:30,fillOpacity:.5,label:{color:Cw}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a,stroke:n}=_w(t),r=s.get(Ew),{fills:l}=e(i);return{fill:a,stroke:n,colorRange:o==="inbuilt"?r:[l[0],l[1]]}}};import{_Theme as ww}from"ag-charts-community";import{_ModuleSupport as vS,_Scene as Pw,_Util as Bw}from"ag-charts-community";import{_ModuleSupport as zw}from"ag-charts-community";var{COLOR_STRING:MS,LINE_DASH:Fw,OBJECT:Vw,POSITIVE_NUMBER:TS,RATIO:AS,Validate:so,SeriesProperties:Uw,SeriesTooltip:Hw}=zw,Fi=class extends Uw{constructor(){super(...arguments),this.topology=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.tooltip=new Hw}};d([so(zi,{optional:!0})],Fi.prototype,"topology",2),d([so(MS)],Fi.prototype,"fill",2),d([so(AS)],Fi.prototype,"fillOpacity",2),d([so(MS)],Fi.prototype,"stroke",2),d([so(AS)],Fi.prototype,"strokeOpacity",2),d([so(TS)],Fi.prototype,"strokeWidth",2),d([so(Fw)],Fi.prototype,"lineDash",2),d([so(TS)],Fi.prototype,"lineDashOffset",2),d([so(Vw)],Fi.prototype,"tooltip",2);var{createDatumId:Gw,Series:Ww,SeriesNodePickMode:Kw,Validate:Yw}=vS,{Selection:jw,Group:Xw,PointerEvents:Zw}=Pw,{Logger:$w}=Bw,vl=class extends Ww{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Kw.EXACT_SHAPE_MATCH]}),this.properties=new Fi,this._chartTopology=void 0,this.itemGroup=this.contentGroup.appendChild(new Xw({name:"itemGroup"})),this.datumSelection=jw.select(this.itemGroup,()=>this.nodeFactory())}get topology(){return this.properties.topology??this._chartTopology}setOptionsData(){}setChartData(){}get hasData(){return!1}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}nodeFactory(){const t=new Na;return t.renderMode=1,t.lineJoin="round",t.pointerEvents=Zw.None,t}async processData(){const{topology:t}=this;this.topologyBounds=t?.features.reduce((e,i)=>{const o=i.geometry;return o==null?e:Oa(o,e)},void 0),t==null&&$w.warnOnce("no topology was provided for [MapShapeBackgroundSeries]; nothing will be rendered.")}async createNodeData(){const{id:t,topology:e,scale:i}=this;if(e==null)return;const o=[],s=[];return e.features.forEach((a,n)=>{const{geometry:r}=a,l=r!=null&&i!=null?Lo(r,i):void 0;l!=null&&o.push({series:this,itemId:n,datum:a,index:n,projectedGeometry:l})}),{itemId:t,nodeData:o,labelData:s}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t}=this;await this.updateSelections(),this.contentGroup.visible=this.visible;const{nodeData:e=[]}=this.contextNodeData??{};this.datumSelection=await this.updateDatumSelection({nodeData:e,datumSelection:t}),await this.updateDatumNodes({datumSelection:t})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Gw(e.index))}async updateDatumNodes(t){const{properties:e}=this,{datumSelection:i}=t,{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,lineDash:r,lineDashOffset:l}=e,c=this.getStrokeWidth(e.strokeWidth);i.each((h,p)=>{const{projectedGeometry:u}=p;if(u==null){h.visible=!1,h.projectedGeometry=void 0;return}h.visible=!0,h.projectedGeometry=u,h.fill=o,h.fillOpacity=s,h.stroke=a,h.strokeWidth=c,h.strokeOpacity=n,h.lineDash=r,h.lineDashOffset=l})}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}getTooltipHtml(){return vS.EMPTY_TOOLTIP_CONTENT}pickFocus(t){}};vl.className="MapShapeBackgroundSeries",vl.type="map-shape-background",d([Yw(zi,{optional:!0,property:"topology"})],vl.prototype,"_chartTopology",2);var{DEFAULT_BACKGROUND_COLOUR:Qw,DEFAULT_HIERARCHY_FILLS:qw}=ww,Jw={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape-background",moduleFactory:t=>new vl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...An,series:{stroke:Qw,strokeWidth:1}},paletteFactory:({themeTemplateParameters:t})=>({fill:t.get(qw)?.[1]})};import{_Theme as tP}from"ag-charts-community";import{_ModuleSupport as rp,_Scale as eP,_Scene as iP,_Util as oP}from"ag-charts-community";function sP(t,{aspectRatio:e,precision:i}){const o=pS(t,i,(l,c,h,p)=>{const u=nP(l,c,h,e),y=u+2*p*e,g=u*Math.SQRT2,f=y*Math.SQRT2;return{distance:g,maxDistance:f}});if(o==null)return;const{x:s,y:a,distance:n}=o,r=n/Math.SQRT2;return{x:s,y:a,maxWidth:r}}function aP(t,e,i,o,s){const[a,n]=t,[r,l]=e,c=1/s,h=r-a,p=l-n,[u,y]=n<=l?t:e,[g,f]=a<=r?t:e,[m,v]=n<=l?e:t,[b,S]=a<=r?e:t;let x=1/0;if(h!==0){const N=p/h;for(let O=0;O<=1;O+=1){const L=O===0?c:-c,C=(N*a-n-L*i+o)/(N-L);if(C>=g&&C<=b){const k=Math.abs(i-C)*2;x=Math.min(x,k)}}}else for(let N=0;N<=1;N+=1){const L=(N===0?c:-c)*(a-i)+o;if(L>=y&&L<=v){const k=Math.abs(o-L)*2*s;x=Math.min(x,k)}}const M=s,T=Math.abs((u-i)/(y-o)),A=Math.abs((m-i)/(v-o));if(v<o&&A<M){const O=Math.abs(o-v)*2*s;x=Math.min(x,O)}else if(y>o&&T<M){const O=Math.abs(o-y)*2*s;x=Math.min(x,O)}const D=Math.abs((f-o)/(g-i)),I=Math.abs((S-o)/(b-i));if(b<i&&I<c){const N=Math.abs(i-b)*2;x=Math.min(x,N)}else if(g>i&&D<c){const N=Math.abs(i-g)*2;x=Math.min(x,N)}return x}function nP(t,e,i,o){let s=!1,a=1/0;for(const n of t){let r=n[n.length-1],[l,c]=r;for(const h of n){const[p,u]=h;u>i!=c>i&&e<(l-p)*(i-u)/(c-u)+p&&(s=!s);const y=aP(r,h,e,i,o);a=Math.min(a,y),r=h,l=p,c=u}}return(s?1:-1)*a}function Ml(t,e,i){i>=e&&(t.maxX=Math.min(t.maxX,i-e)),i<=e&&(t.minX=Math.max(t.minX,i-e))}function rP(t,e,i,o,s,a){const n=s-a/2,r=s+a/2,[l,c]=e,[h,p]=i,u=h-l,y=p-c,[g,f]=l<=h?e:i,[m,v]=l<=h?i:e;if(u!==0){const b=y/u;for(let S=0;S<=1;S+=1){const M=((S===0?n:r)-c)/b+l;M>=g&&M<=m&&Ml(t,o,M)}}else Math.max(n,Math.min(c,p))<=Math.min(r,Math.max(c,p))&&Ml(t,o,l);return m<o&&v>=n&&v<=r?Ml(t,o,m):g>o&&f>=n&&f<=r&&Ml(t,o,g),t}function lP(t,e,i,o){const s={minX:-1/0,maxX:1/0};for(const r of t){let l=r[r.length-1];for(const c of r)rP(s,l,c,e,i,o),l=c}const{minX:a,maxX:n}=s;return Number.isFinite(a)&&Number.isFinite(n)?{x:e+(a+n)/2,width:n-a}:{x:e,width:0}}import{_ModuleSupport as cP}from"ag-charts-community";var{AND:hP,ARRAY:dP,COLOR_STRING:DS,COLOR_STRING_ARRAY:pP,FUNCTION:uP,LINE_DASH:gP,OBJECT:kS,POSITIVE_NUMBER:lp,RATIO:IS,STRING:ao,Validate:At,SeriesProperties:yP,SeriesTooltip:fP}=cP,Mt=class extends yP{constructor(){super(...arguments),this.topology=void 0,this.idKey="",this.idName=void 0,this.topologyIdKey="name",this.labelKey=void 0,this.labelName=void 0,this.colorRange=void 0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeOpacity=1,this.strokeWidth=0,this.lineDash=[0],this.lineDashOffset=0,this.padding=0,this.label=new bn,this.tooltip=new fP}};d([At(zi,{optional:!0})],Mt.prototype,"topology",2),d([At(ao,{optional:!0})],Mt.prototype,"title",2),d([At(ao,{optional:!0})],Mt.prototype,"legendItemName",2),d([At(ao)],Mt.prototype,"idKey",2),d([At(ao,{optional:!0})],Mt.prototype,"idName",2),d([At(ao)],Mt.prototype,"topologyIdKey",2),d([At(ao,{optional:!0})],Mt.prototype,"labelKey",2),d([At(ao,{optional:!0})],Mt.prototype,"labelName",2),d([At(ao,{optional:!0})],Mt.prototype,"colorKey",2),d([At(ao,{optional:!0})],Mt.prototype,"colorName",2),d([At(hP(pP,dP.restrict({minLength:1})),{optional:!0})],Mt.prototype,"colorRange",2),d([At(DS)],Mt.prototype,"fill",2),d([At(IS)],Mt.prototype,"fillOpacity",2),d([At(DS)],Mt.prototype,"stroke",2),d([At(IS)],Mt.prototype,"strokeOpacity",2),d([At(lp)],Mt.prototype,"strokeWidth",2),d([At(gP)],Mt.prototype,"lineDash",2),d([At(lp)],Mt.prototype,"lineDashOffset",2),d([At(lp)],Mt.prototype,"padding",2),d([At(uP,{optional:!0})],Mt.prototype,"itemStyler",2),d([At(kS)],Mt.prototype,"label",2),d([At(kS)],Mt.prototype,"tooltip",2);var{getMissCount:mP,createDatumId:xP,DataModelSeries:SP,SeriesNodePickMode:NS,valueProperty:Tl,Validate:bP,CachedTextMeasurerPool:vP,TextUtils:OS}=rp,{ColorScale:MP}=eP,{Group:LS,Selection:cp,Text:TP,PointerEvents:AP}=iP,{sanitizeHtml:Al,Logger:CS}=oP,ES=rp.MercatorScale.fixedScale(),Dl=class extends SP{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[NS.EXACT_SHAPE_MATCH,NS.NEAREST_NODE]}),this.properties=new Mt,this._chartTopology=void 0,this.colorScale=new MP,this.itemGroup=this.contentGroup.appendChild(new LS({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new LS({name:"itemLabelGroup"})),this.datumSelection=cp.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=cp.select(this.itemLabelGroup,TP),this.highlightDatumSelection=cp.select(this.highlightNode,()=>this.nodeFactory()),this.previousLabelLayouts=void 0,this._previousDatumMidPoint=void 0,this.itemLabelGroup.pointerEvents=AP.None}getNodeData(){return this.contextNodeData?.nodeData}get topology(){return this.properties.topology??this._chartTopology}get hasData(){return super.hasData&&this.topology!=null}setChartTopology(t){this._chartTopology=t,this.topology===t&&(this.nodeDataRefresh=!0)}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager.addListener("legend-item-click",t=>{this.onLegendItemClick(t)}),this.ctx.chartEventManager.addListener("legend-item-double-click",t=>{this.onLegendItemDoubleClick(t)}))}isLabelEnabled(){return this.properties.labelKey!=null&&this.properties.label.enabled}nodeFactory(){const t=new Na;return t.renderMode=1,t.lineJoin="round",t}async processData(t){if(this.data==null||!this.properties.isValid())return;const{data:e,topology:i,colorScale:o}=this,{topologyIdKey:s,idKey:a,colorKey:n,labelKey:r,colorRange:l}=this.properties,c=new Map;i?.features.forEach(f=>{const m=f.properties?.[s];m==null||!Jd(f.geometry,1)||c.set(m,f)});const h=this.colorScale.type,p=this.scale?.type,{dataModel:u,processedData:y}=await this.requestDataModel(t,e,{props:[Tl(a,p,{id:"idValue",includeProperty:!1}),Tl(a,p,{id:"featureValue",includeProperty:!1,processor:()=>f=>c.get(f)}),...r?[Tl(r,"band",{id:"labelValue"})]:[],...n?[Tl(n,h,{id:"colorValue"})]:[]]}),g=u.resolveProcessedDataIndexById(this,"featureValue");if(this.topologyBounds=y.data.reduce((f,{values:m})=>{const b=m[g]?.geometry;return b==null?f:Oa(b,f)},void 0),l!=null&&this.isColorScaleValid()){const f=u.resolveProcessedDataIndexById(this,"colorValue");o.domain=y.domain.values[f],o.range=l,o.update()}i==null&&CS.warnOnce("no topology was provided for [MapShapeSeries]; nothing will be rendered.")}isColorScaleValid(){const{colorKey:t}=this.properties;if(!t)return!1;const{dataModel:e,processedData:i}=this;if(!e||!i)return!1;const o=e.resolveProcessedDataIndexById(this,"colorValue"),s=i.data.length,a=mP(this,i.defs.values[o].missing);return!(s===0||s===a)}getLabelLayout(t,e,i,o,s){if(e==null||o==null)return;const{idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h,padding:p,label:u}=this.properties,y=this.getLabelText(u,{value:e,datum:t,idKey:a,idName:n,colorKey:r,colorName:l,labelKey:c,labelName:h});if(y==null)return;const g=vP.measureText(String(y),{font:i}),f=y.split(`
`).length,m=(g.width+2*p)/(f*OS.getLineHeight(u.fontSize)+2*p);if(s?.geometry===o&&s?.labelText===y&&s?.aspectRatio===m)return s;const v=Lo(o,ES),b=yl(v);if(b==null)return;const S=sP(b,{aspectRatio:m,precision:.001});if(S==null)return;const{x,y:M,maxWidth:T}=S;return{geometry:o,labelText:y,aspectRatio:m,x,y:M,maxWidth:T,fixedPolygon:b}}getLabelDatum(t,e){const{scale:i}=this;if(i==null)return;const{padding:o,label:s}=this.properties,{labelText:a,aspectRatio:n,x:r,y:l,maxWidth:c,fixedPolygon:h}=t,p={width:Math.ceil(c*e),height:Math.ceil(c*e/n),meta:r},u=xn(a,s,{padding:o},(x,M)=>{if(!M)return p;const T=lP(h,r,l,x/e);return{width:T.width*e,height:x,meta:T.x}});if(u==null)return;const[{text:y,fontSize:g,lineHeight:f,width:m},v]=u;if(y===OS.EllipsisChar)return;const b=m<p.width?r:v,S=this.scale.convert(ES.invert([b,l]));return{x:S[0],y:S[1],text:y,fontSize:g,lineHeight:f}}async createNodeData(){const{id:t,dataModel:e,processedData:i,colorScale:o,properties:s,scale:a,previousLabelLayouts:n}=this,{idKey:r,colorKey:l,labelKey:c,label:h,fill:p}=s;if(e==null||i==null)return;const u=a!=null?(a.range[1][0]-a.range[0][0])/a.bounds.width:NaN,y=this.isColorScaleValid(),g=e.resolveProcessedDataIndexById(this,"idValue"),f=e.resolveProcessedDataIndexById(this,"featureValue"),m=c!=null?e.resolveProcessedDataIndexById(this,"labelValue"):void 0,v=l!=null?e.resolveProcessedDataIndexById(this,"colorValue"):void 0,b=h.getFont(),S=new Map;this.previousLabelLayouts=S;const x=[],M=[],T=[];i.data.forEach(({datum:D,values:I})=>{const N=I[g],O=v!=null?I[v]:void 0,L=m!=null?I[m]:void 0,C=I[f]?.geometry;C==null&&T.push(N);const k=y&&O!=null?o.convert(O):void 0,E=this.getLabelLayout(D,L,b,C,n?.get(N));E!=null&&S.set(N,E);const _=E!=null&&a!=null?this.getLabelDatum(E,u):void 0;_!=null&&M.push(_);const w=C!=null&&a!=null?Lo(C,a):void 0;x.push({series:this,itemId:r,datum:D,idValue:N,colorValue:O,labelValue:L,fill:k??p,projectedGeometry:w})});const A=10;if(T.length>A){const D=T.length-A;T.length=A,T.push(`(+${D} more)`)}return T.length>0&&CS.warnOnce("some data items do not have matches in the provided topology",T),{itemId:t,nodeData:x,labelData:M}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update(){const{datumSelection:t,labelSelection:e,highlightDatumSelection:i}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let o=this.ctx.highlightManager?.getActiveHighlight();o!=null&&(o.series!==this||o.datum==null)&&(o=void 0);const s=this.contextNodeData?.nodeData??[],a=this.contextNodeData?.labelData??[];this.datumSelection=await this.updateDatumSelection({nodeData:s,datumSelection:t}),await this.updateDatumNodes({datumSelection:t,isHighlight:!1}),this.labelSelection=await this.updateLabelSelection({labelData:a,labelSelection:e}),await this.updateLabelNodes({labelSelection:e}),this.highlightDatumSelection=await this.updateDatumSelection({nodeData:o!=null?[o]:[],datumSelection:i}),await this.updateDatumNodes({datumSelection:i,isHighlight:!0})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>xP(e.idValue))}async updateDatumNodes(t){const{id:e,properties:i,ctx:{callbackCache:o}}=this,{datumSelection:s,isHighlight:a}=t,{idKey:n,colorKey:r,labelKey:l,fillOpacity:c,stroke:h,strokeOpacity:p,lineDash:u,lineDashOffset:y,itemStyler:g}=i,f=a?i.highlightStyle.item:void 0,m=this.getStrokeWidth(i.strokeWidth);s.each((v,b)=>{const{projectedGeometry:S}=b;if(S==null){v.visible=!1,v.projectedGeometry=void 0;return}let x;g!=null&&(x=o.call(g,{seriesId:e,datum:b.datum,idKey:n,colorKey:r,labelKey:l,fill:b.fill,fillOpacity:c,strokeOpacity:p,stroke:h,strokeWidth:m,lineDash:u,lineDashOffset:y,highlighted:a})),v.visible=!0,v.projectedGeometry=S,v.fill=f?.fill??x?.fill??b.fill,v.fillOpacity=f?.fillOpacity??x?.fillOpacity??c,v.stroke=f?.stroke??x?.stroke??h,v.strokeWidth=f?.strokeWidth??x?.strokeWidth??m,v.strokeOpacity=f?.strokeOpacity??x?.strokeOpacity??p,v.lineDash=f?.lineDash??x?.lineDash??u,v.lineDashOffset=f?.lineDashOffset??x?.lineDashOffset??y})}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontFamily:a}=this.properties.label;e.each((n,{x:r,y:l,text:c,fontSize:h,lineHeight:p})=>{n.visible=!0,n.x=r,n.y=l,n.text=c,n.fill=i,n.fontStyle=o,n.fontWeight=s,n.fontSize=h,n.lineHeight=p,n.fontFamily=a,n.textAlign="center",n.textBaseline="middle"})}onLegendItemClick(t){const{legendItemName:e}=this.properties,{enabled:i,itemId:o,series:s}=t,a=e!=null&&e===t.legendItemName;(s.id===this.id||a)&&this.toggleSeriesItem(o,i)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,{legendItemName:a}=this.properties,n=a!=null&&a===t.legendItemName;o.id===this.id||n?this.toggleSeriesItem(i,!0):e&&s===1?this.toggleSeriesItem(i,!0):this.toggleSeriesItem(i,!1)}resetAnimation(){}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}datumMidPoint(t){const{_previousDatumMidPoint:e}=this;if(e?.datum===t)return e.point;const i=t.projectedGeometry,o=i!=null?yl(i):void 0,s=o!=null?sp(o,2):void 0,a=s!=null?{x:s[0],y:s[1]}:void 0;return this._previousDatumMidPoint={datum:t,point:a},a}getLegendData(t){const{processedData:e,dataModel:i}=this;if(e==null||i==null)return[];const{title:o,legendItemName:s,idKey:a,idName:n,fill:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:p,colorKey:u,colorName:y,colorRange:g,visible:f}=this.properties;if(t==="gradient"&&u!=null&&g!=null){const m=e.domain.values[i.resolveProcessedDataIndexById(this,"colorValue")];return[{legendType:"gradient",enabled:f,seriesId:this.id,colorName:y,colorRange:g,colorDomain:m}]}else return t==="category"?[{legendType:"category",id:this.id,itemId:s??o??n??a,seriesId:this.id,enabled:f,label:{text:s??o??n??a},symbols:[{marker:{fill:r,fillOpacity:l,stroke:c,strokeWidth:h,strokeOpacity:p}}],legendItemName:s}]:[]}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return rp.EMPTY_TOOLTIP_CONTENT;const{legendItemName:a,idKey:n,idName:r,colorKey:l,colorName:c,labelKey:h,labelName:p,stroke:u,strokeWidth:y,strokeOpacity:g,fillOpacity:f,lineDash:m,lineDashOffset:v,itemStyler:b,tooltip:S}=s,{datum:x,fill:M,idValue:T,colorValue:A,labelValue:D,itemId:I}=t,N=Al(s.title??a)??"",O=[];O.push(Al((r!=null?`${r}: `:"")+T)),A!=null&&O.push(Al((c??l)+": "+A)),D!=null&&h!==n&&O.push(Al((p??h)+": "+D));const L=O.join("<br>");let C;b&&(C=o.call(b,{seriesId:e,datum:x,idKey:n,colorKey:l,labelKey:h,fill:M,stroke:u,strokeWidth:this.getStrokeWidth(y),highlighted:!1,fillOpacity:f,strokeOpacity:g,lineDash:m,lineDashOffset:v}));const k=C?.fill??M;return S.toTooltipHtml({title:N,content:L,backgroundColor:k},{seriesId:e,datum:x,idKey:n,title:N,color:k,colorKey:l,colorName:c,idName:r,itemId:I,labelKey:h,labelName:p,...this.getModuleTooltipParams()})}computeFocusBounds(t){return rS(this,t)}};Dl.className="MapShapeSeries",Dl.type="map-shape",d([bP(zi,{optional:!0,property:"topology"})],Dl.prototype,"_chartTopology",2);var{DEFAULT_INVERTED_LABEL_COLOUR:DP,DEFAULT_DIVERGING_SERIES_COLOR_RANGE:kP,DEFAULT_BACKGROUND_COLOUR:IP,singleSeriesPaletteFactory:NP}=tP,OP={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["topology"],identifier:"map-shape",moduleFactory:t=>new Dl(t),tooltipDefaults:{range:"exact"},themeTemplate:{...An,series:{fillOpacity:1,strokeWidth:1,lineDash:[0],lineDashOffset:0,padding:2,label:{color:DP,fontWeight:"bold",overflowStrategy:"hide"}}},paletteFactory:t=>{const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fill:a}=NP(t),n=s.get(kP),{fills:r}=e(i);return{fill:a,stroke:s.get(IP),colorRange:o==="inbuilt"?n:[r[0],r[1]]}}};import{_Theme as hp}from"ag-charts-community";import{_Scene as LP}from"ag-charts-community";import{_ModuleSupport as kl,_Scale as CP,_Scene as EP,_Util as _P}from"ag-charts-community";var{isDefined:RP,ChartAxisDirection:no,PolarAxis:wP,diff:PP,fixNumericExtent:BP,groupAccumulativeValueProperty:_S,keyProperty:zP,mergeDefaults:FP,normaliseGroupTo:VP,resetLabelFn:UP,seriesLabelFadeInAnimation:HP,seriesLabelFadeOutAnimation:GP,valueProperty:WP,animationValidation:KP,formatValue:YP,SeriesNodePickMode:RS}=kl,{BandScale:jP}=CP,{motion:wS}=EP,{isNumber:XP,normalizeAngle360:PS,sanitizeHtml:BS}=_P,ZP=class extends kl.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},zS=class extends kl.PolarSeries{constructor(t,{animationResetFns:e}){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,pickModes:[RS.NEAREST_NODE,RS.EXACT_SHAPE_MATCH],animationResetFns:{...e,label:UP}}),this.NodeEvent=ZP,this.groupScale=new jP,this.circleCache={r:0,cx:0,cy:0}}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===no.X)return e.getDomain(this,"angleValue","key",i);{const o=e.getDomain(this,"radiusValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return BP(s)}}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o,visible:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!(s||a))return;const n=this.getStackId(),r=`${n}-trailing`,l=[];RP(o)&&l.push(VP([n,r],Math.abs(o),"range")),a&&this.processedData&&l.push(PP(this.processedData)),a&&l.push(KP());const c=s||!a?{}:{forceValue:0},h=this.axes[no.Y]?.scale.type,p=this.axes[no.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[zP(e,p,{id:"angleValue"}),WP(i,h,{id:"radiusValue-raw",invalidValue:null,...c}),..._S(i,"normal","current",{id:"radiusValue-end",rangeId:"radiusValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},h),..._S(i,"trailing","current",{id:"radiusValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},h),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}isRadiusAxisReversed(){return this.axes[no.Y]?.isReversed()}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[no.Y];return t instanceof wP?this.radius*t.innerRadiusRatio:0}async createNodeData(){const{processedData:t,dataModel:e,groupScale:i}=this;if(!t||!e||!this.properties.isValid())return;const o=this.axes[no.X],s=this.axes[no.Y],a=o?.scale,n=s?.scale;if(!a||!n)return;const r=e.resolveProcessedDataIndexById(this,"radiusValue-start"),l=e.resolveProcessedDataIndexById(this,"radiusValue-end"),c=e.resolveProcessedDataIndexById(this,"radiusValue-range"),h=e.resolveProcessedDataIndexById(this,"radiusValue-raw");let p=0,u=0;o instanceof Vo&&(p=o.groupPaddingInner,u=o.paddingInner);const g=(a.bandwidth??0)*(1-u),{index:f,visibleGroupCount:m}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);i.domain=Array.from({length:m}).map((C,k)=>String(k)),i.range=[-g/2,g/2],i.paddingInner=m>1?p:0;const v=this.isRadiusAxisReversed(),b=v?this.radius:this.getAxisInnerRadius(),S=v?this.getAxisInnerRadius():this.radius,x=S+b,{angleKey:M,radiusKey:T,angleName:A,radiusName:D,label:I}=this.properties,N=(C,k,E,_)=>{const w=this.getLabelText(I,{value:k,datum:C,angleKey:M,radiusKey:T,angleName:A,radiusName:D},YP);if(w)return{x:E,y:_,text:w,textAlign:"center",textBaseline:"middle"}},O=[],L={itemId:T,nodeData:O,labelData:O};return this.visible?(t.data.forEach((C,k,E)=>{const{datum:_,keys:w,values:B,aggValues:P}=C,R=w[0],z=B[h],F=z>=0&&!Object.is(z,-0),U=B[r],G=B[l],V=P?.[c][F?1:0]??0,j=F===v;if(U===void 0||G===void 0)return;let K,Z;if(E.length===1)K=-.5*Math.PI,Z=1.5*Math.PI;else{const pt=a.convert(R);K=PS(pt+i.convert(String(f))),Z=PS(K+i.bandwidth)}const gt=K+i.bandwidth/2,nt=x-n.convert(U),et=x-n.convert(G),tt=(nt+et)/2,ht=x-n.convert(0),yt=x-n.convert(V),it=Math.cos(gt)*tt,$=Math.sin(gt)*tt,Tt=this.properties.label.enabled?N(_,z,it,$):void 0,Vt=this.getColumnWidth(K,Z);O.push({series:this,datum:_,point:{x:it,y:$,size:0},midPoint:{x:it,y:$},label:Tt,angleValue:R,radiusValue:z,negative:j,innerRadius:nt,outerRadius:et,stackInnerRadius:ht,stackOuterRadius:yt,startAngle:K,endAngle:Z,axisInnerRadius:b,axisOuterRadius:S,columnWidth:Vt,index:k})}),{itemId:T,nodeData:O,labelData:O}):L}getColumnWidth(t,e){return NaN}async update({seriesRect:t}){const e=this.checkResize(t);await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(t,e){let i=[];if(e){const g=this.ctx.highlightManager?.getActiveHighlight();g?.datum&&g.series===this&&(i=[g])}else i=this.nodeData;const{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,strokeWidth:r,lineDash:l,lineDashOffset:c,cornerRadius:h,angleKey:p,radiusKey:u}=FP(e?this.properties.highlightStyle.item:null,this.properties),y=g=>g.angleValue;t.update(i,void 0,y).each((g,f)=>{const m=this.properties.itemStyler?this.ctx.callbackCache.call(this.properties.itemStyler,{datum:f.datum,fill:o,fillOpacity:s,stroke:a,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:c,cornerRadius:h,highlighted:e,angleKey:p,radiusKey:u,seriesId:this.id}):void 0;this.updateItemPath(g,f,e,m),g.fill=m?.fill??o,g.fillOpacity=m?.fillOpacity??s,g.stroke=m?.stroke??a,g.strokeWidth=m?.strokeWidth??r,g.strokeOpacity=m?.strokeOpacity??n,g.lineDash=m?.lineDash??l,g.lineDashOffset=m?.lineDashOffset??c,g.cornerRadius=m?.cornerRadius??h,g.lineJoin="round"})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getColumnTransitionFunctions();wS.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),HP(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getColumnTransitionFunctions();wS.fromToMotion(this.id,"datums",e,[t],i),GP(this,"labels",e,this.labelSelection)}getTooltipHtml(t){const{id:e,axes:i,dataModel:o}=this,{angleKey:s,radiusKey:a,angleName:n,radiusName:r,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,cornerRadius:f,itemStyler:m,tooltip:v}=this.properties,{angleValue:b,radiusValue:S,datum:x,itemId:M}=t,T=i[no.X],A=i[no.Y];if(!this.properties.isValid()||!(T&&A&&XP(S))||!o)return kl.EMPTY_TOOLTIP_CONTENT;const D=T.formatDatum(b),I=A.formatDatum(S),N=BS(r),O=BS(`${D}: ${I}`),{fill:L}=(m&&this.ctx.callbackCache.call(m,{highlighted:!1,seriesId:e,datum:x,angleKey:s,radiusKey:a,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,cornerRadius:f}))??{fill:l};return v.toTooltipHtml({title:N,backgroundColor:l,content:O},{seriesId:e,datum:x,color:L,title:N,angleKey:s,radiusKey:a,angleName:n,radiusName:r,angleValue:b,itemId:M,radiusValue:S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{radiusKey:e,radiusName:i,fill:o,stroke:s,fillOpacity:a,strokeOpacity:n,strokeWidth:r,visible:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:l,label:{text:i??e},symbols:[{marker:{fill:o??"rgba(0, 0, 0, 0)",stroke:s??"rgba(0, 0, 0, 0)",fillOpacity:a??1,strokeOpacity:n??1,strokeWidth:r}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}computeLabelsBBox(){return null}};import{_ModuleSupport as $P,_Scene as QP}from"ag-charts-community";var{Label:qP}=QP,{SeriesProperties:JP,SeriesTooltip:t1,Validate:jt,COLOR_STRING:FS,DEGREE:e1,FUNCTION:i1,LINE_DASH:o1,NUMBER:s1,OBJECT:VS,POSITIVE_NUMBER:dp,RATIO:US,STRING:Nn}=$P,Et=class extends JP{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new qP,this.tooltip=new t1}};d([jt(Nn)],Et.prototype,"angleKey",2),d([jt(Nn,{optional:!0})],Et.prototype,"angleName",2),d([jt(Nn)],Et.prototype,"radiusKey",2),d([jt(Nn,{optional:!0})],Et.prototype,"radiusName",2),d([jt(FS)],Et.prototype,"fill",2),d([jt(US)],Et.prototype,"fillOpacity",2),d([jt(FS)],Et.prototype,"stroke",2),d([jt(dp)],Et.prototype,"strokeWidth",2),d([jt(US)],Et.prototype,"strokeOpacity",2),d([jt(o1)],Et.prototype,"lineDash",2),d([jt(dp)],Et.prototype,"lineDashOffset",2),d([jt(dp)],Et.prototype,"cornerRadius",2),d([jt(i1,{optional:!0})],Et.prototype,"itemStyler",2),d([jt(e1)],Et.prototype,"rotation",2),d([jt(Nn,{optional:!0})],Et.prototype,"stackGroup",2),d([jt(s1,{optional:!0})],Et.prototype,"normalizedTo",2),d([jt(VS)],Et.prototype,"label",2),d([jt(VS)],Et.prototype,"tooltip",2);import{_Scene as a1}from"ag-charts-community";import{_Scene as n1}from"ag-charts-community";var{motion:r1}=n1;function HS(){const t={startAngle:new Map,endAngle:new Map},e=["startAngle","endAngle"],i=(n,r,l)=>{e.forEach(c=>{const h=t[c];let p=(l==="removed"||l==="updated"?n:r)[c],u=(l==="removed"?n:r)[c];isNaN(u)&&(u=n.previousDatum?.[c]??NaN);const y=p-u;Math.abs(y)>Math.PI&&(p-=Math.sign(y)*2*Math.PI),h.set(r,{from:p,to:u})})},o=(n,r)=>({startAngle:t.startAngle.get(n)[r],endAngle:t.endAngle.get(n)[r]});return{calculate:i,from:n=>o(n,"from"),to:n=>o(n,"to")}}function GS(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.startAngle)||isNaN(t.previousDatum.endAngle))return"added";if(isNaN(e.startAngle)||isNaN(e.endAngle))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function l1(t){const e=HS();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p,u,y;return n==="removed"?(c=s.innerRadius,h=s.innerRadius,p=s.columnWidth,u=s.axisInnerRadius,y=s.axisOuterRadius):(c=isNaN(a.innerRadius)?t:a.innerRadius,h=isNaN(a.outerRadius)?t:a.outerRadius,p=isNaN(a.columnWidth)?s.columnWidth:a.columnWidth,u=a.axisInnerRadius,y=a.axisOuterRadius),{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:y,startAngle:r,endAngle:l}},fromFn:(s,a,n)=>{n=GS(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p,u,y;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.columnWidth,u=s.axisInnerRadius,y=s.axisOuterRadius):(c=t,h=t,p=a.columnWidth,u=a.axisInnerRadius,y=a.axisOuterRadius);const g=r1.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,columnWidth:p,axisInnerRadius:u,axisOuterRadius:y,startAngle:r,endAngle:l,phase:g}}}}function c1(t,{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}){return{innerRadius:e,outerRadius:i,columnWidth:o,axisInnerRadius:s,axisOuterRadius:a,startAngle:n,endAngle:r}}var{SectorBox:Il,motion:h1}=a1;function pp(t){const{negative:e,innerRadius:i,outerRadius:o,stackInnerRadius:s,stackOuterRadius:a}=t;return{innerRadius:e?a:s,outerRadius:e?s:a,clipInnerRadius:e?o:i,clipOuterRadius:e?i:o}}function d1(t){const e=HS();return{toFn:(s,a,n)=>{const{startAngle:r,endAngle:l}=e.to(a);let c,h,p;if(n==="removed")c=t,h=t,p=new Il(r,l,c,h);else{let u,y;({innerRadius:c,outerRadius:h,clipInnerRadius:u,clipOuterRadius:y}=pp(a)),isNaN(c)&&(c=t),isNaN(h)&&(h=t),isNaN(u)&&(u=t),isNaN(y)&&(y=t),p=new Il(r,l,u,y)}return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p}},fromFn:(s,a,n)=>{n=GS(s,a,n),e.calculate(s,a,n);const{startAngle:r,endAngle:l}=e.from(a);let c,h,p;n==="removed"||n==="updated"?(c=s.innerRadius,h=s.outerRadius,p=s.clipSector):(c=t,h=t),p??(p=new Il(r,l,c,h));const u=h1.NODE_UPDATE_STATE_TO_PHASE_MAPPING[n];return{innerRadius:c,outerRadius:h,startAngle:r,endAngle:l,clipSector:p,phase:u}}}}function p1(t,e){const{startAngle:i,endAngle:o}=e,{innerRadius:s,outerRadius:a,clipInnerRadius:n,clipOuterRadius:r}=pp(e),l=new Il(i,o,n,r);return{innerRadius:s,outerRadius:a,startAngle:i,endAngle:o,clipSector:l}}var{Sector:u1,SectorBox:g1}=LP,up=class extends zS{constructor(t){super(t,{animationResetFns:{item:p1}}),this.properties=new Et}getStackId(){return`nightingale-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new u1}updateItemPath(t,e,i,o){const{negative:s}=e;if(t.centerX=0,t.centerY=0,t.startOuterCornerRadius=s?0:this.properties.cornerRadius,t.endOuterCornerRadius=s?0:this.properties.cornerRadius,t.startInnerCornerRadius=s?this.properties.cornerRadius:0,t.endInnerCornerRadius=s?this.properties.cornerRadius:0,i){const{startAngle:a,endAngle:n}=e,{innerRadius:r,outerRadius:l,clipInnerRadius:c,clipOuterRadius:h}=pp(e);t.innerRadius=r,t.outerRadius=l,t.startAngle=a,t.endAngle=n,t.clipSector=new g1(a,n,c,h)}}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return d1(t)}};up.className="NightingaleSeries",up.type="nightingale";import{_Theme as Ca}from"ag-charts-community";var y1={series:{strokeWidth:1,label:{enabled:!1,fontSize:12,fontFamily:Ca.DEFAULT_FONT_FAMILY,color:Ca.DEFAULT_LABEL_COLOUR}},axes:{[Ca.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:Ca.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[Ca.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:Ca.POLAR_AXIS_SHAPE.CIRCLE}}},f1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"nightingale",moduleFactory:t=>new up(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:hp.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:hp.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:y1,paletteFactory({takeColors:t,userPalette:e}){const{fills:[i],strokes:[o]}=t(1);return{fill:i,stroke:e!=="inbuilt"?o:hp.DEFAULT_POLAR_SERIES_STROKE}},stackable:!0,groupable:!0,stackedByDefault:!0};import{_Theme as Ea}from"ag-charts-community";import{_ModuleSupport as m1}from"ag-charts-community";import{_Scene as bs}from"ag-charts-community";var x1=class extends eo{constructor(){super(),this.append([new bs.Line({tag:0}),new bs.Line({tag:1}),new bs.Line({tag:2})])}updateCoordinates(){const{x:t,y:e,yBottom:i,yHigh:o,yLow:s,width:a,height:n,datum:{itemId:r}}=this,l=bs.Selection.select(this,bs.Rect),[c]=l.selectByTag(0),[h]=l.selectByTag(1),[p]=l.selectByTag(2);if(a===0||n===0){c.visible=!1,h.visible=!1,p.visible=!1;return}c.visible=!0,h.visible=!0,p.visible=!0;const u=a/2;c.setProperties({x1:Math.floor(t+u),x2:Math.floor(t+u),y1:o,y2:s});const y=r==="up",g=y?i:e,f=y?e:i;h.setProperties({x1:Math.floor(t),x2:Math.floor(t+u),y:Math.round(g)}),p.setProperties({x1:Math.floor(t+u),x2:Math.floor(t+a),y:Math.round(f)})}updateDatumStyles(t,e){const i=bs.Selection.select(this,bs.Rect),[o]=i.selectByTag(0),[s]=i.selectByTag(1),[a]=i.selectByTag(2);o.setProperties(e),s.setProperties(e),a.setProperties(e)}};import{_ModuleSupport as S1}from"ag-charts-community";var{BaseProperties:WS,Validate:Vi,COLOR_STRING:b1,FUNCTION:KS,LINE_DASH:v1,OBJECT:gp,POSITIVE_NUMBER:YS,RATIO:M1}=S1,Eo=class extends WS{constructor(){super(...arguments),this.stroke="#333",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([Vi(b1)],Eo.prototype,"stroke",2),d([Vi(YS)],Eo.prototype,"strokeWidth",2),d([Vi(M1)],Eo.prototype,"strokeOpacity",2),d([Vi(v1)],Eo.prototype,"lineDash",2),d([Vi(YS)],Eo.prototype,"lineDashOffset",2),d([Vi(KS,{optional:!0})],Eo.prototype,"itemStyler",2);var yp=class extends WS{constructor(){super(...arguments),this.up=new Eo,this.down=new Eo}};d([Vi(gp)],yp.prototype,"up",2),d([Vi(gp)],yp.prototype,"down",2);var fp=class extends le{constructor(){super(...arguments),this.item=new yp}};d([Vi(gp)],fp.prototype,"item",2),d([Vi(KS,{optional:!0})],fp.prototype,"itemStyler",2);var{mergeDefaults:jS}=m1,mp=class extends Bm{constructor(t){super(t,Lm),this.properties=new fp}async createNodeData(){const t=this.createBaseNodeData();if(!t)return;const e=t.nodeData.map(i=>{const{stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}=this.getItemConfig(i.itemId);return{...i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,lineDashOffset:r}});return{...t,nodeData:e}}getFormattedStyles(t,e=!1){const{id:i,ctx:{callbackCache:o}}=this,{xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,itemStyler:c}=this.properties,{stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g}=this.getItemConfig(t.itemId);if(c){const f=o.call(c,{datum:t.datum,itemId:t.itemId,seriesId:i,highlighted:e,xKey:s,openKey:a,closeKey:n,highKey:r,lowKey:l,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g});if(f)return jS(f,this.getSeriesStyles(t))}return this.getSeriesStyles(t)}nodeFactory(){return new x1}getSeriesStyles(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=t;return{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}}getActiveStyles(t,e){const i=this.getFormattedStyles(t,e);return e?jS(this.properties.highlightStyle.item,i):i}computeFocusBounds(t){return Em(this,t)}};mp.className="ohlc",mp.type="ohlc";var T1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"ohlc",moduleFactory:t=>new mp(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Ea.CARTESIAN_AXIS_TYPE.NUMBER,position:Ea.CARTESIAN_POSITION.LEFT},{type:Ea.CARTESIAN_AXIS_TYPE.ORDINAL_TIME,position:Ea.CARTESIAN_POSITION.BOTTOM}],themeTemplate:{animation:{enabled:!1},axes:{[Ea.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{snap:!1}},[Ea.CARTESIAN_AXIS_TYPE.ORDINAL_TIME]:{groupPaddingInner:0,crosshair:{enabled:!0}}}},groupable:!1,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{strokes:[s]}=t(e);return{item:{up:{stroke:s},down:{stroke:s}}}}return{item:{up:{stroke:o.up.stroke},down:{stroke:o.down.stroke}}}}};import"ag-charts-community";import{_ModuleSupport as xp,_Scene as A1,_Util as D1}from"ag-charts-community";import{_ModuleSupport as k1,_Scene as I1}from"ag-charts-community";var{Label:XS,DropShadow:N1}=I1,{SeriesProperties:O1,SeriesTooltip:L1,Validate:_t,UNION:C1,COLOR_STRING_ARRAY:ZS,FUNCTION:E1,DIRECTION:_1,BOOLEAN:R1,LINE_DASH:w1,OBJECT:Nl,NUMBER:P1,POSITIVE_NUMBER:Ol,RATIO:$S,STRING:QS}=k1,B1=class extends XS{},Sp=class extends XS{constructor(){super(...arguments),this.spacing=0}};d([_t(P1)],Sp.prototype,"spacing",2),d([_t(C1(["before","after"],"a placement"))],Sp.prototype,"placement",2);var zt=class extends O1{constructor(){super(...arguments),this.fills=[],this.fillOpacity=1,this.strokes=[],this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.direction="vertical",this.reverse=void 0,this.spacing=0,this.aspectRatio=void 0,this.shadow=new N1().set({enabled:!1}),this.label=new B1,this.stageLabel=new Sp,this.tooltip=new L1}};d([_t(QS)],zt.prototype,"stageKey",2),d([_t(QS)],zt.prototype,"valueKey",2),d([_t(ZS)],zt.prototype,"fills",2),d([_t($S)],zt.prototype,"fillOpacity",2),d([_t(ZS)],zt.prototype,"strokes",2),d([_t(Ol)],zt.prototype,"strokeWidth",2),d([_t($S)],zt.prototype,"strokeOpacity",2),d([_t(w1)],zt.prototype,"lineDash",2),d([_t(Ol)],zt.prototype,"lineDashOffset",2),d([_t(_1)],zt.prototype,"direction",2),d([_t(R1,{optional:!0})],zt.prototype,"reverse",2),d([_t(Ol)],zt.prototype,"spacing",2),d([_t(Ol,{optional:!0})],zt.prototype,"aspectRatio",2),d([_t(E1,{optional:!0})],zt.prototype,"itemStyler",2),d([_t(Nl)],zt.prototype,"shadow",2),d([_t(Nl)],zt.prototype,"label",2),d([_t(Nl)],zt.prototype,"stageLabel",2),d([_t(Nl)],zt.prototype,"tooltip",2);var{valueProperty:qS,SeriesNodePickMode:JS,CachedTextMeasurerPool:z1,TextUtils:F1}=xp,{BBox:bp,Group:vp,Selection:Ll,Text:tb,PointerEvents:eb}=A1,{sanitizeHtml:ib}=D1,V1=class extends xp.DataModelSeries{constructor(t){super({moduleCtx:t,pickModes:[JS.EXACT_SHAPE_MATCH,JS.NEAREST_NODE]}),this.properties=new zt,this.itemGroup=this.contentGroup.appendChild(new vp({name:"itemGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new vp({name:"itemLabelGroup"})),this.stageLabelGroup=this.contentGroup.appendChild(new vp({name:"stageLabelGroup"})),this.datumSelection=Ll.select(this.itemGroup,()=>this.nodeFactory()),this.labelSelection=Ll.select(this.itemLabelGroup,tb),this.stageLabelSelection=Ll.select(this.stageLabelGroup,tb),this.highlightDatumSelection=Ll.select(this.highlightNode,()=>this.nodeFactory()),this.itemLabelGroup.pointerEvents=eb.None,this.stageLabelGroup.pointerEvents=eb.None}nodeFactory(){return new Ri}getNodeData(){return this.contextNodeData?.nodeData}async processData(t){if(this.data==null||!this.properties.isValid())return;const{stageKey:e,valueKey:i}=this.properties,o="band",s="number",a=this.visible?{}:{forceValue:0};await this.requestDataModel(t,this.data,{props:[qS(e,o,{id:"xValue"}),qS(i,s,{id:"yValue",...a})]})}async createNodeData(){const{id:t,dataModel:e,processedData:i,properties:o}=this,{stageKey:s,valueKey:a,fills:n,strokes:r,direction:l,reverse:c=l==="horizontal",spacing:h,aspectRatio:p,label:u,stageLabel:y}=o;if(e==null||i==null)return;const g=l==="horizontal",f=e.resolveProcessedDataIndexById(this,"xValue"),m=e.resolveProcessedDataIndexById(this,"yValue"),v=z1.getMeasurer({font:y.getFont()});let b,S;g?(b="center",S=y.placement==="before"?"bottom":"top"):(b=y.placement==="after"?"left":"right",S="middle");const x=y.enabled?[]:void 0;let M=0,T=0,A=0;i.data.forEach(({datum:P,values:R})=>{const z=R[f],F=Number(R[m]);if(A+=F,x==null)return;const U=this.getLabelText(this.properties.stageLabel,{datum:P,value:z,stageKey:s,valueKey:a}),{width:G}=v.measureText(U),V=U.split(`
`).length*F1.getLineHeight(u.fontSize);M=Math.max(M,G),T=Math.max(T,V),x.push({x:NaN,y:NaN,text:U,textAlign:b,textBaseline:S})});const D=this._nodeDataDependencies?.seriesRectWidth??0,I=this._nodeDataDependencies?.seriesRectHeight??0,N=h*(i.data.length-1);let O;if(g){const P=T+y.spacing;O=new bp(0,y.placement==="before"?P:0,D,I-P)}else{const P=M+y.spacing;O=new bp(y.placement==="after"?0:P,0,D-P,I)}if(p!=null&&p!==0){const P=l==="horizontal"?1/p:p,R=Math.min(O.width,O.height*P),z=R/P;O=new bp(O.x+(O.width-R)/2,O.y+(O.height-z)/2,R,z)}let L,C;g?C=y.placement==="before"?O.y-y.spacing:O.y+O.height+y.spacing:L=y.placement==="after"?O.x+O.width+y.spacing:O.x-y.spacing;const k=O.width-(g?N:0),E=O.height-(g?0:N);if(k<0||E<0)return;const _=[],w=[];let B=0;return i.data.forEach(({datum:P,values:R},z)=>{const F=R[f],U=Number(R[m]),G=B+U,V=(B+G)/(2*A),j=(G-B)/A,K=g?k*V+h*z:k*.5,Z=g?E*.5:E*V+h*z,gt=O.x+K,nt=O.y+Z;if(x!=null){const pt=x[z];pt.x=L??gt,pt.y=C??nt}let et,tt,ht,yt;if(g){const pt=k*j;et=pt,ht=pt;const ye=(K+pt/2)*(E/O.width),Ut=(K-pt/2)*(E/O.width);tt=c?O.height-ye:ye,yt=c?O.height-Ut:Ut}else{const pt=E*j;tt=pt,yt=pt;const ye=(Z-pt/2)*(k/O.height),Ut=(Z+pt/2)*(k/O.height);et=c?O.width-ye:ye,ht=c?O.width-Ut:Ut}const it=this.getLabelText(u,{datum:P,value:U,stageKey:s,valueKey:a}),$={x:gt,y:nt,text:it,textAlign:"center",textBaseline:"middle"};w.push($);const Tt=n[z%n.length]??"black",Vt=r[z%r.length]??"black";_.push({series:this,itemId:a,datum:P,index:z,xValue:F,yValue:U,x:gt,y:nt,fill:Tt,stroke:Vt,top:et,right:tt,bottom:ht,left:yt,label:$}),B=G}),{itemId:t,nodeData:_,labelData:w,stageLabelData:x}}async updateSelections(){this.nodeDataRefresh&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}async update({seriesRect:t}){this.checkResize(t);const{datumSelection:e,labelSelection:i,stageLabelSelection:o,highlightDatumSelection:s}=this;await this.updateSelections(),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();let a=this.ctx.highlightManager?.getActiveHighlight();a!=null&&(a.series!==this||a.datum==null)&&(a=void 0);const n=this.contextNodeData?.nodeData??[],r=this.contextNodeData?.labelData??[],l=this.contextNodeData?.stageLabelData??[];this.datumSelection=await this.updateDatumSelection({nodeData:n,datumSelection:e}),await this.updateDatumNodes({datumSelection:e,isHighlight:!1}),this.labelSelection=await this.updateLabelSelection({labelData:r,labelSelection:i}),await this.updateLabelNodes({labelSelection:i}),this.stageLabelSelection=await this.updateStageLabelSelection({stageLabelData:l,stageLabelSelection:o}),await this.updateStageLabelNodes({stageLabelSelection:o}),this.highlightDatumSelection=await this.updateDatumSelection({nodeData:a!=null?[a]:[],datumSelection:s}),await this.updateDatumNodes({datumSelection:s,isHighlight:!0})}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData)}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{properties:o}=this,{stageKey:s,valueKey:a,shadow:n,itemStyler:r}=this.properties,l=i?this.properties.highlightStyle.item:void 0;e.each((c,h)=>{const{x:p,y:u,top:y,right:g,bottom:f,left:m}=h;c.x0=p-y/2,c.x1=p+y/2,c.x2=p+f/2,c.x3=p-f/2,c.y0=u-m/2,c.y1=u-g/2,c.y2=u+g/2,c.y3=u+m/2;const v=l?.fill??h.fill,b=l?.fillOpacity??o.fillOpacity,S=l?.stroke??h.stroke,x=l?.strokeOpacity??o.strokeOpacity,M=l?.strokeWidth??o.strokeWidth,T=l?.lineDash??o.lineDash,A=l?.lineDashOffset??o.lineDashOffset;let D;r!=null&&(D=r({datum:h.datum,seriesId:this.id,highlighted:i,stageKey:s,valueKey:a,fill:v,fillOpacity:b,stroke:S,strokeOpacity:x,strokeWidth:M,lineDash:T,lineDashOffset:A})),c.fill=D?.fill??v,c.fillOpacity=D?.fillOpacity??b,c.stroke=D?.stroke??S,c.strokeOpacity=D?.strokeOpacity??x,c.strokeWidth=D?.strokeWidth??M,c.lineDash=D?.lineDash??T,c.lineDashOffset=D?.lineDashOffset??A,c.fillShadow=n})}async updateLabelSelection(t){return t.labelSelection.update(this.properties.label.enabled?t.labelData:[])}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontSize:o,fontStyle:s,fontWeight:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,text:h,textAlign:p,textBaseline:u})=>{r.visible=!0,r.x=l,r.y=c,r.text=h,r.fill=i,r.fontStyle=s,r.fontWeight=a,r.fontSize=o,r.fontFamily=n,r.textAlign=p,r.textBaseline=u})}async updateStageLabelSelection(t){return t.stageLabelSelection.update(t.stageLabelData)}async updateStageLabelNodes(t){const{stageLabelSelection:e}=t,{color:i,fontSize:o,fontStyle:s,fontWeight:a,fontFamily:n}=this.properties.stageLabel;e.each((r,{x:l,y:c,text:h,textAlign:p,textBaseline:u})=>{r.visible=!0,r.x=l,r.y=c,r.text=h,r.fill=i,r.fontStyle=s,r.fontWeight=a,r.fontSize=o,r.fontFamily=n,r.textAlign=p,r.textBaseline=u})}resetAnimation(t){}computeFocusBounds(t){const e=this.getNodeData()?.[t.datumIndex];if(e!==void 0){for(const i of this.datumSelection)if(i.datum===e)return i.node}}getTooltipHtml(t){const{id:e,ctx:{callbackCache:i}}=this;if(!this.properties.isValid())return xp.EMPTY_TOOLTIP_CONTENT;const{stageKey:o,valueKey:s,itemStyler:a,tooltip:n}=this.properties,{strokeWidth:r,fillOpacity:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=this.properties,{datum:u,xValue:y,yValue:g,fill:f,stroke:m}=t;let v;a&&(v=i.call(a,{highlighted:!1,seriesId:e,datum:u,stageKey:o,valueKey:s,fill:f,fillOpacity:l,stroke:m,strokeWidth:r,strokeOpacity:c,lineDash:h,lineDashOffset:p}));const b=v?.fill??f??"gray",S=ib(String(y)),x=ib(String(g)),M={title:S,content:x,backgroundColor:b};return n.toTooltipHtml(M,{itemId:void 0,datum:u,stageKey:o,valueKey:s,color:b,seriesId:e,title:S})}getLabelData(){return[]}getSeriesDomain(t){return[NaN,NaN]}pickNodeClosestDatum({x:t,y:e}){let i=1/0,o;return this.datumSelection.each((s,a)=>{const n=s.distanceSquared(t,e);n<i&&(i=n,o=a)}),o!=null?{datum:o,distance:Math.sqrt(i)}:void 0}getLegendData(t){return[]}};import{_Theme as Cl}from"ag-charts-community";var U1={series:{direction:"vertical",strokeWidth:0,spacing:2,label:{enabled:!0,fontSize:12,fontFamily:Cl.DEFAULT_FONT_FAMILY,color:Cl.DEFAULT_INSIDE_SERIES_LABEL_COLOUR},stageLabel:{enabled:!0,fontSize:12,fontFamily:Cl.DEFAULT_FONT_FAMILY,color:Cl.DEFAULT_LABEL_COLOUR,spacing:12}}},H1={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["standalone"],identifier:"pyramid",moduleFactory:t=>new V1(t),solo:!0,tooltipDefaults:{range:"exact"},themeTemplate:U1,paletteFactory:({takeColors:t,colorsCount:e})=>{const{fills:i,strokes:o}=t(e);return{fills:i,strokes:o}}};import{_ModuleSupport as G1,_Theme as ob}from"ag-charts-community";import{_ModuleSupport as sb,_Theme as Mp}from"ag-charts-community";var ab={series:{label:{enabled:!1,fontSize:12,fontFamily:Mp.DEFAULT_FONT_FAMILY,color:Mp.DEFAULT_LABEL_COLOUR},marker:{enabled:!0,fillOpacity:1,shape:"circle",size:6,strokeOpacity:1,strokeWidth:0}},axes:{[Mp.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{label:{padding:10}}}},W1=sb.mergeDefaults({series:{strokeWidth:2}},ab),K1=sb.mergeDefaults({series:{fillOpacity:.8,strokeWidth:2,marker:{enabled:!1}}},ab);import{_ModuleSupport as nb,_Scene as Y1}from"ag-charts-community";import{_ModuleSupport as El,_Scene as j1,_Util as Tp}from"ag-charts-community";import{_ModuleSupport as X1,_Scene as Z1}from"ag-charts-community";var{Label:$1}=Z1,{SeriesMarker:Q1,SeriesProperties:q1,SeriesTooltip:J1,Validate:Ce,BOOLEAN:tB,COLOR_STRING:eB,DEGREE:iB,LINE_DASH:oB,OBJECT:Ap,POSITIVE_NUMBER:rb,RATIO:sB,STRING:_l}=X1,pe=class extends q1{constructor(){super(...arguments),this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.rotation=0,this.marker=new Q1,this.label=new $1,this.tooltip=new J1,this.connectMissingData=!1}};d([Ce(_l)],pe.prototype,"angleKey",2),d([Ce(_l)],pe.prototype,"radiusKey",2),d([Ce(_l,{optional:!0})],pe.prototype,"angleName",2),d([Ce(_l,{optional:!0})],pe.prototype,"radiusName",2),d([Ce(eB)],pe.prototype,"stroke",2),d([Ce(rb)],pe.prototype,"strokeWidth",2),d([Ce(sB)],pe.prototype,"strokeOpacity",2),d([Ce(oB)],pe.prototype,"lineDash",2),d([Ce(rb)],pe.prototype,"lineDashOffset",2),d([Ce(iB)],pe.prototype,"rotation",2),d([Ce(Ap)],pe.prototype,"marker",2),d([Ce(Ap)],pe.prototype,"label",2),d([Ce(Ap)],pe.prototype,"tooltip",2),d([Ce(tB)],pe.prototype,"connectMissingData",2);var{ChartAxisDirection:ro,PolarAxis:aB,SeriesNodePickMode:lb,valueProperty:cb,fixNumericExtent:nB,seriesLabelFadeInAnimation:rB,markerFadeInAnimation:lB,resetMarkerFn:cB,animationValidation:hB,formatValue:dB,computeMarkerFocusBounds:pB}=El,{BBox:uB,Group:gB,Path:yB,PointerEvents:fB,Selection:hb,Text:mB,getMarker:xB}=j1,{extent:SB,isNumberEqual:db,sanitizeHtml:pb,toFixed:ub}=Tp,bB=class extends El.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Dp=class extends El.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,pickModes:[lb.NEAREST_NODE,lb.EXACT_SHAPE_MATCH],canHaveAxes:!0,animationResetFns:{item:cB}}),this.properties=new pe,this.NodeEvent=bB,this.resetInvalidToZero=!1,this.circleCache={r:0,cx:0,cy:0};const e=new gB;this.contentGroup.append(e),this.lineSelection=hb.select(e,yB),e.zIndexSubOrder=[()=>this._declarationOrder,1]}nodeFactory(){const{shape:t}=this.properties.marker,e=xB(t);return new e}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===ro.X)return e.getDomain(this,"angleValue","value",i);{const o=e.getDomain(this,"radiusValue","value",i),s=SB(o.length===0?o:[0].concat(o));return nB(s)}}async processData(t){if(!this.properties.isValid())return;const{angleKey:e,radiusKey:i}=this.properties,o=[];this.ctx.animationManager.isSkipped()||o.push(hB());const s=this.axes[ro.Y]?.scale.type,a=this.axes[ro.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[cb(e,a,{id:"angleValue"}),cb(i,s,{id:"radiusValue",invalidValue:void 0}),...o]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}getAxisInnerRadius(){const t=this.axes[ro.Y];return t instanceof aB?this.radius*t.innerRadiusRatio:0}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}async createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e||!this.properties.isValid())return;const{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,label:r}=this.properties,l=this.axes[ro.X]?.scale,c=this.axes[ro.Y]?.scale;if(!l||!c)return;const h=e.resolveProcessedDataIndexById(this,"angleValue"),p=e.resolveProcessedDataIndexById(this,"radiusValue"),u=this.getAxisInnerRadius(),y=t.data.map(g=>{const{datum:f,values:m}=g,v=m[h],b=m[p],S=l.convert(v),x=this.radius+u-c.convert(b),M=Math.cos(S),T=Math.sin(S),A=M*x,D=T*x;let I;if(r.enabled){const N=this.getLabelText(r,{value:b,datum:f,angleKey:i,radiusKey:o,angleName:s,radiusName:a},dB);if(N){let O="right";db(M,0)?O="center":M>0&&(O="left");let L="bottom";db(T,0)?L="middle":T>0&&(L="top"),I={x:A+M*n.size,y:D+T*n.size,text:N,textAlign:O,textBaseline:L}}}return{series:this,datum:f,point:{x:A,y:D,size:n.size},midPoint:{x:A,y:D},label:I,angleValue:v,radiusValue:b,missing:!Tp.isNumber(S)||!Tp.isNumber(x)}});return{itemId:o,nodeData:y,labelData:y}}async update({seriesRect:t}){const e=this.checkResize(t),i=!this.ctx.animationManager.isSkipped(),{series:o}=this.ctx.highlightManager?.getActiveHighlight()??{};this.highlightGroup.visible=(i||this.visible)&&o===this,await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updatePathSelections(),this.updateMarkerSelection(),this.updateMarkers(this.itemSelection,!1),this.updateMarkers(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updatePathSelections(){const t=this.visible?[!0]:[];this.lineSelection.update(t)}updateMarkerSelection(){this.properties.marker.isDirty()&&(this.itemSelection.clear(),this.itemSelection.cleanup(),this.itemSelection=hb.select(this.itemGroup,()=>this.nodeFactory(),!1)),this.itemSelection.update(this.properties.marker.enabled?this.nodeData:[])}getMarkerFill(t){return t?.fill??this.properties.marker.fill}updateMarkers(t,e){const{angleKey:i,radiusKey:o,marker:s,visible:a}=this.properties;let n=[];if(a&&s.shape&&s.enabled)if(e){const l=this.ctx.highlightManager?.getActiveHighlight();l?.datum&&(n=[l])}else n=this.nodeData;const r=e?this.properties.highlightStyle.item:void 0;t.update(n).each((l,c)=>{const h=this.getMarkerFill(r),p=r?.fillOpacity??this.properties.marker.fillOpacity,u=r?.stroke??s.stroke??this.properties.stroke,y=r?.strokeWidth??s.strokeWidth??this.properties.strokeWidth??1,g=r?.strokeOpacity??this.properties.marker.strokeOpacity,f=s.itemStyler?this.ctx.callbackCache.call(s.itemStyler,{datum:c.datum,angleKey:i,radiusKey:o,fill:h,fillOpacity:p,stroke:u,strokeWidth:y,strokeOpacity:g,shape:s.shape,size:s.size,highlighted:e,seriesId:this.id}):void 0;l.fill=f?.fill??h,l.stroke=f?.stroke??u,l.strokeWidth=f?.strokeWidth??y,l.fillOpacity=r?.fillOpacity??s.fillOpacity??1,l.strokeOpacity=s.strokeOpacity??this.properties.strokeOpacity??1,l.size=f?.size??s.size;const{x:m,y:v}=c.point;l.x=m,l.y=v,l.visible=a&&l.size>0&&!isNaN(m)&&!isNaN(v)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getTooltipHtml(t){if(!this.properties.isValid())return El.EMPTY_TOOLTIP_CONTENT;const{id:e}=this,{angleKey:i,radiusKey:o,angleName:s,radiusName:a,marker:n,tooltip:r}=this.properties,{datum:l,angleValue:c,radiusValue:h,itemId:p}=t,u=typeof c=="number"?ub(c):String(c),y=typeof h=="number"?ub(h):String(h),g=pb(a),f=pb(`${u}: ${y}`),{itemStyler:m,fill:v,fillOpacity:b,stroke:S,strokeWidth:x=this.properties.strokeWidth,strokeOpacity:M,shape:T,size:A}=n,{fill:D}=(m&&this.ctx.callbackCache.call(m,{datum:l,angleKey:i,radiusKey:o,fill:v,fillOpacity:b,stroke:S,strokeWidth:x,strokeOpacity:M,shape:T,size:A,highlighted:!1,seriesId:e}))??{fill:v};return r.toTooltipHtml({title:g,content:f,backgroundColor:D},{datum:l,angleKey:i,angleName:s,radiusKey:o,radiusName:a,title:g,color:D,seriesId:e,itemId:p})}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{radiusKey:e,radiusName:i,stroke:o,strokeWidth:s,strokeOpacity:a,lineDash:n,visible:r,marker:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:r,label:{text:i??e},symbols:[{marker:{shape:l.shape,fill:this.getMarkerFill()??l.stroke??o??"rgba(0, 0, 0, 0)",stroke:l.stroke??o??"rgba(0, 0, 0, 0)",fillOpacity:l.fillOpacity??1,strokeOpacity:l.strokeOpacity??a??1,strokeWidth:l.strokeWidth??0,enabled:l.enabled||s<=0},line:{stroke:o,strokeOpacity:a,strokeWidth:s,lineDash:n}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}pickNodeClosestDatum(t){const{nodeData:e,centerX:i,centerY:o}=this,{x:s,y:a}=t,n=this.radius;if(Math.sqrt((s-i)**2+(a-o)**2)>n+this.properties.marker.size)return;let l=1/0,c;for(const h of e){const{point:{x:p=NaN,y:u=NaN}={}}=h;if(isNaN(p)||isNaN(u))continue;const y=Math.sqrt((t.x-p-i)**2+(t.y-u-o)**2);y<l&&(l=y,c=h)}if(c){const h=Math.max(l-(c.point?.size??0),0);return{datum:c,distance:h}}}async computeLabelsBBox(){const{label:t}=this.properties;await this.maybeRefreshNodeData();const e=[],i=new mB;return this.nodeData.forEach(o=>{if(!t.enabled||!o.label)return;i.text=o.label.text,i.x=o.label.x,i.y=o.label.y,i.setFont(t),i.setAlign(o.label);const s=i.getBBox();e.push(s)}),e.length===0?null:uB.merge(e)}getLineNode(){return this.lineSelection?.at(0)}beforePathAnimation(){const t=this.getLineNode();t.fill=void 0,t.lineJoin="round",t.lineCap="round",t.pointerEvents=fB.None,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset}getLinePoints(){const{nodeData:t,resetInvalidToZero:e}=this,{connectMissingData:i}=this.properties;if(t.length===0)return[];const o=this.axes[ro.Y],a=this.axes[ro.X]?.isReversed(),r=o?.isReversed()&&!a?[...t].reverse():t,l=[];let c=!1,h;return r.forEach((p,u)=>{let{x:y,y:g}=p.point;const f=isNaN(y)||isNaN(g);f||(h??(h=p)),f&&!i&&(y=0,g=0);const m=u===0||!e&&!i&&(f||c);l.push({x:y,y:g,moveTo:m}),c=f}),h!==void 0&&l.push({x:h.point.x,y:h.point.y,moveTo:!1}),l}animateSinglePath(t,e,i){const{path:o}=t;o.clear(!0);const s=this.getAxisInnerRadius(),a=this.axes[ro.Y],r=a?.isReversed()?this.radius+s-a?.scale.convert(0):s;e.forEach(l=>{const{x:c,y:h,arc:p,radius:u=0,startAngle:y=0,endAngle:g=0,moveTo:f}=l,m=Math.atan2(h,c),v=r*Math.cos(m),b=r*Math.sin(m),S=i,x=v*(1-S)+c*S,M=b*(1-S)+h*S;p?o.arc(c,h,u,y,g):f?o.moveTo(x,M):o.lineTo(x,M)}),t.checkPathDirty()}animatePaths(t){const e=this.getLinePoints();this.animateSinglePath(this.getLineNode(),e,t)}animateEmptyUpdateReady(){const{itemSelection:t,labelSelection:e}=this,{animationManager:i}=this.ctx;this.beforePathAnimation(),i.animate({id:`${this.id}_'path`,groupId:this.id,from:0,to:1,phase:"initial",collapsable:!1,onUpdate:o=>this.animatePaths(o),onStop:()=>this.animatePaths(1)}),lB(this,i,"added",t),rB(this,"labels",i,e)}animateWaitingUpdateReady(t){super.animateWaitingUpdateReady(t),this.resetPaths()}animateReadyResize(t){super.animateReadyResize(t),this.resetPaths()}resetPaths(){const t=this.getLineNode();if(t){const{path:e}=t,i=this.getLinePoints();t.fill=void 0,t.stroke=this.properties.stroke,t.strokeWidth=this.getStrokeWidth(this.properties.strokeWidth),t.strokeOpacity=this.properties.strokeOpacity,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,e.clear(!0),i.forEach(({x:o,y:s,moveTo:a})=>{a?e.moveTo(o,s):e.lineTo(o,s)}),t.checkPathDirty()}}getFormattedMarkerStyle(t){const{angleKey:e,radiusKey:i}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,angleKey:e,radiusKey:i,highlighted:!0})}computeFocusBounds(t){return pB(this,t)}};Dp.className="RadarSeries";import{_ModuleSupport as vB}from"ag-charts-community";var{RATIO:MB,COLOR_STRING:TB,Validate:gb}=vB,kp=class extends pe{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1}};d([gb(TB)],kp.prototype,"fill",2),d([gb(MB)],kp.prototype,"fillOpacity",2);var{Group:AB,Path:DB,PointerEvents:kB,Selection:IB}=Y1,{ChartAxisDirection:yb}=nb,Ip=class extends Dp{constructor(t){super(t),this.properties=new kp,this.resetInvalidToZero=!0;const e=new AB;e.zIndexSubOrder=[()=>this._declarationOrder,0],this.contentGroup.append(e),this.areaSelection=IB.select(e,DB)}updatePathSelections(){const t=this.visible?[!0]:[];this.areaSelection.update(t),super.updatePathSelections()}getAreaNode(){return this.areaSelection.at(0)}getMarkerFill(t){return t?.fill??this.properties.marker.fill??this.properties.fill}beforePathAnimation(){super.beforePathAnimation();const t=this.getAreaNode();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.pointerEvents=kB.None,t.stroke=void 0}animatePaths(t){super.animatePaths(t),this.animateSinglePath(this.getAreaNode(),this.getAreaPoints(),t)}getAreaPoints(){const t=this.getLinePoints(),e=n=>{const r=this.axes[n];return r instanceof nb.PolarAxis?r:void 0},i=e(yb.Y),o=e(yb.X);if(!i?.isReversed())return t;const a=o?.getAxisLinePoints()?.points??[];return t.concat(...a)}resetPaths(){super.resetPaths();const t=this.getAreaNode();if(t){const{path:e}=t,i=this.getAreaPoints();t.fill=this.properties.fill,t.fillOpacity=this.properties.fillOpacity,t.stroke=void 0,t.lineDash=this.properties.lineDash,t.lineDashOffset=this.properties.lineDashOffset,t.lineJoin=t.lineCap="round",e.clear(!0),i.forEach(({x:o,y:s,moveTo:a,arc:n,radius:r=0,startAngle:l=0,endAngle:c=0})=>{n?e.arc(o,s,r,l,c):a?e.moveTo(o,s):e.lineTo(o,s)}),e.closePath(),t.checkPathDirty()}}};Ip.className="RadarAreaSeries",Ip.type="radar-area";var{markerPaletteFactory:NB}=G1,OB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-area",moduleFactory:t=>new Ip(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:ob.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:ob.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:K1,paletteFactory:t=>{const{marker:e}=NB(t);return{stroke:e.stroke,fill:e.fill,marker:e}}};import{_Theme as fb}from"ag-charts-community";var Np=class extends Dp{updatePathSelections(){this.lineSelection.update(this.visible?[!0]:[])}};Np.className="RadarLineSeries",Np.type="radar-line";var LB={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radar-line",moduleFactory:t=>new Np(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:fb.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:fb.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:W1,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{stroke:e,marker:{fill:e,stroke:i}}}};import{_Theme as mb}from"ag-charts-community";import{_ModuleSupport as Rl,_Scale as CB,_Scene as EB,_Util as _B}from"ag-charts-community";import{_ModuleSupport as RB,_Scene as wB}from"ag-charts-community";var{Label:PB}=wB,{SeriesProperties:BB,SeriesTooltip:zB,Validate:Xt,COLOR_STRING:xb,DEGREE:FB,FUNCTION:VB,LINE_DASH:UB,NUMBER:HB,OBJECT:Sb,POSITIVE_NUMBER:Op,RATIO:bb,STRING:On}=RB,Ft=class extends BB{constructor(){super(...arguments),this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.rotation=0,this.label=new PB,this.tooltip=new zB}};d([Xt(On)],Ft.prototype,"angleKey",2),d([Xt(On)],Ft.prototype,"radiusKey",2),d([Xt(On,{optional:!0})],Ft.prototype,"angleName",2),d([Xt(On,{optional:!0})],Ft.prototype,"radiusName",2),d([Xt(xb)],Ft.prototype,"fill",2),d([Xt(bb)],Ft.prototype,"fillOpacity",2),d([Xt(xb)],Ft.prototype,"stroke",2),d([Xt(Op)],Ft.prototype,"strokeWidth",2),d([Xt(bb)],Ft.prototype,"strokeOpacity",2),d([Xt(UB)],Ft.prototype,"lineDash",2),d([Xt(Op)],Ft.prototype,"lineDashOffset",2),d([Xt(Op)],Ft.prototype,"cornerRadius",2),d([Xt(VB,{optional:!0})],Ft.prototype,"itemStyler",2),d([Xt(FB)],Ft.prototype,"rotation",2),d([Xt(On,{optional:!0})],Ft.prototype,"stackGroup",2),d([Xt(HB,{optional:!0})],Ft.prototype,"normalizedTo",2),d([Xt(Sb)],Ft.prototype,"label",2),d([Xt(Sb)],Ft.prototype,"tooltip",2);import{_Scene as GB}from"ag-charts-community";var{SectorBox:vb,motion:WB}=GB;function KB(t,e,i){if(i==="updated"){if(t.previousDatum==null||isNaN(t.previousDatum.innerRadius)||isNaN(t.previousDatum.outerRadius))return"added";if(isNaN(e.innerRadius)||isNaN(e.outerRadius))return"removed"}return i==="added"&&t.previousDatum!=null?"updated":i}function Mb(t){return{toFn:(o,s,a)=>{let n,r,l,c,h;return a==="removed"?(n=t,r=t,l=s.innerRadius,c=s.outerRadius,h=new vb(n,r,l,c)):(n=s.startAngle,r=s.endAngle,l=isNaN(s.innerRadius)?o.innerRadius:s.innerRadius,c=isNaN(s.outerRadius)?o.outerRadius:s.outerRadius,h=s.clipSector),{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h}},fromFn:(o,s,a)=>{a=KB(o,s,a);let n,r,l,c,h;a==="removed"||a==="updated"?(n=o.startAngle,r=o.endAngle,l=o.innerRadius,c=o.outerRadius,h=o.clipSector):(n=t,r=t,l=s.innerRadius,c=s.outerRadius),h??(h=new vb(n,r,l,c));const p=WB.NODE_UPDATE_STATE_TO_PHASE_MAPPING[a];return{startAngle:n,endAngle:r,innerRadius:l,outerRadius:c,clipSector:h,phase:p}}}}function YB(t,e){return{centerX:0,centerY:0,innerRadius:e.innerRadius,outerRadius:e.outerRadius,startAngle:e.startAngle,endAngle:e.endAngle,clipSector:e.clipSector}}var{ChartAxisDirection:lo,PolarAxis:jB,diff:XB,isDefined:ZB,groupAccumulativeValueProperty:Tb,keyProperty:$B,mergeDefaults:QB,normaliseGroupTo:qB,valueProperty:JB,fixNumericExtent:tz,resetLabelFn:ez,seriesLabelFadeInAnimation:iz,seriesLabelFadeOutAnimation:oz,animationValidation:sz,formatValue:az}=Rl,{BandScale:nz}=CB,{Sector:rz,SectorBox:lz,motion:Ab}=EB,{angleBetween:cz,isNumber:hz,sanitizeHtml:Db}=_B,dz=class extends Rl.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.angleKey=o.properties.angleKey,this.radiusKey=o.properties.radiusKey}},Lp=class extends Rl.PolarSeries{constructor(t){super({moduleCtx:t,useLabelLayer:!0,canHaveAxes:!0,animationResetFns:{item:YB,label:ez}}),this.properties=new Ft,this.NodeEvent=dz,this.groupScale=new nz,this.circleCache={r:0,cx:0,cy:0}}nodeFactory(){return new rz}addChartEventListeners(){this.destroyFns.push(this.ctx.chartEventManager?.addListener("legend-item-click",t=>this.onLegendItemClick(t)),this.ctx.chartEventManager?.addListener("legend-item-double-click",t=>this.onLegendItemDoubleClick(t)))}getSeriesDomain(t){const{dataModel:e,processedData:i}=this;if(!i||!e)return[];if(t===lo.X){const o=e.getDomain(this,"angleValue-end","value",i),s=[o[0]>0?0:o[0],o[1]<0?0:o[1]];return tz(s)}else return e.getDomain(this,"radiusValue","key",i)}async processData(t){const{angleKey:e,radiusKey:i,normalizedTo:o,visible:s}=this.properties,a=!this.ctx.animationManager.isSkipped();if(!this.properties.isValid()||!(s||a))return;const n=this.getStackId(),r=`${n}-trailing`,l=[];ZB(o)&&l.push(qB([n,r],Math.abs(o),"range")),a&&(this.processedData&&l.push(XB(this.processedData)),l.push(sz()));const c=this.visible||!a?{}:{forceValue:0},h=this.axes[lo.Y]?.scale.type,p=this.axes[lo.X]?.scale.type;await this.requestDataModel(t,this.data,{props:[$B(i,h,{id:"radiusValue"}),JB(e,p,{id:"angleValue-raw",invalidValue:null,...c}),...Tb(e,"normal","current",{id:"angleValue-end",rangeId:"angleValue-range",invalidValue:null,groupId:n,separateNegative:!0,...c},p),...Tb(e,"trailing","current",{id:"angleValue-start",invalidValue:null,groupId:r,separateNegative:!0,...c},p),...l]}),this.animationState.transition("updateData")}didCircleChange(){const t=this.radius,e=this.centerX,i=this.centerY,o=this.circleCache;return t===o.r&&e===o.cx&&i===o.cy?!1:(this.circleCache={r:t,cx:e,cy:i},!0)}async maybeRefreshNodeData(){if(!this.didCircleChange()&&!this.nodeDataRefresh)return;const{nodeData:e=[]}=await this.createNodeData()??{};this.nodeData=e,this.nodeDataRefresh=!1}getAxisInnerRadius(){const t=this.axes[lo.Y];return t instanceof jB?this.radius*t.innerRadiusRatio:0}async createNodeData(){const{processedData:t,dataModel:e}=this;if(!t||!e||!this.properties.isValid())return;const i=this.axes[lo.X],o=this.axes[lo.Y],s=i?.scale,a=o?.scale;if(!s||!a)return;const n=e.resolveProcessedDataIndexById(this,"angleValue-start"),r=e.resolveProcessedDataIndexById(this,"angleValue-end"),l=e.resolveProcessedDataIndexById(this,"angleValue-range"),c=e.resolveProcessedDataIndexById(this,"angleValue-raw");let h=0;o instanceof Uo&&(h=o.groupPaddingInner);const{groupScale:p}=this,{index:u,visibleGroupCount:y}=this.ctx.seriesStateManager.getVisiblePeerGroupIndex(this);p.domain=Array.from({length:y}).map((L,C)=>String(C)),p.range=[0,Math.abs(a.bandwidth??0)],p.paddingInner=y>1?h:0;const g=p.bandwidth>=1?p.bandwidth:p.rawBandwidth,f=i.isReversed(),m=o.isReversed(),v=m?this.radius:this.getAxisInnerRadius(),S=(m?this.getAxisInnerRadius():this.radius)+v,{angleKey:x,radiusKey:M,angleName:T,radiusName:A,label:D}=this.properties,I=(L,C,k,E)=>{const _=this.getLabelText(D,{value:C,datum:L,angleKey:x,radiusKey:M,angleName:T,radiusName:A},az);if(_)return{x:k,y:E,text:_,textAlign:"center",textBaseline:"middle"}},N=[],O={itemId:M,nodeData:N,labelData:N};return this.visible&&t.data.forEach((L,C)=>{const{datum:k,keys:E,values:_,aggValues:w}=L,B=E[0],P=_[c],R=P>=0&&!Object.is(P,-0),z=_[n],F=_[r],U=w?.[l][R?1:0]??0,G=R===f;let V=s.convert(z,{clampMode:"clamped"}),j=s.convert(F,{clampMode:"clamped"}),K=s.convert(0,{clampMode:"clamped"}),Z=s.convert(U,{clampMode:"clamped"});G&&([K,Z]=[Z,K],[V,j]=[j,V]);const nt=S-a.convert(B)+p.convert(String(u)),et=nt+g,tt=(nt+et)/2,ht=V+cz(V,j)/2,yt=Math.cos(ht)*tt,it=Math.sin(ht)*tt,$=this.properties.label.enabled?I(k,P,yt,it):void 0,Tt=new lz(V,j,nt,et);N.push({series:this,datum:k,point:{x:yt,y:it,size:0},midPoint:{x:yt,y:it},label:$,angleValue:P,radiusValue:B,innerRadius:nt,outerRadius:et,startAngle:K,endAngle:Z,clipSector:Tt,reversed:G,index:C})}),O}async update({seriesRect:t}){const e=this.checkResize(t);await this.maybeRefreshNodeData(),this.contentGroup.translationX=this.centerX,this.contentGroup.translationY=this.centerY,this.highlightGroup.translationX=this.centerX,this.highlightGroup.translationY=this.centerY,this.labelGroup&&(this.labelGroup.translationX=this.centerX,this.labelGroup.translationY=this.centerY),this.updateSectorSelection(this.itemSelection,!1),this.updateSectorSelection(this.highlightSelection,!0),this.updateLabels(),e&&this.animationState.transition("resize"),this.animationState.transition("update")}updateSectorSelection(t,e){let i=[];if(e){const g=this.ctx.highlightManager?.getActiveHighlight();g?.datum&&g.series===this&&(i=[g])}else i=this.nodeData;const{fill:o,fillOpacity:s,stroke:a,strokeOpacity:n,strokeWidth:r,lineDash:l,lineDashOffset:c,cornerRadius:h,angleKey:p,radiusKey:u}=QB(e?this.properties.highlightStyle.item:null,this.properties),y=g=>g.radiusValue;t.update(i,void 0,y).each((g,f)=>{const m=this.properties.itemStyler?this.ctx.callbackCache.call(this.properties.itemStyler,{seriesId:this.id,datum:f.datum,highlighted:e,angleKey:p,radiusKey:u,fill:o,fillOpacity:s,stroke:a,strokeWidth:r,strokeOpacity:n,lineDash:l,lineDashOffset:c,cornerRadius:h}):void 0;g.fill=m?.fill??o,g.fillOpacity=m?.fillOpacity??s,g.stroke=m?.stroke??a,g.strokeWidth=m?.strokeWidth??r,g.strokeOpacity=m?.strokeOpacity??n,g.lineDash=m?.lineDash??l,g.lineDashOffset=m?.lineDashOffset??c,g.lineJoin="round",g.inset=a!=null?(m?.strokeWidth??r)/2:0,g.startInnerCornerRadius=f.reversed?m?.cornerRadius??h:0,g.startOuterCornerRadius=f.reversed?m?.cornerRadius??h:0,g.endInnerCornerRadius=f.reversed?0:m?.cornerRadius??h,g.endOuterCornerRadius=f.reversed?0:m?.cornerRadius??h,e&&(g.startAngle=f.startAngle,g.endAngle=f.endAngle,g.clipSector=f.clipSector,g.innerRadius=f.innerRadius,g.outerRadius=f.outerRadius)})}updateLabels(){const{label:t}=this.properties;this.labelSelection.update(this.nodeData).each((e,i)=>{t.enabled&&i.label?(e.x=i.label.x,e.y=i.label.y,e.fill=t.color,e.fontFamily=t.fontFamily,e.fontSize=t.fontSize,e.fontStyle=t.fontStyle,e.fontWeight=t.fontWeight,e.text=i.label.text,e.textAlign=i.label.textAlign,e.textBaseline=i.label.textBaseline,e.visible=!0):e.visible=!1})}getBarTransitionFunctions(){const t=this.axes[lo.X]?.scale;let e=0;if(!t)return Mb(e);const i=Math.min(t.domain[0],t.domain[1]),o=Math.max(t.domain[0],t.domain[1]);return i<=0&&o>=0&&(e=t.convert(0)),Mb(e)}animateEmptyUpdateReady(){const{labelSelection:t}=this,e=this.getBarTransitionFunctions();Ab.fromToMotion(this.id,"datums",this.ctx.animationManager,[this.itemSelection],e),iz(this,"labels",this.ctx.animationManager,t)}animateClearingUpdateEmpty(){const{itemSelection:t}=this,{animationManager:e}=this.ctx,i=this.getBarTransitionFunctions();Ab.fromToMotion(this.id,"datums",e,[t],i),oz(this,"labels",e,this.labelSelection)}getTooltipHtml(t){const{id:e,axes:i,dataModel:o}=this,{angleKey:s,angleName:a,radiusKey:n,radiusName:r,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,cornerRadius:f,itemStyler:m,tooltip:v}=this.properties,{angleValue:b,radiusValue:S,datum:x,itemId:M}=t,T=i[lo.X],A=i[lo.Y];if(!this.properties.isValid()||!(T&&A&&hz(b))||!o)return Rl.EMPTY_TOOLTIP_CONTENT;const D=T.formatDatum(b),I=A.formatDatum(S),N=Db(a),O=Db(`${I}: ${D}`),{fill:L}=(m&&this.ctx.callbackCache.call(m,{highlighted:!1,seriesId:e,datum:x,angleKey:s,radiusKey:n,fill:l,fillOpacity:c,stroke:h,strokeWidth:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,cornerRadius:f}))??{fill:l};return v.toTooltipHtml({title:N,backgroundColor:l,content:O},{seriesId:e,datum:x,color:L,title:N,angleKey:s,radiusKey:n,angleName:a,radiusName:r,angleValue:b,itemId:M,radiusValue:S})}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.itemSelection.nodes())}getLegendData(t){if(!this.data?.length||!this.properties.isValid()||t!=="category")return[];const{angleKey:e,angleName:i,fill:o,stroke:s,fillOpacity:a,strokeOpacity:n,strokeWidth:r,visible:l}=this.properties;return[{legendType:"category",id:this.id,itemId:e,seriesId:this.id,enabled:l,label:{text:i??e},symbols:[{marker:{fill:o??"rgba(0, 0, 0, 0)",stroke:s??"rgba(0, 0, 0, 0)",fillOpacity:a??1,strokeOpacity:n??1,strokeWidth:r}}]}]}onLegendItemClick(t){const{enabled:e,itemId:i,series:o}=t;o.id===this.id&&this.toggleSeriesItem(i,e)}onLegendItemDoubleClick(t){const{enabled:e,itemId:i,series:o,numVisibleItems:s}=t,n=o.id===this.id||e&&s===1;this.toggleSeriesItem(i,n)}computeLabelsBBox(){return null}getStackId(){return`radialBar-stack-${this.seriesGrouping?.groupIndex??this.id}-xValues`}};Lp.className="RadialBarSeries",Lp.type="radial-bar";import{_Theme as Cp}from"ag-charts-community";var pz={series:{strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:Cp.DEFAULT_FONT_FAMILY,color:Cp.DEFAULT_INVERTED_LABEL_COLOUR}},axes:{[Cp.POLAR_AXIS_TYPE.RADIUS_CATEGORY]:{innerRadiusRatio:.2,groupPaddingInner:.2,paddingInner:.2,paddingOuter:.1}}},uz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-bar",moduleFactory:t=>new Lp(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:mb.POLAR_AXIS_TYPE.ANGLE_NUMBER},{type:mb.POLAR_AXIS_TYPE.RADIUS_CATEGORY}],themeTemplate:pz,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_Theme as kb}from"ag-charts-community";import{_ModuleSupport as gz,_Scene as yz}from"ag-charts-community";import{_ModuleSupport as fz}from"ag-charts-community";var{Validate:Ib,RATIO:Nb}=fz,Ep=class extends Et{};d([Ib(Nb,{optional:!0})],Ep.prototype,"columnWidthRatio",2),d([Ib(Nb,{optional:!0})],Ep.prototype,"maxColumnWidthRatio",2);var{ChartAxisDirection:mz,PolarAxis:xz}=gz,{RadialColumnShape:Sz,getRadialColumnWidth:bz}=yz,_p=class extends zS{constructor(t){super(t,{animationResetFns:{item:c1}}),this.properties=new Ep}getStackId(){return`radarColumn-stack-${this.seriesGrouping?.groupIndex??this.id}-yValues`}nodeFactory(){return new Sz}getColumnTransitionFunctions(){const t=this.isRadiusAxisReversed()?this.radius:this.getAxisInnerRadius();return l1(t)}isRadiusAxisCircle(){const t=this.axes[mz.Y];return t instanceof xz?t.shape==="circle":!1}updateItemPath(t,e,i){t.isBeveled=this.isRadiusAxisCircle(),t.isRadiusAxisReversed=this.isRadiusAxisReversed(),i&&(t.innerRadius=e.innerRadius,t.outerRadius=e.outerRadius,t.startAngle=e.startAngle,t.endAngle=e.endAngle,t.columnWidth=e.columnWidth,t.axisInnerRadius=e.axisInnerRadius,t.axisOuterRadius=e.axisOuterRadius)}getColumnWidth(t,e){const{columnWidthRatio:i=.5,maxColumnWidthRatio:o=.5}=this.properties;return bz(t,e,this.radius,i,o)}};_p.className="RadialColumnSeries",_p.type="radial-column";import{_Theme as _a}from"ag-charts-community";var vz={series:{columnWidthRatio:.5,maxColumnWidthRatio:.5,strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:_a.DEFAULT_FONT_FAMILY,color:_a.DEFAULT_LABEL_COLOUR}},axes:{[_a.POLAR_AXIS_TYPE.ANGLE_CATEGORY]:{shape:_a.POLAR_AXIS_SHAPE.CIRCLE,groupPaddingInner:0,paddingInner:0,label:{padding:10}},[_a.POLAR_AXIS_TYPE.RADIUS_NUMBER]:{shape:_a.POLAR_AXIS_SHAPE.CIRCLE,innerRadiusRatio:.5}}},Mz={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["polar"],identifier:"radial-column",moduleFactory:t=>new _p(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:kb.POLAR_AXIS_TYPE.ANGLE_CATEGORY},{type:kb.POLAR_AXIS_TYPE.RADIUS_NUMBER}],themeTemplate:vz,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},stackable:!0,groupable:!0};import{_Theme as Rp}from"ag-charts-community";import{_ModuleSupport as Ln,_Scene as Tz,_Util as Az}from"ag-charts-community";import{_Scene as Dz}from"ag-charts-community";var{SvgPath:kz,Rotatable:Iz,Translatable:Nz,Scalable:Oz}=Dz,wp=class extends Iz(Oz(Nz(kz))){constructor(){super(...arguments),this.scalingCenterX=.5,this.scalingCenterY=.5,this.rotationCenterX=.5,this.rotationCenterY=.5}};wp.defaultPathData="M0.50245 0.53745C0.481767 0.53745 0.465 0.520683 0.465 0.5C0.465 0.479317 0.481767 0.46255 0.50245 0.46255L1 0.500012L0.50245 0.53745Z";import{_ModuleSupport as Lz,_Scene as Cz,_Util as Ez}from"ag-charts-community";var{BaseProperties:wl,SeriesTooltip:_z,SeriesProperties:Rz,PropertiesArray:Pp,Validate:H,BOOLEAN:Ob,COLOR_STRING:co,COLOR_STRING_ARRAY:wz,FUNCTION:Pz,LINE_DASH:Pl,NUMBER:vs,OBJECT_ARRAY:Bp,OBJECT:ho,POSITIVE_NUMBER:Ze,RATIO:mi,STRING:zp,UNION:Bz}=Lz,{Label:zz}=Cz,{Logger:Fz}=Ez,Vz=Bz(["inside","outside","middle"],"a placement"),Lb=class extends zz{};d([H(vs,{optional:!0})],Lb.prototype,"spacing",2);var te=class extends wl{constructor(){super(...arguments),this.label=new Lb}};d([H(zp,{optional:!0})],te.prototype,"text",2),d([H(vs,{optional:!0})],te.prototype,"value",2),d([H(Px,{optional:!0})],te.prototype,"shape",2),d([H(Vz,{optional:!0})],te.prototype,"placement",2),d([H(vs,{optional:!0})],te.prototype,"spacing",2),d([H(Ze,{optional:!0})],te.prototype,"size",2),d([H(vs,{optional:!0})],te.prototype,"rotation",2),d([H(co,{optional:!0})],te.prototype,"fill",2),d([H(mi,{optional:!0})],te.prototype,"fillOpacity",2),d([H(co,{optional:!0})],te.prototype,"stroke",2),d([H(Ze,{optional:!0})],te.prototype,"strokeWidth",2),d([H(mi,{optional:!0})],te.prototype,"strokeOpacity",2),d([H(Pl,{optional:!0})],te.prototype,"lineDash",2),d([H(Ze,{optional:!0})],te.prototype,"lineDashOffset",2),d([H(ho)],te.prototype,"label",2);var xi=class extends wl{constructor(){super(...arguments),this.enabled=!0,this.fills=new Pp(Ta),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([H(Ob)],xi.prototype,"enabled",2),d([H(Bp)],xi.prototype,"fills",2),d([H(ll)],xi.prototype,"fillMode",2),d([H(co,{optional:!0})],xi.prototype,"fill",2),d([H(mi)],xi.prototype,"fillOpacity",2),d([H(co,{optional:!0})],xi.prototype,"stroke",2),d([H(Ze,{optional:!0})],xi.prototype,"strokeWidth",2),d([H(mi)],xi.prototype,"strokeOpacity",2),d([H(Pl)],xi.prototype,"lineDash",2),d([H(Ze)],xi.prototype,"lineDashOffset",2);var Si=class extends wl{constructor(){super(...arguments),this.fills=new Pp(Ta),this.fillMode="continuous",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.defaultFill="black"}};d([H(Bp)],Si.prototype,"fills",2),d([H(ll)],Si.prototype,"fillMode",2),d([H(co,{optional:!0})],Si.prototype,"fill",2),d([H(mi)],Si.prototype,"fillOpacity",2),d([H(co)],Si.prototype,"stroke",2),d([H(Ze)],Si.prototype,"strokeWidth",2),d([H(mi)],Si.prototype,"strokeOpacity",2),d([H(Pl)],Si.prototype,"lineDash",2),d([H(Ze)],Si.prototype,"lineDashOffset",2),d([H(co)],Si.prototype,"defaultFill",2);var bi=class extends wl{constructor(){super(...arguments),this.enabled=!0,this.spacing=0,this.fill="black",this.fillOpacity=1,this.stroke="black",this.strokeWidth=0,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0}};d([H(Ob)],bi.prototype,"enabled",2),d([H(mi,{optional:!0})],bi.prototype,"radiusRatio",2),d([H(vs)],bi.prototype,"spacing",2),d([H(co)],bi.prototype,"fill",2),d([H(mi)],bi.prototype,"fillOpacity",2),d([H(co)],bi.prototype,"stroke",2),d([H(Ze)],bi.prototype,"strokeWidth",2),d([H(mi)],bi.prototype,"strokeOpacity",2),d([H(Pl)],bi.prototype,"lineDash",2),d([H(Ze)],bi.prototype,"lineDashOffset",2);var Cb=class extends wi{};d([H(zp,{optional:!0})],Cb.prototype,"text",2);var Eb=class extends bn{};d([H(zp,{optional:!0})],Eb.prototype,"text",2);var Rt=class extends Rz{constructor(){super(...arguments),this.segmentation=new Tn,this.defaultColorRange=[],this.targets=new Pp(te),this.defaultTarget=new te,this.outerRadiusRatio=1,this.innerRadiusRatio=1,this.cornerRadius=0,this.cornerMode="container",this.spacing=0,this.scale=new Si,this.bar=new xi,this.needle=new bi,this.label=new Cb,this.secondaryLabel=new Eb,this.tooltip=new _z}isValid(t){if(!super.isValid(t))return!1;const{outerRadius:e,innerRadius:i}=this;return e==null!=(i==null)?(Fz.warnOnce("Either [innerRadius] and [outerRadius] must both be set, or neither can be set."),!1):!0}};d([H(vs)],Rt.prototype,"value",2),d([H(ho)],Rt.prototype,"segmentation",2),d([H(wz)],Rt.prototype,"defaultColorRange",2),d([H(Bp)],Rt.prototype,"targets",2),d([H(ho)],Rt.prototype,"defaultTarget",2),d([H(mi)],Rt.prototype,"outerRadiusRatio",2),d([H(mi)],Rt.prototype,"innerRadiusRatio",2),d([H(Ze,{optional:!0})],Rt.prototype,"outerRadius",2),d([H(Ze,{optional:!0})],Rt.prototype,"innerRadius",2),d([H(Ze)],Rt.prototype,"cornerRadius",2),d([H(Bx)],Rt.prototype,"cornerMode",2),d([H(vs)],Rt.prototype,"spacing",2),d([H(ho)],Rt.prototype,"scale",2),d([H(ho)],Rt.prototype,"bar",2),d([H(ho)],Rt.prototype,"needle",2),d([H(Pz,{optional:!0})],Rt.prototype,"itemStyler",2),d([H(ho)],Rt.prototype,"label",2),d([H(ho)],Rt.prototype,"secondaryLabel",2),d([H(ho)],Rt.prototype,"tooltip",2);import{_Scene as Uz}from"ag-charts-community";var{SectorBox:Fp}=Uz;function Hz(t){const{startAngle:e,endAngle:i,clipStartAngle:o,clipEndAngle:s,innerRadius:a,outerRadius:n}=t;if(!(o==null||s==null))return new Fp(Math.max(o,e),Math.min(s,i),a,n)}function _b(t,e,i){return Math.max(t,i.startAngle)<=Math.min(e,i.endAngle)}function Vp(t){return t.clipStartAngle!=null&&t.clipEndAngle!=null}function Up(t,e){const{clipStartAngle:i,clipEndAngle:o,innerRadius:s,outerRadius:a}=t;return new Fp(i,e?i:o,s,a)}function Rb(t,e){const i=t?"initial":"update";return{node:{fromFn(a,n){const r=a.previousDatum;let{startAngle:l,endAngle:c}=r??n;const h=r!=null&&Vp(r)?Up(r,t):void 0,p=Vp(n)?Up(n,t):void 0;let u;return h!=null&&p!=null?u=h:h==null&&p!=null?(u=p,l=n.startAngle,c=n.endAngle):h!=null&&p==null?(u=void 0,l=n.startAngle,c=n.endAngle):t&&(c=l),{startAngle:l,endAngle:c,clipSector:u,phase:i}},toFn(a,n){const{startAngle:r,endAngle:l}=n;let c;return Vp(n)&&(c=Up(n,!1)),{startAngle:r,endAngle:l,clipSector:c}},applyFn(a,n){const{startAngle:r,endAngle:l}=n;let{clipSector:c}=n;c!=null&&(c=new Fp(Math.max(r,c.startAngle),Math.min(l,c.endAngle),c.innerRadius,c.outerRadius));const h=c==null||_b(r,l,c);a.startAngle=r,a.endAngle=l,a.clipSector=c,a.visible=h}},needle:{fromFn(a){let{angle:n}=a.previousDatum??a.datum;return t&&(n=e),{rotation:n,phase:i}},toFn(a,n){const{angle:r}=n;return{rotation:r}}}}}function Hp(t,e){const{startAngle:i,endAngle:o}=e,s=Hz(e),a=s==null||_b(i,o,s);return{startAngle:i,endAngle:o,clipSector:s,visible:a}}function wb(t,e){const{angle:i}=e;return{rotation:i}}var Gz={top:0,middle:.5,bottom:1};function Wz(t,e,i,o,s){const{padding:a,textAlign:n,verticalAlign:r}=i;let l,c;if(e.each((x,M)=>{M.label==="primary"?l=M:M.label==="secondary"&&(c=M)}),l==null)return;const h=Mn(t,l,s?.label);if(h==null)return;const p=c!=null?Mn(t,c,s?.secondaryLabel):void 0,u={padding:a},y=n==="center"?2:1,g=r==="middle"?2:1,f=x=>({width:Math.sqrt(Math.max(o**2-(x/g)**2,0))*y,height:Math.min(x,g*o),meta:null});let m,v,b;if(c!=null&&p!=null){const x=Tx(h,l,p,c,u,f);m=x?.label,v=x?.secondaryLabel,b=x?.height??0}else{const x=xn(h,l,u,f);m=x?.[0],v=void 0,b=x?.[0].height??0}const S=b*Gz[r];e.each((x,M)=>{let T;if(M.label==="primary"?T=m:M.label==="secondary"&&(T=v),T==null){x.visible=!1;return}x.visible=!0,x.text=T.text,x.fontSize=T.fontSize,x.lineHeight=T.lineHeight,x.textAlign=n,x.textBaseline="middle";const A=M.label==="primary"?T.height/2:b-T.height/2;x.y=M.centerY+A-S,x.x=M.centerX})}var{fromToMotion:Cn,resetMotion:Pb,SeriesNodePickMode:Bb,StateMachine:Kz,createDatumId:Gp,ChartAxisDirection:_o,EMPTY_TOOLTIP_CONTENT:Yz}=Ln,{BBox:jz,Group:Ms,PointerEvents:Wp,Selection:Ts,Sector:Xz,Text:zb,ConicGradient:Zz,getMarker:$z}=Tz,{normalizeAngle360:Fb,normalizeAngle360Inclusive:Vb,toDegrees:Qz,toRadians:qz}=Az,Jz={inside:90,middle:0,outside:-90},tF=[{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"},{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"}],eF=[{textAlign:"right",textBaseline:"bottom"},{textAlign:"left",textBaseline:"bottom"},{textAlign:"left",textBaseline:"top"},{textAlign:"right",textBaseline:"top"}],Kp=class extends Ln.Series{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,useLabelLayer:!0,pickModes:[Bb.EXACT_SHAPE_MATCH,Bb.NEAREST_NODE]}),this.canHaveAxes=!0,this.properties=new Rt,this.centerX=0,this.centerY=0,this.radius=0,this.textAlign="center",this.verticalAlign="middle",this.scaleGroup=this.contentGroup.appendChild(new Ms({name:"scaleGroup"})),this.itemGroup=this.contentGroup.appendChild(new Ms({name:"itemGroup"})),this.itemNeedleGroup=this.contentGroup.appendChild(new Ms({name:"itemNeedleGroup"})),this.itemTargetGroup=this.contentGroup.appendChild(new Ms({name:"itemTargetGroup"})),this.itemTargetLabelGroup=this.contentGroup.appendChild(new Ms({name:"itemTargetLabelGroup"})),this.itemLabelGroup=this.contentGroup.appendChild(new Ms({name:"itemLabelGroup"})),this.highlightTargetGroup=this.highlightGroup.appendChild(new Ms({name:"itemTargetLabelGroup"})),this.scaleSelection=Ts.select(this.scaleGroup,()=>this.nodeFactory()),this.datumSelection=Ts.select(this.itemGroup,()=>this.nodeFactory()),this.needleSelection=Ts.select(this.itemNeedleGroup,wp),this.targetSelection=Ts.select(this.itemTargetGroup,e=>this.markerFactory(e)),this.targetLabelSelection=Ts.select(this.itemTargetLabelGroup,zb),this.labelSelection=Ts.select(this.itemLabelGroup,zb),this.highlightTargetSelection=Ts.select(this.highlightTargetGroup,e=>this.markerFactory(e)),this.nodeDatum={series:this,datum:{}},this.animationState=new Kz("empty",{empty:{update:{target:"ready",action:()=>this.animateEmptyUpdateReady()},reset:"empty",skip:"ready"},ready:{updateData:"waiting",clear:"clearing",resize:()=>this.animateReadyResize(),reset:"empty",skip:"ready"},waiting:{update:{target:"ready",action:()=>this.animateWaitingUpdateReady()},reset:"empty",skip:"ready"},clearing:{update:{target:"empty"},reset:"empty",skip:"ready"}}),this.itemGroup.pointerEvents=Wp.None,this.itemTargetLabelGroup.pointerEvents=Wp.None,this.itemLabelGroup.pointerEvents=Wp.None}get maximumRadius(){return this.properties.outerRadius}get minimumRadius(){return this.properties.outerRadius}get hasData(){return this.properties.value!=null}nodeFactory(){return new Xz}markerFactory({shape:t}){const e=t!=="line"?$z(t):zd,i=new e;return i.size=1,i}async processData(){this.nodeDataRefresh=!0,this.animationState.transition("updateData")}formatLabel(t){return Ex(t,this.axes[_o.X])}createConicGradient(t,e){const{centerX:i,centerY:o,radius:s}=this,{domain:a,range:n}=this.axes[_o.X].scale,[r,l]=n,{defaultColorRange:c}=this.properties,h=Fb((r+l)/2+Math.PI),p=Vb(l-r),u=wx(t,c,a,e).map(({color:y,offset:g})=>(g=Math.min(Math.max(g,0),1),g=(r+p*g-h)/(2*Math.PI),g=(g%1+1)%1,{offset:g,color:y}));return new Zz("oklch",u,Qz(h)-90,new jz(i-s,o-s,2*s,2*s))}getTargets(){const{properties:t}=this,e=t.defaultTarget;return Array.from(t.targets).map(i=>{const{text:o=e.text,value:s=e.value??0,shape:a=e.shape??"triangle",rotation:n=e.rotation??0,strokeWidth:r=e.strokeWidth??0,placement:l=e.placement??"middle",spacing:c=e.spacing??0,size:h=e.size??0,fill:p=e.fill??"black",fillOpacity:u=e.fillOpacity??1,stroke:y=e.stroke??"black",strokeOpacity:g=e.strokeOpacity??1,lineDash:f=e.lineDash??[0],lineDashOffset:m=e.lineDashOffset??0}=i,{enabled:v=e.label.enabled,color:b=e.label.color??"black",fontStyle:S=e.label.fontStyle??"normal",fontWeight:x=e.label.fontWeight??"normal",fontSize:M=e.label.fontSize,fontFamily:T=e.label.fontFamily,spacing:A=e.label.spacing??0}=i.label;return{text:o,value:s,shape:a,placement:l,spacing:c,size:h,rotation:n,fill:p,fillOpacity:u,stroke:y,strokeWidth:r,strokeOpacity:g,lineDash:f,lineDashOffset:m,label:{enabled:v,color:b,fontStyle:S,fontWeight:x,fontSize:M,fontFamily:T,spacing:A}}})}getTargetRadius(t){const{radius:e,properties:i}=this,{innerRadiusRatio:o,outerRadiusRatio:s}=i,{placement:a,spacing:n,size:r}=t,l=e*s,c=e*o;switch(a){case"inside":return Math.max(c-n-r/2,0);case"outside":return l+n+r/2;default:return(c+l)/2}}getTargetLabel(t){const i=this.axes[_o.X].scale,{value:o,size:s,placement:a,label:n}=t,{spacing:r,color:l,fontStyle:c,fontWeight:h,fontSize:p,fontFamily:u}=n,y=void 0,g=i.convert(o),f=Fb(g)/(Math.PI/2)|0,m=s/2+r;let v,b,S,x;switch(a){case"outside":({textAlign:v,textBaseline:b}=tF[f]),S=m*Math.cos(g),x=m*Math.sin(g);break;case"inside":({textAlign:v,textBaseline:b}=eF[f]),S=-m*Math.cos(g),x=-m*Math.sin(g);break;default:v="center",b="bottom",S=0,x=-m;break}return{offsetX:S,offsetY:x,fill:l,textAlign:v,textBaseline:b,fontStyle:c,fontWeight:h,fontSize:p,fontFamily:u,lineHeight:y}}async createNodeData(){const{id:t,properties:e,radius:i,centerX:o,centerY:s}=this;if(!e.isValid())return;const a=this.axes[_o.X];if(a==null)return;const{value:n,innerRadiusRatio:r,outerRadiusRatio:l,segmentation:c,cornerRadius:h,cornerMode:p,needle:u,bar:y,scale:g,label:f,secondaryLabel:m}=e,{outerRadius:v=i*l,innerRadius:b=i*r}=e,S=this.getTargets(),{domain:x}=a.scale,M=[],T=[],A=[],D=[],I=[],[N,O]=a.range,L=a.scale,C=p==="item",k=L.convert(x[0]),E=L.convert(n),_=Math.ceil(Vb(E-k)*i);let w=c.enabled?c.interval.getSegments(a.scale,_):void 0;const B=y.fill??this.createConicGradient(y.fills,y.fillMode),P=g.fill??(y.enabled&&g.fills.length===0?g.defaultFill:void 0)??this.createConicGradient(g.fills,g.fillMode);if(w==null&&C){const[R,z]=x,F={value:n,segmentStart:R,segmentEnd:z},G=Math.min(h,(v-b)/2)/((b+v)/2);y.enabled&&M.push({series:this,itemId:"value",datum:F,type:0,centerX:o,centerY:s,outerRadius:v,innerRadius:b,startAngle:k-G,endAngle:E+G,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:h,endCornerRadius:h,fill:B}),I.push({series:this,itemId:"scale",datum:F,type:0,centerX:o,centerY:s,outerRadius:v,innerRadius:b,startAngle:N-G,endAngle:O+G,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:h,endCornerRadius:h,fill:P})}else{w??(w=x);for(let R=0;R<w.length-1;R+=1){const z=w[R+0],F=w[R+1],U={value:n,segmentStart:z,segmentEnd:F},G=R===0,V=R===w.length-2,j=L.convert(z),K=L.convert(F);y.enabled&&M.push({series:this,itemId:`value-${R}`,datum:U,type:0,centerX:o,centerY:s,outerRadius:v,innerRadius:b,startAngle:j,endAngle:K,clipStartAngle:k,clipEndAngle:E,startCornerRadius:C||G?h:0,endCornerRadius:C||V?h:0,fill:B}),I.push({series:this,itemId:`scale-${R}`,datum:U,type:0,centerX:o,centerY:s,outerRadius:v,innerRadius:b,startAngle:j,endAngle:K,clipStartAngle:void 0,clipEndAngle:void 0,startCornerRadius:C||G?h:0,endCornerRadius:C||V?h:0,fill:P})}}if(!u.enabled&&f.enabled){const{text:R,color:z,fontSize:F,minimumFontSize:U,fontStyle:G,fontWeight:V,fontFamily:j,lineHeight:K,formatter:Z=gt=>this.formatLabel(gt.value)}=f;D.push({label:"primary",centerX:o,centerY:s,text:R,value:n,fill:z,fontSize:F,minimumFontSize:U,fontStyle:G,fontWeight:V,fontFamily:j,lineHeight:K,formatter:Z})}if(!u.enabled&&m.enabled){const{text:R,color:z,fontSize:F,minimumFontSize:U,fontStyle:G,fontWeight:V,fontFamily:j,lineHeight:K,formatter:Z}=m;D.push({label:"secondary",centerX:o,centerY:s,text:R,value:n,fill:z,fontSize:F,minimumFontSize:U,fontStyle:G,fontWeight:V,fontFamily:j,lineHeight:K,formatter:Z})}if(u.enabled){let R=u.radiusRatio!=null?i*u.radiusRatio:b;R=Math.max(R-u.spacing,0);const z=L.convert(n);A.push({centerX:o,centerY:s,radius:R,angle:z})}for(let R=0;R<S.length;R+=1){const z=S[R],{value:F,text:U,size:G,shape:V,fill:j,fillOpacity:K,stroke:Z,strokeWidth:gt,strokeOpacity:nt,lineDash:et,lineDashOffset:tt}=z;if(F<Math.min(...x)||F>Math.max(...x))continue;const ht=this.getTargetRadius(z),yt=L.convert(F),it=qz(z.rotation+Jz[z.placement]);T.push({series:this,itemId:`target-${R}`,midPoint:{x:ht*Math.cos(yt)+o,y:ht*Math.sin(yt)+s},datum:{value:F},type:1,value:F,text:U,centerX:o,centerY:s,shape:V,radius:ht,angle:yt,rotation:it,size:G,fill:j,fillOpacity:K,stroke:Z,strokeOpacity:nt,strokeWidth:gt,lineDash:et,lineDashOffset:tt,label:this.getTargetLabel(z)})}return{itemId:t,nodeData:M,needleData:A,targetData:T,labelData:D,scaleData:I}}async updateSelections(t){(this.nodeDataRefresh||t)&&(this.contextNodeData=await this.createNodeData(),this.nodeDataRefresh=!1)}highlightDatum(t){if(t!=null&&t.series===this&&t.type===1)return t}async update({seriesRect:t}){const{datumSelection:e,labelSelection:i,needleSelection:o,targetSelection:s,targetLabelSelection:a,scaleSelection:n,highlightTargetSelection:r}=this,l=this.checkResize(t);await this.updateSelections(l),this.contentGroup.visible=this.visible,this.contentGroup.opacity=this.getOpacity();const c=this.contextNodeData?.nodeData??[],h=this.contextNodeData?.labelData??[],p=this.contextNodeData?.needleData??[],u=this.contextNodeData?.targetData??[],y=this.contextNodeData?.scaleData??[],g=this.highlightDatum(this.ctx.highlightManager.getActiveHighlight());this.scaleSelection=await this.updateScaleSelection({scaleData:y,scaleSelection:n}),await this.updateScaleNodes({scaleSelection:n}),this.needleSelection=await this.updateNeedleSelection({needleData:p,needleSelection:o}),await this.updateNeedleNodes({needleSelection:o}),this.targetSelection=await this.updateTargetSelection({targetData:u,targetSelection:s}),await this.updateTargetNodes({targetSelection:s,isHighlight:!1}),this.targetLabelSelection=await this.updateTargetLabelSelection({targetData:u,targetLabelSelection:a}),await this.updateTargetLabelNodes({targetLabelSelection:a}),this.datumSelection=await this.updateDatumSelection({nodeData:c,datumSelection:e}),await this.updateDatumNodes({datumSelection:e}),this.labelSelection=await this.updateLabelSelection({labelData:h,labelSelection:i}),await this.updateLabelNodes({labelSelection:i}),this.highlightTargetSelection=await this.updateTargetSelection({targetData:g!=null?[g]:[],targetSelection:r}),await this.updateTargetNodes({targetSelection:r,isHighlight:!0}),l&&this.animationState.transition("resize"),this.animationState.transition("update")}async updateDatumSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Gp(t.nodeData.length,e.itemId))}async updateDatumNodes(t){const{datumSelection:e}=t,{ctx:i,properties:o}=this,{bar:s,segmentation:a}=o,n=a.spacing??0,{fillOpacity:r,stroke:l,strokeOpacity:c,lineDash:h,lineDashOffset:p}=s,u=this.getStrokeWidth(s.strokeWidth),y=i.animationManager.isSkipped();e.each((g,f)=>{const{centerX:m,centerY:v,innerRadius:b,outerRadius:S,startCornerRadius:x,endCornerRadius:M,fill:T}=f;g.centerX=m,g.centerY=v,g.innerRadius=b,g.outerRadius=S,g.fill=T,g.fillOpacity=r,g.stroke=l,g.strokeOpacity=c,g.strokeWidth=u,g.lineDash=h,g.lineDashOffset=p,g.startOuterCornerRadius=x,g.startInnerCornerRadius=x,g.endOuterCornerRadius=M,g.endInnerCornerRadius=M,g.radialEdgeInset=(n+g.strokeWidth)/2,g.concentricEdgeInset=g.strokeWidth/2,(y||g.previousDatum==null)&&g.setProperties(Hp(g,f))})}async updateScaleSelection(t){return t.scaleSelection.update(t.scaleData,void 0,e=>Gp(t.scaleData.length,e.itemId))}async updateScaleNodes(t){const{scaleSelection:e}=t,{scale:i,segmentation:o}=this.properties,s=o.spacing??0,{fillOpacity:a,stroke:n,strokeOpacity:r,strokeWidth:l,lineDash:c,lineDashOffset:h}=i;e.each((p,u)=>{const{centerX:y,centerY:g,innerRadius:f,outerRadius:m,startCornerRadius:v,endCornerRadius:b,fill:S}=u;p.centerX=y,p.centerY=g,p.innerRadius=f,p.outerRadius=m,p.fill=S,p.fillOpacity=a,p.stroke=n,p.strokeOpacity=r,p.strokeWidth=l,p.lineDash=c,p.lineDashOffset=h,p.startOuterCornerRadius=v,p.startInnerCornerRadius=v,p.endOuterCornerRadius=b,p.endInnerCornerRadius=b,p.radialEdgeInset=(s+p.strokeWidth)/2,p.concentricEdgeInset=p.strokeWidth/2,p.setProperties(Hp(p,u))})}async updateNeedleSelection(t){return t.needleSelection.update(t.needleData,void 0,()=>Gp([]))}async updateNeedleNodes(t){const{needleSelection:e}=t,{fill:i,fillOpacity:o,stroke:s,strokeOpacity:a,strokeWidth:n,lineDash:r,lineDashOffset:l}=this.properties.needle,c=this.ctx.animationManager.isSkipped();e.each((h,p)=>{const{centerX:u,centerY:y,radius:g}=p,f=g*2;h.d=wp.defaultPathData,h.fill=i,h.fillOpacity=o,h.stroke=s,h.strokeOpacity=a,h.strokeWidth=n/f,h.lineDash=r.map(m=>m/f),h.lineDashOffset=l/f,h.translationX=u,h.translationY=y,h.scalingX=f,h.scalingY=f,c&&h.setProperties(wb(h,p))})}async updateTargetSelection(t){return t.targetSelection.update(t.targetData,void 0,e=>e.itemId)}async updateTargetNodes(t){const{targetSelection:e,isHighlight:i}=t,o=i?this.properties.highlightStyle.item:void 0;e.each((s,a)=>{const{centerX:n,centerY:r,angle:l,radius:c,size:h,rotation:p,fill:u,fillOpacity:y,stroke:g,strokeOpacity:f,strokeWidth:m,lineDash:v,lineDashOffset:b}=a;s.size=h,s.fill=o?.fill??u,s.fillOpacity=o?.fillOpacity??y,s.stroke=o?.stroke??g,s.strokeOpacity=o?.strokeOpacity??f,s.strokeWidth=o?.strokeWidth??m,s.lineDash=o?.lineDash??v,s.lineDashOffset=o?.lineDashOffset??b,s.translationX=n+c*Math.cos(l),s.translationY=r+c*Math.sin(l),s.rotation=l+p})}async updateTargetLabelSelection(t){return t.targetLabelSelection.update(t.targetData,void 0,e=>e.itemId)}async updateTargetLabelNodes(t){const{targetLabelSelection:e}=t;e.each((i,o)=>{const{centerX:s,centerY:a,radius:n,angle:r,text:l}=o,{offsetX:c,offsetY:h,fill:p,fontStyle:u,fontWeight:y,fontSize:g,fontFamily:f,textAlign:m,textBaseline:v}=o.label;if(l==null){i.visible=!1;return}i.visible=!0,i.x=s+n*Math.cos(r)+c,i.y=a+n*Math.sin(r)+h,i.text=l,i.fill=p,i.fontStyle=u,i.fontWeight=y,i.fontSize=g,i.fontFamily=f,i.textAlign=m,i.textBaseline=v})}async updateLabelSelection(t){return t.labelSelection.update(t.labelData,void 0,e=>e.label)}async updateLabelNodes(t){const{labelSelection:e}=t,i=this.ctx.animationManager.isSkipped();e.each((o,s)=>{o.fill=s.fill,o.fontStyle=s.fontStyle,o.fontWeight=s.fontWeight,o.fontFamily=s.fontFamily}),(i||this.labelsHaveExplicitText())&&this.formatLabelText()}labelsHaveExplicitText(){for(const{datum:t}of this.labelSelection)if(t.text==null)return!1;return!0}formatLabelText(t){if(this.axes[_o.X]==null)return;const{labelSelection:i,radius:o,textAlign:s,verticalAlign:a}=this,{spacing:n,innerRadiusRatio:r}=this.properties;Wz(this,i,{padding:n,textAlign:s,verticalAlign:a},o*r,t)}resetAllAnimation(){this.ctx.animationManager.stopByAnimationGroupId(this.id),Pb([this.datumSelection],Hp),Pb([this.needleSelection],wb),this.formatLabelText()}resetAnimation(t){t==="initial"?this.animationState.transition("reset"):t==="ready"&&this.animationState.transition("skip")}animateLabelText(t={}){const{animationManager:e}=this.ctx;let i,o,s,a;if(this.labelSelection.each((n,r)=>{n.opacity=1,r.label==="primary"?(i=n.previousDatum?.value??t.from??r.value,o=r.value):r.label==="secondary"&&(s=n.previousDatum?.value??t.from??r.value,a=r.value)}),!this.labelsHaveExplicitText())if(o==null||a==null)this.formatLabelText();else if(i===o&&s===a)this.formatLabelText({label:o,secondaryLabel:a});else{const n=`${this.id}_labels`;e.animate({id:n,groupId:"label",from:{label:i,secondaryLabel:s},to:{label:o,secondaryLabel:a},phase:t.phase??"update",onUpdate:r=>this.formatLabelText(r)})}}animateEmptyUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=Rb(!0,this.axes[_o.X]?.range[0]??0);Cn(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),Cn(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),Cn(this.id,"label",t,[this.labelSelection],Cx,(o,s)=>s.label),this.animateLabelText({from:this.axes[_o.X]?.scale.domain[0]??0,phase:"initial"})}animateWaitingUpdateReady(){const{animationManager:t}=this.ctx,{node:e,needle:i}=Rb(!1,this.axes[_o.X]?.range[0]??0);Cn(this.id,"node",t,[this.datumSelection],e,(o,s)=>s.itemId),Cn(this.id,"needle",t,[this.needleSelection],i,()=>"needle"),this.animateLabelText()}animateReadyResize(){this.resetAllAnimation()}getLabelData(){return[]}getSeriesDomain(){return[NaN,NaN]}getLegendData(){return[]}pickNode(t,e){switch(e){case"event":case"context-menu":{const i=this.scaleGroup.pickNode(t.x,t.y);return i!=null?{pickMode:Ln.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:void 0}case"tooltip":case"highlight":case"highlight-tooltip":{const i=this.itemTargetGroup.pickNode(t.x,t.y);return i!=null?{pickMode:Ln.SeriesNodePickMode.EXACT_SHAPE_MATCH,match:i.datum,distance:0}:{pickMode:Ln.SeriesNodePickMode.NEAREST_NODE,match:this.nodeDatum,distance:0}}}}getTooltipHtml(t){const{id:e,properties:i}=this;if(!i.isValid())return Yz;const o=this.highlightDatum(t),s=o?.value??i.value,a=o?.text,{tooltip:n}=i,r=a??"",l=this.formatLabel(s),c=o?.itemId,h=void 0,p=o?.fill;return n.toTooltipHtml({title:r,content:l,backgroundColor:p},{seriesId:e,itemId:c,title:r,datum:h,color:p,value:s,...this.getModuleTooltipParams()})}pickFocus(t){const e=this.contextNodeData?.targetData;if(e==null||e.length===0)return;const i=Math.min(Math.max(t.datumIndex,0),e.length-1),o=e[i];for(const s of this.targetSelection)if(s.datum===o)return{bounds:s.node,showFocusBox:!0,datum:o,datumIndex:i}}getCaptionText(){const{value:t}=this.properties,e=[];return e.push(this.formatLabel(t)),this.labelSelection.each((i,o)=>{const s=Mn(this,o);s!=null&&e.push(s)}),e.join(". ")}};Kp.className="RadialGaugeSeries",Kp.type="radial-gauge";var{FONT_WEIGHT:Yp,DEFAULT_FONT_FAMILY:jp,DEFAULT_HIERARCHY_FILLS:iF,DEFAULT_LABEL_COLOUR:En,DEFAULT_MUTED_LABEL_COLOUR:oF,POLAR_AXIS_TYPE:Ub}=Rp,sF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["gauge"],identifier:"radial-gauge",moduleFactory:t=>new Kp(t),tooltipDefaults:{range:"exact"},defaultAxes:[{type:Ub.ANGLE_NUMBER,line:{enabled:!1}},{type:Ub.RADIUS_NUMBER,line:{enabled:!1}}],themeTemplate:{minWidth:200,minHeight:200,series:{outerRadiusRatio:1,innerRadiusRatio:.8,bar:{strokeWidth:0},segmentation:{enabled:!1,interval:{},spacing:2},defaultTarget:{fill:En,stroke:En,size:10,shape:"triangle",placement:"outside",spacing:5,label:{enabled:!0,fontWeight:Yp.NORMAL,fontSize:12,fontFamily:jp,color:En,spacing:5}},needle:{enabled:!1,fill:En,spacing:10},label:{enabled:!0,fontWeight:Yp.NORMAL,fontSize:56,minimumFontSize:18,fontFamily:jp,color:En},secondaryLabel:{enabled:!0,fontWeight:Yp.NORMAL,fontSize:14,minimumFontSize:12,fontFamily:jp,color:oF},tooltip:{enabled:!1}},axes:{[Rp.POLAR_AXIS_TYPE.ANGLE_NUMBER]:{startAngle:270,endAngle:450,nice:!1,line:{enabled:!1}}}},paletteFactory(t){const{takeColors:e,colorsCount:i,userPalette:o,themeTemplateParameters:s}=t,{fills:a}=e(i),n=s.get(Rp.DEFAULT_GAUGE_SERIES_COLOR_RANGE),r=s.get(iF),l=o==="inbuilt"?n:[a[0],a[1]];return{scale:{defaultFill:r?.[1],stroke:r?.[2]},defaultColorRange:Lx(l)}}};import{_ModuleSupport as aF,_Theme as Bl}from"ag-charts-community";import{_ModuleSupport as _n,_Scene as Xp,_Util as nF}from"ag-charts-community";import{_ModuleSupport as rF,_Scene as lF}from"ag-charts-community";var{DropShadow:cF,Label:hF}=lF,{CartesianSeriesProperties:dF,InterpolationProperties:pF,SeriesMarker:uF,SeriesTooltip:gF,Validate:Dt,BOOLEAN:yF,COLOR_STRING:Hb,LINE_DASH:fF,OBJECT:Rn,PLACEMENT:mF,POSITIVE_NUMBER:Zp,RATIO:Gb,STRING:As}=rF,$p=class extends hF{constructor(){super(...arguments),this.placement="outside",this.padding=6}};d([Dt(mF)],$p.prototype,"placement",2),d([Dt(Zp)],$p.prototype,"padding",2);var It=class extends dF{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.interpolation=new pF,this.shadow=new cF().set({enabled:!1}),this.marker=new uF,this.label=new $p,this.tooltip=new gF,this.connectMissingData=!1}};d([Dt(As)],It.prototype,"xKey",2),d([Dt(As)],It.prototype,"yLowKey",2),d([Dt(As)],It.prototype,"yHighKey",2),d([Dt(As,{optional:!0})],It.prototype,"xName",2),d([Dt(As,{optional:!0})],It.prototype,"yName",2),d([Dt(As,{optional:!0})],It.prototype,"yLowName",2),d([Dt(As,{optional:!0})],It.prototype,"yHighName",2),d([Dt(Hb)],It.prototype,"fill",2),d([Dt(Gb)],It.prototype,"fillOpacity",2),d([Dt(Hb)],It.prototype,"stroke",2),d([Dt(Zp)],It.prototype,"strokeWidth",2),d([Dt(Gb)],It.prototype,"strokeOpacity",2),d([Dt(fF)],It.prototype,"lineDash",2),d([Dt(Zp)],It.prototype,"lineDashOffset",2),d([Dt(Rn)],It.prototype,"interpolation",2),d([Dt(Rn)],It.prototype,"shadow",2),d([Dt(Rn)],It.prototype,"marker",2),d([Dt(Rn)],It.prototype,"label",2),d([Dt(Rn)],It.prototype,"tooltip",2),d([Dt(yF)],It.prototype,"connectMissingData",2);var{valueProperty:Wb,keyProperty:xF,ChartAxisDirection:vi,mergeDefaults:SF,updateLabelNode:bF,fixNumericExtent:Kb,buildResetPathFn:vF,resetLabelFn:MF,resetMarkerFn:TF,resetMarkerPositionFn:Yb,pathSwipeInAnimation:AF,resetMotion:DF,markerSwipeScaleInAnimation:kF,seriesLabelFadeInAnimation:IF,animationValidation:NF,diff:OF,updateClipPath:jb,formatValue:LF,computeMarkerFocusBounds:Xb,plotPath:zl,pathRanges:Zb,pathRangePoints:Qp,pathRangePointsReverse:CF}=_n,{getMarker:EF,PointerEvents:qp}=Xp,{sanitizeHtml:Ds,extent:_F}=nF,RF=class extends _n.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},Jp=class extends _n.CartesianSeries{constructor(t){super({moduleCtx:t,hasMarkers:!0,pathsPerSeries:["fill","stroke"],pickModes:[_n.SeriesNodePickMode.AXIS_ALIGNED],directionKeys:{[vi.X]:["xKey"],[vi.Y]:["yLowKey","yHighKey"]},directionNames:{[vi.X]:["xName"],[vi.Y]:["yLowName","yHighName","yName"]},animationResetFns:{path:vF({getVisible:()=>this.visible,getOpacity:()=>this.getOpacity()}),label:MF,marker:(e,i)=>({...TF(e),...Yb(e,i)})}}),this.properties=new It,this.NodeEvent=RF}async processData(t){if(!this.properties.isValid()||!this.visible)return;const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.axes[vi.X]?.scale,a=this.axes[vi.Y]?.scale,{xScaleType:n,yScaleType:r}=this.getScaleInformation({xScale:s,yScale:a}),l=[],c=!this.ctx.animationManager.isSkipped();!this.ctx.animationManager.isSkipped()&&this.processedData&&l.push(OF(this.processedData)),c&&l.push(NF()),await this.requestDataModel(t,this.data,{props:[xF(e,n,{id:"xValue"}),Wb(i,r,{id:"yLowValue",invalidValue:void 0}),Wb(o,r,{id:"yHighValue",invalidValue:void 0}),...l]}),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!(e&&i))return[];const{domain:{keys:[o],values:s}}=e;if(t===vi.X){const a=i.resolveProcessedDataDefById(this,"xValue");return a?.def.type==="key"&&a.def.valueType==="category"?o:Kb(_F(o))}else{const a=i.resolveProcessedDataIndexById(this,"yLowValue"),n=s[a],r=i.resolveProcessedDataIndexById(this,"yHighValue"),l=s[r],c=[n[0]>l[0]?l[0]:n[0],l[1]<n[1]?n[1]:l[1]];return Kb(c)}}async createNodeData(){const{data:t,dataModel:e,axes:i,visible:o}=this,s=i[vi.X],a=i[vi.Y];if(!(t&&o&&s&&a&&e))return;const n=s.scale,r=a.scale,{xKey:l,yLowKey:c,yHighKey:h,connectMissingData:p,marker:u}=this.properties,y=`${c}-${h}`,g=(n.bandwidth??0)/2,f=e.resolveProcessedDataDefsByIds(this,["xValue","yHighValue","yLowValue"]),m=(O,L,C,k)=>{const E=n.convert(O)+g,_=r.convert(L),w=r.convert(C),{size:B}=u;return[{point:{x:E,y:_,moveTo:k},size:B,itemId:"high",yValue:L,xValue:O,enabled:!0},{point:{x:E,y:w,moveTo:k},size:B,itemId:"low",yValue:C,xValue:O,enabled:!1}]},v=[],b=[],S={itemId:y,highPoints:[],lowPoints:[]},x={itemId:y,highPoints:[],lowPoints:[]},M={itemId:y,labelData:v,nodeData:b,fillData:x,strokeData:S,scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return M;const T=x.highPoints,A=x.lowPoints,D=S.highPoints,I=S.lowPoints;let N=!0;return this.processedData?.data.forEach(({keys:O,datum:L,values:C},k)=>{const E=e.resolveProcessedDataDefsValues(f,{keys:O,values:C}),{xValue:_,yHighValue:w,yLowValue:B}=E,R=w==null||B==null?[]:m(_,w,B,!1),z=B>w;R.forEach(({point:{x:j,y:K},enabled:Z,size:gt,itemId:nt="",yValue:et})=>{b.push({index:k,series:this,itemId:nt,datum:L,midPoint:{x:j,y:K},yHighValue:w,yLowValue:B,xValue:_,xKey:l,yLowKey:c,yHighKey:h,point:{x:j,y:K,size:gt},enabled:Z});const tt=this.createLabelData({point:{x:j,y:K},value:et,yLowValue:B,yHighValue:w,itemId:nt,inverted:z,datum:L,series:this});v.push(tt)});const F=_!=null,U=w!=null&&B!=null,[G,V]=m(_,w??0,B??0,N);F&&U?(T.push(G),A.push(V),D.push(G),I.push(V),N=!1):p||(N=!0)}),M}createLabelData({point:t,value:e,itemId:i,inverted:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yName:h,yLowName:p,yHighName:u,label:y}=this.properties,{placement:g,padding:f=10}=y;let m=i;o&&(m=i==="low"?"high":"low");const v=g==="outside"&&m==="high"||g==="inside"&&m==="low"?-1:1;return{x:t.x,y:t.y+f*v,series:a,itemId:i,datum:s,text:this.getLabelText(y,{value:e,datum:s,itemId:i,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:p,yHighName:u,yName:h},LF),textAlign:"center",textBaseline:v===-1?"bottom":"top"}}isPathOrSelectionDirty(){return this.properties.marker.isDirty()}markerFactory(){const{shape:t}=this.properties.marker,e=EF(t);return new e}async updatePathNodes(t){const{opacity:e,visible:i}=t,[o,s]=t.paths,a=this.getStrokeWidth(this.properties.strokeWidth);s.setProperties({fill:void 0,lineJoin:s.lineCap="round",pointerEvents:qp.None,stroke:this.properties.stroke,strokeWidth:a,strokeOpacity:this.properties.strokeOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,opacity:e,visible:i}),o.setProperties({stroke:void 0,lineJoin:"round",pointerEvents:qp.None,fill:this.properties.fill,fillOpacity:this.properties.fillOpacity,lineDash:this.properties.lineDash,lineDashOffset:this.properties.lineDashOffset,strokeOpacity:this.properties.strokeOpacity,fillShadow:this.properties.shadow,strokeWidth:a,opacity:e,visible:i}),jb(this,s),jb(this,o)}async updatePaths(t){this.updateAreaPaths(t.paths,t.contextData)}updateAreaPaths(t,e){this.updateFillPath(t,e),this.updateStrokePath(t,e)}updateFillPath(t,e){const{interpolation:i}=this.properties,{fillData:o}=e,[s]=t;s.path.clear();for(const a of Zb(o.highPoints))zl(Qp(o.highPoints,a),s,i),zl(CF(o.lowPoints,a),s,i,!0),s.path.closePath();s.checkPathDirty()}updateStrokePath(t,e){const{interpolation:i}=this.properties,{strokeData:o}=e,[,s]=t;s.path.clear(!0);for(const a of Zb(o.highPoints))zl(Qp(o.highPoints,a),s,i),zl(Qp(o.lowPoints,a),s,i);s.checkPathDirty()}async updateMarkerSelection(t){const{nodeData:e,markerSelection:i}=t;return this.properties.marker.isDirty()&&(i.clear(),i.cleanup()),i.update(this.properties.marker.enabled?e:[])}async updateMarkerNodes(t){const{markerSelection:e,isHighlight:i}=t,{xKey:o,yLowKey:s,yHighKey:a,marker:n,fill:r,stroke:l,strokeWidth:c,fillOpacity:h,strokeOpacity:p}=this.properties,u=SF(i&&this.properties.highlightStyle.item,n.getStyle(),{fill:r,fillOpacity:h,stroke:l,strokeWidth:c,strokeOpacity:p});e.each((y,g)=>{this.updateMarkerStyle(y,n,{datum:g,highlighted:i,xKey:o,yHighKey:a,yLowKey:s},u)}),i||this.properties.marker.markClean()}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;return i.update(e,o=>{o.pointerEvents=qp.None})}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{bF(e,this.properties.label,i)})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getHighlightData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}getTooltipHtml(t){const e=this.axes[vi.X],i=this.axes[vi.Y];if(!this.properties.isValid()||!e||!i)return _n.EMPTY_TOOLTIP_CONTENT;const{id:o}=this,{xKey:s,yLowKey:a,yHighKey:n,xName:r,yName:l,yLowName:c,yHighName:h,fill:p,tooltip:u}=this.properties,{datum:y,itemId:g,xValue:f,yLowValue:m,yHighValue:v}=t,b=p??"gray",S=Ds(e.formatDatum(f)),x=Ds(i.formatDatum(m)),M=Ds(i.formatDatum(v)),T=r??s,A=c??a,D=h??n,I=Ds(l),N=l?`<b>${Ds(T)}</b>: ${S}<br><b>${Ds(A)}</b>: ${x}<br><b>${Ds(D)}</b>: ${M}<br>`:`${S}: ${x} - ${M}`;return u.toTooltipHtml({title:I,content:N,backgroundColor:b},{seriesId:o,itemId:g,datum:y,xKey:s,yLowKey:a,yHighKey:n,xName:r,yLowName:c,yHighName:h,yName:l,color:b,title:I,yHighValue:v,yLowValue:m})}getLegendData(t){if(t!=="category")return[];const{yLowKey:e,yHighKey:i,yName:o,yLowName:s,yHighName:a,fill:n,stroke:r,strokeWidth:l,strokeOpacity:c,lineDash:h,visible:p,marker:u}=this.properties,y=o??`${s??e} - ${a??i}`;return[{legendType:"category",id:this.id,itemId:`${e}-${i}`,seriesId:this.id,enabled:p,label:{text:`${y}`},symbols:[{marker:{shape:u.shape,fill:u.fill??n,stroke:u.stroke??r,fillOpacity:u.fillOpacity,strokeOpacity:u.strokeOpacity,strokeWidth:u.strokeWidth},line:{stroke:r,strokeOpacity:c,strokeWidth:l,lineDash:h}}]}]}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}nodeFactory(){return new Xp.Group}animateEmptyUpdateReady(t){const{markerSelection:e,labelSelection:i,contextData:o,paths:s}=t,{animationManager:a}=this.ctx;this.updateAreaPaths(s,o),AF(this,a,...s),DF([e],Yb),kF(this,a,e),IF(this,"labels",a,i)}animateReadyResize(t){const{contextData:e,paths:i}=t;this.updateAreaPaths(i,e),super.animateReadyResize(t)}animateWaitingUpdateReady(t){const{contextData:e,paths:i}=t;super.animateWaitingUpdateReady(t),this.updateAreaPaths(i,e)}getFormattedMarkerStyle(t){const{xKey:e,yLowKey:i,yHighKey:o}=this.properties;return this.getMarkerStyle(this.properties.marker,{datum:t,xKey:e,yLowKey:i,yHighKey:o,highlighted:!0})}computeFocusBounds(t){const e=Xb(this,t),i=Xb(this,{...t,datumIndex:t.datumIndex+1});if(e&&i)return Xp.BBox.merge([e,i])}};Jp.className="RangeAreaSeries",Jp.type="range-area";import{_Theme as tu}from"ag-charts-community";var wF={series:{fillOpacity:.7,nodeClickRange:"nearest",marker:{enabled:!1,size:6,strokeWidth:2},label:{enabled:!1,placement:"outside",padding:10,fontSize:12,fontFamily:tu.DEFAULT_FONT_FAMILY,color:tu.DEFAULT_LABEL_COLOUR},interpolation:{type:"linear",tension:1,position:"end"}},axes:{[tu.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},{markerPaletteFactory:PF}=aF,BF={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-area",moduleFactory:t=>new Jp(t),tooltipDefaults:{range:"nearest"},defaultAxes:[{type:Bl.CARTESIAN_AXIS_TYPE.NUMBER,position:Bl.CARTESIAN_POSITION.LEFT},{type:Bl.CARTESIAN_AXIS_TYPE.CATEGORY,position:Bl.CARTESIAN_POSITION.BOTTOM}],themeTemplate:wF,paletteFactory:t=>{const{marker:e}=PF(t);return{fill:e.fill,stroke:e.stroke,marker:e}}};import{_Theme as wn}from"ag-charts-community";import{_ModuleSupport as Fl,_Scale as zF,_Scene as FF,_Util as VF}from"ag-charts-community";import{_ModuleSupport as UF,_Scene as HF}from"ag-charts-community";var{DropShadow:GF,Label:WF}=HF,{AbstractBarSeriesProperties:KF,SeriesTooltip:YF,Validate:Nt,COLOR_STRING:$b,FUNCTION:jF,LINE_DASH:XF,OBJECT:eu,PLACEMENT:ZF,POSITIVE_NUMBER:Vl,RATIO:Qb,STRING:ks}=UF,iu=class extends WF{constructor(){super(...arguments),this.placement="inside",this.padding=6}};d([Nt(ZF)],iu.prototype,"placement",2),d([Nt(Vl)],iu.prototype,"padding",2);var wt=class extends KF{constructor(){super(...arguments),this.fill="#99CCFF",this.fillOpacity=1,this.stroke="#99CCFF",this.strokeWidth=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.cornerRadius=0,this.shadow=new GF().set({enabled:!1}),this.label=new iu,this.tooltip=new YF}};d([Nt(ks)],wt.prototype,"xKey",2),d([Nt(ks)],wt.prototype,"yLowKey",2),d([Nt(ks)],wt.prototype,"yHighKey",2),d([Nt(ks,{optional:!0})],wt.prototype,"xName",2),d([Nt(ks,{optional:!0})],wt.prototype,"yName",2),d([Nt(ks,{optional:!0})],wt.prototype,"yLowName",2),d([Nt(ks,{optional:!0})],wt.prototype,"yHighName",2),d([Nt($b)],wt.prototype,"fill",2),d([Nt(Qb)],wt.prototype,"fillOpacity",2),d([Nt($b)],wt.prototype,"stroke",2),d([Nt(Vl)],wt.prototype,"strokeWidth",2),d([Nt(Qb)],wt.prototype,"strokeOpacity",2),d([Nt(XF)],wt.prototype,"lineDash",2),d([Nt(Vl)],wt.prototype,"lineDashOffset",2),d([Nt(Vl)],wt.prototype,"cornerRadius",2),d([Nt(jF,{optional:!0})],wt.prototype,"itemStyler",2),d([Nt(eu)],wt.prototype,"shadow",2),d([Nt(eu)],wt.prototype,"label",2),d([Nt(eu)],wt.prototype,"tooltip",2);var{SeriesNodePickMode:qb,valueProperty:Jb,keyProperty:$F,ChartAxisDirection:ou,getRectConfig:QF,updateRect:qF,checkCrisp:JF,updateLabelNode:tV,SMALLEST_KEY_INTERVAL:eV,LARGEST_KEY_INTERVAL:iV,diff:oV,prepareBarAnimationFunctions:tv,midpointStartingBarPosition:ev,resetBarSelectionsFn:sV,fixNumericExtent:aV,seriesLabelFadeInAnimation:iv,resetLabelFn:nV,animationValidation:rV,createDatumId:lV,formatValue:ov,computeBarFocusBounds:cV}=Fl,{Rect:hV,PointerEvents:dV,motion:sv}=FF,{sanitizeHtml:Is}=VF,{ContinuousScale:pV}=zF,uV=class extends Fl.SeriesNodeEvent{constructor(t,e,i,o){super(t,e,i,o),this.xKey=o.properties.xKey,this.yLowKey=o.properties.yLowKey,this.yHighKey=o.properties.yHighKey}},su=class extends Fl.AbstractBarSeries{constructor(t){super({moduleCtx:t,pickModes:[qb.AXIS_ALIGNED,qb.EXACT_SHAPE_MATCH],hasHighlightedLabels:!0,directionKeys:{x:["xKey"],y:["yLowKey","yHighKey"]},directionNames:{x:["xName"],y:["yLowName","yHighName","yName"]},datumSelectionGarbageCollection:!1,animationResetFns:{datum:sV,label:nV}}),this.properties=new wt,this.NodeEvent=uV}async processData(t){if(!this.properties.isValid())return;const{xKey:e,yLowKey:i,yHighKey:o}=this.properties,s=this.getCategoryAxis()?.scale,a=this.getValueAxis()?.scale,{isContinuousX:n,xScaleType:r,yScaleType:l}=this.getScaleInformation({xScale:s,yScale:a}),c=[];this.ctx.animationManager.isSkipped()||(this.processedData&&c.push(oV(this.processedData)),c.push(rV()));const h=this.visible?{}:{forceValue:0},{processedData:p}=await this.requestDataModel(t,this.data,{props:[$F(e,r,{id:"xValue"}),Jb(i,l,{id:"yLowValue",invalidValue:null,...h}),Jb(o,l,{id:"yHighValue",invalidValue:null,...h}),...n?[eV,iV]:[],...c],groupByKeys:!0});this.smallestDataInterval=p.reduced?.smallestKeyInterval,this.largestDataInterval=p.reduced?.largestKeyInterval,this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");return a?.def.type==="key"&&a?.def.valueType==="category"?o:this.padBandExtent(o)}else{const a=i.resolveProcessedDataIndexById(this,"yLowValue"),n=s[a],r=i.resolveProcessedDataIndexById(this,"yHighValue"),l=s[r],c=[n[0]>l[0]?l[0]:n[0],l[1]<n[1]?n[1]:l[1]];return aV(c)}}async createNodeData(){const{data:t,dataModel:e,groupScale:i,processedData:o,properties:{visible:s}}=this,a=this.getCategoryAxis(),n=this.getValueAxis();if(!(t&&a&&n&&e))return;const r=a.scale,l=n.scale,c=this.getBarDirection()===ou.X,{xKey:h,yLowKey:p,yHighKey:u,fill:y,stroke:g,strokeWidth:f}=this.properties,m=`${p}-${u}`,v={itemId:m,nodeData:[],labelData:[],scales:this.calculateScaling(),visible:this.visible};if(!s)return v;const b=e.resolveProcessedDataIndexById(this,"yLowValue"),S=e.resolveProcessedDataIndexById(this,"yHighValue"),x=e.resolveProcessedDataIndexById(this,"xValue"),{barWidth:M,groupIndex:T}=this.updateGroupScale(a),A=pV.is(r)?M*-.5:0;return o?.data.forEach(({keys:D,datum:I,values:N},O)=>{N.forEach((L,C)=>{const k=D[x],E=Math.round(r.convert(k))+i.convert(String(T))+A,_=L[b],w=L[S],B=Math.min(_,w),P=Math.max(_,w),R=Math.round(l.convert(B)),F=Math.round(l.convert(P)),U=R,G=Math.max(f,Math.abs(U-F)),V={x:c?Math.min(F,U):E,y:c?E:Math.min(F,U),width:c?G:M,height:c?M:G},j={x:V.x+V.width/2,y:V.y+V.height/2},K=this.createLabelData({rect:V,barAlongX:c,yLowValue:B,yHighValue:P,datum:I[C],series:this}),Z={index:O,valueIndex:C,series:this,itemId:m,datum:I[C],xValue:k,yLowValue:_,yHighValue:w,yLowKey:p,yHighKey:u,xKey:h,x:V.x,y:V.y,width:V.width,height:V.height,midPoint:j,fill:y,stroke:g,strokeWidth:f,opacity:1,labels:K};v.nodeData.push(Z),v.labelData.push(...K)})}),v}createLabelData({rect:t,barAlongX:e,yLowValue:i,yHighValue:o,datum:s,series:a}){const{xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u,label:y}=this.properties,g={datum:s,xKey:n,yLowKey:r,yHighKey:l,xName:c,yLowName:h,yHighName:p,yName:u},{placement:f,padding:m}=y,b=m*(f==="outside"?1:-1),S={x:t.x+(e?-b:t.width/2),y:t.y+(e?t.height/2:t.height+b),textAlign:e?"left":"center",textBaseline:e?"middle":"bottom",text:this.getLabelText(y,{itemId:"low",value:i,...g},ov),itemId:"low",datum:s,series:a},x={x:t.x+(e?t.width+b:t.width/2),y:t.y+(e?t.height/2:-b),textAlign:e?"right":"center",textBaseline:e?"middle":"top",text:this.getLabelText(y,{itemId:"high",value:o,...g},ov),itemId:"high",datum:s,series:a};return f==="outside"&&(S.textAlign=e?"right":"center",S.textBaseline=e?"middle":"top",x.textAlign=e?"left":"center",x.textBaseline=e?"middle":"bottom"),[S,x]}nodeFactory(){return new hV}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o,void 0,s=>this.getDatumId(s))}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,ctx:s}=this,{yLowKey:a,yHighKey:n,highlightStyle:{item:r},fillOpacity:l,strokeOpacity:c,strokeWidth:h,lineDash:p,lineDashOffset:u,itemStyler:y,shadow:g}=this.properties,f=this.axes[ou.X],m=JF(f?.scale,f?.visibleRange,this.smallestDataInterval,this.largestDataInterval),v=this.getCategoryDirection()===ou.X;e.each((b,S)=>{const x={fill:S.fill,stroke:S.stroke,fillOpacity:l,strokeOpacity:c,lineDash:p,lineDashOffset:u,fillShadow:g,strokeWidth:this.getStrokeWidth(h),cornerRadius:this.properties.cornerRadius},M=v?S.width>0:S.height>0,T=QF({datum:S,isHighlighted:i,style:x,highlightStyle:r,itemStyler:y,seriesId:o,ctx:s,yLowKey:a,yHighKey:n});T.crisp=m,T.visible=M,qF(b,T)})}getHighlightLabelData(t,e){const i=t.filter(o=>o.datum===e.datum);return i.length>0?i:void 0}async updateLabelSelection(t){const e=this.properties.label.enabled?t.labelData:[];return t.labelSelection.update(e,i=>{i.pointerEvents=dV.None})}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{tV(e,this.properties.label,i)})}getTooltipHtml(t){const{id:e,ctx:{callbackCache:i}}=this,o=this.getCategoryAxis(),s=this.getValueAxis();if(!this.properties.isValid()||!o||!s)return Fl.EMPTY_TOOLTIP_CONTENT;const{xKey:a,yLowKey:n,yHighKey:r,xName:l,yLowName:c,yHighName:h,yName:p,fill:u,strokeWidth:y,itemStyler:g,tooltip:f,fillOpacity:m,stroke:v,strokeOpacity:b,lineDash:S,lineDashOffset:x,cornerRadius:M}=this.properties,{datum:T,xValue:A,yLowValue:D,yHighValue:I}=t;let N;g&&(N=i.call(g,{highlighted:!1,seriesId:e,datum:T,xKey:a,yLowKey:n,yHighKey:r,fill:u,fillOpacity:m,stroke:v,strokeWidth:y,strokeOpacity:b,lineDash:S,lineDashOffset:x,cornerRadius:M}));const O=N?.fill??u??"gray",L=Is(o.formatDatum(A)),C=Is(s.formatDatum(D)),k=Is(s.formatDatum(I)),E=l??a,_=c??n,w=h??r,B=Is(p),P=p?`<b>${Is(E)}</b>: ${L}<br><b>${Is(_)}</b>: ${C}<br><b>${Is(w)}</b>: ${k}<br>`:`${L}: ${C} - ${k}`,R={title:B,content:P,backgroundColor:O};return f.toTooltipHtml(R,{itemId:void 0,datum:T,xKey:a,xName:l,yLowKey:n,yLowName:c,yHighKey:r,yHighName:h,yName:p,color:O,seriesId:e,title:B})}getLegendData(t){const{id:e,visible:i}=this;if(t!=="category")return[];const{fill:o,stroke:s,strokeWidth:a,fillOpacity:n,strokeOpacity:r,yName:l,yLowName:c,yHighName:h,yLowKey:p,yHighKey:u}=this.properties,y=l??`${c??p} - ${h??u}`;return[{legendType:"category",id:e,itemId:`${p}-${u}`,seriesId:e,enabled:i,label:{text:`${y}`},symbols:[{marker:{fill:o,stroke:s,fillOpacity:n,strokeOpacity:r,strokeWidth:a}}]}]}animateEmptyUpdateReady({datumSelection:t,labelSelection:e}){const i=tv(ev(this.isVertical(),"normal"));sv.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],i),iv(this,"labels",this.ctx.animationManager,e)}animateWaitingUpdateReady(t){const{datumSelection:e,labelSelection:i}=t,{processedData:o}=this,s=o?.reduced?.diff;this.ctx.animationManager.stopByAnimationGroupId(this.id);const a=tv(ev(this.isVertical(),"fade"));sv.fromToMotion(this.id,"datums",this.ctx.animationManager,[e],a,(n,r)=>lV(r.xValue,r.valueIndex),s),iv(this,"labels",this.ctx.animationManager,i)}getDatumId(t){return`${t.xValue}-${t.valueIndex}`}isLabelEnabled(){return this.properties.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t,seriesRect:e}){return cV(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};su.className="RangeBarSeries",su.type="range-bar";import{_Theme as au}from"ag-charts-community";var gV={series:{direction:"vertical",strokeWidth:0,label:{enabled:!1,fontSize:12,fontFamily:au.DEFAULT_FONT_FAMILY,color:au.DEFAULT_INSIDE_SERIES_LABEL_COLOUR,placement:"inside"}},axes:{[au.CARTESIAN_AXIS_TYPE.NUMBER]:{crosshair:{enabled:!0}}}},yV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"range-bar",moduleFactory:t=>new su(t),tooltipDefaults:{range:"exact"},defaultAxes:wn.swapAxisCondition([{type:wn.CARTESIAN_AXIS_TYPE.NUMBER,position:wn.CARTESIAN_POSITION.LEFT},{type:wn.CARTESIAN_AXIS_TYPE.CATEGORY,position:wn.CARTESIAN_POSITION.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:gV,paletteFactory:({takeColors:t})=>{const{fills:[e],strokes:[i]}=t(1);return{fill:e,stroke:i}},groupable:!0};import{_Theme as fV}from"ag-charts-community";import{_ModuleSupport as mV,_Scene as av,_Util as xV}from"ag-charts-community";function nv(t){t.nodes.sort((e,i)=>Math.round((e.datum.y-i.datum.y)*100)/100||-(e.datum.size-i.datum.size))}function SV({nodes:t,size:e},{seriesRectHeight:i,nodeSpacing:o,sizeScale:s}){const a=i*e*s;let r=(i-(a+o*(t.length-1)))/2;t.forEach(({datum:l})=>{const c=i*l.size*s;l.y=r,l.height=c,r+=c+o})}function bV(t,e){const{nodes:i}=t,{seriesRectHeight:o,nodeSpacing:s}=e;nv(t);let a=0,n=0;for(const{datum:c}of i){const h=Math.max(n-c.y,0);c.y+=h,a+=h,n=c.y+c.height+s}if(n-s<o)return a>0;let l=o;for(let c=i.length-1;c>=0;c-=1){const{datum:h}=i[c],p=h.y+h.height,u=Math.min(l-p,0);h.y+=u,a+=u,l=h.y-s}return!0}function nu(t,e,i,o,s,a,n,r){const l=(i-t)/(o-e),c=(n-s)/(r-a),h=((a-e)*(l*c)+t*c-s*l)/(c-l);return t<i?h>t&&h<Math.min(i,n):h<t&&h>Math.max(i,n)}function rv(t,e){let i=!1;const o=t.nodes.filter(a=>e(a).length===1);let s=!0;for(let a=0;s&&a<o.length;a+=1){s=!1;for(let n=0;n<o.length-1;n+=1){const{datum:r}=o[n],l=e(o[n])[0].node.datum,{datum:c}=o[n+1],h=e(o[n+1])[0].node.datum;if(!(nu(r.x,r.y,l.x,l.y,c.x,c.y,h.x,h.y)||nu(r.x,r.y+r.height/2,l.x,l.y+l.height/2,c.x,c.y+c.height/2,h.x,h.y+h.height/2)||nu(r.x,r.y+r.height,l.x,l.y+l.height,c.x,c.y+c.height,h.x,h.y+h.height)))continue;const u=o[n];o[n]=o[n+1],o[n+1]=u;const y=r.y;r.y=c.y+c.height-r.height,c.y=y,i=!0,s=!0}}return i}function vV(t){let e=!1;return nv(t),e=rv(t,i=>i.linksBefore)||e,e=rv(t,i=>i.linksAfter)||e,e}function MV(t){if(t.length===0)return;let e=0,i=0;for(const{node:{datum:o}}of t)e+=o.y*o.size,i+=o.size;return e/i}function lv(t,e,i,o){return t.nodes.forEach(({datum:s,linksBefore:a,linksAfter:n})=>{const r=o===1?a:n,l=o===1?n:a,c=MV(r);if(c!=null){const h=l.length!==0?i:1;s.y=s.y+(c-s.y)*h}}),bV(t,e)}function cv(t,e,i){let o=!1;for(const s of t)o=lv(s,e,i,1)||o;return o}function TV(t,e,i){let o=!1;for(let s=t.length-1;s>=0;s-=1)o=lv(t[s],e,i,-1)||o;return o}function hv(t){let e=!1;for(let i=t.length-1;i>=0;i-=1)e=vV(t[i])||e;return e}function AV(t,e){t.forEach(o=>{SV(o,e)});let i=!1;for(let o=0;o<6;o+=1){const s=cv(t,e,1);i=TV(t,e,.5);const a=hv(t);if(!s&&!i&&!a)break}i&&(cv(t,e,1),hv(t))}import{_Scene as DV}from"ag-charts-community";var{BBox:kV,Path:IV,ScenePathChangeDetection:Ra,splitBezier:NV}=DV;function Ul(t,e,i,o,s,a,n,r,l,c){let h,p;if(s!==i&&l!==n){const T=-(o-e)/(s-i),A=-(r-a)/(l-n);h=(n-i+T*e-A*a)/(T-A),p=T*(h-e)+i}else if(s===i&&l!==n)h=e,p=-(r-a)/(l-n)*(h-r)+l;else if(s!==i&&l===n)h=r,p=-(o-e)/(s-i)*(h-e)+i;else throw new Error("Offsetting flat bezier curve");const u=Math.hypot(i-p,e-h),y=(u+c)/u,g=Math.hypot(l-p,r-h),f=(g+c)/g,m=h+(o-h)*y,v=p+(s-p)*y,b=h+(a-h)*f,S=p+(n-p)*f,x=h+(r-h)*f,M=p+(l-p)*f;t.cubicCurveTo(m,v,b,S,x,M)}var Ns=class extends IV{constructor(){super(...arguments),this.x1=0,this.x2=0,this.y1=0,this.y2=0,this.height=0,this.inset=0}computeBBox(){const t=Math.min(this.x1,this.x2),e=Math.max(this.x1,this.x2)-t,i=Math.min(this.y1,this.y2),o=Math.max(this.y1,this.y2)-i+this.height;return new kV(t,i,e,o)}updatePath(){const{path:t,inset:e}=this;t.clear();const i=this.x1+e,o=this.x2-e,s=this.y1+e,a=this.y2+e,n=this.height-2*e;if(n<0||i>o)return;const r=i,l=s+n/2,c=(i+o)/2,h=s+n/2,p=(i+o)/2,u=a+n/2,y=o,g=a+n/2;if(t.moveTo(r,l-n/2),Math.abs(this.y2-this.y1)<1||this.x2-this.x1<this.height*Math.SQRT2)t.cubicCurveTo(c,h-n/2,p,u-n/2,y,g-n/2),t.lineTo(y,g+n/2),t.cubicCurveTo(p,u+n/2,c,h+n/2,r,l+n/2);else{const[f,m]=NV(r,l,c,h,p,u,y,g,.5),v=(a>s?1:-1)*n/2;Ul(t,f[0].x,f[0].y,f[1].x,f[1].y,f[2].x,f[2].y,f[3].x,f[3].y,v),Ul(t,m[0].x,m[0].y,m[1].x,m[1].y,m[2].x,m[2].y,m[3].x,m[3].y,-v),t.lineTo(y,g+n/2),Ul(t,m[3].x,m[3].y,m[2].x,m[2].y,m[1].x,m[1].y,m[0].x,m[0].y,v),Ul(t,f[3].x,f[3].y,f[2].x,f[2].y,f[1].x,f[1].y,f[0].x,f[0].y,-v)}t.closePath()}};d([Ra()],Ns.prototype,"x1",2),d([Ra()],Ns.prototype,"x2",2),d([Ra()],Ns.prototype,"y1",2),d([Ra()],Ns.prototype,"y2",2),d([Ra()],Ns.prototype,"height",2),d([Ra()],Ns.prototype,"inset",2);import{_ModuleSupport as OV,_Scene as LV}from"ag-charts-community";var{BaseProperties:dv,SeriesTooltip:CV,SeriesProperties:EV,ARRAY:_V,COLOR_STRING:Hl,COLOR_STRING_ARRAY:pv,FUNCTION:uv,LINE_DASH:gv,OBJECT:Gl,POSITIVE_NUMBER:Os,RATIO:Wl,STRING:Ro,UNION:RV,Validate:J}=OV,{Label:wV}=LV,PV=RV(["left","right","center","justify"],"a justification value"),yv=class extends wV{constructor(){super(...arguments),this.spacing=1}};d([J(Os)],yv.prototype,"spacing",2);var po=class extends dv{constructor(){super(...arguments),this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([J(Hl,{optional:!0})],po.prototype,"fill",2),d([J(Wl)],po.prototype,"fillOpacity",2),d([J(Hl,{optional:!0})],po.prototype,"stroke",2),d([J(Wl)],po.prototype,"strokeOpacity",2),d([J(Os)],po.prototype,"strokeWidth",2),d([J(gv)],po.prototype,"lineDash",2),d([J(Os)],po.prototype,"lineDashOffset",2),d([J(uv,{optional:!0})],po.prototype,"itemStyler",2);var $e=class extends dv{constructor(){super(...arguments),this.spacing=1,this.width=1,this.alignment="justify",this.fill=void 0,this.fillOpacity=1,this.stroke=void 0,this.strokeOpacity=1,this.strokeWidth=1,this.lineDash=[0],this.lineDashOffset=0}};d([J(Os)],$e.prototype,"spacing",2),d([J(Os)],$e.prototype,"width",2),d([J(PV)],$e.prototype,"alignment",2),d([J(Hl,{optional:!0})],$e.prototype,"fill",2),d([J(Wl)],$e.prototype,"fillOpacity",2),d([J(Hl,{optional:!0})],$e.prototype,"stroke",2),d([J(Wl)],$e.prototype,"strokeOpacity",2),d([J(Os)],$e.prototype,"strokeWidth",2),d([J(gv)],$e.prototype,"lineDash",2),d([J(Os)],$e.prototype,"lineDashOffset",2),d([J(uv,{optional:!0})],$e.prototype,"itemStyler",2);var ue=class extends EV{constructor(){super(...arguments),this.nodes=void 0,this.idKey="",this.idName=void 0,this.labelKey=void 0,this.labelName=void 0,this.sizeKey=void 0,this.sizeName=void 0,this.fills=[],this.strokes=[],this.label=new yv,this.link=new po,this.node=new $e,this.tooltip=new CV}};d([J(_V,{optional:!0})],ue.prototype,"nodes",2),d([J(Ro)],ue.prototype,"fromKey",2),d([J(Ro)],ue.prototype,"toKey",2),d([J(Ro)],ue.prototype,"idKey",2),d([J(Ro,{optional:!0})],ue.prototype,"idName",2),d([J(Ro,{optional:!0})],ue.prototype,"labelKey",2),d([J(Ro,{optional:!0})],ue.prototype,"labelName",2),d([J(Ro,{optional:!0})],ue.prototype,"sizeKey",2),d([J(Ro,{optional:!0})],ue.prototype,"sizeName",2),d([J(pv)],ue.prototype,"fills",2),d([J(pv)],ue.prototype,"strokes",2),d([J(Gl)],ue.prototype,"label",2),d([J(Gl)],ue.prototype,"link",2),d([J(Gl)],ue.prototype,"node",2),d([J(Gl)],ue.prototype,"tooltip",2);var{SeriesNodePickMode:fv,CachedTextMeasurerPool:BV,TextWrapper:mv,TextUtils:xv,createDatumId:Sv,EMPTY_TOOLTIP_CONTENT:zV}=mV,{sanitizeHtml:bv,Logger:FV}=xV,{Rect:VV,BBox:UV}=av,ru=class extends Dd{constructor(t){super({moduleCtx:t,contentGroupVirtual:!1,pickModes:[fv.NEAREST_NODE,fv.EXACT_SHAPE_MATCH]}),this.properties=new ue}isLabelEnabled(){return(this.properties.labelKey!=null||this.nodes==null)&&this.properties.label.enabled}linkFactory(){return new Ns}nodeFactory(){return new VV}async createNodeData(){const{id:t,_nodeDataDependencies:{seriesRectWidth:e,seriesRectHeight:i}={seriesRectWidth:0,seriesRectHeight:0}}=this,{fromKey:o,toKey:s,sizeKey:a,label:{spacing:n},node:{spacing:r,width:l,alignment:c}}=this.properties,{nodeGraph:h,links:p,maxPathLength:u}=this.getNodeGraph(A=>({...A,size:0,x:NaN,y:NaN,width:l,height:NaN}),A=>({...A,x1:NaN,x2:NaN,y1:NaN,y2:NaN,height:NaN}),{includeCircularReferences:!1}),y=h,g=this.isLabelEnabled()?(e-l)*(1-u/(u+1)):0,f=(e-l-2*g)/(u-1),m=[];for(let A=0;A<u;A+=1){const D=g+A*f;m.push({index:A,size:0,nodes:[],x:D})}y.forEach(A=>{const{datum:D,linksBefore:I,linksAfter:N,maxPathLengthBefore:O,maxPathLengthAfter:L}=A,C=Math.max(I.reduce((w,{link:B})=>w+B.size,0),N.reduce((w,{link:B})=>w+B.size,0));if(I.length===0&&N.length===0||C===0){A.columnIndex=-1;return}let k;switch(c){case"left":k=m[O];break;case"right":k=m[u-1-L];break;case"center":{if(I.length!==0)k=m[O];else if(N.length!==0){const w=N.reduce((B,P)=>Math.min(B,P.node.maxPathLengthBefore),u)-1;k=m[w]}else k=m[0];break}case"justify":{k=N.length===0?m[u-1]:m[O];break}}D.x=k.x,D.size=C;const E=w=>String(w),_=this.getLabelText(this.properties.label,{datum:D.datum,value:D.label,fromKey:o,toKey:s,sizeKey:a,size:C},E);D.label=String(_),k.nodes.push(A),k.size+=C,A.columnIndex=k.index}),y.forEach(A=>{let D=1/0,I=0;A.linksAfter.forEach(N=>{const O=N.node,{columnIndex:L}=O;L<D?(D=L,I=O.datum.size):L===D&&(I=Math.max(I,O.datum.size))}),A.closestColumnIndex=D,A.maxSizeOfClosestNodesAfter=I});const v=m.reduce((A,{size:D,nodes:I})=>{const N=(1-(I.length-1)*(r/i))/D;return Math.min(A,N)},1/0);for(let A=m.length-1;A>=0;A-=1)m[A].nodes.sort((I,N)=>I.closestColumnIndex-N.closestColumnIndex||I.maxSizeOfClosestNodesAfter-N.maxSizeOfClosestNodesAfter||I.datum.size-N.datum.size);AV(m,{seriesRectHeight:i,nodeSpacing:r,sizeScale:v});let b=!1;if(y.forEach(({datum:A,linksBefore:D,linksAfter:I})=>{b||(b=A.height<0);const N=A.y+A.height,O=k=>k.sort((E,_)=>{const w=E.node.datum,B=_.node.datum,P=w.y+w.height,R=B.y+B.height,z=Math.atan2(w.y-A.y,Math.abs(w.x-A.x))-Math.atan2(B.y-A.y,Math.abs(B.x-A.x)),F=Math.atan2(P-N,Math.abs(w.x-A.x))-Math.atan2(R-N,Math.abs(B.x-A.x));return z+F});let L=A.y;O(D).forEach(({link:k})=>{k.y2=L,L+=k.size*i*v});let C=A.y;O(I).forEach(({link:k})=>{k.y1=C,C+=k.size*i*v})}),b){FV.warnOnce("There was insufficient space to display the Sankey Series. Reduce the node spacing, or provide a larger container.");return}const S=[],x=[],{fontSize:M}=this.properties.label,T=this.properties.label.getFont();return m.forEach((A,D)=>{const I=D===0,N=D===m.length-1;let O=-1/0;A.nodes.sort((L,C)=>L.datum.y-C.datum.y),A.nodes.forEach(({datum:L})=>{if(L.midPoint={x:L.x+L.width/2,y:L.y+L.height/2},S.push(L),L.label==null)return;const C=I?L.x-n:L.x+L.width+n,k=L.y+L.height/2;let E;if(!I&&!N){const P=k-xv.getLineHeight(M),R=k+xv.getLineHeight(M);let z=e;y.forEach(({datum:U})=>{U.x>L.x&&Math.max(U.y,P)<=Math.min(U.y+U.height,R)&&(z=Math.min(z,U.x-n))});const F=z-L.x-2*n;E=mv.wrapText(L.label,{maxWidth:F,maxHeight:L.height,font:this.properties.label,textWrap:"never",overflow:"hide"})}if(E==null||E===""){const P=I||N?n:n*2;E=mv.wrapText(L.label,{maxWidth:f-P,maxHeight:L.height,font:this.properties.label,textWrap:"never"})}if(E==="")return;const{height:_}=BV.measureText(E,{font:T,textAlign:"left",textBaseline:"middle"}),w=k-_/2,B=k+_/2;w>=O&&(x.push({x:C,y:k,leading:I,text:E}),O=B)})}),p.forEach(A=>{const{fromNode:D,toNode:I,size:N}=A;A.height=i*N*v,A.x1=D.x+l,A.x2=I.x,A.midPoint={x:(A.x1+A.x2)/2,y:(A.y1+A.y2)/2+A.height/2},S.push(A)}),{itemId:t,nodeData:S,labelData:x}}async updateLabelSelection(t){const e=this.isLabelEnabled()?t.labelData:[];return t.labelSelection.update(e)}async updateLabelNodes(t){const{labelSelection:e}=t,{color:i,fontStyle:o,fontWeight:s,fontSize:a,fontFamily:n}=this.properties.label;e.each((r,{x:l,y:c,leading:h,text:p})=>{r.visible=!0,r.x=l,r.y=c,r.text=p,r.fill=i,r.fontStyle=o,r.fontWeight=s,r.fontSize=a,r.fontFamily=n,r.textAlign=h?"right":"left",r.textBaseline="middle"})}async updateNodeSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Sv([e.type,e.id]))}async updateNodeNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=this.properties,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,itemStyler:f}=this.properties.node,m=i?s.highlightStyle.item:void 0,v=this.getStrokeWidth(s.node.strokeWidth);e.each((b,S)=>{const x=c??S.fill,M=p??S.stroke;let T;if(f!=null){const{label:A,size:D}=S;T=a.call(f,{seriesId:o,datum:S.datum,label:A,size:D,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:M,strokeWidth:v,lineDash:y,lineDashOffset:g,highlighted:i})}b.x=S.x,b.y=S.y,b.width=Math.max(S.width,0),b.height=Math.max(S.height,0),b.fill=m?.fill??T?.fill??x,b.fillOpacity=m?.fillOpacity??T?.fillOpacity??h,b.stroke=m?.stroke??T?.stroke??M,b.strokeOpacity=m?.strokeOpacity??T?.strokeOpacity??u,b.strokeWidth=m?.strokeWidth??T?.strokeWidth??v,b.lineDash=m?.lineDash??T?.lineDash??y,b.lineDashOffset=m?.lineDashOffset??T?.lineDashOffset??g})}async updateLinkSelection(t){return t.datumSelection.update(t.nodeData,void 0,e=>Sv([e.type,e.index,e.fromNode.id,e.toNode.id]))}async updateLinkNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,properties:s,ctx:{callbackCache:a}}=this,{fromKey:n,toKey:r,sizeKey:l}=s,{fill:c,fillOpacity:h,stroke:p,strokeOpacity:u,lineDash:y,lineDashOffset:g,itemStyler:f}=s.link,m=i?s.highlightStyle.item:void 0,v=this.getStrokeWidth(s.link.strokeWidth);e.each((b,S)=>{const x=c??S.fromNode.fill,M=p??S.fromNode.stroke;let T;f!=null&&(T=a.call(f,{seriesId:o,datum:S.datum,fromKey:n,toKey:r,sizeKey:l,fill:x,fillOpacity:h,strokeOpacity:u,stroke:M,strokeWidth:v,lineDash:y,lineDashOffset:g,highlighted:i})),b.x1=S.x1,b.y1=S.y1,b.x2=S.x2,b.y2=S.y2,b.height=S.height,b.fill=m?.fill??T?.fill??x,b.fillOpacity=m?.fillOpacity??T?.fillOpacity??h,b.stroke=m?.stroke??T?.stroke??M,b.strokeOpacity=m?.strokeOpacity??T?.strokeOpacity??u,b.strokeWidth=Math.min(m?.strokeWidth??T?.strokeWidth??v,S.height/2),b.lineDash=m?.lineDash??T?.lineDash??y,b.lineDashOffset=m?.lineDashOffset??T?.lineDashOffset??g,b.inset=b.strokeWidth/2})}getTooltipHtml(t){const{id:e,processedData:i,ctx:{callbackCache:o},properties:s}=this;if(!i||!s.isValid())return zV;const{fromKey:a,toKey:n,sizeKey:r,sizeName:l,tooltip:c}=s,{datum:h,itemId:p,size:u}=t;let y;const g=[];let f;if(t.type===0){const{fillOpacity:b,strokeOpacity:S,strokeWidth:x,lineDash:M,lineDashOffset:T,itemStyler:A}=s.link,{fromNode:D,toNode:I}=t;y=`${D.label??D.id} - ${I.label??I.id}`,r!=null&&g.push(bv(`${l??r}: `+u)),f=s.link.fill??D.fill;const N=s.link.stroke??D.stroke;let O;A!=null&&(O=o.call(A,{seriesId:e,datum:h.datum,fromKey:a,toKey:n,sizeKey:r,fill:f,fillOpacity:b,strokeOpacity:S,stroke:N,strokeWidth:x,lineDash:M,lineDashOffset:T,highlighted:!0})),f=O?.fill??f}else{const{fillOpacity:b,strokeOpacity:S,strokeWidth:x,lineDash:M,lineDashOffset:T,itemStyler:A}=s.node,{id:D,label:I}=t;y=I??D,r!=null&&g.push(bv(`${l??r}: `+u)),f=s.link.fill??h.fill;const N=s.link.stroke??h.stroke;let O;A!=null&&(O=o.call(A,{seriesId:e,datum:h.datum,label:I,size:u,fromKey:a,toKey:n,sizeKey:r,fill:f,fillOpacity:b,strokeOpacity:S,stroke:N,strokeWidth:x,lineDash:M,lineDashOffset:T,highlighted:!0})),f=O?.fill??f}const m=g.join("<br>"),v=f;return c.toTooltipHtml({title:y,content:m,backgroundColor:v},{seriesId:e,datum:h,size:u,title:y,color:v,itemId:p,fromKey:a,toKey:n,sizeKey:r,sizeName:l,...this.getModuleTooltipParams()})}getLabelData(){return[]}computeFocusBounds({datumIndex:t,seriesRect:e}){const i=this.contextNodeData?.nodeData[t];if(i?.type===1){const{x:o,y:s,width:a,height:n}=i,r=new UV(o,s,a,n);return av.Transformable.toCanvas(this.contentGroup,r).clip(e)}else if(i?.type===0){for(const o of this.linkSelection)if(o.datum===i)return o.node;return}}};ru.className="SankeySeries",ru.type="sankey";var{DEFAULT_FONT_FAMILY:HV,DEFAULT_LABEL_COLOUR:GV}=fV,WV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["flow-proportion"],solo:!0,identifier:"sankey",moduleFactory:t=>new ru(t),tooltipDefaults:{range:"exact"},themeTemplate:{seriesArea:{padding:{top:10,bottom:10}},series:{highlightStyle:{series:{dimOpacity:.2}},label:{fontFamily:HV,color:GV,fontSize:12,spacing:10},node:{spacing:20,width:10,strokeWidth:0},link:{fillOpacity:.5,strokeWidth:0}},legend:{enabled:!1,toggleSeries:!1}},paletteFactory({takeColors:t,colorsCount:e}){return t(e)}};import{_Theme as vv}from"ag-charts-community";import{_ModuleSupport as Kl,_Scene as lu,_Util as Mv}from"ag-charts-community";import{_ModuleSupport as KV}from"ag-charts-community";var{HierarchySeriesProperties:YV,HighlightStyle:jV,SeriesTooltip:XV,Validate:Ot,COLOR_STRING:ZV,FUNCTION:$V,NUMBER:Tv,OBJECT:wa,POSITIVE_NUMBER:cu,RATIO:Yl,STRING:jl}=KV,wo=class extends jV{constructor(){super(...arguments),this.label=new wi,this.secondaryLabel=new wi}};d([Ot(jl,{optional:!0})],wo.prototype,"fill",2),d([Ot(Yl,{optional:!0})],wo.prototype,"fillOpacity",2),d([Ot(ZV,{optional:!0})],wo.prototype,"stroke",2),d([Ot(cu,{optional:!0})],wo.prototype,"strokeWidth",2),d([Ot(Yl,{optional:!0})],wo.prototype,"strokeOpacity",2),d([Ot(wa)],wo.prototype,"label",2),d([Ot(wa)],wo.prototype,"secondaryLabel",2);var ve=class extends YV{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=0,this.strokeOpacity=1,this.cornerRadius=0,this.highlightStyle=new wo,this.label=new wi,this.secondaryLabel=new bn,this.tooltip=new XV}};d([Ot(jl,{optional:!0})],ve.prototype,"sizeName",2),d([Ot(jl,{optional:!0})],ve.prototype,"labelKey",2),d([Ot(jl,{optional:!0})],ve.prototype,"secondaryLabelKey",2),d([Ot(Yl)],ve.prototype,"fillOpacity",2),d([Ot(cu)],ve.prototype,"strokeWidth",2),d([Ot(Yl)],ve.prototype,"strokeOpacity",2),d([Ot(cu)],ve.prototype,"cornerRadius",2),d([Ot(Tv,{optional:!0})],ve.prototype,"sectorSpacing",2),d([Ot(Tv,{optional:!0})],ve.prototype,"padding",2),d([Ot($V,{optional:!0})],ve.prototype,"itemStyler",2),d([Ot(wa)],ve.prototype,"highlightStyle",2),d([Ot(wa)],ve.prototype,"label",2),d([Ot(wa)],ve.prototype,"secondaryLabel",2),d([Ot(wa)],ve.prototype,"tooltip",2);var{fromToMotion:QV,formatValue:Av}=Kl,{Sector:Xl,ScalableGroup:Dv,Selection:kv,TransformableText:Pn}=lu,{sanitizeHtml:hu}=Mv,Iv=(t,e=0,i=2*Math.PI/t.sumSize,o=Array.from(t,()=>{}))=>{let s=e;for(const a of t.children){const n=s,r=s+a.sumSize*i;o[a.index]={start:n,end:r},Iv(a,n,i,o),s=r}return o},du=class extends Kl.HierarchySeries{constructor(){super(...arguments),this.properties=new ve,this.groupSelection=kv.select(this.contentGroup,Dv),this.highlightSelection=kv.select(this.highlightGroup,Dv),this.angleData=[]}async processData(){const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n}=this.properties;await super.processData(),this.angleData=Iv(this.rootNode),this.labelData=Array.from(this.rootNode,({datum:r,depth:l})=>{let c;if(r!=null&&l!=null&&o!=null){const p=r[o];c=this.getLabelText(this.properties.label,{depth:l,datum:r,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:p},Av)}c===""&&(c=void 0);let h;if(r!=null&&l!=null&&s!=null){const p=r[s];h=this.getLabelText(this.properties.secondaryLabel,{depth:l,datum:r,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:p},Av)}return h===""&&(h=void 0),c!=null||h!=null?{label:c,secondaryLabel:h}:void 0})}async updateSelections(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{chart:t}=this;if(t==null||t.seriesRect==null)return;const i=Array.from(this.rootNode),o=s=>{s.append([new Xl,new Pn({tag:0}),new Pn({tag:1})])};this.groupSelection.update(i,o,s=>this.getDatumId(s)),this.highlightSelection.update(i,o,s=>this.getDatumId(s))}async updateNodes(){const{chart:t,data:e,maxDepth:i,labelData:o}=this;if(t==null||e==null||o==null)return;const{width:s,height:a}=t.seriesRect,{sectorSpacing:n=0,padding:r=0,cornerRadius:l,highlightStyle:c}=this.properties;this.contentGroup.translationX=s/2,this.contentGroup.translationY=a/2,this.highlightGroup.translationX=s/2,this.highlightGroup.translationY=a/2;const h=n*.5,u=Math.min(s,a)/2/(i+1),y=-Math.PI/2,g=this.ctx.highlightManager?.getActiveHighlight();new Pn().setFont(this.properties.label),this.rootNode.walk(S=>{const x=this.angleData[S.index];if(S.depth!=null&&x!=null){const M=x.end-x.start,T=(S.depth+.5)*u;S.midPoint.x=Math.cos(M)*T,S.midPoint.y=Math.sin(M)*T}});const m=(S,x,M)=>{const{depth:T}=S,A=this.angleData[S.index];if(T==null||A==null){x.visible=!1;return}x.visible=!0;let D,I,N,O,L;M&&(D=c.fill,I=c.fillOpacity,N=c.stroke,O=c.strokeWidth,L=c.strokeOpacity);const C=this.getSectorFormat(S,M),k=C?.fill??D??S.fill,E=C?.fillOpacity??I??this.properties.fillOpacity,_=C?.stroke??N??S.stroke,w=C?.strokeWidth??O??this.properties.strokeWidth,B=C?.strokeOpacity??L??this.properties.strokeOpacity;x.fill=k,x.fillOpacity=E,x.stroke=_,x.strokeWidth=w,x.strokeOpacity=B,x.centerX=0,x.centerY=0,x.innerRadius=T*u,x.outerRadius=(T+1)*u,x.startAngle=A.start+y,x.endAngle=A.end+y,x.inset=h+w*.5,x.cornerRadius=l};this.groupSelection.selectByClass(Xl).forEach(S=>{m(S.datum,S,!1)}),this.highlightSelection.selectByClass(Xl).forEach(S=>{const x=S.datum,M=g===x;S.visible=M,S.visible&&m(S.datum,S,M)});const v=Array.from(this.rootNode,(S,x)=>{const{depth:M}=S,T=o[x],A=this.angleData[x];if(M==null||A==null)return;const D=M*u+h,I=(M+1)*u-h,N=D>h?h/D:h,O=I>h?h/I:h,L=A.start+N,k=A.end+N-L,E=A.start+O,w=A.end+O-E,B=nt=>{if(M===0&&S.parent?.sumSize===S.sumSize)return{width:2*Math.sqrt(I**2-(nt*.5)**2),height:nt,meta:0};const tt=nt,ht=2*Math.sqrt(I**2-(D+tt)**2),yt=k<Math.PI?2*D*Math.tan(k*.5):1/0,it=Math.min(ht,yt),$=Math.PI/4;let Tt,Vt;return M===0?(Tt=nt,Vt=Math.sqrt(I**2-(Tt/2)**2)-nt/(2*Math.tan(w*.5))):Mv.normalizeAngle360(k)<$?(Tt=2*D*Math.tan(k*.5),Vt=Math.sqrt(I**2-(Tt/2)**2)-D):(Vt=0,Tt=0),it>=Vt?{width:it,height:tt,meta:1}:{width:Vt,height:Tt,meta:2}},P=_d(T?.label,this.properties.label,T?.secondaryLabel,this.properties.secondaryLabel,{padding:r},B);if(P==null)return;const{width:R,height:z,meta:F,label:U,secondaryLabel:G}=P,V=y+(A.start+A.end)/2,j=Math.sin(V)>=0,K=Math.cos(V)>=0,Z=(j?3:12)&(K?6:9);let gt;switch(F){case 0:gt=0;break;case 1:{const et=I-(u-z)*.58,tt=Math.sqrt((I-r)**2-(R/2)**2);gt=Math.min(et,tt);break}case 2:if(M===0){const nt=z/(2*Math.tan(k*.5))+R*.5,et=Math.sqrt(I**2-(z*.5)**2)-R*.5;gt=(nt+et)*.5}else gt=(D+I)*.5;break}return{width:R,height:z,labelPlacement:F,circleQuarter:Z,radius:gt,theta:V,label:U,secondaryLabel:G}}),b=(S,x,M,T)=>{const{index:A,depth:D}=S,I=v?.[A],N=M===0?this.properties.label:this.properties.secondaryLabel,O=M===0?I?.label:I?.secondaryLabel;if(D==null||I==null||O==null){x.visible=!1;return}const{height:L,labelPlacement:C,circleQuarter:k,radius:E,theta:_}=I;let w;switch(T&&(w=(M===0?this.properties.highlightStyle.label:this.properties.highlightStyle.secondaryLabel).color),x.text=O.text,x.fontSize=O.fontSize,x.lineHeight=O.lineHeight,x.fontStyle=N.fontStyle,x.fontFamily=N.fontFamily,x.fontWeight=N.fontWeight,x.fill=w??N.color,C){case 0:x.textAlign="center",x.textBaseline="top",x.translationX=0,x.translationY=(M===0?0:L-O.height)-L*.5,x.rotation=0;break;case 1:{const B=(k&3)!==0,P=M===0==!B?E:E-(L-O.height);x.textAlign="center",x.textBaseline=B?"bottom":"top",x.translationX=Math.cos(_)*P,x.translationY=Math.sin(_)*P,x.rotation=B?_-Math.PI*.5:_+Math.PI*.5;break}case 2:{const B=(k&6)!==0,P=M===0==!B?(L-O.height)*.5:(O.height-L)*.5;x.textAlign="center",x.textBaseline="middle",x.translationX=Math.cos(_)*E+Math.cos(_+Math.PI/2)*P,x.translationY=Math.sin(_)*E+Math.sin(_+Math.PI/2)*P,x.rotation=B?_:_+Math.PI;break}}x.visible=!0};this.groupSelection.selectByClass(Pn).forEach(S=>{b(S.datum,S,S.tag,!1)}),this.highlightSelection.selectByClass(Pn).forEach(S=>{const x=S.datum,M=g===x;S.visible=M,S.visible&&b(S.datum,S,S.tag,M)})}getSectorFormat(t,e){const{datum:i,fill:o,stroke:s,depth:a}=t,{ctx:{callbackCache:n},properties:{itemStyler:r}}=this;if(!r||i==null||a==null)return{};const{colorKey:l,childrenKey:c,labelKey:h,secondaryLabelKey:p,sizeKey:u,strokeWidth:y,fillOpacity:g,strokeOpacity:f}=this.properties;return n.call(r,{seriesId:this.id,highlighted:e,datum:i,depth:a,colorKey:l,childrenKey:c,labelKey:h,secondaryLabelKey:p,sizeKey:u,fill:o,fillOpacity:g,stroke:s,strokeWidth:y,strokeOpacity:f})}getTooltipHtml(t){const{id:e}=this,{tooltip:i,colorKey:o,colorName:s=o,labelKey:a,secondaryLabelKey:n,sizeKey:r,sizeName:l=r,childrenKey:c}=this.properties,{datum:h,depth:p}=t;if(h==null||p==null)return Kl.EMPTY_TOOLTIP_CONTENT;const u=a!=null?h[a]:void 0,g=this.getSectorFormat(t,!1)?.fill??t.fill;if(!i.renderer&&!u)return Kl.EMPTY_TOOLTIP_CONTENT;const f=[],m=n!=null?h[n]:void 0;m!=null&&n!==o&&n!==r&&f.push(hu(m));const v=r!=null?h[r]:void 0;v!=null&&f.push(`${l}: ${hu(v)}`);const b=o!=null?h[o]:void 0;b!=null&&f.push(`${s}: ${hu(b)}`);const S=f.join("<br>"),x={title:u,color:this.properties.label.color,backgroundColor:g,content:S};return i.toTooltipHtml(x,{depth:p,datum:h,colorKey:o,labelKey:a,secondaryLabelKey:n,sizeKey:r,title:u,color:g,seriesId:e,childrenKey:c,colorName:s,itemId:void 0,sizeName:l})}async createNodeData(){}pickNodeClosestDatum(t){return this.pickNodeNearestDistantObject(t,this.groupSelection.selectByClass(Xl))}animateEmptyUpdateReady({datumSelections:t}){QV(this.id,"nodes",this.ctx.animationManager,t,{toFn(e,i,o){return{scalingX:1,scalingY:1}},fromFn(e,i,o){return o==="unknown"&&i!=null&&e.previousDatum==null?{scalingX:0,scalingY:0}:{scalingX:1,scalingY:1}}})}computeFocusBounds(t){let e;for(const{node:i,datum:o}of this.groupSelection)o===t&&(e=lu.Selection.selectByClass(i,lu.Sector)[0]);return e}};du.className="SunburstSeries",du.type="sunburst";var{DEFAULT_INSIDE_SERIES_LABEL_COLOUR:Zl}=vv,qV={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"sunburst",moduleFactory:t=>new du(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{label:{fontSize:14,minimumFontSize:9,color:Zl,overflowStrategy:"ellipsis",wrapping:"never",spacing:2},secondaryLabel:{fontSize:8,minimumFontSize:7,color:Zl,overflowStrategy:"ellipsis",wrapping:"never"},sectorSpacing:2,padding:3,highlightStyle:{label:{color:Zl},secondaryLabel:{color:Zl},stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(vv.DEFAULT_DIVERGING_SERIES_COLOR_RANGE);return{fills:o,strokes:s,colorRange:a}}};import{_Theme as JV}from"ag-charts-community";import{_ModuleSupport as $l,_Scene as pu,_Util as tU}from"ag-charts-community";import{_ModuleSupport as eU,_Scene as iU}from"ag-charts-community";var{Label:oU}=iU,{BaseProperties:Ql,HierarchySeriesProperties:sU,HighlightStyle:aU,SeriesTooltip:nU,Validate:Y,BOOLEAN:rU,COLOR_STRING:ql,FUNCTION:lU,NUMBER:cU,OBJECT:Qe,POSITIVE_NUMBER:Ui,RATIO:Po,STRING:Ls,STRING_ARRAY:Nv,TEXT_ALIGN:Ov,VERTICAL_ALIGN:hU}=eU,Lv=class extends oU{constructor(){super(...arguments),this.spacing=0}};d([Y(cU)],Lv.prototype,"spacing",2);var qe=class extends Ql{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.gap=0,this.padding=0,this.interactive=!0,this.label=new Lv}};d([Y(Ls,{optional:!0})],qe.prototype,"fill",2),d([Y(Po)],qe.prototype,"fillOpacity",2),d([Y(ql,{optional:!0})],qe.prototype,"stroke",2),d([Y(Ui)],qe.prototype,"strokeWidth",2),d([Y(Po)],qe.prototype,"strokeOpacity",2),d([Y(Ui)],qe.prototype,"cornerRadius",2),d([Y(Ov)],qe.prototype,"textAlign",2),d([Y(Ui)],qe.prototype,"gap",2),d([Y(Ui)],qe.prototype,"padding",2),d([Y(rU)],qe.prototype,"interactive",2),d([Y(Qe)],qe.prototype,"label",2);var Ve=class extends Ql{constructor(){super(...arguments),this.fillOpacity=1,this.strokeWidth=1,this.strokeOpacity=1,this.cornerRadius=0,this.textAlign="center",this.verticalAlign="middle",this.gap=0,this.padding=0,this.label=new wi,this.secondaryLabel=new bn}};d([Y(Ls,{optional:!0})],Ve.prototype,"fill",2),d([Y(Po)],Ve.prototype,"fillOpacity",2),d([Y(ql,{optional:!0})],Ve.prototype,"stroke",2),d([Y(Ui,{optional:!0})],Ve.prototype,"strokeWidth",2),d([Y(Po)],Ve.prototype,"strokeOpacity",2),d([Y(Ui)],Ve.prototype,"cornerRadius",2),d([Y(Ov)],Ve.prototype,"textAlign",2),d([Y(hU)],Ve.prototype,"verticalAlign",2),d([Y(Ui)],Ve.prototype,"gap",2),d([Y(Ui)],Ve.prototype,"padding",2),d([Y(Qe)],Ve.prototype,"label",2),d([Y(Qe)],Ve.prototype,"secondaryLabel",2);var Cs=class extends Ql{constructor(){super(...arguments),this.label=new wi}};d([Y(Ls,{optional:!0})],Cs.prototype,"fill",2),d([Y(Po,{optional:!0})],Cs.prototype,"fillOpacity",2),d([Y(ql,{optional:!0})],Cs.prototype,"stroke",2),d([Y(Ui,{optional:!0})],Cs.prototype,"strokeWidth",2),d([Y(Po,{optional:!0})],Cs.prototype,"strokeOpacity",2),d([Y(Qe)],Cs.prototype,"label",2);var Bo=class extends Ql{constructor(){super(...arguments),this.label=new wi,this.secondaryLabel=new bn}};d([Y(Ls,{optional:!0})],Bo.prototype,"fill",2),d([Y(Po,{optional:!0})],Bo.prototype,"fillOpacity",2),d([Y(ql,{optional:!0})],Bo.prototype,"stroke",2),d([Y(Ui,{optional:!0})],Bo.prototype,"strokeWidth",2),d([Y(Po,{optional:!0})],Bo.prototype,"strokeOpacity",2),d([Y(Qe)],Bo.prototype,"label",2),d([Y(Qe)],Bo.prototype,"secondaryLabel",2);var uu=class extends aU{constructor(){super(...arguments),this.group=new Cs,this.tile=new Bo}};d([Y(Qe)],uu.prototype,"group",2),d([Y(Qe)],uu.prototype,"tile",2);var Mi=class extends sU{constructor(){super(...arguments),this.highlightStyle=new uu,this.tooltip=new nU,this.group=new qe,this.tile=new Ve,this.undocumentedGroupFills=[],this.undocumentedGroupStrokes=[]}};d([Y(Ls,{optional:!0})],Mi.prototype,"sizeName",2),d([Y(Ls,{optional:!0})],Mi.prototype,"labelKey",2),d([Y(Ls,{optional:!0})],Mi.prototype,"secondaryLabelKey",2),d([Y(lU,{optional:!0})],Mi.prototype,"itemStyler",2),d([Y(Qe)],Mi.prototype,"highlightStyle",2),d([Y(Qe)],Mi.prototype,"tooltip",2),d([Y(Qe)],Mi.prototype,"group",2),d([Y(Qe)],Mi.prototype,"tile",2),d([Y(Nv)],Mi.prototype,"undocumentedGroupFills",2),d([Y(Nv)],Mi.prototype,"undocumentedGroupStrokes",2);var{TextUtils:dU,TextWrapper:pU,formatValue:Cv}=$l,{Rect:Jl,Group:uU,BBox:tc,Selection:Ev,Text:Bn}=pu,{Color:gU,Logger:yU,clamp:fU,isEqual:mU,sanitizeHtml:gu}=tU,_v=new Bn;function xU(t,e){const{fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a}=e;_v.setProperties({text:t,fontStyle:i,fontWeight:o,fontSize:s,fontFamily:a,textAlign:"left",textBaseline:"top"});const{width:n,height:r}=_v.getBBox();return{width:n,height:r}}function Rv(t){if(typeof t=="string"&&!gU.validColorString(t)){const e="black";return yU.warnOnce(`invalid Treemap tile colour string "${t}". Affected treemap tiles will be coloured ${e}.`),e}return t}function zo(t){return t.children.length>0?t.sumSize-t.size:t.size}var wv={left:0,center:.5,right:1},SU={top:0,middle:.5,bottom:1},bU=class extends pu.Group{distanceSquared(t,e){return this.getBBox().distanceSquared(t,e)}},yu=class extends $l.HierarchySeries{constructor(){super(...arguments),this.properties=new Mi,this.groupSelection=Ev.select(this.contentGroup,bU),this.highlightSelection=Ev.select(this.highlightGroup,uU)}groupTitleHeight(t,e){const i=this.labelData?.[t.index]?.label,{label:o}=this.properties.group,s=3;if(i!=null){if(o.fontSize>e.width/s||o.fontSize>e.height/s)return;{const{height:a}=xU(i,o);return Math.max(a,o.fontSize)}}}getNodePadding(t,e){if(t.index===0)return{top:0,right:0,bottom:0,left:0};if(t.children.length===0){const{padding:n}=this.properties.tile;return{top:n,right:n,bottom:n,left:n}}const{label:{spacing:i},padding:o}=this.properties.group,s=this.groupTitleHeight(t,e),a=s!=null?s+i:0;return{top:o+a,right:o,bottom:o,left:o}}async processData(){await super.processData();const{childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,tile:r,group:l}=this.properties;if(!this.data?.length){this.labelData=void 0;return}this.labelData=Array.from(this.rootNode,({datum:c,depth:h,children:p})=>{const u=p.length===0,y=u?r.label:l.label;let g;if(c!=null&&h!=null&&o!=null){const m=c[o];g=this.getLabelText(y,{depth:h,datum:c,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:m},Cv)}g===""&&(g=void 0);let f;if(u&&c!=null&&h!=null&&s!=null){const m=c[s];f=this.getLabelText(r.secondaryLabel,{depth:h,datum:c,childrenKey:t,colorKey:e,colorName:i,labelKey:o,secondaryLabelKey:s,sizeKey:a,sizeName:n,value:m},Cv)}return f===""&&(f=void 0),g!=null||f!=null?{label:g,secondaryLabel:f}:void 0})}sortChildren({children:t}){const e=Array.from(t,(o,s)=>s).filter(o=>zo(t[o])>0).sort((o,s)=>zo(t[s])-zo(t[o]));return{sortedChildrenIndices:e,childAt:o=>{const s=e[o];return t[s]}}}squarify(t,e,i,o){const{index:s,datum:a,children:n}=t;if(e.width<=0||e.height<=0){i[s]=void 0,o[s]=void 0;return}const r=a!=null?this.getNodePadding(t,e):{top:0,right:0,bottom:0,left:0};i[s]=s===0?void 0:e,o[s]=s===0?void 0:r;const{sortedChildrenIndices:l,childAt:c}=this.sortChildren(t),h=l.every(D=>n[D].children.length===0),p=1,u=e.width-r.left-r.right,y=e.height-r.top-r.bottom;if(u<=0||y<=0)return;const g=l.length;let f=0,m=0,v=1/0,b=l.reduce((D,I)=>D+zo(n[I]),0);const S=new tc(e.x+r.left,e.y+r.top,u,y),x=S.clone();let M=0;for(;M<g;){const D=zo(c(M)),I=zo(c(m)),N=x.width<x.height;f+=D;const O=N?x.height:x.width,L=N?x.width:x.height,C=L*I/f;let k=O*f/b;const E=Math.max(C,k)/Math.min(C,k),_=Math.abs(p-E);if(_<v){v=_,M++;continue}f-=D,k=O*f/b;let w=N?x.x:x.y;for(let B=m;B<M;B++){const P=c(B),R=zo(P),z=N?w:x.x,F=N?x.y:w,U=L*R/f,G=N?U:k,V=N?k:U,j=new tc(z,F,G,V);this.applyGap(S,j,h),this.squarify(P,j,i,o),b-=R,w+=U}N?(x.y+=k,x.height-=k):(x.x+=k,x.width-=k),m=M,f=0,v=1/0}const T=x.width<x.height;let A=T?x.x:x.y;for(let D=m;D<g;D++){const I=c(D),N=T?A:x.x,O=T?x.y:A,L=zo(I)/b,C=x.width*(T?L:1),k=x.height*(T?1:L),E=new tc(N,O,C,k);this.applyGap(S,E,h),this.squarify(I,E,i,o),A+=T?C:k}}applyGap(t,e,i){const o=i?this.properties.tile.gap*.5:this.properties.group.gap*.5,s=l=>({left:l.x,top:l.y,right:l.x+l.width,bottom:l.y+l.height}),a=s(t),n=s(e);["top","right","bottom","left"].forEach(l=>{mU(a[l],n[l])||e.shrink(o,l)})}async createNodeData(){}async updateSelections(){if(!this.nodeDataRefresh)return;this.nodeDataRefresh=!1;const{seriesRect:t}=this.chart??{};if(!t)return;const e=Array.from(this.rootNode),i=o=>{o.append([new Jl,new Bn({tag:0}),new Bn({tag:1})])};this.groupSelection.update(e,i,o=>this.getDatumId(o)),this.highlightSelection.update(e,i,o=>this.getDatumId(o))}getTileFormat(t,e){const{datum:i,depth:o,children:s}=t,{colorKey:a,childrenKey:n,labelKey:r,secondaryLabelKey:l,sizeKey:c,tile:h,group:p,itemStyler:u}=this.properties;if(!u||i==null||o==null)return{};const y=s.length===0,g=this.getNodeFill(t),f=this.getNodeStroke(t),m=y?h.strokeWidth:p.strokeWidth;return this.ctx.callbackCache.call(u,{seriesId:this.id,highlighted:e,datum:i,depth:o,colorKey:a,childrenKey:n,labelKey:r,secondaryLabelKey:l,sizeKey:c,fill:g,fillOpacity:1,stroke:f,strokeWidth:m,strokeOpacity:1})}getNodeFill(t){if(t.children.length===0)return this.properties.tile.fill??t.fill;const{undocumentedGroupFills:i}=this.properties,o=i[Math.min(t.depth??0,i.length)];return this.properties.group.fill??o}getNodeStroke(t){if(t.children.length===0)return this.properties.tile.stroke??t.stroke;const{undocumentedGroupStrokes:i}=this.properties,o=i[Math.min(t.depth??0,i.length)];return this.properties.group.stroke??o}async updateNodes(){const{rootNode:t,data:e}=this,{highlightStyle:i,tile:o,group:s}=this.properties,{seriesRect:a}=this.chart??{};if(!a||!e)return;const{width:n,height:r}=a,l=Array.from(this.rootNode,()=>{}),c=Array.from(this.rootNode,()=>{});this.squarify(t,new tc(0,0,n,r),l,c);let h=this.ctx.highlightManager?.getActiveHighlight();h!=null&&!this.properties.group.interactive&&h.children.length!==0&&(h=void 0),this.updateNodeMidPoint(l);const p=(g,f,m)=>{const v=l[g.index];if(v==null){f.visible=!1;return}const b=g.children.length===0;let S,x,M,T,A;if(m){const{tile:w,group:B}=i;S=b?w.fill:B.fill,x=b?w.fillOpacity:B.fillOpacity,M=b?w.stroke:B.stroke,T=b?w.strokeWidth:B.strokeWidth,A=b?w.strokeOpacity:B.strokeOpacity}const D=this.getTileFormat(g,m),I=D?.fill??S??this.getNodeFill(g),N=D?.fillOpacity??x??(b?o.fillOpacity:s.fillOpacity),O=D?.stroke??M??this.getNodeStroke(g),L=D?.strokeWidth??T??(b?o.strokeWidth:s.strokeWidth),C=D?.strokeOpacity??A??(b?o.strokeOpacity:s.strokeOpacity);f.crisp=!0,f.fill=Rv(I),f.fillOpacity=N,f.stroke=Rv(O),f.strokeWidth=L,f.strokeOpacity=C,f.cornerRadius=b?o.cornerRadius:s.cornerRadius;const k=g.parent?.children.every(w=>w.children.length===0),E=g.parent!=null?l[g.parent.index]:void 0,_=g.parent!=null?c[g.parent.index]:void 0;k===!0&&E!=null&&_!=null?(f.clipBBox=v,f.x=E.x+_.left,f.y=E.y+_.top,f.width=E.width-(_.left+_.right),f.height=E.height-(_.top+_.bottom)):(f.clipBBox=void 0,f.x=v.x,f.y=v.y,f.width=v.width,f.height=v.height),f.visible=!0};this.groupSelection.selectByClass(Jl).forEach(g=>p(g.datum,g,!1)),this.highlightSelection.selectByClass(Jl).forEach(g=>{const f=g.datum===h;g.visible=f||(h?.contains(g.datum)??!1),g.visible&&p(g.datum,g,f)});const u=Array.from(this.rootNode,g=>{const{index:f,children:m}=g,v=l[f],b=this.labelData?.[f];if(!(v==null||b==null))if(m.length===0){const S={width:v.width,height:v.height,meta:null},x=_d(b.label,this.properties.tile.label,b.secondaryLabel,this.properties.tile.secondaryLabel,{padding:o.padding},()=>S);if(x==null)return;const{height:M,label:T,secondaryLabel:A}=x,{textAlign:D,verticalAlign:I,padding:N}=o,O=wv[D]??.5,L=v.x+N+(v.width-2*N)*O,C=SU[I]??.5,k=v.y+N+M*.5+(v.height-2*N-M)*C;return{label:T!=null?{text:T.text,fontSize:T.fontSize,lineHeight:T.lineHeight,style:this.properties.tile.label,x:L,y:k-(M-T.height)*.5}:void 0,secondaryLabel:A!=null?{text:A.text,fontSize:A.fontSize,lineHeight:A.fontSize,style:this.properties.tile.secondaryLabel,x:L,y:k+(M-A.height)*.5}:void 0,verticalAlign:"middle",textAlign:D}}else{if(b?.label==null)return;{const{padding:S,textAlign:x}=s,M=this.groupTitleHeight(g,v);if(M==null)return;const T=v.width-2*S,A=pU.wrapText(b.label,{maxWidth:v.width-2*S,font:s.label,textWrap:"never"}),D=wv[x]??.5;return{label:{text:A,fontSize:s.label.fontSize,lineHeight:dU.getLineHeight(s.label.fontSize),style:this.properties.group.label,x:v.x+S+T*D,y:v.y+S+M*.5},secondaryLabel:void 0,verticalAlign:"middle",textAlign:x}}}}),y=(g,f,m,v)=>{const b=g.children.length===0,S=u[g.index],x=m===0?S?.label:S?.secondaryLabel;if(S==null||x==null){f.visible=!1;return}let M;if(v){const{tile:T,group:A}=i;M=T.secondaryLabel.color,b?m===0&&(M=T.label.color):M=A.label.color}f.text=x.text,f.fontSize=x.fontSize,f.lineHeight=x.lineHeight,f.fontStyle=x.style.fontStyle,f.fontFamily=x.style.fontFamily,f.fontWeight=x.style.fontWeight,f.fill=M??x.style.color,f.textAlign=S.textAlign,f.textBaseline=S.verticalAlign,f.x=x.x,f.y=x.y,f.visible=!0};this.groupSelection.selectByClass(Bn).forEach(g=>{y(g.datum,g,g.tag,!1)}),this.highlightSelection.selectByClass(Bn).forEach(g=>{const f=g.datum===h;g.visible=f||(h?.contains(g.datum)??!1),g.visible&&y(g.datum,g,g.tag,f)})}updateNodeMidPoint(t){this.rootNode.walk(e=>{const i=t[e.index];i!=null&&(e.midPoint.x=i.x+i.width/2,e.midPoint.y=i.y)})}pickNodeClosestDatum(t){const e=this.pickNodeExactShape(t);return e!==void 0?e:this.pickNodeNearestDistantObject(t,this.groupSelection.nodes())}getTooltipHtml(t){const{datum:e,depth:i}=t,{id:o}=this,{tooltip:s,colorKey:a,colorName:n=a,labelKey:r,secondaryLabelKey:l,sizeKey:c,sizeName:h=c,childrenKey:p}=this.properties,u=t.children.length===0,y=u||this.properties.group.interactive;if(e==null||i==null||!y)return $l.EMPTY_TOOLTIP_CONTENT;const g=r!=null?e[r]:void 0,m=this.getTileFormat(t,!1)?.fill??this.getNodeFill(t);if(!s.renderer&&!g)return $l.EMPTY_TOOLTIP_CONTENT;const v=[],b=l!=null?e[l]:void 0;b!=null&&l!==a&&l!==c&&v.push(gu(b));const S=c!=null?e[c]:void 0;S!=null&&v.push(`${h}: ${gu(S)}`);const x=a!=null?e[a]:void 0;x!=null&&v.push(`${n}: ${gu(x)}`);const M=v.join("<br>"),T={title:g,color:u?this.properties.tile.label.color:this.properties.group.label.color,backgroundColor:m,content:M};return s.toTooltipHtml(T,{depth:i,datum:e,colorKey:a,labelKey:r,secondaryLabelKey:l,sizeKey:c,title:g,color:m,seriesId:o,childrenKey:p,colorName:n,itemId:void 0,sizeName:h})}pickFocus(t){const{focusPath:e}=this;(e.length<2||this.focusSorted==null)&&(e.length=1,this.focusSorted=this.sortChildren(e[0].nodeDatum),e.push({nodeDatum:this.focusSorted.childAt(0),childIndex:0}));const{datumIndexDelta:i,otherIndexDelta:o}=t,s=e[e.length-1];if(o===1){if(s.nodeDatum.children.length>0){this.focusSorted=this.sortChildren(s.nodeDatum);const n={nodeDatum:this.focusSorted.childAt(0),childIndex:0};return e.push(n),this.computeFocusOutputs(n)}}else if(i!==0){const n=s.childIndex+i,r=(s.nodeDatum.parent?.children.length??1)-1;return s.childIndex=fU(0,n,r),s.nodeDatum=this.focusSorted.childAt(s.childIndex),this.computeFocusOutputs(s)}const a=super.pickFocus(t);return o<0&&(this.focusSorted=this.sortChildren(e[e.length-1].nodeDatum.parent)),a}computeFocusBounds(t){const e=this.groupSelection.selectByClass(Jl);return pu.Transformable.toCanvas(e[t.index])}};yu.className="TreemapSeries",yu.type="treemap";var{DEFAULT_DIVERGING_SERIES_COLOR_RANGE:vU,DEFAULT_FONT_FAMILY:fu,DEFAULT_HIERARCHY_FILLS:MU,DEFAULT_HIERARCHY_STROKES:TU,DEFAULT_INSIDE_SERIES_LABEL_COLOUR:ec,DEFAULT_LABEL_COLOUR:Pv,FONT_WEIGHT:Bv}=JV,AU={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["hierarchy"],identifier:"treemap",moduleFactory:t=>new yu(t),tooltipDefaults:{range:"exact"},solo:!0,themeTemplate:{series:{group:{label:{enabled:!0,color:Pv,fontStyle:void 0,fontWeight:Bv.NORMAL,fontSize:12,fontFamily:fu,spacing:4},fill:void 0,stroke:void 0,strokeWidth:1,padding:4,gap:2,textAlign:"left"},tile:{label:{enabled:!0,color:ec,fontStyle:void 0,fontWeight:Bv.NORMAL,fontSize:18,minimumFontSize:10,fontFamily:fu,wrapping:"on-space",overflowStrategy:"ellipsis",spacing:2},secondaryLabel:{enabled:!0,color:ec,fontStyle:void 0,fontWeight:void 0,fontSize:12,minimumFontSize:10,fontFamily:fu,wrapping:"never",overflowStrategy:"ellipsis"},fill:void 0,stroke:void 0,strokeWidth:0,padding:3,gap:1},highlightStyle:{group:{label:{color:Pv},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2},tile:{label:{color:ec},secondaryLabel:{color:ec},fill:void 0,stroke:"rgba(0, 0, 0, 0.4)",strokeWidth:2}}},gradientLegend:{enabled:!0}},paletteFactory:({takeColors:t,colorsCount:e,themeTemplateParameters:i})=>{const{fills:o,strokes:s}=t(e),a=i.get(vU),n=i.get(MU),r=i.get(TU);return{fills:o,strokes:s,colorRange:a,undocumentedGroupFills:n,undocumentedGroupStrokes:r}}};import{_Theme as Fo}from"ag-charts-community";import{_ModuleSupport as Es,_Scene as zv,_Util as DU}from"ag-charts-community";import{_ModuleSupport as kU,_Scene as IU}from"ag-charts-community";var{DropShadow:NU,Label:OU}=IU,{AbstractBarSeriesProperties:LU,BaseProperties:zn,PropertiesArray:CU,SeriesTooltip:EU,Validate:q,BOOLEAN:_U,COLOR_STRING:mu,FUNCTION:Fv,LINE_DASH:Vv,NUMBER:RU,OBJECT:uo,OBJECT_ARRAY:wU,POSITIVE_NUMBER:Pa,RATIO:xu,STRING:Ba,UNION:Uv}=kU,ic=class extends zn{};d([q(Uv(["subtotal","total"],"a total type"))],ic.prototype,"totalType",2),d([q(RU)],ic.prototype,"index",2),d([q(Ba)],ic.prototype,"axisLabel",2);var Hv=class extends zn{};d([q(Fv,{optional:!0})],Hv.prototype,"renderer",2);var Su=class extends OU{constructor(){super(...arguments),this.placement="outside-end",this.padding=6}};d([q(Uv(["inside-center","inside-start","inside-end","outside-start","outside-end",{value:"inside",deprecatedTo:"inside-center"},{value:"start",deprecatedTo:"outside-start"},{value:"end",deprecatedTo:"outside-end"}],"a placement"))],Su.prototype,"placement",2),d([q(Pa)],Su.prototype,"padding",2);var ge=class extends zn{constructor(){super(...arguments),this.fill="#c16068",this.stroke="#c16068",this.fillOpacity=1,this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=1,this.cornerRadius=0,this.shadow=new NU().set({enabled:!1}),this.label=new Su,this.tooltip=new Hv}};d([q(Ba,{optional:!0})],ge.prototype,"name",2),d([q(mu)],ge.prototype,"fill",2),d([q(mu)],ge.prototype,"stroke",2),d([q(xu)],ge.prototype,"fillOpacity",2),d([q(xu)],ge.prototype,"strokeOpacity",2),d([q(Vv)],ge.prototype,"lineDash",2),d([q(Pa)],ge.prototype,"lineDashOffset",2),d([q(Pa)],ge.prototype,"strokeWidth",2),d([q(Pa)],ge.prototype,"cornerRadius",2),d([q(Fv,{optional:!0})],ge.prototype,"itemStyler",2),d([q(uo)],ge.prototype,"shadow",2),d([q(uo)],ge.prototype,"label",2),d([q(uo)],ge.prototype,"tooltip",2);var _s=class extends zn{constructor(){super(...arguments),this.enabled=!0,this.stroke="black",this.strokeOpacity=1,this.lineDash=[0],this.lineDashOffset=0,this.strokeWidth=2}};d([q(_U)],_s.prototype,"enabled",2),d([q(mu)],_s.prototype,"stroke",2),d([q(xu)],_s.prototype,"strokeOpacity",2),d([q(Vv)],_s.prototype,"lineDash",2),d([q(Pa)],_s.prototype,"lineDashOffset",2),d([q(Pa)],_s.prototype,"strokeWidth",2);var oc=class extends zn{constructor(){super(...arguments),this.positive=new ge,this.negative=new ge,this.total=new ge}};d([q(uo)],oc.prototype,"positive",2),d([q(uo)],oc.prototype,"negative",2),d([q(uo)],oc.prototype,"total",2);var go=class extends LU{constructor(){super(...arguments),this.item=new oc,this.totals=new CU(ic),this.line=new _s,this.tooltip=new EU}};d([q(Ba)],go.prototype,"xKey",2),d([q(Ba)],go.prototype,"yKey",2),d([q(Ba,{optional:!0})],go.prototype,"xName",2),d([q(Ba,{optional:!0})],go.prototype,"yName",2),d([q(uo)],go.prototype,"item",2),d([q(wU)],go.prototype,"totals",2),d([q(uo)],go.prototype,"line",2),d([q(uo)],go.prototype,"tooltip",2);var{adjustLabelPlacement:PU,SeriesNodePickMode:Gv,fixNumericExtent:BU,valueProperty:Wv,keyProperty:zU,accumulativeValueProperty:sc,trailingAccumulatedValueProperty:FU,ChartAxisDirection:bu,getRectConfig:VU,updateRect:UU,checkCrisp:HU,updateLabelNode:GU,prepareBarAnimationFunctions:WU,collapsedStartingBarPosition:KU,resetBarSelectionsFn:YU,seriesLabelFadeInAnimation:jU,resetLabelFn:XU,animationValidation:ZU,DEFAULT_CARTESIAN_DIRECTION_KEYS:$U,DEFAULT_CARTESIAN_DIRECTION_NAMES:QU,formatValue:qU,computeBarFocusBounds:JU}=Es,{Rect:tH,motion:eH}=zv,{sanitizeHtml:Fn,isContinuous:Kv}=DU,iH={"inside-center":"inside-center","inside-start":"inside-start","inside-end":"inside-end","outside-start":"outside-start","outside-end":"outside-end",inside:"inside-center",start:"outside-start",end:"outside-end"},vu=class extends Es.AbstractBarSeries{constructor(t){super({moduleCtx:t,directionKeys:$U,directionNames:QU,pickModes:[Gv.NEAREST_NODE,Gv.EXACT_SHAPE_MATCH],pathsPerSeries:["connector"],hasHighlightedLabels:!0,pathsZIndexSubOrderOffset:[-1,-1],animationResetFns:{datum:YU,label:XU}}),this.properties=new go,this.seriesItemTypes=new Set(["positive","negative","total"])}async processData(t){const{xKey:e,yKey:i,totals:o}=this.properties,{data:s=[]}=this;if(!this.properties.isValid()||!this.visible)return;const a=b=>Kv(b)&&Number(b)>=0,n=b=>Kv(b)&&Number(b)>=0,r=b=>b==="total"||b==="subtotal",l={missingValue:void 0,invalidValue:void 0},c=[],h=o.reduce((b,S)=>{const x=b.get(S.index);return x?x.push(S):b.set(S.index,[S]),b},new Map);s.forEach((b,S)=>{c.push(b),h.get(S)?.forEach(x=>c.push({...x.toJson(),[e]:x.axisLabel}))});const p=[];this.ctx.animationManager.isSkipped()||p.push(ZU());const u=this.getCategoryAxis()?.scale,y=this.getValueAxis()?.scale,{isContinuousX:g,xScaleType:f,yScaleType:m}=this.getScaleInformation({xScale:u,yScale:y}),{processedData:v}=await this.requestDataModel(t,c,{props:[zU(e,f,{id:"xValue"}),sc(i,m,{...l,id:"yCurrent"}),sc(i,m,{...l,missingValue:0,id:"yCurrentTotal"}),sc(i,m,{...l,id:"yCurrentPositive",validation:a}),sc(i,m,{...l,id:"yCurrentNegative",validation:n}),FU(i,m,{...l,id:"yPrevious"}),Wv(i,m,{id:"yRaw"}),Wv("totalType","band",{id:"totalTypeValue",missingValue:void 0,validation:r}),...g?[Es.SMALLEST_KEY_INTERVAL,Es.LARGEST_KEY_INTERVAL]:[],...p]});this.smallestDataInterval=v.reduced?.smallestKeyInterval,this.largestDataInterval=v.reduced?.largestKeyInterval,this.updateSeriesItemTypes(),this.animationState.transition("updateData")}getSeriesDomain(t){const{processedData:e,dataModel:i}=this;if(!e||!i)return[];const{keys:[o],values:s}=e.domain;if(t===this.getCategoryDirection()){const a=i.resolveProcessedDataDefById(this,"xValue");if(a?.def.type==="key"&&a?.def.valueType==="category")return o;const n=t===bu.Y,r=this.getCategoryAxis().isReversed();return this.padBandExtent(o,r!==n)}else{const a=i.resolveProcessedDataIndexById(this,"yCurrent"),n=s[a],r=[Math.min(0,n[0]),Math.max(0,n[1])];return BU(r)}}async createNodeData(){const{data:t,dataModel:e}=this,i=this.getCategoryAxis(),o=this.getValueAxis();if(!t||!i||!o||!e)return;const{line:s}=this.properties,a=i.scale,n=o.scale,r=this.getBarDirection()===bu.X,l=this.getBandwidth(i)??10,c=i.isReversed(),h=o.isReversed();if(this.processedData?.type!=="ungrouped")return;const p={itemId:this.properties.yKey,nodeData:[],labelData:[],pointData:[],scales:this.calculateScaling(),visible:this.visible};if(!this.visible)return p;const u=e.resolveProcessedDataIndexById(this,"yRaw"),y=e.resolveProcessedDataIndexById(this,"xValue"),g=e.resolveProcessedDataIndexById(this,"totalTypeValue"),f=[],m=e.resolveProcessedDataIndexById(this,"yCurrent"),v=e.resolveProcessedDataIndexById(this,"yPrevious"),b=e.resolveProcessedDataIndexById(this,"yCurrentTotal");function S(O,L,C){return O||L?{cumulativeValue:C[b],trailingValue:L?M:0}:{cumulativeValue:C[m],trailingValue:C[v]}}function x(O,L,C,k,E){return O?k:L?(k??0)-(E??0):C}let M=0;const{xKey:T,yKey:A,xName:D,yName:I}=this.properties;this.processedData?.data.forEach(({keys:O,datum:L,values:C},k)=>{const E=C[g],_=this.isSubtotal(E),w=this.isTotal(E),B=w||_,P=O[y],R=Math.round(a.convert(P)),z=C[u],{cumulativeValue:F,trailingValue:U}=S(w,_,C);B&&(M=F??0);const G=Math.round(n.convert(F)),V=Math.round(n.convert(U)),j=x(w,_,z,F,U),K=(j??0)>=0,Z=this.getSeriesItemType(K,E),{fill:gt,stroke:nt,strokeWidth:et,label:tt}=this.getItemConfig(Z),ht=K?G:V,yt=K?V:G,it=Math.max(et,Math.abs(yt-ht)),$={x:r?Math.min(ht,yt):R,y:r?R:Math.min(ht,yt),width:r?it:l,height:r?l:it},Tt={x:$.x+$.width/2,y:$.y+$.height/2},Vt=B?G:V,pt=Math.floor(s.strokeWidth)%2/2,ye=c?G:Vt,Ut=c?Vt:G;let _e,Ue;r?(_e={x:ye+pt,y:$.y},Ue={x:Ut+pt,y:$.y+$.height}):(_e={x:$.x,y:ye+pt},Ue={x:$.x+$.width,y:Ut+pt});const Hi={x:c?Ue.x:_e.x,y:c?Ue.y:_e.y,x2:c?_e.x:Ue.x,y2:c?_e.y:Ue.y,size:0};f.push(Hi);const ws=Z==="subtotal"?"total":Z,Hn=this.getLabelText(tt,{itemId:ws,value:j,datum:L,xKey:T,yKey:A,xName:D,yName:I},qU),za={index:k,series:this,itemId:Z,datum:L,cumulativeValue:F??0,xValue:P,yValue:j,yKey:A,xKey:T,x:$.x,y:$.y,width:$.width,height:$.height,midPoint:Tt,fill:gt,stroke:nt,strokeWidth:et,opacity:1,label:{text:Hn,...PU({isUpward:(j??-1)>=0!==h,isVertical:!r,placement:iH[tt.placement],padding:tt.padding,rect:$})}};p.nodeData.push(za),p.labelData.push(za)});const N=this.properties.line.enabled;return m!==void 0&&N&&(p.pointData=f),p}updateSeriesItemTypes(){const{dataModel:t,seriesItemTypes:e,processedData:i}=this;if(!t||!i)return;e.clear();const o=t.resolveProcessedDataIndexById(this,"yCurrentPositive"),s=t.resolveProcessedDataIndexById(this,"yCurrentNegative"),a=t.resolveProcessedDataIndexById(this,"totalTypeValue"),n=i.domain.values[o]??[],r=i.domain.values[s]??[];n.length>0&&e.add("positive"),r.length>0&&e.add("negative");const l=i?.domain.values[a];l&&l.forEach(c=>{(c==="total"||c==="subtotal")&&e.add("total")})}isSubtotal(t){return t==="subtotal"}isTotal(t){return t==="total"}nodeFactory(){return new tH}getSeriesItemType(t,e){return e??(t?"positive":"negative")}getItemConfig(t){switch(t){case"positive":return this.properties.item.positive;case"negative":return this.properties.item.negative;case"subtotal":case"total":return this.properties.item.total}}async updateDatumSelection(t){const{nodeData:e,datumSelection:i}=t,o=e??[];return i.update(o)}async updateDatumNodes(t){const{datumSelection:e,isHighlight:i}=t,{id:o,ctx:s}=this,{yKey:a,highlightStyle:{item:n}}=this.properties,r=this.getCategoryAxis(),l=HU(r?.scale,r?.visibleRange,this.smallestDataInterval,this.largestDataInterval),c=this.getCategoryDirection()===bu.X;e.each((h,p)=>{const u=p.itemId,{fillOpacity:y,strokeOpacity:g,strokeWidth:f,lineDash:m,lineDashOffset:v,cornerRadius:b,itemStyler:S,shadow:x}=this.getItemConfig(u),M={fill:p.fill,stroke:p.stroke,fillOpacity:y,strokeOpacity:g,lineDash:m,lineDashOffset:v,fillShadow:x,strokeWidth:this.getStrokeWidth(f),cornerRadius:b},T=c?p.width>0:p.height>0,A=VU({datum:p,isHighlighted:i,style:M,highlightStyle:n,itemStyler:S,seriesId:o,itemId:p.itemId,ctx:s,value:p.yValue,yKey:a});A.crisp=l,A.visible=T,UU(h,A)})}async updateLabelSelection(t){const{labelData:e,labelSelection:i}=t;if(e.length===0)return i.update([]);const o=e.filter(s=>{const{label:a}=this.getItemConfig(s.itemId);return a.enabled});return i.update(o)}async updateLabelNodes(t){t.labelSelection.each((e,i)=>{GU(e,this.getItemConfig(i.itemId).label,i.label)})}getTooltipHtml(t){const e=this.getCategoryAxis(),i=this.getValueAxis();if(!this.properties.isValid()||!e||!i)return Es.EMPTY_TOOLTIP_CONTENT;const{id:o}=this,{xKey:s,yKey:a,xName:n,yName:r,tooltip:l}=this.properties,{datum:c,itemId:h,xValue:p,yValue:u}=t,{fill:y,fillOpacity:g,stroke:f,strokeWidth:m,strokeOpacity:v,lineDash:b=[],lineDashOffset:S,cornerRadius:x,name:M,itemStyler:T}=this.getItemConfig(h);let A;T&&(A=this.ctx.callbackCache.call(T,{datum:c,xKey:s,yKey:a,fill:y,fillOpacity:g,stroke:f,strokeWidth:m,strokeOpacity:v,lineDash:b,lineDashOffset:S,cornerRadius:x,highlighted:!1,seriesId:o,itemId:t.itemId}));const D=A?.fill??y??"gray",I=Fn(e.formatDatum(p)),N=Fn(i.formatDatum(u)),O=this.isTotal(h),L=this.isSubtotal(h);let C;O?C="Total":L?C="Subtotal":C=M??r??a;const k=Fn(r),E=`<b>${Fn(n??s)}</b>: ${I}<br/><b>${Fn(C)}</b>: ${N}`;return l.toTooltipHtml({title:k,content:E,backgroundColor:D},{seriesId:o,itemId:h,datum:c,xKey:s,yKey:a,xName:n,yName:r,color:D,title:k})}getLegendData(t){if(t!=="category")return[];const{id:e,seriesItemTypes:i}=this,o=[],s=a=>a.charAt(0).toUpperCase()+a.substring(1);return i.forEach(a=>{const{fill:n,stroke:r,fillOpacity:l,strokeOpacity:c,strokeWidth:h,name:p}=this.getItemConfig(a);o.push({legendType:"category",id:e,itemId:a,seriesId:e,enabled:!0,label:{text:p??s(a)},symbols:[{marker:{fill:n,stroke:r,fillOpacity:l,strokeOpacity:c,strokeWidth:h}}]})}),o}toggleSeriesItem(){}animateEmptyUpdateReady({datumSelection:t,labelSelection:e,contextData:i,paths:o}){const s=WU(KU(this.isVertical(),this.axes,"normal"));eH.fromToMotion(this.id,"datums",this.ctx.animationManager,[t],s),jU(this,"labels",this.ctx.animationManager,e);const{pointData:a}=i;if(!a)return;const[n]=o;this.isVertical()?this.animateConnectorLinesVertical(n,a):this.animateConnectorLinesHorizontal(n,a)}animateConnectorLinesHorizontal(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c<h:(c,h)=>c>h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.x,c)&&(c=h.x),c),s?1/0:0),l=(c,h,p,u,y)=>(c-h)/(p-h)*(y-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:Es.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.x),y=l(c,n,r,n,h.x2);p!==0&&i.lineTo(u,h.y),i.moveTo(y,h.y2)}),t.checkPathDirty()}})}animateConnectorLinesVertical(t,e){const{path:i}=t;this.updateLineNode(t);const o=this.getValueAxis(),s=o?.isReversed(),a=s?(c,h)=>c>h:(c,h)=>c<h,n=o?.scale.convert(0),r=e.reduce((c,h)=>(a(h.y,c)&&(c=h.y),c),s?0:1/0),l=(c,h,p,u,y)=>(c-h)/(p-h)*(y-u)+u;this.ctx.animationManager.animate({id:`${this.id}_connectors`,groupId:this.id,phase:"initial",from:n,to:r,ease:Es.Motion.easeOut,collapsable:!1,onUpdate(c){i.clear(!0),e.forEach((h,p)=>{const u=l(c,n,r,n,h.y),y=l(c,n,r,n,h.y2);p!==0&&i.lineTo(h.x,u),i.moveTo(h.x2,y)}),t.checkPathDirty()}})}animateReadyResize(t){super.animateReadyResize(t),this.resetConnectorLinesPath(t)}async updatePaths(t){this.resetConnectorLinesPath({contextData:t.contextData,paths:t.paths})}resetConnectorLinesPath({contextData:t,paths:e}){if(e.length===0)return;const[i]=e;this.updateLineNode(i);const{path:o}=i;o.clear(!0);const{pointData:s}=t;s&&(s.forEach((a,n)=>{n!==0&&o.lineTo(a.x,a.y),o.moveTo(a.x2,a.y2)}),i.checkPathDirty())}updateLineNode(t){const{stroke:e,strokeWidth:i,strokeOpacity:o,lineDash:s,lineDashOffset:a}=this.properties.line;t.setProperties({fill:void 0,stroke:e,strokeWidth:this.getStrokeWidth(i),strokeOpacity:o,lineDash:s,lineDashOffset:a,lineJoin:"round",pointerEvents:zv.PointerEvents.None})}isLabelEnabled(){const{positive:t,negative:e,total:i}=this.properties.item;return t.label.enabled||e.label.enabled||i.label.enabled}onDataChange(){}computeFocusBounds({datumIndex:t,seriesRect:e}){return JU(this.contextNodeData?.nodeData[t],this.contentGroup,e)}};vu.className="WaterfallSeries",vu.type="waterfall";import{_Theme as ac}from"ag-charts-community";var Mu={strokeWidth:0,label:{enabled:!1,fontStyle:void 0,fontWeight:ac.FONT_WEIGHT.NORMAL,fontSize:12,fontFamily:ac.DEFAULT_FONT_FAMILY,color:ac.DEFAULT_LABEL_COLOUR,formatter:void 0,placement:"outside-end"}},oH={series:{item:{positive:Mu,negative:Mu,total:Mu},line:{stroke:ac.PALETTE_NEUTRAL_STROKE,strokeOpacity:1,lineDash:[0],lineDashOffset:0,strokeWidth:2}},legend:{enabled:!0,toggleSeries:!1}},sH={type:"series",optionsKey:"series[]",packageType:"enterprise",chartTypes:["cartesian"],identifier:"waterfall",solo:!0,moduleFactory:t=>new vu(t),tooltipDefaults:{range:"exact"},defaultAxes:Fo.swapAxisCondition([{type:Fo.CARTESIAN_AXIS_TYPE.NUMBER,position:Fo.CARTESIAN_POSITION.LEFT},{type:Fo.CARTESIAN_AXIS_TYPE.CATEGORY,position:Fo.CARTESIAN_POSITION.BOTTOM}],t=>t?.direction==="horizontal"),themeTemplate:oH,paletteFactory:({takeColors:t,colorsCount:e,userPalette:i,palette:o})=>{if(i==="user-indexed"){const{fills:s,strokes:a}=t(e);return{line:{stroke:o.neutral.stroke},item:{positive:{fill:s[0],stroke:a[0]},negative:{fill:s[1],stroke:a[1]},total:{fill:s[2],stroke:a[2]}}}}return{line:{stroke:o.neutral.stroke},item:{positive:{fill:o.altUp.fill,stroke:o.altUp.stroke,label:{color:Fo.DEFAULT_LABEL_COLOUR}},negative:{fill:o.altDown.fill,stroke:o.altDown.stroke,label:{color:Fo.DEFAULT_LABEL_COLOUR}},total:{fill:o.neutral.fill,stroke:o.neutral.stroke,label:{color:Fo.DEFAULT_LABEL_COLOUR}}}}}},aH=`.ag-watermark{position:absolute;bottom:20px;right:25px;font-weight:700;font-family:Impact,sans-serif;font-size:19px;opacity:.7;animation:1s ease-out 3s ag-watermark-fadeout;color:#9b9b9b;pointer-events:none;&:before{content:"";display:block;height:40px;width:170px;background-image:url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU4IiBoZWlnaHQ9IjQwIiB2aWV3Qm94PSIwIDAgMjU4IDQwIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMjUuNzc5IDI4LjY1N0gxMy4zNTlMMTEuMTczIDM0LjAxMkg1LjY3Mjk3TDE3LjE4MiA3LjA1OTk5SDIxLjk1M0wzMy40NjIgMzQuMDEySDI3Ljk2MkwyNS43NzYgMjguNjU3SDI1Ljc3OVpNMjQuMDY4IDI0LjM5N0wxOS41ODggMTMuNDM0TDE1LjEwNyAyNC4zOTdIMjQuMDY4Wk02Mi4wOTIgMTguODIzSDQ5LjgxN1YyMy4wODZINTYuNzc1QzU2LjU1NSAyNS4yMjIgNTUuNzU1IDI2LjkyNyA1NC4zNzIgMjguMjAyQzUyLjk4OSAyOS40NzYgNTEuMTY2IDMwLjExNSA0OC45MDkgMzAuMTE1QzQ3LjYyMiAzMC4xMTUgNDYuNDUgMjkuODg1IDQ1LjM5MyAyOS40MjNDNDQuMzU4MyAyOC45NzgxIDQzLjQzMjYgMjguMzEzOCA0Mi42OCAyNy40NzZDNDEuOTI3IDI2LjYzOSA0MS4zNDQgMjUuNjMxIDQwLjkzMSAyNC40NTNDNDAuNTE5IDIzLjI3NSA0MC4zMTEgMjEuOTcgNDAuMzExIDIwLjUzN0M0MC4zMTEgMTkuMTA1IDQwLjUxNiAxNy44IDQwLjkzMSAxNi42MjFDNDEuMzQ0IDE1LjQ0MyA0MS45MjcgMTQuNDM2IDQyLjY4IDEzLjU5OEM0My40Mzc2IDEyLjc1NzcgNDQuMzY5NiAxMi4wOTMyIDQ1LjQxMSAxMS42NTFDNDYuNDc4IDExLjE4OSA0Ny42NTYgMTAuOTYgNDguOTQ2IDEwLjk2QzUxLjYxMiAxMC45NiA1My42MzcgMTEuNjAyIDU1LjAyIDEyLjg4NUw1OC4zIDkuNjA0OTlDNTUuODE3IDcuNjY5OTkgNTIuNjc2IDYuNjk5OTkgNDguODcyIDYuNjk5OTlDNDYuNzYgNi42OTk5OSA0NC44NTMgNy4wMzQ5OSA0My4xNTQgNy43MDA5OUM0MS40NTUgOC4zNjc5OSAzOS45OTggOS4zMDM5OSAzOC43ODMgMTAuNTA0QzM3LjU2NyAxMS43MDcgMzYuNjM0IDEzLjE1OCAzNS45NzcgMTQuODU3QzM1LjMxOSAxNi41NTYgMzQuOTk0IDE4LjQ1MSAzNC45OTQgMjAuNTRDMzQuOTk0IDIyLjYzIDM1LjMyOSAyNC40OTQgMzUuOTk1IDI2LjIwNUMzNi42NjIgMjcuOTE2IDM3LjYwNSAyOS4zNzQgMzguODE3IDMwLjU3N0M0MC4wMzIgMzEuNzggNDEuNDg2IDMyLjcxMyA0My4xODggMzMuMzgzQzQ0Ljg4OCAzNC4wNDkgNDYuNzgyIDM0LjM4NCA0OC44NzIgMzQuMzg0QzUwLjk2MSAzNC4zODQgNTIuNzUgMzQuMDQ5IDU0LjM5IDMzLjM4M0M1Ni4wMzEgMzIuNzE2IDU3LjQyNiAzMS43OCA1OC41NzkgMzAuNTc3QzU5LjczMyAyOS4zNzQgNjAuNjE5IDI3LjkxNiA2MS4yMzkgMjYuMjA1QzYxLjg2IDI0LjQ5NCA2Mi4xNyAyMi42MDUgNjIuMTcgMjAuNTRDNjIuMTY5NiAxOS45Njg4IDYyLjE0NDUgMTkuMzk4IDYyLjA5NSAxOC44MjlMNjIuMDkyIDE4LjgyM1pNMTUxLjgxIDE2Ljk4MUMxNTMuNDEgMTQuNjA5IDE1Ny40MTkgMTQuMzU4IDE1OS4wMjIgMTQuMzU4VjE4LjkxQzE1Ni45NTcgMTguOTEgMTU0Ljk4NSAxOC45OTYgMTUzLjc1NyAxOS44OTJDMTUyLjUyOSAyMC43OTIgMTUxLjkxOSAyMS45ODIgMTUxLjkxOSAyMy40NjRWMzMuOTlIMTQ2Ljk2NFYxNC4zNThIMTUxLjczNkwxNTEuODEgMTYuOTgxWk0xNDMuMDExIDE0LjM2MVYzNC4wMzFIMTM4LjI0TDEzOC4xMzEgMzEuMDQ1QzEzNy40NjYgMzIuMDc2IDEzNi41NTEgMzIuOTIxOSAxMzUuNDcxIDMzLjUwNEMxMzQuMzc2IDM0LjA5OSAxMzMuMDY4IDM0LjM5NiAxMzEuNTM2IDM0LjM5NkMxMzAuMiAzNC4zOTYgMTI4Ljk2MyAzNC4xNTIgMTI3LjgyMiAzMy42NjhDMTI2LjcgMzMuMTk2NCAxMjUuNjg5IDMyLjQ5NSAxMjQuODU1IDMxLjYwOUMxMjQuMDE4IDMwLjcyMiAxMjMuMzU0IDI5LjY2MiAxMjIuODcxIDI4LjQyMkMxMjIuMzg0IDI3LjE4NSAxMjIuMTQyIDI1LjgxMSAxMjIuMTQyIDI0LjMwNEMxMjIuMTQyIDIyLjc5OCAxMjIuMzg0IDIxLjM3OCAxMjIuODcxIDIwLjExNkMxMjMuMzU3IDE4Ljg1NCAxMjQuMDE4IDE3Ljc3MiAxMjQuODU1IDE2Ljg3M0MxMjUuNjg4IDE1Ljk3NjQgMTI2LjY5OCAxNS4yNjM2IDEyNy44MjIgMTQuNzhDMTI4Ljk2MyAxNC4yODEgMTMwLjIwMyAxNC4wMzMgMTMxLjUzNiAxNC4wMzNDMTMzLjA0MyAxNC4wMzMgMTM0LjMzIDE0LjMxOCAxMzUuMzk3IDE0Ljg4OEMxMzYuNDYyIDE1LjQ1ODkgMTM3LjM3NSAxNi4yNzggMTM4LjA1NyAxNy4yNzZWMTQuMzYxSDE0My4wMTFaTTEzMi42MzEgMzAuMTMzQzEzNC4yNTYgMzAuMTMzIDEzNS41NjcgMjkuNTk0IDEzNi41NjUgMjguNTEyQzEzNy41NjEgMjcuNDMgMTM4LjA2IDI1Ljk5MSAxMzguMDYgMjQuMTk2QzEzOC4wNiAyMi40MDEgMTM3LjU2MSAyMC45OSAxMzYuNTY1IDE5Ljg5OUMxMzUuNTcgMTguODA3IDEzNC4yNTkgMTguMjU4IDEzMi42MzEgMTguMjU4QzEzMS4wMDMgMTguMjU4IDEyOS43MjkgMTguODA0IDEyOC43MzQgMTkuODk5QzEyNy43MzggMjAuOTkzIDEyNy4yMzkgMjIuNDM4IDEyNy4yMzkgMjQuMjMzQzEyNy4yMzkgMjYuMDI4IDEyNy43MzUgMjcuNDMzIDEyOC43MzQgMjguNTE1QzEyOS43MjkgMjkuNTk0IDEzMS4wMjggMzAuMTM2IDEzMi42MzEgMzAuMTM2VjMwLjEzM1pNOTMuNjk4IDI3Ljg3NkM5My41Nzk1IDI4LjAwMjUgOTMuNDU2NCAyOC4xMjQ2IDkzLjMyOSAyOC4yNDJDOTEuOTQ3IDI5LjUxNiA5MC4xMjMgMzAuMTU1IDg3Ljg2NiAzMC4xNTVDODYuNTggMzAuMTU1IDg1LjQwOCAyOS45MjYgODQuMzUgMjkuNDY0QzgzLjMxNTUgMjkuMDE4OSA4Mi4zODk4IDI4LjM1NDYgODEuNjM3IDI3LjUxN0M4MC44ODQgMjYuNjc5IDgwLjMwMSAyNS42NzIgNzkuODg5IDI0LjQ5NEM3OS40NzYgMjMuMzE1IDc5LjI2OSAyMi4wMSA3OS4yNjkgMjAuNTc4Qzc5LjI2OSAxOS4xNDUgNzkuNDczIDE3Ljg0IDc5Ljg4OSAxNi42NjJDODAuMzAxIDE1LjQ4NCA4MC44ODQgMTQuNDc2IDgxLjYzNyAxMy42MzlDODIuMzk0OSAxMi43OTg3IDgzLjMyNzMgMTIuMTM0MiA4NC4zNjkgMTEuNjkyQzg1LjQzNiAxMS4yMyA4Ni42MTQgMTEgODcuOTAzIDExQzkwLjU3IDExIDkyLjU5NSAxMS42NDIgOTMuOTc3IDEyLjkyNkw5Ny4yNTggOS42NDQ5OUM5NC43NzQgNy43MTA5OSA5MS42MzMgNi43Mzk5OSA4Ny44MjkgNi43Mzk5OUM4NS43MTggNi43Mzk5OSA4My44MTEgNy4wNzQ5OSA4Mi4xMTIgNy43NDE5OUM4MC40MTMgOC40MDc5OSA3OC45NTYgOS4zNDQ5OSA3Ny43NCAxMC41NDVDNzYuNTI1IDExLjc0NyA3NS41OTIgMTMuMTk5IDc0LjkzNCAxNC44OThDNzQuMjc3IDE2LjU5NyA3My45NTEgMTguNDkxIDczLjk1MSAyMC41ODFDNzMuOTUxIDIyLjY3IDc0LjI4NiAyNC41MzQgNzQuOTUzIDI2LjI0NUM3NS42MTkgMjcuOTU3IDc2LjU2MiAyOS40MTQgNzcuNzc0IDMwLjYxN0M3OC45OSAzMS44MiA4MC40NDQgMzIuNzUzIDgyLjE0NiAzMy40MjNDODMuODQ1IDM0LjA5IDg1LjczOSAzNC40MjQgODcuODI5IDM0LjQyNEM4OS45MTkgMzQuNDI0IDkxLjcwOCAzNC4wOSA5My4zNDggMzMuNDIzQzk0LjcxOCAzMi44NjUgOTUuOTE4IDMyLjEyMSA5Ni45NDggMzEuMTkxQzk3LjE0OSAzMS4wMDggOTcuMzQ4IDMwLjgxNSA5Ny41MzcgMzAuNjJMOTMuNzAxIDI3Ljg4NUw5My42OTggMjcuODc2Wk0xMTAuODAyIDE0LjAxNUMxMDkuMTk5IDE0LjAxNSAxMDYuODM2IDE0LjQ3MSAxMDUuNjExIDE2LjE1OEwxMDUuNTM3IDYuMDE1OTlIMTAwLjc2NVYzMy45MzlIMTA1LjcyVjIyLjY0MUMxMDUuNzcxIDIxLjQ2MDcgMTA2LjI4OCAyMC4zNDg4IDEwNy4xNTcgMTkuNTQ4OUMxMDguMDI3IDE4Ljc0OTEgMTA5LjE3OCAxOC4zMjY2IDExMC4zNTggMTguMzc0QzExMy4zOTcgMTguMzc0IDExNC4yNjggMjEuMTU5IDExNC4yNjggMjIuNjQxVjMzLjkzOUgxMTkuMjIzVjIxLjA1OUMxMTkuMjIzIDIxLjA1OSAxMTkuMTQyIDE0LjAxNSAxMTAuODAyIDE0LjAxNVpNMTczLjc2MyAxNC4zNThIMTY5Ljk5OVY4LjcxNDk5SDE2NS4wNDhWMTQuMzU4SDE2MS4yODRWMTguOTE2SDE2NS4wNDhWMzQuMDAzSDE2OS45OTlWMTguOTE2SDE3My43NjNWMTQuMzU4Wk0xOTAuNzg3IDI1LjI2MkMxOTAuMTI5IDI0LjUwMTQgMTg5LjMwNyAyMy44OTk0IDE4OC4zODQgMjMuNTAxQzE4Ny40ODggMjMuMTE3IDE4Ni4zMzEgMjIuNzMyIDE4NC45NDggMjIuMzY0QzE4NC4xNjUgMjIuMTQzOSAxODMuMzkgMjEuODk3OCAxODIuNjIzIDIxLjYyNkMxODIuMTYzIDIxLjQ2MjEgMTgxLjc0MSAyMS4yMDY2IDE4MS4zODMgMjAuODc1QzE4MS4yMzUgMjAuNzQyMSAxODEuMTE4IDIwLjU3ODkgMTgxLjAzOSAyMC4zOTY0QzE4MC45NjEgMjAuMjE0IDE4MC45MjIgMjAuMDE2NiAxODAuOTI3IDE5LjgxOEMxODAuOTI3IDE5LjI3MiAxODEuMTU2IDE4Ljg0NCAxODEuNjI1IDE4LjUxQzE4Mi4xMjEgMTguMTU2IDE4Mi44NjIgMTcuOTc2IDE4My44MjYgMTcuOTc2QzE4NC43OSAxNy45NzYgMTg1LjU4NyAxOC4yMDkgMTg2LjE0OCAxOC42NjhDMTg2LjcwNiAxOS4xMjQgMTg3LjAwNyAxOS43MjUgMTg3LjA3MiAyMC41TDE4Ny4wOTQgMjAuNzgySDE5MS42MzNMMTkxLjYxNyAyMC40NkMxOTEuNTIxIDE4LjQ4NSAxOTAuNzcxIDE2LjkgMTg5LjM4NSAxNS43NUMxODguMDEyIDE0LjYxMiAxODYuMTg1IDE0LjAzMyAxODMuOTYyIDE0LjAzM0MxODIuNDc3IDE0LjAzMyAxODEuMTQxIDE0LjI4NyAxNzkuOTk0IDE0Ljc4NkMxNzguODMxIDE1LjI5MSAxNzcuOTI2IDE1Ljk5NSAxNzcuMjk2IDE2Ljg4MkMxNzYuNjczIDE3Ljc0NTUgMTc2LjMzOCAxOC43ODQgMTc2LjM0MSAxOS44NDlDMTc2LjM0MSAyMS4xNjcgMTc2LjY5OCAyMi4yNDkgMTc3LjM5OSAyMy4wNjRDMTc4LjA2IDIzLjg0MzIgMTc4Ljg5OCAyNC40NTM0IDE3OS44NDIgMjQuODQ0QzE4MC43NDQgMjUuMjE2IDE4MS45MjggMjUuNjA3IDE4My4zNjEgMjZDMTg0LjgwNiAyNi40MSAxODUuODcyIDI2Ljc4NSAxODYuNTMgMjcuMTIzQzE4Ny4xIDI3LjQxNCAxODcuMzc5IDI3Ljg0NSAxODcuMzc5IDI4LjQ0NEMxODcuMzc5IDI5LjA0MiAxODcuMTIyIDI5LjQ2NyAxODYuNTk1IDI5LjgzOUMxODYuMDQzIDMwLjIyNiAxODUuMjM3IDMwLjQyNSAxODQuMjAxIDMwLjQyNUMxODMuMTY2IDMwLjQyNSAxODIuMzk0IDMwLjE3NCAxODEuNzQ5IDI5LjY3NEMxODEuMTEzIDI5LjE4MSAxODAuNzcyIDI4LjU4OSAxODAuNzEgMjcuODY0TDE4MC42ODUgMjcuNTgySDE3Ni4wMTNMMTc2LjAyNSAyNy45MDFDMTc2LjA2NyAyOS4wOTU1IDE3Ni40NzIgMzAuMjQ4NyAxNzcuMTg4IDMxLjIwNkMxNzcuOTA3IDMyLjE4IDE3OC44OTMgMzIuOTU4IDE4MC4xMTggMzMuNTE5QzE4MS4zMzYgMzQuMDc3IDE4Mi43MzIgMzQuMzYyIDE4NC4yNjYgMzQuMzYyQzE4NS44MDEgMzQuMzYyIDE4Ny4xMDkgMzQuMTA4IDE4OC4yMzggMzMuNjA5QzE4OS4zNzYgMzMuMTA0IDE5MC4yNzIgMzIuMzk0IDE5MC45MDEgMzEuNDk0QzE5MS41MzQgMzAuNTkyIDE5MS44NTMgMjkuNTU0IDE5MS44NTMgMjguNDAzQzE5MS44MjggMjcuMTEgMTkxLjQ2NiAyNi4wNTMgMTkwLjc3NyAyNS4yNjJIMTkwLjc4N1oiIGZpbGw9IiM5QjlCOUIiLz4KPHBhdGggZD0iTTI0MS45ODIgMjUuNjU4MlYxNy43MTE3SDIyOC40NDFMMjIwLjQ5NCAyNS42NTgySDI0MS45ODJaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNTcuMjM5IDUuOTUwODFIMjQwLjI2NUwyMzIuMjU1IDEzLjg5NzNIMjU3LjIzOVY1Ljk1MDgxWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjEyLjYxMSAzMy42MDQ4TDIxNi42OCAyOS41MzYxSDIzMC40MTJWMzcuNDgyN0gyMTIuNjExVjMzLjYwNDhaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yMTUuNTk5IDIxLjc4MDNIMjI0LjM3MkwyMzIuMzgyIDEzLjgzMzdIMjE1LjU5OVYyMS43ODAzWiIgZmlsbD0iIzlCOUI5QiIvPgo8cGF0aCBkPSJNMjA2IDMzLjYwNDdIMjEyLjYxMUwyMjAuNDk0IDI1LjY1ODJIMjA2VjMzLjYwNDdaIiBmaWxsPSIjOUI5QjlCIi8+CjxwYXRoIGQ9Ik0yNDAuMjY1IDUuOTUwODFMMjM2LjE5NyAxMC4wMTk0SDIxMC4yNTlWMi4wNzI4OEgyNDAuMjY1VjUuOTUwODFaIiBmaWxsPSIjOUI5QjlCIi8+Cjwvc3ZnPgo=);background-repeat:no-repeat;background-size:170px 40px}>span{padding-left:.7rem}}@keyframes ag-watermark-fadeout{0%{opacity:.5}to{opacity:0}}.ag-charts-popover{position:absolute;border:var(--ag-charts-popover-border);border-radius:var(--ag-charts-popover-border-radius);background:var(--ag-charts-popover-background-color);color:var(--ag-charts-popover-foreground-color);font-family:var(--ag-charts-font-family);font-size:var(--ag-charts-popover-font-size);z-index:var(--ag-charts-layer-ui-overlay)}.ag-charts-menu{display:grid;grid:auto-flow auto / 1fr;column-gap:12px;min-width:200px;font-size:var(--ag-charts-popover-font-size-small);--item-padding: 6px 12px;--icon-color: var(--ag-charts-popover-foreground-color)}.ag-charts-menu:has(.ag-charts-menu__icon,.ag-charts-menu__row--stroke-width-visible){grid:auto-flow auto / auto 1fr}.ag-charts-menu__row--stroke-width-visible:before{content:"";height:var(--strokeWidth);width:12px;background:var(--icon-color)}.ag-charts-menu__row--stroke-width-visible[aria-disabled=true]:before{filter:grayscale(1);opacity:.5}.ag-charts-menu__row{display:grid;grid-column:1 / -1;grid-template-columns:subgrid;align-items:center;padding:var(--item-padding)}.ag-charts-menu__row:not(.ag-charts-menu__row--active){cursor:pointer}.ag-charts-menu__row:first-child{border-top-left-radius:inherit;border-top-right-radius:inherit}.ag-charts-menu__row:last-child{border-bottom-left-radius:inherit;border-bottom-right-radius:inherit}.ag-charts-menu__row:focus{background:var(--ag-charts-popover-hover-color)}.ag-charts-menu__row:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-menu__row--active{--icon-color: var(--ag-charts-popover-active-color);background:var(--ag-charts-popover-active-background-color);color:var(--ag-charts-popover-active-color)}.ag-charts-menu__label{grid-column:-1 / span 1}.ag-charts-dialog{display:flex;flex-direction:column;font-size:14px}.ag-charts-dialog__tabs{display:flex;flex-direction:column}.ag-charts-dialog__header{border-bottom:1px solid var(--ag-charts-border-color);display:flex}.ag-charts-dialog__tab-list{display:flex;gap:var(--ag-charts-input-spacing)}.ag-charts-dialog__drag-handle{align-items:center;color:inherit;cursor:grab;display:flex;padding:1px 6px;text-align:center}.ag-charts-dialog__drag-handle--dragging{cursor:grabbing}.ag-charts-dialog__tab-button{background:none;border:0;border-bottom:2px solid transparent;border-radius:0;color:var(--ag-charts-dialog-tab-color--inactive);margin-bottom:-1px;padding:var(--ag-charts-input-padding) calc(var(--ag-charts-input-padding) / 2)}.ag-charts-dialog__tab-button:hover{background:none}.ag-charts-dialog__tab-button--active{border-color:currentColor;color:inherit}.ag-charts-dialog__drag-handle+.ag-charts-dialog__tab-button{margin-left:calc(var(--ag-charts-input-spacing) * -1)}.ag-charts-button.ag-charts-dialog__close-button{background:none;border:0;margin-left:auto;padding:1px 6px}.ag-charts-dialog__close-button:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-charts-dialog__tab-panel{display:none;flex-direction:column;gap:calc(var(--ag-charts-input-spacing) * 2);margin:0 calc(var(--ag-charts-input-spacing) * 2);padding:calc(var(--ag-charts-input-spacing) * 2) 0}.ag-charts-dialog__tab-panel--active{display:flex}.ag-charts-dialog__input-group-line{display:flex;gap:18px}.ag-charts-dialog__input-group{align-items:center;display:flex;font-size:12px}.ag-charts-dialog__input-group-label{color:var(--ag-charts-dialog-input-group-label-color);margin-right:5px}.ag-charts-dialog__input-group-label[for]{cursor:pointer}.ag-charts-dialog__button{border-radius:0;margin-right:-1px}.ag-charts-dialog__button.ag-charts-dialog__button--active{background:var(--ag-charts-input-background-color--active);border-color:var(--ag-charts-input-border-color--active);color:var(--ag-charts-input-color--active);z-index:var(--input-layer-active)}.ag-charts-dialog__button:first-child,.ag-charts-dialog__input-group-label+.ag-charts-dialog__button{border-bottom-left-radius:var(--ag-charts-input-border-radius);border-top-left-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__button:last-child{border-bottom-right-radius:var(--ag-charts-input-border-radius);border-top-right-radius:var(--ag-charts-input-border-radius)}.ag-charts-dialog__color-picker-button{--color: #000;background:var(--color);border:none;color:transparent;height:26px;width:26px}.ag-charts-dialog__color-picker-button:hover{background:var(--color)}.ag-charts-color-picker{width:190px;padding:8px;--h: 0;--s: 0;--v: 0;--a: 0;--color: #000;--color-a: #000;--thumb-size: 18px;--inner-width: 172px;--track-height: 12px;--palette-height: 136px;--checker: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="4" height="4"><rect x="0" y="0" width="4" height="4" fill="%23fff"/><path d="M0 0H2V4H4V2H0Z" fill="%23b2b2b2"/></svg>')}.ag-charts-color-picker__content{display:flex;flex-direction:column}.ag-charts-color-picker__palette{position:relative;width:100%;height:var(--palette-height);margin-bottom:8px;background:linear-gradient(to bottom,#0000,#000),linear-gradient(to right,#fff,#fff0) hsl(var(--h),100%,50%);border-radius:6px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__palette:after{content:"";position:absolute;display:block;top:calc(var(--thumb-size) * -.5 + (1 - var(--v)) * 100%);left:calc(var(--thumb-size) * -.5 + var(--s) * 100%);background:var(--color);width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038}.ag-charts-color-picker__palette:focus-visible:after{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),0 0 0 2px #fff8,var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input,.ag-charts-color-picker__alpha-input{-webkit-appearance:none;display:block;position:relative;padding:0;margin:0 calc(var(--inset) * -1);border:0;height:var(--thumb-size);width:auto;background:transparent;--inset: calc((var(--thumb-size) - var(--track-height)) / 2)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{-webkit-appearance:none;width:var(--thumb-size);height:var(--thumb-size);border-radius:99px;box-shadow:var(--box-shadow);--box-shadow: inset 0 0 0 3px white, inset 0 0 1px 3px #0006, 0 0 5px #00000038;transform:translateZ(0)}.ag-charts-color-picker__hue-input::-webkit-slider-thumb{background:hsl(var(--h),100%,50%)}.ag-charts-color-picker__alpha-input::-webkit-slider-thumb{background:transparent}.ag-charts-color-picker__alpha-input--opaque::-webkit-slider-thumb{background:var(--color)}.ag-charts-color-picker__hue-input:focus-visible::-webkit-slider-thumb,.ag-charts-color-picker__alpha-input:focus-visible::-webkit-slider-thumb{outline:var(--ag-charts-focus-border);box-shadow:var(--box-shadow),var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__hue-input:before,.ag-charts-color-picker__alpha-input:before{position:absolute;content:"";display:block;top:calc(50% - var(--track-height) / 2);left:var(--inset);right:var(--inset);height:var(--track-height);border-radius:99px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__hue-input{margin-bottom:4px}.ag-charts-color-picker__hue-input:before{background:linear-gradient(to right,red,red calc((100% - var(--track-height)) * 0 / 6 + var(--track-height) / 2),#ff0 calc((100% - var(--track-height)) * 1 / 6 + var(--track-height) / 2),#0f0 calc((100% - var(--track-height)) * 2 / 6 + var(--track-height) / 2),#0ff calc((100% - var(--track-height)) * 3 / 6 + var(--track-height) / 2),#00f calc((100% - var(--track-height)) * 4 / 6 + var(--track-height) / 2),#f0f calc((100% - var(--track-height)) * 5 / 6 + var(--track-height) / 2),red calc((100% - var(--track-height)) * 6 / 6 + var(--track-height) / 2))}.ag-charts-color-picker__alpha-input{margin-bottom:7px}.ag-charts-color-picker__alpha-input:before{background:linear-gradient(to right,transparent,var(--color)),var(--checker) top left / 4px 4px}.ag-charts-color-picker__color-field{display:flex;border:var(--ag-charts-border);background:var(--ag-charts-background-color);border-radius:4px;overflow:hidden}.ag-charts-color-picker__color-field:has(:focus-visible){border-color:var(--ag-charts-active-color);box-shadow:var(--ag-charts-focus-border-shadow)}.ag-charts-color-picker__color-label{width:16px;height:16px;margin:7px 0 7px 7px;color:transparent;background:linear-gradient(to right,var(--color-a),var(--color-a)),var(--checker) top left / 4px 4px;border-radius:2px;box-shadow:inset 0 0 0 1px #0003}.ag-charts-color-picker__color-input{flex:1;min-width:0;padding:7px 7px 7px 8px;border:0;margin:0;color:inherit;background:transparent;font-variant:tabular-nums}.ag-charts-color-picker__color-input:focus-visible{border:none;outline:none}.ag-charts-annotations__axis-button-wrapper{position:absolute;left:0;top:0;user-select:none;font:16px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-annotations);box-sizing:border-box}.ag-charts-annotations__axis-button-wrapper--hidden{display:none}.ag-charts-annotations__axis-button{cursor:pointer;border:none;border-radius:2px;padding:0;line-height:16px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-charts-annotations__axis-button:hover{opacity:.8;color:var(--ag-charts-axis-label-color)}.annotations__text-size{width:34px;min-width:0;border-top-left-radius:0;border-top-right-radius:0;--item-padding: 4px 8px}.annotations__line-stroke-width{min-width:0;--item-padding: 6px;column-gap:var(--item-padding)}.annotations__line-style-type{min-width:0;--item-padding: 6px;column-gap:0}.ag-charts-dialog--annotation-settings{min-height:233px;width:289px}.ag-charts-dialog--annotation-settings .ag-charts-textarea{height:calc(10px * 2 + var(--line-height) * 1em * 3 + 2px);overflow-y:auto;resize:vertical}.ag-charts-annotations-text-size-menu{border-top-left-radius:0;border-top-right-radius:0;min-width:0;width:34px;--item-padding: 4px 8px}.ag-chart-context-menu{background:#f8f8f8;border:1px solid #babfc7;border-radius:5px;box-shadow:0 1px 4px 1px #babfc766;color:#181d1f;font:13px Verdana,sans-serif;transition:transform .1s ease;white-space:nowrap;z-index:var(--ag-charts-layer-ui-overlay)}.ag-chart-context-menu.ag-charts-dark-context-menu{color:#fff;background:#15181c}.ag-chart-context-menu__cover{position:fixed;left:0;top:0}.ag-chart-context-menu__menu{display:flex;flex-direction:column;padding:.5em 0}.ag-chart-context-menu__menu:focus{outline:none}.ag-chart-context-menu__item{background:none;border:none;box-sizing:border-box;font:inherit;padding:.5em 1em;text-align:left;-webkit-appearance:none;-moz-appearance:none}.ag-chart-context-menu__item.ag-charts-dark-context-menu{color:#fff}.ag-chart-context-menu__item:focus{background:#2196f31a}.ag-chart-context-menu__item:focus.ag-charts-dark-context-menu{background:#2196f31a}.ag-chart-context-menu__item:active{background:#2196f333}.ag-chart-context-menu__item:active.ag-charts-dark-context-menu{background:#2196f31a}.ag-chart-context-menu__item:focus-visible{outline:var(--ag-charts-focus-border);box-shadow:var(--ag-charts-focus-border-shadow);z-index:calc(var(--ag-charts-layer-ui-overlay) + 1)}.ag-chart-context-menu__item[aria-disabled=true]{border:none;opacity:.5;text-align:left}.ag-chart-context-menu__item[aria-disabled=true]:focus{background:inherit;cursor:inherit}.ag-chart-context-menu__divider{margin:5px 0;background:#babfc7;height:1px}.ag-chart-context-menu__divider.ag-charts-dark-context-menu{background:#2196f31a}.ag-crosshair-label{position:absolute;left:0;top:0;user-select:none;pointer-events:none;font:12px Verdana,sans-serif;overflow:hidden;white-space:nowrap;z-index:var(--ag-charts-layer-crosshair);box-sizing:border-box}.ag-crosshair-label-content{padding:0 8px;border-radius:2px;line-height:20px;background-color:var(--ag-charts-axis-label-background-color);color:var(--ag-charts-axis-label-color)}.ag-crosshair-label-hidden{visibility:hidden!important}.ag-charts-text-input{position:absolute}.ag-charts-text-input__textarea{display:block;height:100%;width:100%;border:0;background:none;line-height:1.38;transform:translateY(.09em)}.ag-charts-text-input__textarea[placeholder]:empty:before{content:attr(placeholder);color:var(--ag-charts-input-placeholder-color);font-weight:400}.ag-charts-text-input__textarea[placeholder]:not(:empty):before{content:""}
`;function nH(){Fa.moduleRegistry.register(UM,iT,GT,eN,uN,y0,AL,d2,K2,_C,eE,T1,FL,mN,TN,zN,UN,l0,G_,qR,MR,Rw,OP,Jw,k0,z0,KO,zE,f1,aT,OB,LB,uz,Mz,ET,sF,VT,yV,BF,H1,WV,qV,Z0,AU,sH,OO),Fa.enterpriseModule.isEnterprise=!0,Fa.enterpriseModule.styles=aH,Fa.enterpriseModule.licenseManager=t=>new jO(t.container?.ownerDocument??(typeof document>"u"?void 0:document)),Fa.enterpriseModule.injectWatermark=$O}function rH(){return nH(),qv()}export{Qv as AgCharts,rH as setupEnterpriseModules};
